"use strict";(self.webpackChunksheet=self.webpackChunksheet||[]).push([["78401"],{927053:function(e,t,i){i.d(t,{OD:function(){return l}});var n=i(758699),o=i(921734),r=i(696030),s=i(156084),a=i(951924),l={NONE:0,TOP:1,RIGHT:2,BOTTOM:4,LEFT:8,Y:5,X:10,ALL:15};t.ZP=function(e){function t(t){var i;return(i=e.call(this)||this)._Sq=!1,i.spreadsheetView=t,i._SL=l.NONE,i._SQ={x:0,y:0},i._Sr={clientX:0,clientY:0,identifier:Date.now(),target:document},i.handleMousemove=e=>{i._Sw()?(i._So=e.clientX,i._SO=e.clientY,i._SZ({diffX:i._SQ.x,diffY:i._SQ.y,source:a.o.USER_AUTO_SCROLL}),i._ST(i._Su)):i._ab&&clearInterval(i._ab)},i._SR=(0,s.default)(i.handleMousemove,60),i._Ss=e=>{i._Sw()?(i._So=e.touches[0].clientX,i._SO=e.touches[0].clientY,i._SZ({diffX:i._SQ.x,diffY:i._SQ.y,source:a.o.USER_AUTO_SCROLL}),i._ST(i._SU)):i._ab&&clearInterval(i._ab)},i._SS=(0,s.default)(i._Ss,60),i._St=()=>{document.removeEventListener("mousemove",i._SR),document.removeEventListener("mouseup",i._St),document.removeEventListener("touchmove",i._SS),document.removeEventListener("touchend",i._St),clearTimeout(i._ab),i._SL=l.NONE,i._SM=null,i._Sm=null,i._SN=null,i._Sn=null,i._SQ.x=0,i._SQ.y=0,i._Sp=0,i._SP=0,i._Sq=!1},i._ST=e=>{clearTimeout(i._ab),i._ab=setTimeout(e,60)},i._Su=()=>{try{var e=new MouseEvent("mousemove",{clientX:i._So,clientY:i._SO});document.dispatchEvent(e)}catch(e){return}i._ST(i._Su)},i._SU=()=>{i._Sr.clientX=i._So,i._Sr.clientY=i._SO;var e=new TouchEvent("touchmove",{touches:[new Touch(i._Sr)]});document.dispatchEvent(e),i._ST(i._SU)},i}(0,o._)(t,e);var i=t.prototype;return i.ready=function(e,t,i){this._SL=e;var n=this._Sv(),o=this._SV();this._Sn=n,this._Sm=n,this._SN=o,this._SM=o,document.addEventListener("mousemove",this._SR,!0),document.addEventListener("mouseup",this._St,!0),document.addEventListener("touchmove",this._SS,!0),document.addEventListener("touchend",this._St,!0),this._Sp=(t||this.spreadsheetView.clientRect.width-this.spreadsheetView.areaData.col.flow.displayPadding)-10,this._SP=(i||this.spreadsheetView.clientRect.height-this.spreadsheetView.areaData.row.flow.displayPadding)-20,this._Sq=!0},i.dispose=function(){e.prototype.dispose.call(this),this._Sq&&(document.removeEventListener("mousemove",this._SR,!0),document.removeEventListener("mouseup",this._St,!0),document.removeEventListener("touchmove",this._SS,!0),document.removeEventListener("touchend",this._St,!0))},i._Sv=function(){var{operateData:e}=this.spreadsheetView.operateContext;return e.currRow>=0&&e.currRow<Number.MAX_SAFE_INTEGER?e.currRow<=this.spreadsheetView.areaData.row.frozen.to?this.spreadsheetView.areaData.row.frozen:this.spreadsheetView.areaData.row.flow:null},i._SV=function(){var{operateData:e}=this.spreadsheetView.operateContext;return e.currCol>=0&&e.currCol<Number.MAX_SAFE_INTEGER?e.currCol<=this.spreadsheetView.areaData.col.frozen.to?this.spreadsheetView.areaData.col.frozen:this.spreadsheetView.areaData.col.flow:null},i._Sw=function(){var e=this._SW(),t=this._Sx();return!!(Number(e)|Number(t))},i._SW=function(){var e=!1,{operateData:t}=this.spreadsheetView.operateContext;return this._SL&l.RIGHT&&(t.currCol===Number.MAX_SAFE_INTEGER||this._Sp>0&&t.displayCurrX>this._Sp)?e=this._SX():this._SL&l.LEFT&&(e=this._Sy()),e||(this._SQ.x=0),e},i._Sx=function(){var e=!1,{operateData:t}=this.spreadsheetView.operateContext;return this._SL&l.BOTTOM&&(t.currRow===Number.MAX_SAFE_INTEGER||this._SP>0&&t.displayCurrY>this._SP)?e=this._SY():this._SL&l.TOP&&(e=this._Sz()),e||(this._SQ.y=0),e},i._SX=function(){var{operateData:e}=this.spreadsheetView.operateContext,t=e.displayCurrX-this._Sp;return this._SQ.x=this._ta(l.X,t),!0},i._Sy=function(){var{operateData:e}=this.spreadsheetView.operateContext,t=this.spreadsheetView.areaData.col,i=this.spreadsheetView.headSize;if(this._SM===t.flow){if(e.currCol<t.flow.from){var n=t.frozen.displayViewSize+i.displayRowHeadWidth-e.displayCurrX;return this._SQ.x=-this._ta(l.X,n),!0}}else if(this._SM===t.frozen){var o=this._SV();if(null!==this._SN&&null!==o&&this._SN!==o)return this._SQ.x=-t.flow.offsetSize,this._SN=o,!0}return!1},i._SY=function(){var{operateData:e}=this.spreadsheetView.operateContext,t=e.displayCurrY-this._SP;return this._SQ.y=this._ta(l.Y,t),!0},i._Sz=function(){var{operateData:e}=this.spreadsheetView.operateContext,t=this.spreadsheetView.areaData.row,i=this.spreadsheetView.headSize;if(this._Sm===this.spreadsheetView.areaData.row.flow){if(e.currRow<this.spreadsheetView.areaData.row.flow.from){var n=t.frozen.displayViewSize+i.displayColHeadHeight-e.displayCurrY;return this._SQ.y=-this._ta(l.Y,n),!0}}else if(this._Sm===this.spreadsheetView.areaData.row.frozen){var o=this._Sv();if(null!==this._Sn&&null!==o&&this._Sn!==o)return this._SQ.y=-this.spreadsheetView.areaData.row.flow.offsetSize,this._Sn=o,!0}return!1},i._SZ=function(e){var{areaData:t}=this.spreadsheetView;t.col.flow.setOffsetSize(t.col.flow.offsetSize+e.diffX,e.source),t.row.flow.setOffsetSize(t.row.flow.offsetSize+e.diffY,e.source)},i._ta=function(e,t){var i=Math.max(Math.max(Math.floor(t),0)-20,0);return Math.min((e===l.X?40:8)+Math.floor(+i),e===l.X?80:120)},(0,n._)(t,[{key:"running",get:function(){return this._Sq}}]),t}(r.Disposable)},194305:function(e,t,i){i.d(t,{Z:function(){return S}});var n=i(921734),o=i(121210),r=i(887106),s=i(150061),a=i(494153),l=i(850934),c=i(683461),h=i(631352),_=i(365392),d=i(82041),u=i(541612),f=i(680465),p=i(971433),g=i(955953),v=i(122477),w=i(109960),m=new Image;m.src=a;var R=new Image;R.src=h;var S=function(e){function t(t){var i;return(i=e.call(this,t)||this)._AHz=new Map,i.renderAfterCell=e=>{var{row:t,col:n,cell:o}=e;if(i._Bvp(t,n,o)){var a=o.cellWidth,h=o.cellHeight,p=i._AiA(t,n),g=(0,w.Bh)(p||"");if(g){i._bLf({row:t,col:n,imageUrl:g,cellWidth:a,cellHeight:h});var S=s.ZP._cnA(g);if(!S)if(!s.ZP._cnb(g))return;else S=m;var{dx:A,dy:E,dWidth:y,dHeight:T,sx:L,sy:b,sWidth:C,sHeight:I}=(0,c.xl)({image:new l.x({url:g,width:S.width,height:S.height}),cellWidth:a-1,cellHeight:h-1,horizontalAlign:_.ZP.newInstance(d.V.Center),verticalAlign:u.ZP.newInstance(f.M.SmlCenter),imageElement:S}),D={dx:A,dy:E,dWidth:y,dHeight:T,img:S,sx:L,sy:b,sWidth:C,sHeight:I};i.alloyExcel.collectEngine.collectCell(r.g4.bitmap,{bitmapInfo:D,pos:{row:t,col:n}},r.Nm.mainContent);var M=i._Aia(t,n);if(v.QH.includes(M?.hyperlink.type)){var{dx:x,dy:O,dWidth:B,dHeight:N,sx:V,sy:z,sWidth:P,sHeight:k}=(0,c.xl)({image:new l.x({url:R.src,width:R.width,height:R.height}),cellWidth:a-1,cellHeight:h-1,horizontalAlign:_.ZP.newInstance(d.V.Center),verticalAlign:u.ZP.newInstance(f.M.SmlCenter),imageElement:R,fixedRatio:.3});i.alloyExcel.collectEngine.collectCell(r.g4.bitmap,{bitmapInfo:{dx:x,dy:O,dWidth:B,dHeight:N,img:R,sx:V,sy:z,sWidth:P,sHeight:k},pos:{row:t,col:n}},r.Nm.DateReminderContent)}}}},i._Rj=t.workbook,i._ll=t.renderApi,i.alloyExcel.onAfterCellRender(i.renderAfterCell),i}(0,n._)(t,e);var i=t.prototype;return i._Bvp=function(e,t,i){if(!v.Gt||i.isPrivate||i.isCanNotRead)return!1;var n=this._Rj.activeSheet.getCellDataAtPosition(e,t);return(0,v.zJ)(n)},i._bLf=function(e){var{imageUrl:t,row:i,col:n}=e;if(s.ZP._cnb(t))return!0;var{_ll:o}=this;return s.ZP._cnf(t).then(e=>{e&&o.renderNextTick({cellsToInvalidate:[{row:i,col:n}]})}).catch(()=>{o.renderNextTick({cellsToInvalidate:[{row:i,col:n}]})}),!0},i._Aia=function(e,t){var i=this._Rj.activeSheet.getCellDataAtPosition(e,t),n=i?.getCellHyperlinksInfo();if(n)return n.hyperlinksInfo.find(e=>v.PQ.includes(e.hyperlink.type)&&e.hyperlink.displayType===p.T.PreviewImage)},i._AiA=function(e,t){var i=this._Aia(e,t);if(i){var n=this._AHz.get(i.hyperlink.url);return n||this._Aib(e,t,i),n?.thumbnailUrl}},i._Aib=function(e,t,i){this._AHz.set(i.hyperlink.url,{thumbnailUrl:""}),(0,g.w)(i).then(n=>{n?this._AHz.set(i.hyperlink.url,{thumbnailUrl:n}):this._AHz.set(i.hyperlink.url,{thumbnailUrl:a}),this._ll.renderNextTick({cellsToInvalidate:[{row:e,col:t}]})})},t}(o.Z)},438810:function(e,t,i){i.d(t,{Z:function(){return h}});var n=i(921734),o=i(852743),r=i(683461),s=i(356318),a=i(121210),l=i(211672),c=i(887106),h=function(e){function t(t){var i;return(i=e.call(this,t)||this).renderAfterCell=e=>{var{row:t,col:n,cell:a}=e,l=i._bLe(t,n,a);if(null!==l){var h=i._Asd.getCellStyle(t,n),_=a.cellWidth,d=a.cellHeight,u=_-1,f=d-1,p=o.K,{dx:g,dy:v}=(0,r.F1)({cellWidth:u,cellHeight:f,dWidth:p,dHeight:p,horizontalAlign:h.horizontalAlign,verticalAlign:h.verticalAlign,marginX:o.Kw,marginY:o.Kw});i.alloyExcel.collectEngine.collectCell(c.g4.bitmap,{bitmapInfo:{dx:g,dy:v,dWidth:p,dHeight:p,img:l?s.Hy:s.uV,clipInfo:[0,0,u,f]},pos:{row:t,col:n}},c.Nm.mainContent)}},i._Rj=t.workbook,i._XY=t.rowColAccessor,i._Asd=t.cellStyleAccessor,i.alloyExcel.onAfterCellRender(i.renderAfterCell),i}return(0,n._)(t,e),t.prototype._bLe=function(e,t,i){var n=this._Rj.activeSheet.getCellDataAtPosition(e,t);if(n?.getExtendedType()!==l.$.Checkbox||i.isPrivate||i.isCanNotRead)return null;var r=n.getExtendedValue();return r!==o.cF.FALSE&&r!==o.cF.TRUE?null:r===o.cF.TRUE},t}(a.Z)},356318:function(e,t,i){i.d(t,{uV:function(){return s},mN:function(){return n},Hy:function(){return r},mn:function(){return o}});var n="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTUiIGhlaWdodD0iMTUiIHg9Ii41IiB5PSIuNSIgZmlsbD0iIzA2YTM1NyIgc3Ryb2tlPSIjMDZhMzU3IiByeD0iMiIvPjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik02LjY0IDkuNiAxMS45IDQgMTMgNS4xNjggNi41NyAxMiAzIDguMjA0bDEuMTctMS4yNDJ6Ii8+PC9zdmc+",o="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiI+PHJlY3Qgd2lkdGg9IjE1IiBoZWlnaHQ9IjE1IiB4PSIuNSIgeT0iLjUiIGZpbGw9IiNmZmYiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utb3BhY2l0eT0iLjE2IiByeD0iMiIvPjwvc3ZnPg==",r=new Image;r.src=n;var s=new Image;s.src=o},899842:function(e,t,i){i.d(t,{Z:function(){return f}});var n=i(921734),o=i(494153),r=i(524112),s=i(593296),a=i(109960),l=i(683461),c=i(150061),h=i(121210),_=i(887106),d=null,u=()=>(d||((d=new Image).src=o),d),f=function(e){function t(t){var i;return(i=e.call(this,t)||this)._bLE="test"===(0,r.IZ)("mode"),i.renderAfterCell=e=>{var{row:t,col:n,cell:o}=e,r=o.extendedValue,h=o.cellWidth,d=o.cellHeight;if(i._bLf({row:t,col:n,cell:o,image:r,cellWidth:h,cellHeight:d})){var f=(0,a.Bh)(r.url),p=c.ZP._cnA(f),g=!1;if(!p)if(!c.ZP._cnb(f))return;else p=u(),g=!0;var v=i._Asd.getCellStyle(t,n),{dx:w,dy:m,dWidth:R,dHeight:S,sx:A,sy:E,sWidth:y,sHeight:T}=(0,l.xl)({image:r,cellWidth:h-1,cellHeight:d-1,horizontalAlign:v.horizontalAlign,verticalAlign:v.verticalAlign,imageElement:p,isPlaceHolder:g}),L={dx:w,dy:m,dWidth:R,dHeight:S,img:p,sx:A,sy:E,sWidth:y,sHeight:T};i.alloyExcel.collectEngine.collectCell(_.g4.bitmap,{bitmapInfo:L,pos:{row:t,col:n}},_.Nm.CellImage,_.hP.CELL_IMAGE),i._bLE&&(0,s.default)(window,["cellImageConfigs",t,n],L)}},i._ll=t.renderApi,i._Asd=t.cellStyleAccessor,i.alloyExcel.onAfterCellRender(i.renderAfterCell),i}return(0,n._)(t,e),t.prototype._bLf=function(e){var{row:t,col:i,cell:n,image:o,cellWidth:r,cellHeight:s}=e;if(!o?.url||n.isPrivate||n.isCanNotRead)return!1;var l=(0,a.Bh)(o.url);if(c.ZP._cnb(l))return!0;var{_ll:h}=this,_=(0,c.yc)(o,r,s);return c.ZP._cnf(l,_).then(e=>{e&&h.renderNextTick({cellsToInvalidate:[{row:t,col:i}]})}).catch(e=>{console.error(e),h.renderNextTick({cellsToInvalidate:[{row:t,col:i}]})}),!0},t}(h.Z)},599099:function(e,t,i){i.d(t,{Z:function(){return d}});var n=i(921734),o=i(852743),r=i(496430),s=i(683461),a=i(121210),l=i(484893),c=i(211672),h=i(887106),_=i(869855),d=function(e){function t(t){var i;return(i=e.call(this,t)||this).renderAfterCell=e=>{var{row:t,col:n,cell:a}=e;if(i._BvP(t,n,a)){var c=a.content,d=a.cellWidth,u=a.cellHeight,f=(0,l.Gs)(c),p=d-1,g=u-1,v=i._Asd.getCellStyle(t,n),w=i._Asd.getCellPadding(t,n),m=[0,0,p-w.right,g],R=w.left??r.J9.left,S=p-R-(w.right??r.J9.right),A=o.$O,E=Math.max(S*f/100,2*A),{dy:y}=(0,s.F1)({cellWidth:p,cellHeight:g,dWidth:E,dHeight:o.E8,horizontalAlign:v.horizontalAlign,verticalAlign:v.verticalAlign,marginX:R,marginY:2}),T=i.alloyExcel.collectEngine;T.collectCell(h.g4.roundRect,{roundRectInfo:{rect:[R,y,E,o.E8],radius:A,clipInfo:m},roundRectProp:{fillColor:"#00c29c"},pos:{row:t,col:n}},h.Nm.mainContent),T.collectCell(h.g4.graphics,{color:_.BM.backgroundColor,graphicsInfo:{path:[0,0,p,0,p,g,0,g],fillInfo:{gradientFill:v.background.gradientFill??void 0,patternFill:v.background.patternFill??void 0}},pos:{row:t,col:n}},h.Nm.mainBackground)}},i._Rj=t.workbook,i._XY=t.rowColAccessor,i._Asd=t.cellStyleAccessor,i.alloyExcel.onAfterCellRender(i.renderAfterCell),i}return(0,n._)(t,e),t.prototype._BvP=function(e,t,i){var n=this._Rj.activeSheet.getCellDataAtPosition(e,t);if(n?.getExtendedType()!==c.$.Progress||i.isPrivate||i.isCanNotRead)return!1;var{content:o}=i;return!!(0,l.Gs)(o)&&!!(n?.getDataValidationResult()??!0)},t}(a.Z)},203712:function(e,t,i){i.d(t,{Z:function(){return h}});var n=i(921734),o=i(801903),r=i(198141),s=i(121210),a=i(57677),l=i(211672),c=i(887106),h=function(e){function t(t){var i;return(i=e.call(this,t)||this).renderAfterCell=e=>{var{row:t,col:n,cell:s}=e,l=i._Asd.getCellPadding(t,n);if(i._BvP(t,n,s)){var h=s.cellWidth,_=s.cellHeight,{collectEngine:d}=i.alloyExcel,u=s.isPrivate,f=s.isCanNotRead,p=i._AnW.getParagraph(t,n),g=i._Asd.getCellStyle(t,n),v=(0,a.rG)(i._Rj,s.content,g,l,p,i._XY,i._Anx,t,n,u,f);if(v?.length){var w=[0,0,h-l.right,_];v.forEach(e=>{var{offsetX:i,offsetY:s}=e,a=0;e.segments.forEach(e=>{var l,h,{size:_,text:u,bgColor:f,textProp:p}=e,g=_.width,v=_.height,m=a+i,{MARGIN:R,PADDING_X:S,RADIUS:A}=o.Gy,E=s-.75*v+R,y={fillColor:f?.hex||""};if(f?.hex==="#ffffff"&&(y.borderWidth=1,y.strokeColor="rgba(0,0,0,0.08)"),p[r.MG.STRIKETHROUGH]){var T=Math.round(v/4);l=[m+1+S,s-T,m+g-1-S,s-T]}p[r.MG.UNDERLINE]&&(h=[m+1+S,s+2,m+g-1-S,s+2]),d.collectCell(c.g4.roundRect,{roundRectInfo:{rect:[m+R,E,g-2*R,v-2*R],radius:A,clipInfo:w},roundRectProp:y,pos:{row:t,col:n}},c.Nm.mainContent),d.collectCell(c.g4.text,{textInfo:{pos:[m+R+S,E+.75*(v-2*R)],text:u,clipInfo:w,strikethroughInfo:l,underlineInfo:h},textPropHash:p.renderHash,pos:{row:t,col:n}},c.Nm.mainContent),a+=g})})}}},i._Rj=t.workbook,i._Anx=t.alignCrossCenterAccessor,i._XY=t.rowColAccessor,i._AnW=t.paragraphAccessor,i._Asd=t.cellStyleAccessor,i.alloyExcel.onAfterCellRender(i.renderAfterCell),i}return(0,n._)(t,e),t.prototype._BvP=function(e,t,i){var n=this._Rj.activeSheet.getCellDataAtPosition(e,t);return n?.getExtendedType()===l.$.Select&&!i.isPrivate&&!i.isCanNotRead&&n.getDataValidation()?.withColor},t}(s.Z)},749089:function(e,t,i){i.d(t,{Z:function(){return f}});var n=i(921734),o=i(708559),r=i(67790),s=i(852743),a=i(683461),l=i(121210),c=i(211672),h=i(887106),_=i(184951),d=new Image;d.src=r;var u=new Image;u.src=o;var f=function(e){function t(t){var i;return(i=e.call(this,t)||this).renderAfterCell=e=>{var{row:t,col:n,cell:o}=e;if(i._BvP(t,n,o))for(var r=i._Rj.activeSheet.getCellDataAtPosition(t,n),l=(0,_.rs)(r),c=o.cellWidth,f=o.cellHeight,p=c-1,g=f-1,v=s.gb+2*s.$S,w=v*s.mr,m=i._Asd.getCellStyle(t,n),{dx:R,dy:S}=(0,a.F1)({cellWidth:p,cellHeight:g,dWidth:w,dHeight:v,horizontalAlign:m.horizontalAlign,verticalAlign:m.verticalAlign,marginX:s.L6,marginY:s.L6}),A=[0,0,p,g],E=0;E<s.mr;E++)i.alloyExcel.collectEngine.collectCell(h.g4.bitmap,{bitmapInfo:{dx:R+s.$S*(2*E+1)+s.gb*E,dy:S+s.$S,dWidth:s.gb,dHeight:s.gb,img:E<l?d:u,clipInfo:A},pos:{row:t,col:n}},h.Nm.mainContent)},i._Rj=t.workbook,i._XY=t.rowColAccessor,i._Asd=t.cellStyleAccessor,i.alloyExcel.onAfterCellRender(i.renderAfterCell),i}return(0,n._)(t,e),t.prototype._BvP=function(e,t,i){var n=this._Rj.activeSheet.getCellDataAtPosition(e,t);return n?.getExtendedType()===c.$.Star&&!i.isPrivate&&!i.isCanNotRead},t}(l.Z)},955953:function(e,t,i){i.d(t,{w:function(){return d}});var n=i(434902),o=i(115089),r=i(384341),s=i(727503),a=i(98352),l=i(45865),c=i(122477),h=l.Z.getConfig("custom.imageThumbnailPath"),_=h?h.replace(/\{width\}/,"800").replace(/\{height\}/,"600"):"",d=(0,n._)(function*(e){return new Promise((0,n._)(function*(t){var{fetchFileInfo:n,FileInfoFetchType:l}=yield Promise.all([i.e("96660"),i.e("78459"),i.e("28998"),i.e("52302")]).then(i.bind(i,978733)),h=yield Promise.resolve().then(i.bind(i,579114)),_=(0,s.e)(e.hyperlink.url||"");try{var d=yield n({fileId:o.q.getConfig("padId"),objKey:(0,a.xg)(e.hyperlink.url)},_?l.Local:void 0);if(d?.data){var{thumbnailUrl:f}=d.data?.result?.fileMeta||{};if(f){if(c.QH.includes(e.hyperlink.type))return void t(h.default.status===h.NETWORK_STATUS.OFFLINE&&r.default.isElectronTencentDocsClient||_?f:u(f));t(f);return}}t("")}catch(e){t("")}}))}),u=e=>e.includes("?")?e+_.replace(/^\?/,"&"):e+_},934143:function(e,t,i){var n=i(558186);i(683461),i(150061),i(850934),new Image().src=n.UF,new Image().src=n.VH},791721:function(e,t,i){var n=i(384341),o=i(496430);t.Z=function(e){if(this.spreadsheetView=e,this.default=o.QX,!n.default.isPC&&!n.default.isIPad){var t=o.U2;(this.spreadsheetView.areaData.row.frozen.isValid()||this.spreadsheetView.areaData.col.frozen.isValid())&&(t=o.ai),this.default=t,this.spreadsheetView.scale.scaleTo(t)}}},622850:function(e,t,i){i.d(t,{Z:function(){return d}});var n=i(921734),o=i(696030),r=i(384341),s=i(202630),a=i(795849),l=i(532565),c=i(671888),h=i(491820),_=1.5*!r.default.isMobile,d=function(e){function t(t,i,n){(o=e.call(this)||this)._Rj=t,o._ATf=i,o._ArY=n,o._AGi=e=>{var t,{scale:i,areaData:n}=o._ATf,r=e.index,d=o._ArY.selectQueue,u=(0,h.q)(o._Rj),f=(d.length>1?.5:_)/i.scale;for(var p of(e._Bwm(u),d)){if(p instanceof s.Z){e.selected(u),e._BwL(f);return}if(p instanceof a.Z)e.active(u),e._BwL(f);else if(p instanceof l.Z)r>=p.xRange[0]&&r<=p.xRange[1]&&(e.active(u),t=n.getFirstRowInView(),p.yRange[0]<=t&&p.yRange[1]>=t&&e._BwL(f));else if(p instanceof c.Z&&r>=p.xRange[0]&&r<=p.xRange[1]){e.selected(u),e._BwL(f);return}}},o._AGj=e=>{var t,{scale:i,areaData:n}=o._ATf,r=e.index,d=o._ArY.selectQueue,u=(0,h.q)(o._Rj),f=(d.length>1?.5:_)/i.scale;for(var p of(e._Bwm(u),d)){if(p instanceof s.Z){e.selected(u),e._BwL(f);return}if(p instanceof c.Z)e.active(u),e._BwL(f);else if(p instanceof l.Z)r>=p.yRange[0]&&r<=p.yRange[1]&&(e.active(u),t=n.getFirstColInView(),p.xRange[0]<=t&&p.xRange[1]>=t&&e._BwL(f));else if(p instanceof a.Z&&r>=p.yRange[0]&&r<=p.yRange[1]){e.selected(u),e._BwL(f);return}}};var o,r=o._ATf.transformTable;return o._register(r.onCalcColHeadStatus(o._AGi)),o._register(r.onCalcRowHeadStatus(o._AGj)),o}return(0,n._)(t,e),t}(o.Disposable)},636869:function(e,t,i){i.d(t,{Z:function(){return d}});var n=i(943194),o=i(167398),r=i(921734),s=i(563411),a=i(696030),l=(0,o._)("__Bvq"),c=(0,o._)("__BvQ"),h=(0,o._)("_onDragOver"),_=(0,o._)("_onDrop"),d=function(e){function t(t){var i;return Object.defineProperty(i=e.call(this)||this,l,{writable:!0,value:void 0}),Object.defineProperty(i,c,{writable:!0,value:void 0}),Object.defineProperty(i,h,{writable:!0,value:void 0}),Object.defineProperty(i,_,{writable:!0,value:void 0}),(0,n._)(i,l)[l]=new s.Q({name:"dragEnter"}),(0,n._)(i,c)[c]=new s.Q({name:"dragLeave"}),(0,n._)(i,h)[h]=new s.Q({name:"dragOver"}),(0,n._)(i,_)[_]=new s.Q({name:"drop"}),i._Bvq=(0,n._)(i,l)[l].event,i._BvQ=(0,n._)(i,c)[c].event,i.onDragOver=(0,n._)(i,h)[h].event,i.onDrop=(0,n._)(i,_)[_].event,i._JB=e=>{i.node.contains(e.target)&&(e.preventDefault(),(0,n._)(i,l)[l].fire(e))},i._Jc=e=>{i.node.contains(e.target)&&(e.preventDefault(),(0,n._)(i,c)[c].fire(e))},i._JC=e=>{i.node.contains(e.target)&&(e.preventDefault(),(0,n._)(i,h)[h].fire(e))},i._Jd=e=>{i.node.contains(e.target)&&(e.preventDefault(),(0,n._)(i,_)[_].fire(e))},i.node=t,document.addEventListener("dragenter",i._JB),document.addEventListener("dragleave",i._Jc),document.addEventListener("dragover",i._JC),document.addEventListener("drop",i._Jd),i}return(0,r._)(t,e),t}(a.Disposable)},447055:function(e,t,i){var n=i(758699),o=i(921734);i(738355);var r=i(340576),s=i(264983),a=i(72941),l=i(393743);t.Z=function(e){function t(t,i,n){var o;return(o=e.call(this,t,i,n)||this)._bLm=new r.Q5({name:"updateCurrentIndex"}),o._bLM=-1,o.onUpdateCurrentIndex=o._bLm.event,o}(0,o._)(t,e);var s=t.prototype;return s.addSelection=function(t){null===t?e.prototype.addSelection.call(this,null,null):(t.activation||(t.activation={row:t.yRange?t.yRange[0]:0,col:t.xRange?t.xRange[0]:0}),e.prototype.addSelection.call(this,t,t.activation)),this.currentSelectIndex+=1,this._cpr.fire(this.select)},s.updateSelection=function(t,n){var o=this._cpQ[t];if(void 0===o)throw i.g.log?.error(l.w.FormulaSelectData,"\u9519\u8BEF\u66F4\u65B0\u9009\u533A\uFF0C\u7D22\u5F15\u5F02\u5E38",this._cpQ,t),Error("\u9519\u8BEF\u66F4\u65B0\u9009\u533A");if(!n.activation){if(!o.activation)throw i.g.log?.error(l.w.FormulaSelectData,"\u672A\u83B7\u53D6\u5230\u6FC0\u6D3B\u533A\u57DF\uFF0C\u5E76\u4E14\u65E0\u6CD5\u590D\u7528\u4E4B\u524D\u7684\u6FC0\u6D3B\u533A\u57DF",this._cpQ,t,o),Error("\u672A\u4F20\u5165\u6FC0\u6D3B\u533A\u57DF\uFF0C\u5E76\u4E14\u65E0\u6CD5\u590D\u7528\u4E4B\u524D\u7684\u6FC0\u6D3B\u533A\u57DF");if(n.activation={row:o.activation.row,col:o.activation.col},n.xRange&&(n.activation.col<n.xRange[0]||n.activation.col>n.xRange[1])||n.yRange&&(n.activation.row<n.yRange[0]||n.activation.row>n.yRange[1]))throw i.g.log?.error(l.w.FormulaSelectData,"\u672A\u83B7\u53D6\u5230\u6FC0\u6D3B\u533A\u57DF\uFF0C\u590D\u7528\u4E4B\u524D\u7684\u6FC0\u6D3B\u533A\u57DF\uFF0C\u4F46\u662F\u590D\u7528\u9009\u533A\u5BF9\u4E0D\u4E0A",this._cpQ,t,n),Error("\u672A\u4F20\u5165\u6FC0\u6D3B\u533A\u57DF\uFF0C\u5E76\u4E14\u65E0\u6CD5\u590D\u7528\u4E4B\u524D\u7684\u6FC0\u6D3B\u533A\u57DF")}e.prototype.updateSelection.call(this,t,n,n.activation),this._bLM=t,this._cpR.fire({index:t,selection:this._cpQ[t]})},s.removeSelection=function(t){e.prototype.removeSelection.call(this,t),this._bLM=Math.min(this._bLM,this._cpQ.length-1),this._cps.fire(t)},s.resetSelection=function(){e.prototype.resetSelection.call(this),this._bLM=-1,this._cpq.fire()},(0,n._)(t,[{key:"currentSelectIndex",get:function(){return this._bLM},set:function(e){if(e>this._cpQ.length)throw i.g.log?.error(l.w.FormulaSelectData,"\u8BBE\u7F6E\u9009\u533A\u7D22\u5F15\u5F02\u5E38",this._cpQ,e),Error("\u8BBE\u7F6E\u7684\u5F53\u524D\u9009\u533A\u5F02\u5E38");this._bLM=e,this._bLm.fire(e)}},{key:"activeRow",get:function(){if(!this._cpQ[this._bLM])return -1;var{activation:e}=this._cpQ[this._bLM];return e?(0,a.Uz)(this.spreadsheetView.transformTable,e.row,e.col).row:-1}},{key:"activeCol",get:function(){if(!this._cpQ[this._bLM])return -1;var{activation:e}=this._cpQ[this._bLM];return e?(0,a.Uz)(this.spreadsheetView.transformTable,e.row,e.col).col:-1}},{key:"activation",get:function(){return this._cpQ[this._bLM]?.activation}},{key:"select",get:function(){return this._cpQ[this._bLM]||null}}]),t}(s.Z)},24191:function(e,t,i){i.d(t,{Z:function(){return u}});var n=i(758699),o=i(921734),r=i(200271),s=i(969099);i(575739);var a=i(774058),l=function(){function e(e){this._Ru=document.createElement("div"),this._Ru.classList.add("formula-selection"),this.setAttribute(e)}var t=e.prototype;return t.setAttribute=function(e){var t=(0,a.np)(e.index);this._RU=t;var{display:i=!0}=e;(e.width<0||e.height<0)&&(i=!1),Object.assign(this._Ru.style,{left:`${e.left}px`,top:`${e.top}px`,width:`${e.width}px`,height:`${e.height}px`,"border-color":t,"background-color":function(e,t){if(e&&/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(e)){for(var i=[],n=1;n<7;n+=2)i.push(parseInt(`0x${e.slice(n,n+2)}`,16));return`RGBA(${i.join(",")}, ${.2})`}return e}(t,.2),display:`${i?"block":"none"}`})},t.active=function(){this._Ru.style.borderStyle="dashed"},t.unactive=function(){this._Ru.style.borderStyle="solid"},e.newInstance=function(t,i){var n=e._cA.pop();return n?n.setAttribute(i):n=new e(i),t.appendChild(n._Ru),n},e.destroy=function(t){t._Ru.remove(),t._RU="",e._cA.push(t)},(0,n._)(e,[{key:"element",get:function(){return this._Ru}},{key:"color",get:function(){return this._RU}}]),e}();l._cA=[];var c=function(){function e(e){this._Rt=[],this._CA=e}var t=e.prototype;return t.clear=function(){for(var e;e=this._Rt.pop();)l.destroy(e)},t.remove=function(e){var t=this._Rt[e];if(void 0===t)return void console.error("can't find formula selection by index: ",e);this._Rt.splice(e,1),l.destroy(t)},t.add=function(e){e.index=this._Rt.length,this._Rt.push(l.newInstance(this._CA,e))},t.update=function(e,t){t.index=e;var i=this._Rt[e];if(void 0===i)return void console.error("can't find multiple selection by index: ",e);i.setAttribute(t)},e}(),h=function(e){function t(t,i){var n;return(n=e.call(this)||this).spreadsheetView=t,n.blockBoard=i,n.board=document.createElement("div"),n.board.classList.add("selection-stage-board"),n.blockBoard.hiddenBoard.append(n.board),n._RT=new c(n.board),n}(0,o._)(t,e);var i=t.prototype;return i.addSelection=function(e,t){var i={left:e.left-this.blockBoard.globalOffsetX,top:e.top-this.blockBoard.globalOffsetY,width:e.width,height:e.height,padding:e.padding,display:t};this._RT.add(i)},i.updateSelection=function(e,t,i){var n={left:t.left-this.blockBoard.globalOffsetX,top:t.top-this.blockBoard.globalOffsetY,width:t.width,height:t.height,padding:t.padding,display:i};this._RT.update(e,n)},i.removeSelection=function(e){this._RT.remove(e)},i.resetSelection=function(){this._RT.clear()},i.show=function(){this.board.style.display="block"},i.hide=function(){this.board.style.display="none"},i.dispose=function(){e.prototype.dispose.call(this),this.board.remove()},(0,n._)(t,[{key:"formulaSelectionApi",get:function(){return this._RT}}]),t}(i(696030).Disposable),_=i(761344),d=i(155094),u=function(e){function t(t,i,n){var o;return(o=e.call(this,t)||this)._showing=!0,o.formulaSelectData=t,o.spreadsheetView=i,o.mutexManagement=n,o._BXl=(0,r.ad)(()=>{for(var e=0;e<o._selectData.selectQueue.length;e++){var t=o._selectData.selectQueue[e];o._updateSelection({index:e,selection:t})}}),o.topLeft=o._register(new h(i,o.spreadsheetView.mainBoard.top.left)),o.topRight=o._register(new h(i,o.spreadsheetView.mainBoard.top.right)),o.bottomLeft=o._register(new h(i,o.spreadsheetView.mainBoard.bottom.left)),o.bottomRight=o._register(new h(i,o.spreadsheetView.mainBoard.bottom.right)),o._register(o.spreadsheetView.areaData.row.frozen.onUpdateViewSize(o._BXl)),o._register(o.spreadsheetView.areaData.row.flow.onUpdateViewSize(o._BXl)),o._register(o.spreadsheetView.areaData.col.frozen.onUpdateViewSize(o._BXl)),o._register(o.spreadsheetView.areaData.col.flow.onUpdateViewSize(o._BXl)),o._register(o.spreadsheetView.areaData.row.frozen.onUpdateTotalSize(o._BXl)),o._register(o.spreadsheetView.areaData.row.flow.onUpdateTotalSize(o._BXl)),o._register(o.spreadsheetView.areaData.col.frozen.onUpdateTotalSize(o._BXl)),o._register(o.spreadsheetView.areaData.col.flow.onUpdateTotalSize(o._BXl)),o.mutexManagement.addMutexComponent(d.d.SELECTION,o),o}(0,o._)(t,e);var i=t.prototype;return i.refresh=function(){},i.show=function(){this._showing||this._show()},i.hide=function(){this._showing&&this._hide()},i.mutexHide=function(){this._showing&&this._hide()},i._show=function(){this._showing=!0,this.topLeft.show(),this.topRight.show(),this.bottomLeft.show(),this.bottomRight.show(),this.mutexManagement.mutexShow(d.d.FORMULA_SELECTION)},i._hide=function(){this._showing=!1,this.topLeft.hide(),this.topRight.hide(),this.bottomLeft.hide(),this.bottomRight.hide()},i._addSelection=function(){var{areaData:e}=this.spreadsheetView;this.topLeft.resetSelection(),this.topRight.resetSelection(),this.bottomLeft.resetSelection(),this.bottomRight.resetSelection(),this._ASF(this._selectData.selectQueue).forEach(t=>{var i=(0,_.i)(this.spreadsheetView.transformTable,e,t);this.topLeft.addSelection(i,i.startRow<=e.row.frozen.to&&i.startCol<=e.col.frozen.to),this.topRight.addSelection(i,i.startRow<=e.row.frozen.to&&i.endCol>=e.col.flow.from),this.bottomLeft.addSelection(i,i.endRow>=e.row.flow.from&&i.startCol<=e.col.frozen.to),this.bottomRight.addSelection(i,i.endRow>=e.row.flow.from&&i.endCol>=e.col.flow.from)})},i._updateSelection=function(e){var{index:t,selection:i}=e,{areaData:n}=this.spreadsheetView,o=(0,_.i)(this.spreadsheetView.transformTable,n,i);this.topLeft.updateSelection(t,o,o.startRow<=n.row.frozen.to&&o.startCol<=n.col.frozen.to),this.topRight.updateSelection(t,o,o.startRow<=n.row.frozen.to&&o.endCol>=n.col.flow.from),this.bottomLeft.updateSelection(t,o,o.endRow>=n.row.flow.from&&o.startCol<=n.col.frozen.to),this.bottomRight.updateSelection(t,o,o.endRow>=n.row.flow.from&&o.endCol>=n.col.flow.from)},i._removeSelection=function(e){this.topLeft.removeSelection(e),this.topRight.removeSelection(e),this.bottomLeft.removeSelection(e),this.bottomRight.removeSelection(e)},i._resetSelection=function(){this.topLeft.resetSelection(),this.topRight.resetSelection(),this.bottomLeft.resetSelection(),this.bottomRight.resetSelection()},i._ASF=function(e){var t=new Map;for(var i of e){var n=i.generateKey();n&&!t.has(n)&&t.set(n,i)}return Array.from(t).map(e=>e[1])},(0,n._)(t,[{key:"showing",get:function(){return this._showing}}]),t}(s.Z)},233455:function(e,t,i){i.d(t,{Z:function(){return p}});var n=i(921734),o=i(696030),r=i(340576),s=i(745725),a=i(496430),l=i(951924),c=i(209787),h=i(146849),_=i(998722),d=i(725275),u=i(115089),f=function(e){function t(t){(n=e.call(this)||this)._ASX=!1,n._ab=0,n._AeT=t,n._ASz=e=>{n._ASX=e[h.rn]||e[h.U6],0!==e.deltaY&&(n._Ata(e),window.removeEventListener("wheel",n._ASz,!0),n._Aet?.addEventListener("wheel",n._ASZ,{capture:!0,passive:!1}),n._Aet?.addEventListener("keyup",n._cq))},n._ASZ=e=>{0!==e.deltaY&&(n._ab&&i.g.clearTimeout(n._ab),n._ab=i.g.setTimeout(()=>{n._Aet?.removeEventListener("wheel",n._ASZ,!0),n._Aet?.removeEventListener("keyup",n._cq),n._Aet?.addEventListener("wheel",n._ASz,{capture:!0,passive:!1}),n._ab=0,n._ASX=!1},100),n._Ata(e))},n._cq=e=>{[h.MW,h.jx].includes(e.key)&&(n._ASX=!1)},n._Ata=e=>{if(n._ASX){var t=-e.deltaY/Math.abs(e.deltaY),i=_.jE*t;n._AeT.scaleTo(n._AeT.displayScale+i),e.stopPropagation(),e.preventDefault()}};var n,o=u.q.getConfig("isHistory")?"#mainContainer":"#workbenchContainer";n._Aet=document.querySelector(o),n._Aet?.addEventListener("wheel",n._ASz,{capture:!0,passive:!1});var r=window.preventWheelZoomHandler;return r&&window.removeEventListener("wheel",r),window.tdocs?.setZoomLevel?.({zoom_level:0}),n}return(0,n._)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),window.removeEventListener("wheel",this._ASz,!0)},t}(o.Disposable);f=(0,c.__decorate)([(0,c.__param)(0,d.Z),(0,c.__metadata)("design:type",Function),(0,c.__metadata)("design:paramtypes",[void 0===d.Z?Object:d.Z])],f);var p=function(e){function t(t,i){var n;return(n=e.call(this)||this)._ASy=0,n._ASY=null,n.spreadsheetView=t,n.scrollApi=i,n._ASW=new r.Q5({name:"startScale"}),n._ASx=new r.Q5({name:"endScale"}),n._handleTouchstart=()=>{n.spreadsheetView.operateContext.operateData.fingerData.mode===s.w.SCALE&&(n._ASy=n.spreadsheetView.scale.displayScale,n._ASW.fire(),document.body.addEventListener("touchmove",n._bH),document.body.addEventListener("touchend",n._handleTouchend))},n._bH=()=>{var e=n.spreadsheetView.operateContext.operateData;if(e.fingerData.mode===s.w.SCALE){var t=e.fingerData.zoom*n.spreadsheetView.scale.displayScale;t=Math.min(a.SH,Math.max(a.lD,t)),n._sr({scale:t,center:{...e.fingerData.center}})}},n._handleTouchend=()=>{n._ASx.fire(),document.body.removeEventListener("touchmove",n._bH),document.body.removeEventListener("touchup",n._handleTouchend)},n._sp=()=>{if(n._ASY){var{scale:e,center:t}=n._ASY;if(n._ASY=null,e!==n.spreadsheetView.scale.displayScale){var i=n.spreadsheetView.scale.displayScale,o=n.spreadsheetView.areaData.col.flow.offsetSize+t.x/i*n._ASy,r=n.spreadsheetView.areaData.row.flow.offsetSize+t.y/i*n._ASy;n.spreadsheetView.scale.scaleTo(e);var s=n.spreadsheetView.areaData.col.flow.offsetSize+t.x/e*n._ASy,a=n.spreadsheetView.areaData.row.flow.offsetSize+t.y/e*n._ASy;n.scrollApi.scrollByPixel({diffX:o-s,diffY:r-a,areaX:"flow",areaY:"flow"},void 0,void 0,l.o.USER_SCALE)}}},n._BvX=n._ASW.event,n._Bvy=n._ASx.event,n._register(n.spreadsheetView.operateContext.touchOperate.onTouchstart(n._handleTouchstart)),n._bMv=new f(t.scale),n}(0,n._)(t,e);var i=t.prototype;return i.dispose=function(){e.prototype.dispose.call(this),this._bMv.dispose()},i._sr=function(e){if(this._ASY){this._ASY.scale=e.scale;return}this._ASY=e,window.requestAnimationFrame(this._sp)},t}(o.Disposable)},602418:function(e,t,i){i.d(t,{ru:function(){return o}});var n=i(730635),o={LINE:"LINE",EASE_OUT:"EASE_OUT"};(0,n.y)("IScrollApi")},735683:function(e,t,i){i(738355);var n=i(737814),o=i(602418),r=i(650163),s=i(951924);t.Z=function(){function e(e){this.spreadsheetView=e}var t=e.prototype;return t.scrollByPixel=function(e,t,i,n){void 0===t&&(t=!0),void 0===n&&(n=s.o.SLIENT);var o=0,r=0,a=0,l=0,c={flow:!1,frozen:!1};if(e?.diffX!==void 0)switch(e?.areaX){case"flow":o=e.diffX;break;case"frozen":a=e.diffX}if(e?.diffY!==void 0)switch(e?.areaY){case"flow":r=e.diffY;break;case"frozen":l=e.diffY}this._Aka({diffX:o,diffY:r},t,{...i,onAnimationEnd:()=>{c.flow=!0,c.frozen&&i?.onAnimationEnd?.()}},n),this.scrollOfFrozen({diffFrozenX:a,diffFrozenY:l},()=>{c.frozen=!0,c.flow&&i?.onAnimationEnd?.()})},t.scrollToRenderFrom=function(e,t,i,n){void 0===t&&(t=!0),void 0===n&&(n=s.o.SLIENT);var o=0,r=0,{areaData:a}=this.spreadsheetView,{row:l,col:c}=e;void 0!==l&&l>=a.row.flow.from&&l<=a.row.flow.to&&(r=a.getAreaTopByRow(l)-a.row.flow.offsetSize),void 0!==c&&c>=a.col.flow.from&&c<=a.col.flow.to&&(o=a.getAreaLeftByCol(c)-a.col.flow.offsetSize),this._Aka({diffX:o,diffY:r},t,i,n)},t.scrollToCenterTop=function(e,t,i,n){void 0===t&&(t=!0);var{row:o,col:r}=e;if(void 0!==o||void 0!==r){var s=void 0,a=void 0,{rowColAccessor:l,clientRect:c,headSize:h,areaData:_}=this.spreadsheetView;if(void 0!==o){var d=l.getRowDisplayHeight(o);a=Math.max(a=Math.round((c.height-h.displayColHeadHeight-_.row.frozen.displayViewSize-d)/2),0)}if(void 0!==r){var u=l.getColSetWidth(r);s=Math.max(s=Math.round((c.width-h.displayRowHeadWidth-_.col.frozen.displayViewSize-u)/2),0)}this.scrollToVisible({row:o,col:r,x:s,y:a},t,i,n)}},t.scrollPointToCenter=function(e,t,i,n){var{row:o,col:r,left:s,top:a,width:l=0,height:c=0}=e,{clientRect:h,headSize:_,areaData:d}=this.spreadsheetView,u=d.getAreaTopByRow(o),f=d.getAreaLeftByCol(r),p=h.height-_.displayColHeadHeight,g=f+s+l/2-(h.width-_.displayRowHeadWidth)/2-d.col.flow.offsetSize,v=u+a+c/2-p/2-d.row.flow.offsetSize;this._Aka({diffX:g,diffY:v},t,i,n)},t.scrollToVisible=function(e,t,i,n){void 0===t&&(t=!0),void 0===n&&(n=s.o.SLIENT);var{areaData:o}=this.spreadsheetView,a=(0,r.Hg)(e,o),l=(0,r.yE)(e,o);this._Aka({diffX:a,diffY:l},t,i,n)},t.scrollToDistanceAnchor=function(e,t,i,n){void 0===t&&(t=!0);var{row:o,col:r,left:s=0,top:a=0,ignoreFrozen:l=!1}=e,{areaData:c}=this.spreadsheetView;if(!l&&(c.row.frozen.isValid()||c.col.frozen.isValid()))return void this.scrollToVisible({row:o,col:r},t,i,n);var h=0,_=0;if(void 0!==o&&o>=c.row.flow.from){if(o>c.row.flow.to)throw Error("row \u8D8A\u754C\uFF0C\u65E0\u6CD5\u5B9A\u4F4D");_=c.getAreaTopByRow(o)-a-c.row.flow.offsetSize}if(void 0!==r&&r>=c.col.flow.from){if(r>c.col.flow.to)throw Error("col \u8D8A\u754C\uFF0C\u65E0\u6CD5\u5B9A\u4F4D");h=c.getAreaLeftByCol(r)-s-c.col.flow.offsetSize}this._Aka({diffX:h,diffY:_},t,i,n)},t.scrollOfFrozen=function(e,t,i,n){void 0===t&&(t=()=>{}),void 0===n&&(n=!0);var{diffFrozenX:o,diffFrozenY:r}=e;this._AJY&&(this._AJY(),this._AJY=void 0),t()},t.scrollFrozenToRenderFrom=function(e,t,i,n){void 0===t&&(t=!0),void 0===i&&(i=()=>{}),void 0===n&&(n=s.o.SLIENT),i()},t._AJz=function(e,t){void 0===t&&(t=s.o.USER);var{diffFrozenX:i,diffFrozenY:n}=e;0!==i&&this._AkC(i,t),0!==n&&this._Akd(n,t),this.spreadsheetView.renderManager.renderApi.renderTable()},t._AJZ=function(e,t,i){void 0===t&&(t=()=>{}),void 0===i&&(i=s.o.USER);var{diffFrozenX:n,diffFrozenY:o}=e,a=(0,r.SI)(n,o),l=Math.abs(n)>Math.abs(o)?n:o,c=0,h=0;this._AJY=(0,r.bJ)(0,l,a,e=>{var t=e/l*n-c,r=e/l*o-h;this._AkC(t,i),this._Akd(r,i),this.spreadsheetView.renderManager.renderApi.renderTable(),c+=t,h+=r},()=>{t(),this._AJY=void 0})},t._Aka=function(e,t,i,n){void 0===t&&(t=!0),void 0===i&&(i={}),void 0===n&&(n=s.o.SLIENT);var{diffX:o,diffY:r}=e,{areaData:a}=this.spreadsheetView;if(this._AJy&&(this._AJy(),this._AJy=void 0),0===o&&0===r)return void i.onAnimationEnd?.();if(t){a.row.flow.setOffsetSize(a.row.flow.offsetSize+r,n),a.col.flow.setOffsetSize(a.col.flow.offsetSize+o,n),i.onAnimationEnd?.();return}this._AkA(o,r,i,n)},t._AkA=function(e,t,i,n){void 0===n&&(n=s.o.SLIENT);var{type:r=o.ru.LINE,onAnimationEnd:a}=i;switch(r){case o.ru.EASE_OUT:this._AkB(e,t,a,n,i.duration);break;case o.ru.LINE:this._Akc(e,t,a,n,i.steps)}},t._Akb=function(e,t,i){void 0===i&&(i=s.o.SLIENT);var{areaData:n}=this.spreadsheetView,o=0,r=0;if(Math.abs(e)<100)o=e;else{var a=e/Math.abs(e),l=n.col.flow.offsetSize+a*(Math.abs(e)-100);n.col.flow.setOffsetSize(l,i),o=100*a}if(Math.abs(t)<100)r=t;else{var c=t/Math.abs(t),h=n.row.flow.offsetSize+c*(Math.abs(t)-100);n.row.flow.setOffsetSize(h,i),r=100*c}return{diffX:o,diffY:r}},t._AkB=function(e,t,i,n,o){void 0===n&&(n=s.o.SLIENT);var a=this.spreadsheetView.getActiveSheetId(),{diffX:l,diffY:c}=this._Akb(e,t,n),{areaData:h}=this.spreadsheetView,_=h.col.flow.offsetSize,d=h.row.flow.offsetSize,u=0,f=0;this._AJy=(0,r.Vv)(e=>{var t=()=>{i?.(),this._AJy?.(),this._AJy=void 0};if(a!==this.spreadsheetView.getActiveSheetId())return t();var o=Math.ceil(e*l),r=Math.ceil(e*c);if(Math.abs(o-u)<2&&(o=u),Math.abs(r-f)<2&&(r=f),o===u&&r===f)return void i?.();u=o,f=r,Math.abs(l-o)<2&&(o=l),Math.abs(c-r)<2&&(r=c),h.col.flow.setOffsetSize(o+_,n),h.row.flow.setOffsetSize(r+d,n),o===l&&r===c&&t()},()=>{a===this.spreadsheetView.getActiveSheetId()&&(h.col.flow.setOffsetSize(l+_,n),h.row.flow.setOffsetSize(c+d,n),i?.(),this._AJy=void 0)},o)},t._Akc=function(e,t,i,n,o){void 0===n&&(n=s.o.SLIENT);var{areaData:a}=this.spreadsheetView,l=o||(0,r.SI)(e,t),c=Math.abs(e)>Math.abs(t)?e:t,h=0,_=0;this._AJy=(0,r.bJ)(0,c,l,i=>{var o=i/c*e-h,r=i/c*t-_;a.row.flow.setOffsetSize(a.row.flow.offsetSize+r,n),a.col.flow.setOffsetSize(a.col.flow.offsetSize+o,n),h+=o,_+=r},()=>{i?.(),this._AJy=void 0})},t._AkC=function(e,t){void 0===t&&(t=s.o.USER);var{viewSize:i}=this.spreadsheetView.areaData.col.frozen;i+=e,i=Math.min(this.spreadsheetView.areaData.col.frozen.totalSize,Math.max((0,n.pJ)(this.spreadsheetView),i)),this.spreadsheetView.areaData.col.setMaxFrozenViewSize(i,t)},t._Akd=function(e,t){void 0===t&&(t=s.o.USER);var{viewSize:i}=this.spreadsheetView.areaData.row.frozen;i+=e,i=Math.min(this.spreadsheetView.areaData.row.frozen.totalSize,Math.max((0,n.n_)(this.spreadsheetView),i)),this.spreadsheetView.areaData.row.setMaxFrozenViewSize(i,t)},e}()},650163:function(e,t,i){i.d(t,{Hg:function(){return l},K1:function(){return _},SI:function(){return s},Vv:function(){return a},bJ:function(){return r},jc:function(){return c},yE:function(){return h}}),i(738355);var n=i(365943),o=i.n(n);function r(e,t,i,n,o){i=i||2;var r=0,s=e,a=function(){if(Math.abs(s+=(t-e)/i)>Math.abs(t)-5){n(t),o?.(),r=0;return}n(s),r=requestAnimationFrame(a)};return a(),()=>{r&&cancelAnimationFrame(r)}}function s(e,t){var i=Math.abs(e||t);return 0===i?8:Math.min(16,Math.max(8,Math.round(8+i/(window.innerHeight/2)*8)))}function a(e,t,i){void 0===i&&(i=600);var n=o()(0,.98,.26,.99),r=Date.now(),s=0,a=()=>{var o=(Date.now()-r)/i,l=n(o);l<1&&o<1?(e(l),s=requestAnimationFrame(a)):(t?.(),s=0)};return a(),()=>{s&&cancelAnimationFrame(s)}}function l(e,t){var i=0,n=e.x||0,o=e.padding?.left||0,r=e.padding?.right||0;if(void 0!==e.col&&e.col>=t.col.flow.from){if(e.col>t.col.flow.to)throw Error("col\u8D8A\u754C\uFF0C\u65E0\u6CD5\u5B9A\u4F4D");0===(i=Math.min(0,i=t.getAreaLeftByCol(e.col)-n-o-t.col.flow.offsetSize))&&(i=Math.max(0,i=t.getAreaLeftByCol(e.col+1)+n+r-t.col.flow.viewSize-t.col.flow.offsetSize+t.col.flow.padding))}return i}function c(e,t){var i=0,n=e.x||0,o=e.padding?.left||0,r=e.padding?.right||0,{canvas:s}=t.view,{areaData:a,transformTable:l}=s;if(void 0!==e.col&&e.col>=a.col.frozen.from){if(e.col>a.col.frozen.to)return 0;if(0===(i=Math.min(0,i=a.getAreaLeftByCol(e.col)-n-o-a.col.frozen.offsetSize))){var c=l.getCellBackgroundWidth(e.row||0,e.col||0),h=a.getAreaLeftByCol(e.col)+c,{scale:_}=s.scale,d=Math.floor((s.clientRect.width-s.headSize.rowHeadWidth)/_);i=Math.max(0,i=h+n+r-(d=Math.min(d,a.col.frozen.viewSize))-a.col.frozen.offsetSize+a.col.frozen.padding)}}return i}function h(e,t){var i=0,n=e.y||0,o=e.padding?.top||0,r=e.padding?.bottom||0;if(void 0!==e.row&&e.row>=t.row.flow.from){if(e.row>t.row.flow.to)throw Error("row \u8D8A\u754C\uFF0C\u65E0\u6CD5\u5B9A\u4F4D");0===(i=Math.min(0,i=t.getAreaTopByRow(e.row)-n-o-t.row.flow.offsetSize))&&(i=Math.max(0,i=t.getAreaTopByRow(e.row+1)+n+r-t.row.flow.viewSize-t.row.flow.offsetSize+t.row.flow.padding))}return i}function _(e,t){var i=0,n=e.y||0,o=e.padding?.top||0,r=e.padding?.bottom||0,{canvas:s}=t.view,{areaData:a,transformTable:l}=s;if(void 0!==e.row&&e.row>=a.row.frozen.from){if(e.row>a.row.frozen.to)return 0;if(0===(i=Math.min(0,i=a.getAreaTopByRow(e.row)-n-o-a.row.frozen.offsetSize))){var c=l.getCellBackgroundHeight(e.row||0,e.col||0),h=a.getAreaTopByRow(e.row)+c,{scale:_}=s.scale,d=Math.floor((s.clientRect.height-s.headSize.colHeadHeight)/_);i=Math.max(0,i=h+n+r-(d=Math.min(a.row.frozen.viewSize,d))-a.row.frozen.offsetSize+a.row.frozen.padding)}}return i}},426948:function(e,t,i){i.d(t,{Z:function(){return u}});var n=i(921734),o=i(563411),r=i(156084),s=i(384341);function a(e,t,i){return void 0===i&&(i=0),(e.displayViewSize-e.displayPadding-t-2*i)/(e.displayTotalSize+e.displayPadding-e.displayViewSize)}var l=function(){function e(e,t,i,n){this._sA=document.createElement("div"),this._tf=document.createElement("div"),this._CD=0,this._tg=!1,this._tG=()=>{var e;if(0===this._tF.displayViewSize||this._tF.displayTotalSize<=this._tF.displayViewSize){this._sA.style.display="none";return}this._sA.style.display="block",this.height=Math.max(60,(e=this._tF).displayViewSize/(e.displayTotalSize+e.displayPadding)*e.displayViewSize),this._tf.style.height=`${this.height}px`,this._th()},this._th=()=>{this._tg||(this._tg=!0,requestAnimationFrame(()=>{this._tg=!1;var e=this._tF.displayOffsetSize*a(this._tF,this.height,5);this._tf.style.transform=`translateY(${e}px)`}))},this.handleMousedown=e=>{e.preventDefault(),e.stopPropagation(),this._CD=e.clientY,this._tf.classList.add("scroll-ondrag"),document.addEventListener("mousemove",this.handleMousemove),document.addEventListener("mouseup",this.handleMouseup)},this.handleMousemove=e=>{var t=e.clientY,i=t-this._CD;this._CD=t;var n=this._tF.displayViewSize===this.height?0:i/a(this._tF,this.height,5)/this._HD.scale;this._tE({x:0,y:n})},this.handleMouseup=()=>{document.removeEventListener("mousemove",this.handleMousemove),document.removeEventListener("mouseup",this.handleMouseup),this._CD=0,this._tf.classList.remove("scroll-ondrag")},this._tH=e=>{e.stopPropagation(),this._CD=e.targetTouches?.[0]?.clientY,this._tf.classList.add("scroll-ondrag"),document.addEventListener("touchmove",this._Ss),document.addEventListener("touchend",this._ti)},this._Ss=e=>{var t=e.targetTouches?.[0]?.clientY,i=t-this._CD;this._CD=t;var n=this._tF.displayViewSize===this.height?0:i/a(this._tF,this.height,5)/this._HD.scale;this._tE({x:0,y:n})},this._ti=()=>{document.removeEventListener("touchmove",this._Ss),document.removeEventListener("touchend",this._ti),this._CD=0,this._tf.classList.remove("scroll-ondrag")},this._tF=t,this._HD=i,this._tE=n,this._tp=(0,r.default)(this._tG,200),this._sA.classList.add("scroll-y-board-pc"),this._tf.classList.add("scroll-y-box-pc"),s.default.isMobile&&this._tf.classList.add("scroll-y-box-pad"),this._sA.appendChild(this._tf),e.appendChild(this._sA),this._tG(),this._tF.onUpdateOffset(this._th),this._tF.onUpdateViewSize(this._tp),this._tF.onUpdateTotalSize(this._tp),this.bind()}var t=e.prototype;return t.refresh=function(){this._tp()},t.bind=function(){this._tf.addEventListener("mousedown",this.handleMousedown),this._tf.addEventListener("touchstart",this._tH)},t.unbind=function(){this._tf.removeEventListener("mousedown",this.handleMousedown),this._tf.removeEventListener("touchstart",this._tH)},e}(),c=function(){function e(e,t,i,n){this._sA=document.createElement("div"),this._tf=document.createElement("div"),this._Cd=0,this._tg=!1,this._tO=()=>{if(0===this._tF.displayViewSize||this._tF.displayTotalSize<=this._tF.displayViewSize){this._sA.style.display="none";return}this._sA.style.display="block",this.width=Math.max(60,this._tF.displayViewSize/this._tF.displayTotalSize*this._tF.displayViewSize),this._tf.style.width=`${0|this.width}px`,this._th()},this._th=()=>{this._tg||(this._tg=!0,requestAnimationFrame(()=>{this._tg=!1;var e=this._tF.displayOffsetSize*a(this._tF,this.width,5);this._tf.style.transform=`translateX(${e}px)`}))},this.handleMousedown=e=>{e.preventDefault(),e.stopPropagation(),this._Cd=e.clientX,this._tf.classList.add("scroll-ondrag"),document.addEventListener("mousemove",this.handleMousemove),document.addEventListener("mouseup",this.handleMouseup)},this.handleMousemove=e=>{var t=e.clientX,i=t-this._Cd,n=this._tF.displayViewSize===this.width?0:i/a(this._tF,this.width,5)/this._HD.scale;this._tE({x:n,y:0}),this._Cd=t},this.handleMouseup=()=>{document.removeEventListener("mousemove",this.handleMousemove),document.removeEventListener("mouseup",this.handleMouseup),this._Cd=0,this._tf.classList.remove("scroll-ondrag")},this._tH=e=>{e.stopPropagation(),this._Cd=e.targetTouches?.[0]?.clientX,this._tf.classList.add("scroll-ondrag"),document.addEventListener("touchmove",this._Ss),document.addEventListener("touchend",this._ti)},this._Ss=e=>{var t=e.targetTouches?.[0]?.clientX,i=t-this._Cd,n=this._tF.displayViewSize===this.width?0:i/a(this._tF,this.width,5)/this._HD.scale;this._tE({x:n,y:0}),this._Cd=t},this._ti=()=>{document.removeEventListener("touchmove",this._Ss),document.removeEventListener("touchend",this._ti),this._Cd=0,this._tf.classList.remove("scroll-ondrag")},this._tF=t,this._HD=i,this._tE=n,this._tN=(0,r.default)(this._tO,200),this._sA.classList.add("scroll-x-board-pc"),this._tf.classList.add("scroll-x-box-pc"),s.default.isMobile&&this._tf.classList.add("scroll-x-box-pad"),this._tO(),this._sA.appendChild(this._tf),e.appendChild(this._sA),this._tF.onUpdateOffset(this._th),this._tF.onUpdateViewSize(this._tN),this._tF.onUpdateTotalSize(this._tN),this.bind()}var t=e.prototype;return t.refresh=function(){this._tN()},t.bind=function(){this._tf.addEventListener("mousedown",this.handleMousedown),this._tf.addEventListener("touchstart",this._tH)},t.unbind=function(){this._tf.removeEventListener("mousedown",this.handleMousedown),this._tf.removeEventListener("touchstart",this._tH)},e}(),h=function(){function e(e){this._tk=document.createElement("div"),this._tK=document.createElement("div"),this._tm=()=>{this._tk.style.top=`${this._tJ.row.frozen.displayViewSize}px`,this._tl.refresh()},this._tM=()=>{this._tK.style.left=`${this._tJ.col.frozen.displayViewSize}px`,this._tL.refresh()},this._GM=e.container,this._tJ=e.areaData,this._HD=e.scale,this._tk.classList.add("scroll-y-wrap-pc"),this._tK.classList.add("scroll-x-wrap-pc"),this._tl=new l(this._tk,this._tJ.row.flow,this._HD,e.onDragCb),this._tL=new c(this._tK,this._tJ.col.flow,this._HD,e.onDragCb),this._GM.appendChild(this._tk),this._GM.appendChild(this._tK),this.refresh(),this._tJ.row.frozen.onUpdateViewSize(this._tm),this._tJ.col.frozen.onUpdateViewSize(this._tM),this._HD.onScale(()=>{this._tm(),this._tM()})}return e.prototype.refresh=function(){this._tm(),this._tM()},e}(),_=i(951924),d=function(){function e(e,t){this._sn=null,this._sp=()=>{this._sn&&(0!==this._sn.y&&this._KQ.row.flow.setOffsetSize(this._KQ.row.flow.offsetSize+this._sn.y,_.o.USER),0!==this._sn.x&&this._KQ.col.flow.setOffsetSize(this._KQ.col.flow.offsetSize+this._sn.x,_.o.USER),this._sn=null)},this._tD=e,this._KQ=t.areaData,this._tD._AhX(e=>{this._sr(e)})}return e.prototype._sr=function(e){if(this._sn){this._sn.x+=e.x,this._sn.y+=e.y;return}this._sn=e,window.requestAnimationFrame(this._sp)},e}(),u=function(e){function t(t){var i;return(i=e.call(this,t)||this)._tE=e=>{i._sl.fire(e)},i._te=new h({container:i._Kq.element,areaData:i._KQ,scale:i._tR,onDragCb:i._tE}),new d(i,{areaData:i._KQ}),i}return(0,n._)(t,e),t.prototype.refresh=function(){this._te.refresh()},t}(function(e){this._sl=new o.Q,this._AhX=this._sl.event,this._Kq=e.mainBoard,this._KQ=e.areaData,this._tR=e.scale})},163861:function(e,t,i){var n=i(460725),o=i(72941);t.Z=function(){function e(e){this.spreadsheetView=e,this.spreadsheetView=e}var t=e.prototype;return t.select=function(e,t,i){void 0===i&&(i=null);var{xRange:o,yRange:r}=t,s=o&&o[1]===n.INFINITE_INDEX,a=r&&r[1]===n.INFINITE_INDEX;return s&&a?void this.selectAll(e,i):s?void this.selectRows(e,r,i):a?void this.selectCols(e,o,i):void this.selectCells(e,t,i)},t.selectAll=function(e,t){void 0===t&&(t=null),this._bLr(e),e.addSelection({activation:t},t)},t.selectCells=function(e,t,i){void 0===i&&(i=null),this._bLr(e),e.addSelection({...t,activation:i},i)},t.selectRows=function(e,t,i){void 0===i&&(i=null),this._bLr(e),e.addSelection({yRange:t,activation:i},i)},t.selectCols=function(e,t,i){void 0===i&&(i=null),this._bLr(e),e.addSelection({xRange:t,activation:i},i)},t.getSelectedRows=function(e){return(0,o.TS)(this.spreadsheetView.rowColAccessor,e.selectQueue)},t.getSelectedCols=function(e){return(0,o.rz)(this.spreadsheetView.rowColAccessor,e.selectQueue)},t._bLr=function(e){e.resetSelection()},e}()},264983:function(e,t,i){i.d(t,{Z:function(){return p}});var n=i(758699),o=i(921734);i(738355);var r=i(202630),s=i(795849),a=i(671888),l=i(532565),c=i(72941),h=i(157054),_=i(164013),d=i(696030),u=i(340576),f=function(e){function t(t){var i;return(i=e.call(this)||this)._updateSelectDataByMerge=e=>{for(var{startRow:t,endRow:n,startCol:o,endCol:r}=e,{selectQueue:s}=i._selectData,a=0;a<s.length;a++){var c=s[a];c instanceof l.Z&&n>=c.yRange[0]&&t<=c.yRange[1]&&r>=c.xRange[0]&&o<=c.xRange[1]&&i._selectData.updateSelection(a,c,c.activation)}},i._updateSelectDataByInsertCol=e=>{if(i._Alu(e))for(var{index:t,count:n}=e,{selectQueue:o}=i._selectData,r=i.workbook.activeSheet.getColCount(),s=0;s<o.length;s++){var c=o[s],h=!1,{activation:_}=c;_&&t<=_.col&&(h=!0,_.col+=n,_.col=Math.min(_.col,r-1)),(c instanceof a.Z||c instanceof l.Z)&&(t<=c.xRange[0]&&(h=!0,c.xRange[0]+=n,c.xRange[0]=Math.min(c.xRange[0],r-1)),t<=c.xRange[1]&&(h=!0,c.xRange[1]+=n,c.xRange[1]=Math.min(c.xRange[1],r-1))),h&&i._selectData.updateSelection(s,c,_)}},i._updateSelectDataByInsertRow=e=>{if(i._Alu(e))for(var{index:t,count:n}=e,{selectQueue:o}=i._selectData,r=i.workbook.activeSheet.getRowCount(),a=0;a<o.length;a++){var c=o[a],h=!1,{activation:_}=c;_&&t<=_.row&&(h=!0,_.row+=n,_.row=Math.min(_.row,r-1)),(c instanceof s.Z||c instanceof l.Z)&&(t<=c.yRange[0]&&(h=!0,c.yRange[0]+=n,c.yRange[0]=Math.min(c.yRange[0],r-1)),t<=c.yRange[1]&&(h=!0,c.yRange[1]+=n,c.yRange[1]=Math.min(c.yRange[1],r-1))),h&&i._selectData.updateSelection(a,c,_)}},i._updateSelectDataByDeleteCol=e=>{if(i._Alu(e))for(var{index:t,count:n}=e,{selectQueue:o}=i._selectData,r=i._spreadsheetView.rowColAccessor.getColCount(),s=0;s<o.length;s++){var c=o[s],h=!1,{activation:_}=c;if(c instanceof a.Z||c instanceof l.Z){var d=c.xRange[0],u=c.xRange[1];if(t<=d){for(h=!0,d=Math.min(r-1,Math.max(t,d-n));d<=r-1&&i._spreadsheetView.rowColAccessor.isColHidden(d);d++);for(d=Math.min(r-1,d);d>=0&&i._spreadsheetView.rowColAccessor.isColHidden(d);d--);d=Math.max(0,d)}if(t<=u){for(h=!0,u=Math.min(r-1,Math.max(t,u-n));u<=r-1&&i._spreadsheetView.rowColAccessor.isColHidden(u);u++);for(u=Math.min(r-1,u);u>=d&&i._spreadsheetView.rowColAccessor.isColHidden(u);u--);u=Math.max(d,u)}_&&h&&(_.col=Math.min(u,Math.max(d,t,_.col-n))),c.xRange[0]=d,c.xRange[1]=u}else if(_&&t<=_.col){h=!0;for(var f=Math.min(r-1,Math.max(t,_.col-n));f<=r-1&&i._spreadsheetView.rowColAccessor.isColHidden(f);f++);for(f=Math.min(r-1,f);f>=0&&i._spreadsheetView.rowColAccessor.isColHidden(f);f--);_.col=Math.max(0,f)}h&&i._selectData.updateSelection(s,c,_)}},i._updateSelectDataByDeleteRow=e=>{if(i._Alu(e))for(var{index:t,count:n}=e,{selectQueue:o}=i._selectData,r=i._spreadsheetView.rowColAccessor.getRowCount(),a=0;a<o.length;a++){var c=o[a],h=!1,{activation:_}=c;if(c instanceof s.Z||c instanceof l.Z){var d=c.yRange[0],u=c.yRange[1];if(t<=d){for(h=!0,d=Math.min(r-1,Math.max(t,d-n));d<=r-1&&i._spreadsheetView.rowColAccessor.isRowHidden(d);d++);for(d=Math.min(r-1,d);d>=0&&i._spreadsheetView.rowColAccessor.isRowHidden(d);d--);d=Math.max(0,d)}if(t<=u){for(h=!0,u=Math.min(r-1,Math.max(t,u-n));u<=r-1&&i._spreadsheetView.rowColAccessor.isRowHidden(u);u++);for(u=Math.min(r-1,u);u>=d&&i._spreadsheetView.rowColAccessor.isRowHidden(u);u--);u=Math.max(d,u)}_&&h&&(_.row=Math.min(u,Math.max(d,t,_.row-n))),c.yRange[0]=d,c.yRange[1]=u}else if(_&&t<=_.row){h=!0;for(var f=Math.min(r-1,Math.max(t,_.row-n));f<=r-1&&i._spreadsheetView.rowColAccessor.isRowHidden(f);f++);for(f=Math.min(r-1,f);f>=0&&i._spreadsheetView.rowColAccessor.isRowHidden(f);f--);_.row=Math.max(0,f)}h&&i._selectData.updateSelection(a,c,_)}},i._selectData=t.selectData,i._dataCallView=t.dataCallView,i._spreadsheetView=t.spreadsheetView,i.workbook=t.workbook,i._register(i.workbook.event.onMergedUnmergedRanges(e=>{e.forEach(e=>{var{startColIndex:t,startRowIndex:n,endColIndex:o,endRowIndex:r}=e.range;i._updateSelectDataByMerge({startRow:n,endRow:r,startCol:t,endCol:o})})})),i._register(i._dataCallView.onInsertDeleteRow(e=>{var{insert:t,remove:n}=e;t.forEach(i._updateSelectDataByInsertRow),n.forEach(i._updateSelectDataByDeleteRow)})),i._register(i._dataCallView.onInsertDeleteCol(e=>{var{insert:t,remove:n}=e;t.forEach(i._updateSelectDataByInsertCol),n.forEach(i._updateSelectDataByDeleteCol)})),i}return(0,o._)(t,e),t.prototype._Alu=function(e){return e.sheetId===this._spreadsheetView.getActiveSheetId()},t}(d.Disposable),p=function(e){function t(t,i,n){var o;return(o=e.call(this)||this)._bLR=!1,o.dataCallView=t,o.spreadsheetView=i,o._cpQ=[],o._cpr=new u.Q5({name:"addSelectData"}),o._cpR=new u.Q5({name:"updateSelectData"}),o._cps=new u.Q5({name:"removeSelectData"}),o._cpq=new u.Q5({name:"resetSelectData"}),o.onAddSelectData=o._cpr.event,o.onUpdateSelectData=o._cpR.event,o.onRemoveSelectData=o._cps.event,o.onResetSelectData=o._cpq.event,o.workbook=n,o._register(new f({dataCallView:o.dataCallView,spreadsheetView:o.spreadsheetView,selectData:o,workbook:n})),o}(0,o._)(t,e);var i=t.prototype;return i.isValid=function(){return!!this._cpQ.length},i.setIsInsertion=function(e){this._bLR=e},i.getIsInsertion=function(){return this._bLR},i.addSelection=function(e,t){var i;if(null===e)i=_.Z.newInstance();else if(t){var{correctParam:n,correctActivation:o}=this._bLs(e,t);i=this._bLT(n,o)}else i=this._bLt(e);this._cpQ.splice(this.currentSelectIndex+1,0,i)},i.updateSelection=function(e,t,i){var n,o=this._cpQ[e];if(void 0===o)throw Error("index error when change selectData");if(i){var{correctParam:r,correctActivation:s}=this._bLs(t,i);n=this._bLT(r,s)}else n=this._bLt(t);this._cpQ[e]=n,this._bLS(o)},i.removeSelection=function(e){var t=this._cpQ.splice(e,1)[0];if(void 0===t)throw Error("index error when remove selectData");this._bLS(t)},i.resetSelection=function(){for(var e;e=this._cpQ.shift();)this._bLS(e)},i._bLs=function(e,t){var{rowColAccessor:i,transformTable:n}=this.spreadsheetView;if(e.xRange&&e.yRange){var{correctParam:o,correctActivation:r}=(0,c.Ci)(i,t,e);return{correctParam:o,correctActivation:r}}if(e.xRange){var{correctParam:s,correctActivation:a}=(0,c.ml)(n,i,t,e);return{correctParam:s,correctActivation:a}}if(e.yRange){var{correctParam:l,correctActivation:h}=(0,c.me)(n,i,t,e);return{correctParam:l,correctActivation:h}}var{correctParam:_,correctActivation:d}=(0,c.Ci)(i,t,e);return{correctParam:_,correctActivation:d}},i._bLS=function(e){if(e.activation&&(e.activation=null),e instanceof r.Z)r.Z.destroy(e);else if(e instanceof s.Z)s.Z.destroy(e);else if(e instanceof a.Z)a.Z.destroy(e);else if(e instanceof l.Z)l.Z.destroy(e);else if(e instanceof _.Z)_.Z.destroy(e);else throw Error("unknown selection type")},i._bLt=function(e){var t;return e.xRange&&e.yRange?(e.ignoreAroundEdge||(0,c.nM)(this.spreadsheetView.transformTable,e.yRange,e.xRange,c.mk.EXTEND),t=l.Z.newInstance(e.yRange[0],e.yRange[1],e.xRange[0],e.xRange[1])):t=e.xRange?a.Z.newInstance(e.xRange[0],e.xRange[1]):e.yRange?s.Z.newInstance(e.yRange[0],e.yRange[1]):r.Z.newInstance(),t},i._bLT=function(e,t){var i;return e.xRange&&e.yRange?(e.ignoreAroundEdge||(0,c.nM)(this.spreadsheetView.transformTable,e.yRange,e.xRange,c.mk.EXTEND),i=l.Z.newInstance(e.yRange[0],e.yRange[1],e.xRange[0],e.xRange[1])):i=e.xRange?a.Z.newInstance(e.xRange[0],e.xRange[1]):e.yRange?s.Z.newInstance(e.yRange[0],e.yRange[1]):r.Z.newInstance(),i.activation=new h.Z(t.row,t.col),i},(0,n._)(t,[{key:"select",get:function(){return this._cpQ[this._cpQ.length-1]||null}},{key:"selectQueue",get:function(){return this._cpQ}},{key:"currentSelectIndex",get:function(){return this._cpQ.length-1}}]),t}(d.Disposable)},157054:function(e,t){t.Z=function(e,t){this.row=-1,this.col=-1,this.row=e,this.col=t}},202630:function(e,t,i){var n=i(758699),o=i(921734);i(575739);var r=i(460725),s=i(357744),a=`0-${r.INFINITE_INDEX}:0-${r.INFINITE_INDEX}`,l=function(e){function t(){var t;return(t=e.call(this)||this)._selectAll=!0,t.using=!1,t.using=!0,t}return(0,o._)(t,e),t.prototype.generateKey=function(){return a},t.newInstance=function(){var e=t._cA.pop();return e?(e.using=!0,e):new t},t.destroy=function(e){e.using=!1,t._cA.push(e)},(0,n._)(t,[{key:"selectAll",get:function(){return this._selectAll}}]),t}(s.Z);l._cA=[],t.Z=l},357744:function(e,t,i){var n=i(758699);t.Z=function(){function e(){this.activation=null,this._selectRow=!1,this._selectCol=!1,this._selectCell=!1,this._selectAll=!1}return e.prototype.isEqual=function(e){return e.generateKey()===this.generateKey()},(0,n._)(e,[{key:"selectRow",get:function(){return this._selectRow}},{key:"selectCol",get:function(){return this._selectCol}},{key:"selectCell",get:function(){return this._selectCell}},{key:"selectAll",get:function(){return this._selectAll}}]),e}()},532565:function(e,t,i){var n=i(758699),o=i(921734);i(313575),i(322554),i(323242),i(604509),i(100355),i(83731),i(575739);var r=function(e){function t(t,i,n,o){var r;return(r=e.call(this)||this).xRange=new Uint32Array(2),r.yRange=new Uint32Array(2),r._selectCell=!0,r._using=!1,r._cZ=!0,r._using=!0,r.yRange[0]=t,r.yRange[1]=i,r.xRange[0]=n,r.xRange[1]=o,r}return(0,o._)(t,e),t.prototype.generateKey=function(){return`${this.xRange[0]}-${this.xRange[1]}:${this.yRange[0]}-${this.yRange[1]}`},t.newInstance=function(e,i,n,o){var r=t._cA.pop();return r?(r._using=!0,r.yRange[0]=e,r.yRange[1]=i,r.xRange[0]=n,r.xRange[1]=o,r):new t(e,i,n,o)},t.destroy=function(e){e._using=!1,e.xRange[0]=0,e.xRange[1]=0,e.yRange[0]=0,e.yRange[1]=0,t._cA.push(e)},(0,n._)(t,[{key:"selectCell",get:function(){return this._selectCell}}]),t}(i(357744).Z);r._cA=[],t.Z=r},671888:function(e,t,i){var n=i(758699),o=i(921734);i(313575),i(322554),i(323242),i(604509),i(100355),i(83731),i(575739);var r=i(460725),s=function(e){function t(t,i){var n;return(n=e.call(this)||this).xRange=new Uint32Array(2),n._selectCol=!0,n._using=!1,n._using=!0,n.xRange[0]=t,n.xRange[1]=i,n}return(0,o._)(t,e),t.prototype.generateKey=function(){return`${this.xRange[0]}-${this.xRange[1]}:0-${r.INFINITE_INDEX}`},t.newInstance=function(e,i){var n=t._cA.pop();return n?(n._using=!0,n.xRange[0]=e,n.xRange[1]=i,n):new t(e,i)},t.destroy=function(e){e._using=!1,e.xRange[0]=0,e.xRange[1]=0,t._cA.push(e)},(0,n._)(t,[{key:"selectCol",get:function(){return this._selectCol}}]),t}(i(357744).Z);s._cA=[],t.Z=s},164013:function(e,t,i){var n=i(921734);i(575739);var o=function(e){function t(){var t;return(t=e.call(this)||this)._using=!1,t._using=!0,t}return(0,n._)(t,e),t.prototype.generateKey=function(){return"undefined:undefined"},t.newInstance=function(){var e=t._cA.pop();return e?(e._using=!0,e):new t},t.destroy=function(e){e._using=!1,t._cA.push(e)},t}(i(357744).Z);o._cA=[],t.Z=o},795849:function(e,t,i){var n=i(758699),o=i(921734);i(313575),i(322554),i(323242),i(604509),i(100355),i(83731),i(575739);var r=i(460725),s=function(e){function t(t,i){var n;return(n=e.call(this)||this).yRange=new Uint32Array(2),n._selectRow=!0,n._using=!1,n._using=!0,n.yRange[0]=t,n.yRange[1]=i,n}return(0,o._)(t,e),t.prototype.generateKey=function(){return`0-${r.INFINITE_INDEX}:${this.yRange[0]}-${this.yRange[1]}`},t.newInstance=function(e,i){var n=t._cA.pop();return n?(n._using=!0,n.yRange[0]=e,n.yRange[1]=i,n):new t(e,i)},t.destroy=function(e){e._using=!1,e.yRange[0]=0,e.yRange[1]=0,t._cA.push(e)},(0,n._)(t,[{key:"selectRow",get:function(){return this._selectRow}}]),t}(i(357744).Z);s._cA=[],t.Z=s},969099:function(e,t,i){var n=i(921734),o=i(696030),r=i(340576);t.Z=function(e){function t(t){var i;return(i=e.call(this)||this)._cTh=new r.Q5({name:"selectionStageVisiableChange"}),i._showing=!0,i._selectData=t,i._register(i._selectData.onAddSelectData(i._addSelection.bind(i))),i._register(i._selectData.onUpdateSelectData(i._updateSelection.bind(i))),i._register(i._selectData.onRemoveSelectData(i._removeSelection.bind(i))),i._register(i._selectData.onResetSelectData(i._resetSelection.bind(i))),i._cTG=i._cTh.event,i}return(0,n._)(t,e),t}(o.Disposable)},761344:function(e,t,i){i.d(t,{i:function(){return c}}),i(738355);var n=i(202630),o=i(795849),r=i(671888),s=i(532565),a=i(72941),l=i(164013);function c(e,t,i){if(i instanceof n.Z)c=0,h=0,_=t.col.frozen.displayTotalSize+t.col.flow.displayContentSize,d=t.row.frozen.displayTotalSize+t.row.flow.displayContentSize,f=0,g=0,p=Number.MAX_SAFE_INTEGER,v=Number.MAX_SAFE_INTEGER;else if(i instanceof o.Z)c=0,h=t.getDisplayGlobalTopByRow(i.yRange[0]),_=t.col.frozen.displayTotalSize+t.col.flow.displayContentSize,d=t.getDisplayGlobalBottomByRow(i.yRange[1])-h,t.row.frozen.to>=0&&i.yRange[0]===t.row.frozen.to+1&&(h+=1,d-=1),f=i.yRange[0],g=0,p=i.yRange[1],v=Number.MAX_SAFE_INTEGER;else if(i instanceof r.Z)c=t.getDisplayGlobalLeftByCol(i.xRange[0]),h=0,_=t.getDisplayGlobalRightByCol(i.xRange[1])-c,d=t.row.frozen.displayTotalSize+t.row.flow.displayContentSize,t.col.frozen.to>=0&&i.xRange[0]===t.col.frozen.to+1&&(c+=1,_-=1),f=0,g=i.xRange[0],p=Number.MAX_SAFE_INTEGER,v=i.xRange[1];else if(i instanceof s.Z)c=t.getDisplayGlobalLeftByCol(i.xRange[0]),h=t.getDisplayGlobalTopByRow(i.yRange[0]),_=t.getDisplayGlobalRightByCol(i.xRange[1])-c,d=t.getDisplayGlobalBottomByRow(i.yRange[1])-h,t.row.frozen.to>=0&&i.yRange[0]===t.row.frozen.to+1&&(h+=1,d-=1),t.col.frozen.to>=0&&i.xRange[0]===t.col.frozen.to+1&&(c+=1,_-=1),f=i.yRange[0],g=i.xRange[0],p=i.yRange[1],v=i.xRange[1];else if(i instanceof l.Z)c=-1,h=-1,_=-1,d=-1,f=-1,g=-1,p=-1,v=-1;else throw Error("\u4E0D\u53EF\u7528\u7684\u9009\u533A\u7C7B\u578B");if(i.activation&&i.activation.row>-1&&i.activation.col>-1){var c,h,_,d,u,f,p,g,v,{row:w,col:m}=(0,a.Uz)(e,i.activation.row,i.activation.col);if(w>=0&&m>=0){u=[0,0,0,0];var R=e.getMergeData(w,m),S=w+(R?R.rowCount-1:0),A=m+(R?R.colCount-1:0),E=t.getDisplayGlobalLeftByCol(m),y=t.getDisplayGlobalTopByRow(w),T=t.getDisplayGlobalRightByCol(A),L=t.getDisplayGlobalBottomByRow(S);u[0]=Math.max(y-h,0),u[3]=Math.max(E-c,0),u[1]=Math.max(c+_-T,0),u[2]=Math.max(h+d-L,0)}}return{left:c,top:h,width:_,height:d,padding:u,startRow:f,endRow:p,startCol:g,endCol:v}}},72941:function(e,t,i){i.d(t,{BS:function(){return d},CK:function(){return E},Ci:function(){return g},Kt:function(){return R},Q8:function(){return h},TD:function(){return A},TS:function(){return v},Uz:function(){return c},Xe:function(){return _},lP:function(){return u},me:function(){return f},mk:function(){return a},ml:function(){return p},nM:function(){return l},rl:function(){return S},rz:function(){return w},yW:function(){return m}}),i(575739),i(738355);var n=i(131524),o=i(671888),r=i(532565),s=i(795849);i(460725);var a={DISCARD:0,EXTEND:1};function l(e,t,i,n){void 0===n&&(n=a.EXTEND);var o,r,s,l,c,h,_,d,u,f,p,g,v=e.getRowCount(),w=e.getColCount();for(s=i[0],c=Math.min(i[1],w-1),l=t[0],h=Math.min(t[1],v-1),o=l;o<=h;o++){for(u=!1,_=o===l||o===h?1:Math.max(c-s,1),r=s;r<=c;r+=_)if((d={mergeData:e.getMergeData(o,r),mergeParent:e.getMergeParent(o,r)}).mergeParent||d.mergeData){if(d.mergeParent?(f=r+d.mergeParent.x,p=o+d.mergeParent.y,g={mergeData:e.getMergeData(p,f),mergeParent:e.getMergeParent(p,f)}):(f=r,p=o,g=d),null===g)throw`getCellViewAtPosition error!, y: ${p}, x: ${f}`;if(!g.mergeData)continue;if(n===a.DISCARD){if(g.mergeData.colCount+f-1>c){if((c=f-1)<s)return!1;u=!0;break}if(g.mergeData.rowCount+p-1>h){if((h=p-1)<l)return!1;u=!0;break}if(f<s){if((s=g.mergeData.colCount+f)>c)return!1;u=!0;break}if(p<l){if((l=g.mergeData.rowCount+p)>h)return!1;u=!0;break}}else if(g.mergeData.rowCount+p>h+1&&(h=g.mergeData.rowCount+p-1),p<l&&(o=l=p,u=!0),g.mergeData.colCount+f>c+1&&(c=g.mergeData.colCount+f-1,u=!0),f<s&&(s=f,u=!0),u)break}u&&(o=l-1)}return i[0]=s,i[1]=c,t[0]=l,t[1]=h,!0}function c(e,t,i){var n=e.getMergeParent(t,i);return n?{col:i+n.x,row:t+n.y}:{row:t,col:i}}function h(e,t,i,n,o){for(;i<=n;){if(o(e,i,t))return i;i+=1}return null}function _(e,t,i,n,o){for(;i>=n;){if(o(e,i,t))return i;i-=1}return null}function d(e,t,i,n,o){for(;t<=n;){if(o(e,i,t))return t;t+=1}return null}function u(e,t,i,n,o){for(;t>=n;){if(o(e,i,t))return t;t-=1}return null}function f(e,t,i,o){var r={...i},s={...o},a=h(e,i.row,i.col,t.getColCount()-1,(e,i,o)=>(0,n.D0)(e,i,o)&&(0,n.hZ)(t,i,o));return null===a&&(s.xRange&&(s.xRange=[0,0]),a=0),r.col=a,{correctParam:s,correctActivation:r}}function p(e,t,i,o){var r={...i},s={...o},a=d(e,i.row,i.col,t.getRowCount()-1,(e,i,o)=>(0,n.dK)(e,i,o)&&(0,n.hZ)(t,i,o));return null===a&&(s.yRange&&(s.yRange=[0,0]),a=0),r.row=a,{correctParam:s,correctActivation:r}}function g(e,t,i){var o={...t},r={...i},s=h(e,t.row,t.col,e.getColCount()-1,n.Sl),a=d(e,t.row,t.col,e.getRowCount()-1,n.So);return null===s&&(r.xRange=[0,0],s=0),null===a&&(r.yRange=[0,0],a=0),o.row=a,o.col=s,{correctParam:r,correctActivation:o}}function v(e,t){for(var i=[],n=0;n<t.length;n++){var o=t[n];o.selectAll||o.selectCol?i.push([0,e.getRowCount()-1]):(o.selectRow||o.selectCell)&&i.push([o.yRange[0],o.yRange[1]])}return i}function w(e,t){for(var i=[],n=0;n<t.length;n++){var o=t[n];o.selectAll||o.selectRow?i.push([0,e.getColCount()-1]):(o.selectCol||o.selectCell)&&i.push([o.xRange[0],o.xRange[1]])}return i}function m(e,t){for(var i=[],n=0;n<t.length;n++){var o=t[n];o.selectAll?i.push({xRange:[0,e.getColCount()-1],yRange:[0,e.getRowCount()-1]}):o.selectCol?i.push({xRange:[o.xRange[0],o.xRange[1]],yRange:[0,e.getRowCount()-1]}):o.selectRow?i.push({xRange:[0,e.getColCount()-1],yRange:[o.yRange[0],o.yRange[1]]}):o.selectCell&&i.push({xRange:[o.xRange[0],o.xRange[1]],yRange:[o.yRange[0],o.yRange[1]]})}return i}function R(e,t,i){for(var{selectQueue:n}=i,a=0;a<n.length;a++){var l=n[a];if(l.selectAll)return!0;if(l instanceof s.Z){if(e>=l.yRange[0]&&e<=l.yRange[1])return!0}else if(l instanceof o.Z){if(t>=l.xRange[0]&&t<=l.xRange[1])return!0}else if(l instanceof r.Z){if(e>=l.yRange[0]&&e<=l.yRange[1]&&t>=l.xRange[0]&&t<=l.xRange[1])return!0}else throw Error("\u4E0D\u53EF\u7528\u7684\u9009\u533A\u7C7B\u578B")}return!1}function S(e,t){for(var{selectQueue:i}=t,n=0;n<i.length;n++){var r=i[n];if(r.selectAll||r instanceof o.Z&&e>=r.xRange[0]&&e<=r.xRange[1])return!0}return!1}function A(e,t){for(var{selectQueue:i}=t,n=0;n<i.length;n++){var o=i[n];if(o.selectAll||o instanceof s.Z&&e>=o.yRange[0]&&e<=o.yRange[1])return!0}return!1}function E(e,t){if(1!==t.selectQueue.length)return!1;var{select:i}=t;if(i instanceof r.Z){var[n,o]=i.xRange,[s,a]=i.yRange;if(n===o&&s===a)return!0;var l=e.getMergeData(s,n);if(l&&l.colCount===o-n+1&&l.rowCount===a-s+1)return!0}return!1}},924412:function(e,t,i){i.d(t,{f:function(){return s}}),i(575739);var n=i(460725),o=i(954057),r=i(164013);function s(e,t){var i=[],{selectQueue:s}=e;return s.forEach(e=>{if(!(e instanceof r.Z)){if(e.selectAll)return void i.push((0,o.Sh)(t));if(e.selectRow){var{yRange:s}=e;i.push((0,o.eI)(t,s[0],s[1]));return}if(e.selectCol){var{xRange:a}=e;i.push((0,o.eq)(t,a[0],a[1]));return}var{xRange:l,yRange:c}=e;i.push(new n.GridRange({sheetId:t,startRowIndex:c[0],endRowIndex:c[1],startColIndex:l[0],endColIndex:l[1]}))}}),i}},952869:function(e,t,i){var n=i(758699),o=i(921734);i(738355);var r=i(200271),s=i(340576),a=i(264983),l=i(72941);t.Z=function(e){function t(t,i,n){var o;return(o=e.call(this,t,i,n)||this)._bLX=new s.Q5({name:"modifySelectData"}),o._bLy=(0,r.ad)(()=>{o._bLX.fire()}),o.onModifySelectData=o._bLX.event,o}(0,o._)(t,e);var a=t.prototype;return a.isSingle=function(){return 1===this._cpQ.length},a.addSelection=function(t){var i=this.select;i&&(i.activation=null,this._cpR.fire({index:this.currentSelectIndex,selection:i})),t.activation||(t.activation={row:t.yRange?t.yRange[0]:0,col:t.xRange?t.xRange[0]:0}),e.prototype.addSelection.call(this,t,t.activation),this._cpr.fire(this.select),this._bLy()},a.updateSelection=function(t,i){var n=this._cpQ[t];if(!n)throw Error("\u9519\u8BEF\u66F4\u65B0\u9009\u533A");i.activation||(n.activation?i.activation={row:n.activation.row,col:n.activation.col}:i.activation=null),e.prototype.updateSelection.call(this,t,i,i.activation),this._cpR.fire({index:t,selection:this._cpQ[t]}),this._bLy()},a.removeSelection=function(t){if(t<0||t>this.selectQueue.length)return void i.g.log.error(`\u{79FB}\u{9664}\u{7B2C}${t}\u{9009}\u{533A}\u{5931}\u{8D25}`);e.prototype.removeSelection.call(this,t),this._cps.fire(t)},a.resetSelection=function(){e.prototype.resetSelection.call(this),this._cpq.fire(),this._bLy()},(0,n._)(t,[{key:"activeRow",get:function(){var{activation:e}=this;return e?(0,l.Uz)(this.spreadsheetView.transformTable,e.row,e.col).row:-1}},{key:"activeCol",get:function(){var{activation:e}=this;return e?(0,l.Uz)(this.spreadsheetView.transformTable,e.row,e.col).col:-1}},{key:"activation",get:function(){return null===this.select?null:this.select.activation}}]),t}(a.Z)},159409:function(e,t,i){i.d(t,{Z:function(){return C}});var n=i(758699),o=i(921734);i(575739);var r=function(){function e(e){this._cB=document.createElement("div"),this._cc=document.createElement("div"),this._cC=document.createElement("div"),this._cd=e=>{2==e.button&&e.stopPropagation()},this._cB.classList.add("multiple-selection","my-vip-cursor-style"),this._cc.classList.add("multiple-selection-active"),this._cC.classList.add("multiple-selection-border-style"),this._cB.addEventListener("mousedown",this._cd),this._cB.appendChild(this._cc),this._cB.appendChild(this._cC),this.setAttribute(e)}return e.prototype.setAttribute=function(e){var t,i=Math.max(0,e.width-2),n=Math.max(0,e.height-2),o=-1,r=0,s=0;if(e.padding){this._cc.style.display="block";var{padding:a}=e;t=`${a[0]}px ${a[1]}px ${a[2]}px ${a[3]}px`,r=0-a[0],s=0-a[3]}else this._cc.style.display="none",t=`0px 0px 0px ${i}px`,o-=i;var{display:l=!0}=e;Object.assign(this._cB.style,{left:`${e.left}px`,top:`${e.top}px`,width:`${i}px`,height:`${n}px`,"border-width":t,display:`${l?"block":"none"}`}),Object.assign(this._cC.style,{left:`${o}px`,top:"-1px",width:`${i}px`,height:`${n}px`,marginTop:`${r}px`,marginLeft:`${s}px`})},e.newInstance=function(t,i){var n=e._cA.pop();return n?n.setAttribute(i):n=new e(i),t.appendChild(n._cB),n},e.destroy=function(t){t._cB.remove(),e._cA.push(t)},e}();r._cA=[];var s=function(){function e(e){this._Ca=[],this._CA=e}var t=e.prototype;return t.size=function(){return this._Ca.length},t.clear=function(){for(var e;e=this._Ca.pop();)r.destroy(e)},t.remove=function(e){var t=this._Ca[e];if(void 0===t)return void console.error("can't find multiple selection by index: ",e);this._Ca.splice(e,1),r.destroy(t)},t.add=function(e){this._Ca.push(r.newInstance(this._CA,e))},t.update=function(e,t){var i=this._Ca[e];if(void 0===i)return void console.error("can't find multiple selection by index: ",e);i.setAttribute(t)},e}(),a=i(115089),l=i(242947),c=i(342493),h=i(556019),_=i(464882),d=function(e){function t(){return e.apply(this,arguments)||this}return(0,o._)(t,e),t.newInstance=function(e){var i=t._cA.pop();return i||(i=new t),e.appendChild(i._cB),i._cB.appendChild(i._BRm),i._cB.appendChild(i._cC),i._BRm.appendChild(i._BRN),i._BRm.appendChild(i._BRM),i._BRM.appendChild(i._BRp),i._BRM.appendChild(i._BRn),i._BRm.appendChild(i._BRo),i._BRm.appendChild(i._BRO),i},t.destroy=function(e){e._cB.remove(),t._cA.push(e)},t}(function(){function e(){this._cB=document.createElement("div"),this._BRm=document.createElement("div"),this._BRM=document.createElement("div"),this._BRn=document.createElement("div"),this._BRN=document.createElement("div"),this._BRo=document.createElement("div"),this._BRO=document.createElement("div"),this._BRp=document.createElement("div"),this._cC=document.createElement("div"),this._BRP=-24,this._BRq=0,this.isShow=!1,this.isSVip=!1,this._BRQ=!1,this._BRr=!1,this.isPreview=!1,this.isFirstRow=!1,this._BRR=!1,this.isReverse=!1,this._cak=!1,this._cB.classList.add("single-selection"),this._BRm.classList.add("single-selection-nick-wrapper"),this._BRM.classList.add("single-selection-nick"),this._BRN.classList.add("single-selection-left"),this._BRo.classList.add("single-selection-right"),this._BRp.classList.add("single-selection-nick-icon"),this._BRn.classList.add("single-selection-nick-text"),this._BRO.classList.add("single-selection-nick-image-border"),this._cC.classList.add("select-selection-border"),this._BRn.innerText=a.q.getConfig("userName"),this._zr=h.QI.invokeFunction(e=>e.get(_.y)),this._mz()}var t=e.prototype;return t.setAttribute=function(e){this._BRs=e,this.isShow=!0,this.isSVip&&!this._BRQ&&this._BRV();var t=0,i=0,n=0,o=0,r=0,s=0;if(e.padding){var{padding:a}=e;n=a[0],i=a[1],o=a[2],r=-(t=a[3]),s=-n,this.isReverse=a[0]>0}else t=e.width-2;var{display:l=!0}=e;Object.assign(this._cB.style,{left:`${e.left}px`,top:`${e.top}px`,width:`${Math.max(0,e.width-2)}px`,height:`${Math.max(0,e.height-2)}px`,display:`${l?"block":"none"}`,borderLeftWidth:`${t}px`,borderRightWidth:`${i}px`,borderTopWidth:`${n}px`,borderBottomWidth:`${o}px`,borderLeftColor:this._BRU(t),borderRightColor:this._BRU(i),borderTopColor:this._BRU(n),borderBottomColor:this._BRU(o)}),Object.assign(this._cC.style,{width:`${Math.max(0,e.width-2)}px`,height:`${Math.max(0,e.height-2)}px`,marginLeft:`${r}px`,marginTop:`${s}px`}),this._BRX(e)},t._BRU=function(e){return"rgba(1, 136, 251, 0.1)"},t.show=function(){this._cB.style.display="block"},t.hide=function(){this._cB.style.display="none"},t._BRv=function(e){var{activeSheet:t}=i.g.SpreadsheetApp.workbook,n=t.getFrozenColCount(),o=t.getFrozenRowCount(),{startRow:r,startCol:s}=e;return i.g.SpreadsheetApp.view.canvas.inputManager?.isInputtingState()||this._BRR||1===o&&0===r||1===n&&0===s||this._BRW()||this.onlySupperSVip()&&this._BRx()?"none":"flex"},t._BRw=function(){return!!this._BRR||!this.isPreview&&!this._zr.cursorId},t._BRW=function(){return this._BRr&&!this.isPreview&&!this._zr.alwayShow},t.onlySupperSVip=function(){var e=a.q.getConfig("vipInfo");return e?.type==="SUPER"},t._BRx=function(){var e=a.q.getConfig("vipInfo");return e?.type!=="SUPER"&&!this.isPreview},t._BRX=function(e){var{left:t,width:i,padding:n}=e,{clientWidth:o}=this._BRm,r=getComputedStyle(this._BRm),s=getComputedStyle(this._cC),{marginRight:a}=r,{borderWidth:l}=s,c=this._BRy(e),h=this._BRY(t,i,o,l,a,n?.[1]||0),_=c>0?"scale(1,-1)":"";Object.assign(this._BRm.style,{top:`${c}px`,right:`${h}px`,display:this._BRv(e),transform:_}),Object.assign(this._BRn.style,{transform:_}),this.setIconStyle(_)},t.setIconStyle=function(e){var t=e?"0px":`${this._zr.getVipCursorIconTop()}px`;Object.assign(this._BRp.style,{top:t,transform:e})},t._BRy=function(e){var{top:t,padding:i}=e,{clientHeight:n}=t?this._BRm:this._cB,o=getComputedStyle(this._BRm),r=getComputedStyle(this._cC),{marginTop:s,height:a}=o,{borderWidth:l}=r,c=n||this._BRz(a),h=i?.[0]||0,_=i?.[2]||0,d=this._BRz(l),u=this._BRz(s);return t?(this.isFirstRow=!1,this._BRP=-d-u-c-h,this._BRP):(this.isFirstRow=!0,c+_)},t._BRY=function(e,t,i,n,o,r){var s=this._BRz(n),a=this._BRz(o);return!e&&i>t?t-i:(this._BRq=-s-a-r,this._BRq)},t._BRz=function(e){return parseInt(e,10)},t._BRZ=function(){var e=this._zr.getVipCursorIconTop(),t="";this.isFirstRow&&(e=0,t="scale(1, -1)"),Object.assign(this._BRp.style,{top:`${e}px`,transform:t})},t._BRV=function(e){if(this.isShow){if(this._BRQ=!0,this._cB.classList.add(l.s9),e===l.J4){this._BRm.style.display="none";return}if(this._zr.alwayShow&&!this.isPreview){this._BRm.style.display=this._BRv(this._BRs);return}setTimeout(()=>{this._BRm.classList.add("hide-nick"),setTimeout(()=>{this.hideNick()},1e3)},5e3)}},t.hideNick=function(){(!this._zr.alwayShow||this.isPreview)&&(this._BRm.style.display="none",this._BRr=!0)},t._BsA=function(){this._cB.classList.add("my-vip-cursor-style"),this._BRm.classList.remove("hide-nick");var e=this._BRy(this._BRs),t=this.isFirstRow?"scale(1,-1)":"",i={display:this._BRv(this._BRs),transform:t};this.isReverse||(i.top=`${e}px`),Object.assign(this._BRm.style,i),Object.assign(this._BRn.style,{transform:t}),this._BRZ()},t._mz=function(){this._zr.cursorStyleLoadedStatusEvent(e=>{if(e.type===c.PR.ALWAYS_CHANGE){var t=e?.cursorIds?.[0];if(!t)return;this._BRV(t)}if(e.type===c.PR.LOADED&&(this.isSVip=!0,this._caK(),this._BRV()),e.type===c.PR.PREVIEW){var i=e?.cursorIds?.[0];this.isPreview=!0,i===l.J4?(this._BRR=!0,this.hideNick()):(this._BRR=!1,this._BsA())}e.type===c.PR.PREVIEW_CANCEL&&(this.hideNick(),this._BRZ(),this.isPreview=!1,this._BRR=!1)})},t._caK=function(){var e=a.q.getConfig("userName");e&&!this._cak&&(this._BRn.innerText=e,this._cak=!0)},e}());d._cA=[];var u=i(696030),f=i(563411),p=function(e){function t(t){var n;return(n=e.call(this)||this)._Ja=new f.Q({name:"clickSmartCorner"}),n._Je=new f.Q({name:"dbclickSmartCorner"}),n._BL=e=>{e.preventDefault()},n.handleMousedown=e=>{if(2===e.button)return e.preventDefault();n._Ja.fire(e)},n._JE=e=>{n._Je.fire(e)},n._Jf=()=>{i.g.removeEventListener("mouseup",n._Jf),setTimeout(()=>{n._JD.classList.remove("no-cursor")},100)},n._JF=()=>{n._JD.classList.add("no-cursor"),i.g.addEventListener("mouseup",n._Jf)},n.onClick=n._Ja.event,n.onDoubleClick=n._Je.event,n._JD=document.createElement("div"),n._JD.classList.add("smart-corner","my-vip-cursor-style"),n._JD.addEventListener("mousedown",n.handleMousedown),n._JD.addEventListener("dblclick",n._JE),n._JD.addEventListener("contextmenu",n._BL),t.appendChild(n._JD),n}(0,o._)(t,e);var n=t.prototype;return n.setAttribute=function(e){this._JF(),Object.assign(this._JD.style,{left:`${e.left+e.width-1}px`,top:`${e.top+e.height-1}px`})},n.show=function(){this._JD.style.display="block"},n.hide=function(){this._JD.style.display="none"},t}(u.Disposable),g=i(340576),v=function(){function e(e){this._Ry=!1,this._RY=e=>{this._RX={topDragger:this._Rz("top"),rightDragger:this._Rz("right"),bottomDragger:this._Rz("bottom"),leftDragger:this._Rz("left")},Object.keys(this._RX).forEach(t=>{e.appendChild(this._RX[t])})},this._Rz=e=>{var t=document.createElement("div");return t.classList.add("range-move-dragger"),t.classList.add(e),t.addEventListener("mousedown",this.handleMousedown),t.addEventListener("contextmenu",this._BL),t},this._BL=e=>{e.preventDefault(),e.stopPropagation()},this.handleMousedown=e=>{if(2===e.button)return e.preventDefault();this._Rx.fire(e)},this._Jf=()=>{i.g.removeEventListener("mouseup",this._Jf),setTimeout(()=>{this._RX.topDragger.classList.remove("no-cursor"),this._RX.rightDragger.classList.remove("no-cursor"),this._RX.bottomDragger.classList.remove("no-cursor"),this._RX.leftDragger.classList.remove("no-cursor")},100)},this._JF=()=>{this._RX.topDragger.classList.add("no-cursor"),this._RX.rightDragger.classList.add("no-cursor"),this._RX.bottomDragger.classList.add("no-cursor"),this._RX.leftDragger.classList.add("no-cursor"),i.g.addEventListener("mouseup",this._Jf)},this._RY(e),this._Rx=new g.Q5({name:"mouseDownDragger"}),this.onMouseDown=this._Rx.event}var t=e.prototype;return t.setAttribute=function(t){this._JF(),Object.assign(this._RX.topDragger.style,{left:`${t.left}px`,top:`${t.top-2}px`,width:`${t.width}px`,height:`${e.BORDER_WIDTH}px`}),Object.assign(this._RX.rightDragger.style,{left:`${t.left+t.width-e.BORDER_WIDTH+1}px`,top:`${t.top}px`,width:`${e.BORDER_WIDTH}px`,height:`${t.height-e.BORDER_WIDTH}px`}),Object.assign(this._RX.bottomDragger.style,{left:`${t.left}px`,top:`${t.top+t.height-e.BORDER_WIDTH+1}px`,width:`${t.width}px`,height:`${e.BORDER_WIDTH}px`}),Object.assign(this._RX.leftDragger.style,{left:`${t.left-1}px`,top:`${t.top}px`,width:`${e.BORDER_WIDTH}px`,height:`${t.height-e.BORDER_WIDTH}px`})},t.show=function(){this._Ry&&Object.keys(this._RX).forEach(e=>{this._RX[e].style.display="block"})},t.hide=function(){Object.keys(this._RX).forEach(e=>{this._RX[e].style.display="none"})},t.setValid=function(e){if(this._Ry=e,!e)return void this.hide();this.show()},e}();v.BORDER_WIDTH=4;var w=i(45865),m=function(){function e(e){this._sA=e,this._RZ=d.newInstance(this._sA),this._sa=new p(this._sA),this.rangeMoveDragger=new v(this._sA)}var t=e.prototype;return t.getLeft=function(){return this._sb},t.getTop=function(){return this._sB},t.getWidth=function(){return this._An},t.getHeight=function(){return this._AN},t.getSmartCorner=function(){return this._sa},t.hide=function(){!1!==w.Z.getConfig("custom.insertDeleteMoveRange")&&this.rangeMoveDragger.hide(),this._sa.hide(),this._RZ.hide()},t.show=function(){!1!==w.Z.getConfig("custom.insertDeleteMoveRange")&&this.rangeMoveDragger.show(),this._sa.show(),this._RZ.show()},t.update=function(e){this._sb=e.left,this._sB=e.top,this._An=e.width,this._AN=e.height,!1!==w.Z.getConfig("custom.insertDeleteMoveRange")&&this.rangeMoveDragger.setAttribute(e),this._sa.setAttribute(e),this._RZ.setAttribute(e)},e}(),R={EMPTY:0,USING_SINGLE:1,USING_MULTIPLE:2},S=function(e){function t(t,i,n,o){var r;return(r=e.call(this)||this).view=t,r.sheetStatus=i,r.spreadsheetView=n,r.blockBoard=o,r.board=document.createElement("div"),r._AtB=R.EMPTY,r._Atc=()=>{if(r.sheetStatus.canEdit(r.view.getSelectionRanges())){var e=!1!==w.Z.getConfig("custom.insertDeleteMoveRange");r._sk.rangeMoveDragger.setValid(e);return}r._sk.rangeMoveDragger.setValid(!1)},r.board.classList.add("selection-stage-board"),r.blockBoard.hiddenBoard.append(r.board),r._sk=new m(r.board),r._Atb=new s(r.board),r.sheetStatus.change(r._Atc),r._Atc(),r}(0,o._)(t,e);var i=t.prototype;return i.addSelection=function(e,t){var i={left:e.left-this.blockBoard.globalOffsetX,top:e.top-this.blockBoard.globalOffsetY,width:e.width,height:e.height,padding:e.padding,display:t,startRow:e?.startRow,startCol:e?.startCol};this._AtB===R.EMPTY?(this._sk.update(i),this._sk.show(),this._AtB=R.USING_SINGLE):this._AtB===R.USING_SINGLE?(this._sk.hide(),this._Atb.add({left:this._sk.getLeft(),top:this._sk.getTop(),width:this._sk.getWidth(),height:this._sk.getHeight()}),this._Atb.add(i),this._AtB=R.USING_MULTIPLE):this._Atb.add(i)},i.updateSelection=function(e,t,i,n){var o={left:t.left-this.blockBoard.globalOffsetX,top:t.top-this.blockBoard.globalOffsetY,width:t.width,height:t.height,padding:t.padding,display:i,startRow:t?.startRow,startCol:t?.startCol};n&&this.setSingleSelectionStatus(),this._AtB===R.USING_MULTIPLE?this._Atb.update(e,o):this._AtB===R.USING_SINGLE&&this._sk.update(o)},i.setSingleSelectionStatus=function(){this._AtB=R.USING_SINGLE,this._Atb.clear(),this._sk.show()},i.removeSelection=function(e){this._AtB===R.USING_MULTIPLE?this._Atb.remove(e):this._AtB===R.USING_SINGLE&&this._sk.hide()},i.resetSelection=function(){this._Atb.clear(),this._sk.hide(),this._AtB=R.EMPTY},i.show=function(){this.board.style.display="block"},i.hide=function(){this.board.style.display="none"},i.dispose=function(){e.prototype.dispose.call(this),this.board.remove()},(0,n._)(t,[{key:"singleSelectionApi",get:function(){return this._sk}}]),t}(u.Disposable),A=i(761344),E=i(969099),y=i(200271),T=i(155094),L=i(156084),b=i(951924),C=function(e){function t(t,i,n,o,r){var s;return(s=e.call(this,i)||this)._bbr=!1,s.view=t,s.normalSelectData=i,s.spreadsheetView=n,s.sheetStatus=o,s.mutexManagement=r,s._handleUpdateSelections=(0,y.ad)(()=>{for(var e=0;e<s._selectData.selectQueue.length;e++){var t=s._selectData.selectQueue[e];s._updateSelection({index:e,selection:t})}}),s._bbQ=(0,L.default)(s._handleUpdateSelections,void 0,{trailing:!0}),s._bbR=e=>{var{source:t}=e;if(!s._bbr){if(t===b.o.RENDER)return void s._bbQ();t===b.o.USER&&(s._bbr=!0),g.ju.once(s.spreadsheetView.renderManager.renderApi.onAfterRender)(()=>{s._bbr=!1,s._handleUpdateSelections()})}},s.topLeft=s._register(new S(t,o,n,s.spreadsheetView.mainBoard.top.left)),s.topRight=s._register(new S(t,o,n,s.spreadsheetView.mainBoard.top.right)),s.bottomLeft=s._register(new S(t,o,n,s.spreadsheetView.mainBoard.bottom.left)),s.bottomRight=s._register(new S(t,o,n,s.spreadsheetView.mainBoard.bottom.right)),s._register(s.spreadsheetView.areaData.row.frozen.onUpdateViewSize(s._bbR)),s._register(s.spreadsheetView.areaData.row.flow.onUpdateViewSize(s._bbR)),s._register(s.spreadsheetView.areaData.col.frozen.onUpdateViewSize(s._bbR)),s._register(s.spreadsheetView.areaData.col.flow.onUpdateViewSize(s._bbR)),s._register(s.spreadsheetView.areaData.row.frozen.onUpdateTotalSize(s._bbR)),s._register(s.spreadsheetView.areaData.row.flow.onUpdateTotalSize(s._bbR)),s._register(s.spreadsheetView.areaData.col.frozen.onUpdateTotalSize(s._bbR)),s._register(s.spreadsheetView.areaData.col.flow.onUpdateTotalSize(s._bbR)),s.mutexManagement.addMutexComponent(T.d.SELECTION,s),s}(0,o._)(t,e);var i=t.prototype;return i.refresh=function(){},i.show=function(){this._showing||this._show()},i.hide=function(){this._showing&&this._hide()},i.mutexHide=function(){this._showing&&this._hide()},i._show=function(){this._showing=!0,this.topLeft.show(),this.topRight.show(),this.bottomLeft.show(),this.bottomRight.show(),this.mutexManagement.mutexShow(T.d.SELECTION),this._cTh.fire(this._showing)},i._hide=function(){this._showing=!1,this.topLeft.hide(),this.topRight.hide(),this.bottomLeft.hide(),this.bottomRight.hide(),this._cTh.fire(this._showing)},i._addSelection=function(e){var{areaData:t}=this.spreadsheetView,i=(0,A.i)(this.spreadsheetView.transformTable,t,e);this.topLeft.addSelection(i,i.startRow<=t.row.frozen.to&&i.startCol<=t.col.frozen.to),this.topRight.addSelection(i,i.startRow<=t.row.frozen.to&&i.endCol>=t.col.flow.from),this.bottomLeft.addSelection(i,i.endRow>=t.row.flow.from&&i.startCol<=t.col.frozen.to),this.bottomRight.addSelection(i,i.endRow>=t.row.flow.from&&i.endCol>=t.col.flow.from)},i._updateSelection=function(e){var{index:t,selection:i}=e,{areaData:n}=this.spreadsheetView,o=(0,A.i)(this.spreadsheetView.transformTable,n,i),r=1===this._selectData.selectQueue.length;this.topLeft.updateSelection(t,o,o.startRow<=n.row.frozen.to&&o.startCol<=n.col.frozen.to,r),this.topRight.updateSelection(t,o,o.startRow<=n.row.frozen.to&&o.endCol>=n.col.flow.from,r),this.bottomLeft.updateSelection(t,o,o.endRow>=n.row.flow.from&&o.startCol<=n.col.frozen.to,r),this.bottomRight.updateSelection(t,o,o.endRow>=n.row.flow.from&&o.endCol>=n.col.flow.from,r)},i._removeSelection=function(e){this._showing||this._show(),this.topLeft.removeSelection(e),this.topRight.removeSelection(e),this.bottomLeft.removeSelection(e),this.bottomRight.removeSelection(e)},i._resetSelection=function(){this.topLeft.resetSelection(),this.topRight.resetSelection(),this.bottomLeft.resetSelection(),this.bottomRight.resetSelection()},(0,n._)(t,[{key:"showing",get:function(){return this._showing}}]),t}(E.Z)},644080:function(e,t,i){var n=i(921734),o=i(696030),r=i(951924);t.Z=function(e){function t(t,i){var n;return(n=e.call(this)||this).slideOperate=t,n.spreadsheetView=i,n._Ate=e=>{var{areaData:t}=n.spreadsheetView;t.row.flow.setOffsetSize(t.row.flow.offsetSize-e.y,r.o.USER),t.col.flow.setOffsetSize(t.col.flow.offsetSize-e.x,r.o.USER)},n._register(n.slideOperate.onSlide(n._Ate)),n}return(0,n._)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this)},t}(o.Disposable)},388261:function(e,t,i){var n=i(921734);i(575739);var o=i(384341),r=i(66031),s=i(340576),a=i(696030),l=i(745725),c=i(737814),h=Math.cos(.25*Math.PI);t.Z=function(e){function t(t,i){var n;return(n=e.call(this)||this)._Atj=!1,n._AtJ=!1,n._bMX=!1,n._ASY=null,n.spreadsheetView=t,n._ms=i,n._AtF={currX:0,currY:0},n._Atg=[],n._AtG=new s.Q5,n.cancelAnimationFrame=()=>{cancelAnimationFrame(n._Ath)},n.handleMousedown=()=>{n.cancelAnimationFrame()},n._AtK=e=>{switch(e.state){case"begin":n._Atl(e);break;case"change":n._AtL(e);break;case"end":n._Atm()}},n._Atl=e=>{n.cancelAnimationFrame(),n._AtF.currX=e["location.x"],n._AtF.currY=e["location.y"]},n._AtL=e=>{n._Atg.length>10&&n._Atg.shift(),n._Atg.push({x:e["location.x"],y:e["location.y"],time:performance.now()});var t=e["location.x"]-n._AtF.currX,i=e["location.y"]-n._AtF.currY;n._AtF.currX=e["location.x"],n._AtF.currY=e["location.y"],n._sr({x:t,y:i})},n._Atm=()=>{n._AtM()},n._kG=()=>{var e=n.spreadsheetView.operateContext.operateData,t=n.spreadsheetView.areaData;n.cancelAnimationFrame(),n._AtJ=e.startRow<=t.row.frozen.to,n._Atj=e.startCol<=t.col.frozen.to,n._AtH=!1,n._Ati=!1,n._Atg=[{x:e.currX,y:e.currY,time:performance.now()}],document.body.addEventListener("touchmove",n._Ss),document.body.addEventListener("touchend",n._ti),document.body.addEventListener("touchcancel",n._ti),r.Jn.sendEvent("sheet","sheet_r_start_slide")},n._Ss=()=>{var e=n.spreadsheetView.operateContext.operateData;e.fingerData.mode===l.w.MOVE&&(n._bMX||(n._Atg.length>=12&&n._Atg.shift(),n._Atg.push({x:e.currX,y:e.currY,time:performance.now()}),n._sr({x:e.diffX,y:e.diffY})))},n._ti=()=>{if(!n._bMX){var e=n.spreadsheetView.operateContext.operateData;n._Atg.push({x:e.currX,y:e.currY,time:performance.now()}),e.fingerData.mode===l.w.IDLE&&(n._AtM(),document.body.removeEventListener("touchmove",n._Ss),document.body.removeEventListener("touchend",n._ti),document.body.removeEventListener("touchcancel",n._ti)),n._Atg=[],r.Jn.sendEvent("sheet","sheet_r_end_slide")}},n._sp=()=>{n._ASY&&(n._AtG.fire(n._ASY),n._ASY=null)},n.onSlide=n._AtG.event,n._mm(),n._ms.onSwitchSheetEvent?.(n.cancelAnimationFrame),o.default.isIOS&&o.default.isWxWork&&window.tdocs?.addEventListener?.("notifyContainerLifeCycle",e=>{var{value:t}=e;n._bMy("willDisappear"!==t)}),n}(0,n._)(t,e);var a=t.prototype;return a.dispose=function(){e.prototype.dispose.call(this),this._AFS()},a._bMy=function(e){this._bMX=!e,e||(this.cancelAnimationFrame(),document.body.removeEventListener("touchmove",this._Ss),document.body.removeEventListener("touchend",this._ti),document.body.removeEventListener("touchcancel",this._ti),this._Atg=[])},a._mm=function(){this.spreadsheetView.container.addEventListener("touchstart",this._kG),this.spreadsheetView.container.addEventListener("mousedown",this.handleMousedown),o.default.isIPad&&o.default.isTencentDocsApp&&i.g.mqq?.addEventListener("ipadWheelEvent",this._AtK)},a._AFS=function(){this.spreadsheetView.container.removeEventListener("touchstart",this._kG),this.spreadsheetView.container.removeEventListener("mousedown",this.handleMousedown),o.default.isIPad&&o.default.isTencentDocsApp&&i.g.mqq?.removeEventListener("ipadWheelEvent",this._AtK)},a._AtM=function(){var[e,t,i]=this._Atn();if(!(e<.04)){var n=.72*e,o=Math.round(e/6e-4);this._ASY&&(this._ASY.isTriggerMomentumScroll=!0),this._AtN(n*n/.0012,Math.abs(t)<h?0:t,Math.abs(i)<h?0:i,o)}},a._Atn=function(){if(this._Atg.length<4)return[0];var e=this._Atg[0],t=this._Atg[this._Atg.length-1],i=t.x-e.x,n=t.y-e.y,o=Math.sqrt(i*i+n*n);return[o/(t.time-e.time),i/o,n/o]},a._AtN=function(e,t,i,n){this._Atk=0;var o,r=Date.now(),s=()=>{var a,l=Date.now()-r;if(l>=n)return void this._Ato(e,t,i);o=e*(1-(a=l/n-1)*a*a*a),!(e-o<.33)&&(this._Ato(o,t,i),this._AtO(),this._AtH&&this._Ati||(this._Ath=requestAnimationFrame(s)))};this._Ath=requestAnimationFrame(s)},a._Ato=function(e,t,i){var n=(e-this._Atk)*t,o=(e-this._Atk)*i;this._Atk=e,this._AtG.fire({x:this._AtH?0:n,y:this._Ati?0:o})},a._AtO=function(){var e=this.spreadsheetView.areaData;if(this._Atj){var{offsetSize:t,viewSize:i,totalSize:n}=e.col.frozen;(0===t||i===Math.min((0,c.pJ)(this.spreadsheetView),n))&&(this._AtH=!0)}else{var{offsetSize:o,maxOffsetSize:r}=e.col.flow;(0===o||o===r)&&(this._AtH=!0)}if(this._AtJ){var{offsetSize:s,viewSize:a,totalSize:l}=e.row.frozen;(0===s||a===Math.min((0,c.n_)(this.spreadsheetView),l))&&(this._Ati=!0)}else{var{offsetSize:h,maxOffsetSize:_}=e.row.flow;(0===h||h===_)&&(this._Ati=!0)}},a._sr=function(e){if(this._ASY){this._ASY.x+=e.x,this._ASY.y+=e.y;return}this._ASY=e,window.requestAnimationFrame(this._sp)},t}(a.Disposable)},375218:function(e,t,i){var n=i(921734),o=i(696030),r=i(951924);t.Z=function(e){function t(t,i){var n;return(n=e.call(this)||this)._BDe=t,n.spreadsheetView=i,n._sT=e=>{var{areaData:t}=n.spreadsheetView;t.row.flow.setOffsetSize(t.row.flow.offsetSize-e.y,r.o.USER),t.col.flow.setOffsetSize(t.col.flow.offsetSize-e.x,r.o.USER)},n._register(n._BDe._AhX(n._sT)),n}return(0,n._)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this)},t}(o.Disposable)},56332:function(e,t,i){var n=i(921734),o=i(340576),r=i(696030),s=i(384341);t.Z=function(e){function t(t,i){var n;return(n=e.call(this)||this)._sL=!1,n._sm=!1,n._sM="",n._sn=null,n._sN=!1,n.spreadsheetView=t,n._BDD=i,n._sl=new o.Q5,n._so=e=>{if(!n._sN){var t=0,i=0;if("wheel"===e.type)t=e.deltaX,i=e.deltaY,1===e.deltaMode?s.default.isMac?(0!==i&&(i=i>0?Math.max(10,Math.min(10*i,80)):Math.min(-10,Math.max(10*i,-80))),0!==t&&(t=t>0?Math.max(10,Math.min(10*t,80)):Math.min(-10,Math.max(10*t,-80)))):(0!==i&&(i=i>0?Math.max(20,Math.min(20*i,100)):Math.min(-20,Math.max(20*i,-100))),0!==t&&(t=t>0?Math.max(20,Math.min(20*t,100)):Math.min(-20,Math.max(20*t,-100)))):(i*=1,t*=1),n._sQ(-t,-i,e.shiftKey);else{var o=e.axis,r=e.detail>0?Math.max(10,Math.min(10*e.detail,80)):Math.min(-10,Math.max(10*e.detail,-80));1===o?n._sQ(-r,0):n._sQ(0,-r)}e.preventDefault()}},n._sO=e=>{if(!n._sN){var t=0,i=0;void 0!==e.deltaY?t=-e.deltaY:void 0!==e.wheelDeltaY?t=e.wheelDeltaY:e.wheelDelta?t=e.wheelDelta:e.detail&&(t=-e.detail),void 0!==e.deltaX?i=-e.deltaX:void 0!==e.wheelDeltaX&&(i=e.wheelDeltaX),n._sL||0===t||t%120!==0?(n._sL=!0,t*=1):t=50*Math.ceil(t/120),n._sm||0===i||i%120!==0?(n._sm=!0,i*=1):i=50*Math.ceil(i/120),n._sQ(i,t,e.shiftKey),n._YC(i,t),e.preventDefault()}},n._bg=()=>{n._sN=!0,document.addEventListener("mouseup",n._bh,!0)},n._bh=()=>{n._sN=!1,document.removeEventListener("mouseup",n._bh,!0)},n._sp=()=>{n._sn&&(n._sl.fire({...n._sn}),n._sn=null)},n._AhX=n._sl.event,n._sP(),n}(0,n._)(t,e);var i=t.prototype;return i.dispose=function(){e.prototype.dispose.call(this),this._sq()},i._sP=function(){this._BDD.forEach(e=>{if(s.default.isFirefox){var t,i="onwheel"in document.createElement("div")?"wheel":"DOMMouseScroll";this._sM=i,e.addEventListener(i,this._so)}else t="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",this._sM=t,e.addEventListener(t,this._sO);(s.default.isIPad||s.default.isIPadEmulatedMac)&&e.addEventListener("mousedown",this._bg,!0)})},i._sq=function(){this._BDD.forEach(e=>{""!==this._sM&&(s.default.isFirefox?e.removeEventListener(this._sM,this._so):e.removeEventListener(this._sM,this._sO),e.removeEventListener("mousedown",this._bg,!0))})},i._sQ=function(e,t,i){void 0===i&&(i=!1),this._YE();var n={x:e,y:t};i&&0!==n.y&&(n.x=n.y,n.y=0),this._sr(n)},i._YC=function(e,t){(0===e||1===e)&&(0===t||1===t)&&(this._sn&&(this._sn.isTriggerMomentumScroll=!0),this._YE(),this._Yc=setTimeout(()=>{this._sQ(e/2,t/2)},30))},i._YE=function(){clearTimeout(this._Yc)},i._sr=function(e){if(this._sn){this._sn.x+=e.x,this._sn.y+=e.y;return}this._sn=e,window.requestAnimationFrame(this._sp)},t}(r.Disposable)},729345:function(e,t,i){i.d(t,{GV:function(){return s},Je:function(){return a},LG:function(){return r},Te:function(){return n},W4:function(){return o},fS:function(){return l},t1:function(){return c}});var n=7719==i.j?{SHARE:"0",MENU:"1",STAR_OFF:"2",STAR_ON:"3",BACK:"4",UNDO:"5",REDO:"6",EXPAND:"7",DONE:"10",EYE:"11",ADD_COLLABORATOR:"12",COLLABORATOR:"13",NOTIFICATION:"14",AUTH:"15",EXIT:"16",UPLOAD_TO_CLOUD:"17",UPLOAD_TO_CLOUD_SUC:"18",INVITE_AUTH:"20",DOC_MEMBER_ICON:"21"}:null,o=7719==i.j?{show:0,hide:1,disable:2,selected:3}:null,r=7719==i.j?{left:0,right:1,middle:2}:null,s="nv_types",a="sheet",l="2.16.9",c="3.0.0"},715399:function(e,t,i){i.d(t,{W:function(){return c},j:function(){return h}});var n=i(384341),o=i(524112),r=i(729345),s=i(470484),a=i(976037),l=void 0;function c(){return void 0!==l?l:l=!!(n.default.isTencentDocsApp&&((0,s.ry)()||null!==(0,o.ej)(r.GV).match(r.Je)))||!1}function h(e){var t=document.getElementById("mobile-design-menu-mountpoint");t&&0!==t.children.length?a.ZP.default.trigger("hideMobileMoreMenu"):a.ZP.default.trigger("showMobileMoreMenu",void 0,e)}},914228:function(e,t,i){i.d(t,{e:function(){return n}});var n={EDIT:"edit",FILTER:"filter",WRITE_TOGETHER:"write-together",OPERATE:"operate",COMMIT:"commit",TAB_TOOLS:"tab-tools",TAB_FILE:"tab-file",TAB_VIEW:"tab-view",DATA_VIEW:"data-view",OPEN_VIEW:"open-view",SCROLL_TO_TOP:"scroll-to-top",SCROLL_TO_BOTTOM:"scroll-to-bottom",SEARCH_REPLACE:"search-replace",SHEET_AI_HELPER:"sheet-ai-sidebar"}},943138:function(e,t,i){i.d(t,{VX:function(){return o},em:function(){return r}});var n=i(914228),o="mobile-action-button-bar",r={QUICK_FILL:"quick-fill",SEARCH:"smart-sheet|search",INSERT_RECORD:"smart-sheet|insert-record",VIEW_SWITCH:"smart-sheet|view-switch",LIKE:"like",SMART_CANVAS_EDIT:"smartcanvas:mobile-actionbar#edit",TOOL_BOX:"tool-box"};n.e.EDIT,n.e.OPEN_VIEW,n.e.FILTER,n.e.SEARCH_REPLACE,r.SEARCH,r.VIEW_SWITCH,r.INSERT_RECORD,r.SMART_CANVAS_EDIT,n.e.SHEET_AI_HELPER,n.e.OPERATE,n.e.SCROLL_TO_TOP,n.e.SCROLL_TO_BOTTOM,r.SEARCH,r.VIEW_SWITCH,r.INSERT_RECORD,r.SMART_CANVAS_EDIT,n.e.EDIT,r.QUICK_FILL,n.e.FILTER},622228:function(e,t,i){i.d(t,{HM:function(){return n}}),i(575739);var n={TOOLBAR_MENU:"single_toolbar_menu",UNDO:"undo",REDO:"redo",FORMAT_PAINTER:"format-painter",CLEAR_FORMAT:"clear-format",INSERT:"toolbar-insert",INSERT_GROUP:"toolbar-insert-group",NUMBER_FORMAT:"number-format",NUMBER_FORMAT_GROUP:"number-format-group",PERCENT_STYLE:"percent-style",COMMA_STYLE:"comma-style",DECIMAL:"decimal",FONT_GROUP:"font",FONT_FAMILY:"font-family",FONT_SIZE:"font-size",FONT_INCREASE:"font-increase",FONT_REDUCE:"font-reduce",SINGLE_FONT_GROUP:"SINGLE_FONT_GROUP",BOLD:"bold",ITALIC:"italic",UNDERLINE:"underline",STRIKETHROUGH:"strikethrough",FONT_COLOR:"font-color",BACKGROUND_COLOR:"background-color",CELL_BORDER:"cell-border",SHAPE_BORDER:"shape-border",TABLE_STYLE:"table-style",MERGE:"merge",HORIZONTAL_ALIGN:"horizontal-align",VERTICAL_ALIGN:"vertical-align",TEXT_ORIENTATION:"text-orientation",AUTO_WRAP:"auto-wrap",FREEZE:"freeze",FORMULA:"formula",FILTER:"filter",SORT:"sort",DATA:"toolbar-data",DATA_GROUP:"data-group",FIND_REPLACE:"find-replace",EXTEND_ADDON:"extend-addon",RANGE_AUTH:"range-auth",PAGE_SETTING:"page-setting",RESIZE_ROW_COL:"resize-row-col",TOOLBAR_MODE:"toobar-mode",ALIGN_GROUP:"align",HORIZONTAL_ALIGN_CENTER:"horizontal-align-center",HORIZONTAL_ALIGN_LEFT:"horizontal-align-left",HORIZONTAL_ALIGN_RIGHT:"horizontal-align-right",VERTICAL_ALIGN_MIDDLE:"vertical_align_middle",VERTICAL_ALIGN_TOP:"vertical_align_top",VERTICAL_ALIGN_BOTTOM:"vertical_align_bottom",COMMENT_ENT:"comment-ent",MENTION_ENT:"mention-ent",ALL_COMMENTS_ENT:"all-comments-ent",TOGGLE_TITLEBAR:"toggle-titlebar",TOOL_BOX:"tool-box",PDF_CHANGE:"pdf-change",PDF_FORMAT_CHANGE_DOUBLE:"pdf-format-change-double",PDF_FORMAT_CHANGE_SINGLE:"pdf-format-change-single",PDF_TO_WORD:"pdf-to-word",PDF_TO_EXCEL:"pdf-to-excel",PDF_TO_PPT:"pdf-to-ppt",EXPORT_TO_IMAGE:"export-to-image",CONVERT_TO_SMART_SHEET:"toolbar-convert-to-smart-sheet",CONVERT_TO_SMART_SHEET_GROUP:"toolbar-convert-to-smart-sheet",INSERT_CHART:"insert-chart",INSERT_SPARKLINES:"insert-sparkline-charts",INSERT_SLICER:"insert-slicer",INSERT_SHAPE:"insert-shape",PRINT:"print",RELATE_FORM:"relate_form",INSERT_PIVOT_TABLE:"insert-pivot-table",CELL:"cell",INSERT_ROW_COL_IN_INSERT_TOOLBAR:"insert-row-col-in-insert-toolbar",INSERT_LINK:"insert-link",INSERT_LOCATION:"insert-location",INSERT_CELL_IMG:"insert-cell-img",INSERT_CELL_IMG_IN_CLIENT:"insert-cell-img-in-client",INSERT_CELL_IMG_FROM_LOCAL:"insert-cell-img-from-local",INSERT_CELL_IMG_FROM_DRIVE:"insert-cell-img-from-drive",INSERT_CELL_IMG_SINGLE:"insert-cell-img-single",INSERT_FLOAT_IMG:"insert-float-img",INSERT_FLOAT_IMG_IN_CLIENT:"insert-float-img-in-client",INSERT_DOCLINK:"insert-docLink",INSERT_DOC:"insert-doc-wecom",INSERT_ATTACHMENT:"insert-attachment",INSERT_COMMENT:"insert-comment",CONDITION_FORMAT:"condition-format",OTHER_CONDITION_FORMAT:"other-condition-format",MANAGE_CONDITION_FORMAT:"manage-condition-format",HIGHLIGHT_REPEAT:"highlight-repeat",HIGHLIGHT_EMPTY:"highlight-empty",HIGHLIGHT_CELLS:"highlight-cells",FIRST_LAST_AVERAGE:"first-last-average",CUSTOM_EXPRESSION:"custom-expression",COLOR_SCALE:"color-scale",DATA_BAR:"data-bar",ICON_SET:"icon-set",CLEAN_FORMART:"clean-formart",TEXT_TO_COLUMNS:"text-to-columns",GROUP:"group",SET_COL_COMBINATION:"set-col-combination",AI_FORMULA:"ai-formula",AI_FUNCTION:"ai-function",IMPORT_FILE_FORMULA:"import-range-formula",DATA_VALIDATION_EDIT:"data-validation-edit",DATA_VALIDATION_SELECT:"data-validation_select",DATA_VALIDATION_CHECKBOX:"data-validation_checkbox",EDIT_HISTORY:"edit-history",HIGHLIGHT_SELECTION:"highlight-selection",VIEW_SCALE:"view-scale",GRID_LINE:"grid-line",CREATE_CUSTOM_SHEET_VIEW:"create-custom-sheet-view",TOGGLE_CUSTOM_SHEET_VIEW:"toggle-custom-sheet-view",TOOL_BOX_GROUP:"quick-toolbox-double",TOOLBOX_DUPLICATE:"toolbox-duplicate",TOOLBOX_BATCH_CLEAR:"toolbox-batch-clear",TOOLBOX_ID_UTILS:"toolbox-id-utils",TOOLBOX_CELL_HANDING:"toolbox-cell-handing",TOOLBOX_MULTIPED_IMAGE:"toolbox-multiped\u2014image",TOOLBOX_CATALOGUE_CREATORE:"toolbox-catalogue-creatore",INSERT_IMAGE:"insert-image",WATERMARK:"toolbar-watermark",CALCULATE_OPTION:"calculateOption",SHEET_AI:"sheet-ai",CELL_EDIT_HISTORY:"cell-edit-history",TABLE_STYLE_HEADER_ROW:"table-style-header-row",TABLE_STYLE_HEADER_COL:"table-style-header-col",TABLE_STYLE_OUTER_LINES:"table-style-outer-lines",TABLE_STYLE_INCLUDE_FILTER:"table-style-include-filter",TABLE_STYLE_ADD_CUSTOM:"table-style-add-custom",TABLE_STYLE_EDIT_TABLE:"table-style-edit-table",TABLE_STYLE_CLEAR:"table-style-clear",TABLE_STYLE_TRANSFORM_NORMAL_AREA:"table-style-transform-normal-area",TABLE_STYLE_STYLES:"table-style-styles",INSERT_QQ_GROUP_CARD:"insert-qq-group-card",INSERT_MULTI_IMAGES:"insert-multi-images",NAMED_CELL_STYLE:"named-cell-style",NAME_MANAGER:"name-manager",NAME_MANAGER_QUICK_CREATE:"name-manager-quick-create",TDOCS_SCRIPT_EDITOR:"tdocs-script-editor",PIC_TO_SHEET:"pic-to-sheet",PIC_TO_SHEET_MOBILE:"pic-to-sheet-mobile",PIC_TO_SHEET_PC:"pic-to-sheet-pc",PIC_TO_SHEET_PRODUCTIVITY:"pic-to-sheet-productivity",PIC_TO_SHEET_MOBILE_PRODUCTIVITY:"pic-to-sheet-mobile-productivity",PIC_TO_SHEET_PC_PRODUCTIVITY:"pic-to-sheet-pc-productivity",SUBSCRIBE_RANGE:"subscribe-range",VIP_FEATURE:"vip_feature",IMG_TO_WORD:"img-to-word",IMG_TO_EXCEL:"img-to-excel",MORE_VIP_FUNCTION:"more-vip-function",VIP_TEMPLATE:"vip-template",VIP_BACKGROUND:"vip-background",VIP_CURSOR:"vip-cursor",VIP_MORE_TEMPLATE:"vip-more-template",VIP_CUSTOM_DRAWER:"vip_custom_drawer",PRIVATE_FILL:"private-fill",VIP_MODE:"vip-mode",PIVOT_TABLE_NAME:"pivot-table-name",PIVOT_TABLE_ACTIVE_FIELD:"pivot-table-active-field",PIVOT_TABLE_FIELD_SETTING:"pivot-table-field-setting",PIVOT_TABLE_FIELD_COLLAPSE:"pivot-table-field-collapse",PIVOT_TABLE_FIELD_EXPAND:"pivot-table-field-expand",PIVOT_TABLE_DATA_SOURCE:"pivot-table-data-source",PIVOT_TABLE_CLEAR:"pivot-table-clear",PIVOT_TABLE_SELECT:"pivot-table-select",PIVOT_TABLE_MOVE:"pivot-table-move",PIVOT_TABLE_DELETE:"pivot-table-delete",PIVOT_TABLE_ITEM_SETTING:"pivot-table-item-setting",PIVOT_TABLE_COLLAPSE_BUTTON:"pivot-table-collapse-botton",PIVOT_TABLE_FIELD_HEADER:"pivot-table-field-header",FILE_COMPERSSION:"file-comperssion",EXPORT_TO_PDF_ENT:"export-to-pdf",EXPORT_TO_PDF_GROUP:"export-to-pdf-group",INSERT_STAFF_CARD:"insert-staff-card",INSERT_GROUP_CARD:"insert-group-card",SCHEDULE:"schedule",MEETING:"meeting",ENT_INSERT_FILE:"insert-file",INSERT_TODO:"insert-todo",INSERT_DATE_REMINDER:"insert-date-reminder",INSERT_APPLICATION:"insert-application",CONVERT_TO_SMART_SHEET_PREVIEW:"toolbar-convert-to-smart-sheet-preview",IMPORT_SHEET:"import-sheet"};n.UNDO,n.REDO,n.INSERT,n.FILTER,n.FIND_REPLACE,n.FONT_FAMILY,n.FONT_SIZE,n.BOLD,n.FONT_COLOR,n.UNDERLINE,n.ITALIC,n.STRIKETHROUGH,n.FORMULA,n.REDO,n.UNDO}}]);
//# sourceMappingURL=initial_core_2.ffe9eb32c9c6d003.js.map