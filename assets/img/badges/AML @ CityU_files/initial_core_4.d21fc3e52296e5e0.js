"use strict";(self.webpackChunksheet=self.webpackChunksheet||[]).push([["90146"],{702235:function(){},385861:function(e,t,n){n.d(t,{Az:function(){return I},ZP:function(){return w},go:function(){return S}});var r=n(434902),i=n(758699),o=n(209787);n(738355);var a=n(730635),s=n(800152),c=n(339326),l=n(450586),u=n(291698),h=n(107535),_=n(563411),A=n(393743),d=n(45865),f=n(575145),E=n(115089),g=n(328432),R=n(988495),C=n(804875),T=n(470484),p=n(524112),v=n(245887),m=n(899504),S=e=>{if("firstData"in e)return e.firstData??[];if("chunkData"in e)return e.chunkData??[];throw Error("\u5206\u7247\u6570\u636E\u4E2D\u6CA1\u6709 commands \u6570\u636E")},w=function(){function e(e,t){this._Fc=e,this._AVn=t,this._AcJ=new _.Q,this.getBaseVersion=()=>{var e=this._Fc.messageCenterAdapter?.getCurrentVersion()??E.q.getConfig("rev");return n.g.log?.info(A.w.DataFlow,"DataCenterMiddleware getBaseVersion",e),e},this._Ack=(e,t)=>(0,r._)(function*(){yield e.service._cWD("onComplete",e),t()}),this._ALM=()=>{this._ALm=+new Date,n.g.openDocXhr&&n.g.openDocResponseText?l.ZP.tdwReport({opername:"excel_performance",module:"start",action:v.m.SERVER_LOADER_OPEN_DOC_INLINE_DATA}):n.g.openDocXhr||l.ZP.tdwReport({opername:"excel_performance",module:"start",action:v.m.SERVER_LOADER_FETCH_OPEN_DOC})},this._ALn=()=>{if(this._ALm){var e=+new Date;l.ZP.tdwReport({opername:"excel_performance",module:"start",action:v.m.SERVER_LOADER_OPEN_DOC_INLINE_NOT_DATA,ver5:e-this._ALm}),this._ALm=void 0}}}var t=e.prototype;return t.beforeLoadData=function(e){var t=this;return(0,r._)(function*(){yield t._Acn();var{options:i}=e.request;return Object.assign(i,{fetchMode:c.G5.SEND_AFTER_PENDED,cellAmount:i.chunkLen?void 0:g.Fw,getDefaultSpreadConfig:()=>E.q,appConfigInstance:(0,d.z)(),openDocConfig:{openDocType:n.g.openDocType,openDocXhr:n.g.openDocXhr,openDocResponseText:n.g.openDocResponseText},isBlockMode:!1}),yield new Promise((0,r._)(function*(r,i){if(n.g.log?.info(A.w.DataFlow,"DataCenterMiddleware \u6570\u636E\u52A0\u8F7D\u5F00\u59CB"),"loadDocument"===e.request.type){if(e.request.options.secretId===p.Lf){var{clientVars:o,documentData:a}=(0,C.J)();yield t._AcK(e,o,E.q),yield t._Acl(e,a,r,i);return}t._ALM(),t.dataCenter.loadDocumentData({...e.request.options,secretId:e.request.options.secretId??location.pathname.split("/").pop(),onClientVars:t._AcK.bind(t,e),onFirstSuccess:n=>t._Acl(e,n,r,i),onChunkSuccess:n=>t._AcL(e,n,r,i),onFail:e=>t._AcM(e.error,i),onBeforeLoadChunk:n=>t._Acm(e,n),isChunkMode:(0,T.x7)(),isBlockMode:!1})}else t.dataCenter.loadSheetData({...e.request.options,sheetId:e.request.options.sheetId,onFirstSuccess:n=>t._Acl(e,n,r,i),onChunkSuccess:n=>t._AcL(e,n,r,i),onFail:e=>t._AcM(e.error,i),onBeforeLoadChunk:n=>t._Acm(e,n),isChunkMode:(0,T.x7)(),isBlockMode:!1})}))})()},t.loopFetchVersionData=function(e){return this.dataCenter.loopFetchVersionData({...e,onSuccess:t=>{this.loadSheetStatus.hasFetching()||(e.onSuccess?.(t),this._AcJ.fire(t.data.rev))}})},t.getRowColCountBySheetId=function(e){return{rowCount:0,colCount:0}},t._cWe=function(){return(0,r._)(function*(){})()},t._AcK=function(e,t,i){return(0,r._)(function*(){n.g.log?.info(A.w.DataFlow,"DataCenterMiddleware \u6536\u5230 clientVars",{clientVars:t,spreadConfig:i});var r={...t,...{collab_client_vars:{...t.collab_client_vars,initialAttributedText:{text:[],attribs:""}}}};(0,f.f)(r),e.response={clientVars:r,spreadConfig:i,isSuccess:!0},yield e.service._cWD("onClientVars",e,r,i)})()},t._Acl=function(e,t,i,o){var a=this;return(0,r._)(function*(){n.g.log?.info(A.w.DataFlow,"DataCenterMiddleware \u6536\u5230\u9996\u7247\u6570\u636E"),e.response||(e.response={});var r=e.response;return t.error||"isSuccess"in t&&!t.isSuccess||!t?void o(t.error):(r.isSuccess=!0,r.firstChunk=t,yield e.service._cWD("onFirstSuccess",e,t),t.isLastChunk)?void(yield a._Ack(e,i)()):void(!e.scheduler&&(e.scheduler=new R.Z(t)),Object.defineProperty(e,"scheduler",{value:e.scheduler,writable:!1}))})()},t._AcL=function(e,t,n,i){var o=this;return(0,r._)(function*(){var a=!t.error&&(!("isSuccess"in t)||!!t.isSuccess);if(e.response?.isSuccess!==!1){if(!a)return void i(t.error);var c=e.response?.firstChunk?.loader?.name===s.Zq.OFFLINE;c&&l.ZP.tdwReport({opername:"doc_excel_editor",module:"offline",action:"offline_open_doc"});var u=o._Ack(e,n);if(!t.chunkData?.length&&!c)return void(yield u());e.scheduler._caZ(t,(0,r._)(function*(){e.response?.isSuccess!==!1&&(yield e.service._cWD("onChunkSuccess",e,t))}),u)}})()},t._Acm=function(e,t){return(0,r._)(function*(){e.response?.isSuccess!==!1&&(yield e.service._cWD("onBeforeLoadChunk",e,t))})()},t._AcM=function(e,t){return(0,r._)(function*(){t({...e||{},isDataCenterError:!0})})()},t._Acn=function(){var e=this;return(0,r._)(function*(){if(!e.dataCenter){n.g.log?.info(A.w.DataFlow,"DataCenterMiddleware \u5F00\u59CB\u521D\u59CB\u5316 OfflineAPI");var t=yield e._cWe();n.g.log?.info(A.w.DataFlow,"DataCenterMiddleware \u521D\u59CB\u5316 OfflineAPI \u5B8C\u6210"),e.dataCenter=new s.ur(e.getBaseVersion,n.g.log,e.getRowColCountBySheetId,t),n.g.log?.info(A.w.DataFlow,"DataCenterMiddleware \u521D\u59CB\u5316 DataCenter \u5B8C\u6210")}})()},(0,i._)(e,[{key:"onDataVersionChange",get:function(){return this._AcJ.event}},{key:"loadSheetStatus",get:function(){return this._AVn.loadSheetStatus}}]),e}();w=(0,o.__decorate)([(0,o.__param)(0,u.P),(0,o.__param)(1,m.b),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===u.P?Object:u.P,void 0===m.b?Object:m.b])],w);var I=(0,a.y)("DataCenterMiddleware");(0,h.dR)(I,w)},50130:function(e,t,n){n.d(t,{Q:function(){return h}});var r=n(434902),i=n(209787),o=n(730635),a=n(107535),s=n(823676),c=n(341176),l=n(477067),u=function(){function e(e){this._Zn=e,this.emitter=new s.Z}var t=e.prototype;return t.beforeLoadData=function(e){var t=this;return(0,r._)(function*(){t.emitter.emit("beforeLoadData",e)})()},t.onClientVars=function(e,t,n){var i=this;return(0,r._)(function*(){i.emitter.emit("onClientVars",e,t,n);var r=(0,c.G)(e);yield e.request.options.onClientVars?.(r,t,n)})()},t.onFirstSuccess=function(e,t){var n=this;return(0,r._)(function*(){n.emitter.emit("onFirstSuccess",e,t);var r=(0,c.G)(e);yield e.request.options.onFirstSuccess?.(r,t),n._Zn.onChunkLoaded(r)})()},t.onChunkSuccess=function(e,t){var n=this;return(0,r._)(function*(){n.emitter.emit("onChunkSuccess",e,t);var r=(0,c.G)(e);yield e.request.options.onChunkSuccess?.(r,t),n._Zn.onChunkLoaded(r)})()},t.onComplete=function(e){var t=this;return(0,r._)(function*(){t.emitter.emit("onComplete",e);var n=(0,c.G)(e),r=(0,c._)(e);yield e.request.options.onComplete?.(n,r)})()},t.onFail=function(e,t){var n=this;return(0,r._)(function*(){n.emitter.emit("onFail",e,t),yield e.request.options.onFail?.(t)})()},e}();u=(0,i.__decorate)([(0,i.__param)(0,l.UY),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[void 0===l.UY?Object:l.UY])],u);var h=(0,o.y)("EventCallbacksMiddleware");(0,a.dR)(h,u)},839101:function(e,t,n){n.d(t,{h:function(){return _}});var r=n(434902),i=n(209787),o=n(730635),a=n(509234),s=n(107535),c=n(393743),l=n(311759),u=n(341176),h=function(){function e(e,t){this._Fc=e,this._FT=t}var t=e.prototype;return t.onFirstSuccess=function(e,t){var n=this;return(0,r._)(function*(){yield n._Zp(e,t,!0)})()},t.onChunkSuccess=function(e,t){var n=this;return(0,r._)(function*(){yield n._Zp(e,t,!1)})()},t._Zp=function(e,t,i){var o=this;return(0,r._)(function*(){var r=(0,u.G)(e),a=o._Fc.containerModel.sheetListManager.getSheetBySheetId(r);if(!a)return void n.g.log?.error(c.w.DataFlow,"ExternalSheetApplyMiddleware \u5B50\u8868\u7684\u6CE8\u518C\u4FE1\u606F\u4E0D\u5B58\u5728\uFF01",r);var{sheetType:s}=a;if("loadDocument"===e.request.type&&i&&o._Fc.viewManager.hiddenOtherContainer(s),(0,l.G)(s)){n.g.log?.info(c.w.DataFlow,"ExternalSheetApplyMiddleware \u5E94\u7528\u6570\u636E\u5230\u5916\u90E8\u5B50\u8868\u5F00\u59CB",{sheetId:r,sheetType:s});var h=yield o._FT.getAdapterBySheetType(s);if(!h)return void n.g.log?.error(c.w.DataFlow,"ExternalSheetApplyMiddleware \u9996\u8868\u5BF9\u5E94\u7684 adapter \u672A\u6CE8\u518C\uFF01",s);h.handleSheetData(r,t),n.g.log?.info(c.w.DataFlow,"ExternalSheetApplyMiddleware \u5E94\u7528\u6570\u636E\u5230\u5916\u90E8\u5B50\u8868\u5B8C\u6210",{sheetId:r,sheetType:s})}})()},e}();h=(0,i.__decorate)([(0,i.__param)(0,a.PH),(0,i.__param)(1,a.y9),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[void 0===a.PH?Object:a.PH,void 0===a.y9?Object:a.y9])],h);var _=(0,o.y)("ExternalSheetApplyMiddleware");(0,s.dR)(_,h)},899504:function(e,t,n){n.d(t,{b:function(){return g}});var r=n(434902),i=n(209787),o=n(730635),a=n(291698),s=n(393743),c=n(107535),l=n(341176),u=n(477067),h=n(524112),_=n(510981),A=n(800152),d=n(976037),f=n(149344),E=function(){function e(e,t){this._AcN="",this._Fc=e,this._Zn=t,this._AkV=new Map,this._ALc=new Map,this._Aco=e=>{(!n.g.isPreOpenContainer||n.g.inPreloadModeReplacement)&&(this._Fc.containerStatus.statusSetter.activeTempStatus(!1),this._AcN=e)},this._AcO=()=>{(!n.g.isPreOpenContainer||n.g.inPreloadModeReplacement)&&(this._Fc.containerStatus.statusSetter.unactiveTempStatus(),this._AcN="")},this._ALe=()=>{var{dataCenter:e}=this._Fc.dataFlowController,{loadersStore:t}=e.loaderManager,n=t.get(A.Zq.NATIVE_CHUNK);return!!n&&n._cAO()},this._ALE=e=>{this._Zn.getIsLoaded(e)&&this._ALe()&&this._AcO()},d.ZP.localEdit.one(f.W1.LOCAL_EDIT_LOAD_CHUNK_DATA_END,()=>{this._ALE(this._Fc.containerModel.activeSheetId)})}var t=e.prototype;return t.beforeLoadData=function(e){var t=this;return(0,r._)(function*(){var{options:r}=e.request,{sheetId:i}=r;if(i){if((0,h.$0)()&&t._AcN&&t._AcN!==i&&r.shouldSwitchActiveSheet&&t._ALE(i),e.loadStartTime=+new Date,(t._Zn.getIsLoaded(i)||t._Zn.getIsFetching(i))&&"loadSheet"===e.request.type&&r.shouldSwitchActiveSheet){t._Fc.containerModel.setActiveSheetId(i);var o=(0,h.XK)(window.location.href,{tab:i});o!==window.location.href&&window.history.replaceState(i,"",o)}var{requiredBlockRanges:a}=r;if(t._Zn.getIsLoaded(i))return n.g.log?.info(s.w.DataFlow,"LoadStatusMiddleware \u5B50\u8868\u5DF2\u52A0\u8F7D\u8FC7",i),yield r.onFirstSuccess?.(i),yield r.onRequiredRowRangesLoaded?.(i),yield r.onComplete?.(i),{stop:!0};if(t._Zn.getIsFetching(i)){(0,h.$0)()&&i===t._Fc.containerModel.activeSheetId&&t._Aco(i),n.g.log?.info(s.w.DataFlow,"LoadStatusMiddleware \u5B50\u8868\u5DF2\u5728\u52A0\u8F7D",i),yield r.onFirstSuccess?.(i);var c=t._ALK(i),l=t._ALl(i);return c.add(e.request.options.onComplete),l.add(e.request.options.onFail),t._Zn.onSheetFinishLoading(i,()=>r.onComplete?.(i)),r.onRequiredRowRangesLoaded&&a&&(t._Zn.addLoadRequest(i,{requiredBlockRanges:a,onRequiredRowRangesLoaded:r.onRequiredRowRangesLoaded}),t._Zn.onChunkLoaded(i)),{stop:!0}}n.g.log?.info(s.w.DataFlow,"LoadStatusMiddleware \u5F00\u59CB\u52A0\u8F7D\u5B50\u8868",i),t._Zn.startLoading(i),r.onRequiredRowRangesLoaded&&a&&t._Zn.addLoadRequest(i,{requiredBlockRanges:a,onRequiredRowRangesLoaded:r.onRequiredRowRangesLoaded})}})()},t.onFirstSuccess=function(e){var t=this;return(0,r._)(function*(){var r=(0,l.G)(e);"loadSheet"===e.request.type&&e.request.options.shouldSwitchActiveSheet&&t._Fc.containerModel.setActiveSheetId(r),(0,h.$0)()&&(r===t._Fc.containerModel.activeSheetId||"loadDocument"===e.request.type)&&t._Aco(r),t._Acp(e),n.g.log?.info(s.w.DataFlow,"LoadStatusMiddleware \u9996\u7247\u52A0\u8F7D\u5B8C\u6210",r),t._Zn.startLoading(r)})()},t.onComplete=function(e){var t=this;return(0,r._)(function*(){var r=(0,l.G)(e),i=n.g.performance?.timeOrigin||n.g.performance?.timing?.navigationStart||+new Date,o="loadDocument"===e.request.type?i:e.loadStartTime;_.xt._cOF({type:_.c1.LoadChunk,startTime:o,endTime:+new Date}),t._Acp(e),n.g.log?.info(s.w.DataFlow,"LoadStatusMiddleware \u6240\u6709\u5206\u7247\u52A0\u8F7D\u5B8C\u6210",r),t._Zn.finishLoading(r),t._AkV.get(r)?.forEach(e=>e?.(r)),t._AkV.delete(r),(0,h.$0)()&&t._ALE(t._Fc.containerModel.activeSheetId)})()},t.onFail=function(e,t){var i=this;return(0,r._)(function*(){var r=(0,l.G)(e);i._Acp(e),n.g.log?.info(s.w.DataFlow,"LoadStatusMiddleware \u4E2D\u6B62\u52A0\u8F7D\u5B50\u8868",r),i._Zn.stopLoading(r),i._ALc.get(r)?.forEach(e=>e?.(t)),i._ALc.delete(r)})()},t._Acp=function(e){var t=e.request.options.sheetId,n=(0,l.G)(e);t&&t!==n&&this._Zn.stopLoading(t)},t._ALK=function(e){var t=this._AkV.get(e);if(t)return t;var n=new Set;return this._AkV.set(e,n),n},t._ALl=function(e){var t=this._ALc.get(e);if(t)return t;var n=new Set;return this._ALc.set(e,n),n},e}();E=(0,i.__decorate)([(0,i.__param)(0,a.P),(0,i.__param)(1,u.UY),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[void 0===a.P?Object:a.P,void 0===u.UY?Object:u.UY])],E);var g=(0,o.y)("LoadStatusMiddleware");(0,c.dR)(g,E)},229704:function(e,t,n){n.d(t,{E:function(){return R}});var r=n(434902),i=n(209787);n(738355);var o=n(730635),a=n(291698),s=n(107535),c=n(963248),l=n(393743),u=n(311792),h=n(115089),_=n(510981),A=n(800152),d=n(470484),f=n(341176);n(916140);var E=n(668705),g=function(){function e(e,t){this._Fc=e,this._FQ=t}var t=e.prototype;return t.onFirstSuccess=function(e,t){var i=this;return(0,r._)(function*(){if(e.response?.firstChunk?.loader?.name===A.Zq.NATIVE_CHUNK&&(0,d._c)(!0),(0,d.x7)()&&"loadDocument"===e.request.type&&(i._Fc.containerStatus.statusSetter.activeTempStatus(!1),i._Fc.messageCenterAdapter?.pause()),"loadDocument"===e.request.type&&t.firstData||(0,d.Ly)()){if(!e.response.spreadConfig&&!(0,d.Ly)())throw n.g.log?.error(l.w.DataFlow,"WorkbookApplyMiddleware spreadConfig \u4E3A\u7A7A"),Error("spreadConfig \u4E3A\u7A7A");_.xt._cOF({type:_.c1.FSChunkLoad,startTime:window.performance?.timeOrigin||window.performance?.timing?.navigationStart||+new Date,endTime:+new Date});var r=(0,f.G)(e);n.g.log?.info(l.w.DataFlow,"WorkbookApplyMiddleware applyWorkbookToSdk \u6267\u884C\u5F00\u59CB");try{i.applyWorkbookToSdk(e,r,t)}catch(e){throw n.g.log?.error(l.w.DataFlow,"WorkbookApplyMiddleware applyWorkbookToSdk \u6267\u884C\u5931\u8D25",e),n.g.tencentDocReport?.cube?.wdocs?.({module:"data-flow",action:"applyWorkbookToSdkError",opername:"applyWorkbookToSdk",str1:e?.message||""},!0),(0,E.c)("apply_first_data"),e}n.g.log?.info(l.w.DataFlow,"WorkbookApplyMiddleware applyWorkbookToSdk \u6267\u884C\u5B8C\u6210")}})()},t.onChunkSuccess=function(e,t){var n=this;return(0,r._)(function*(){if((0,d.Ly)()){var{workbook:e}=t.chunkData?.[0]||{};e&&n._FQ.applyWorkbook({workbookData:e,activeSheetId:t.sheetId,isCompressed:!t.noCompress,baseVersion:h.q.getConfig("rev"),notSetActiveSheet:!0})}})()},t.applyWorkbookToSdk=function(e,t,r){var i,o,a=h.q.getConfig("dver"),s=n.g.__globalCodeVersion;if(this._Acq(a,s)){n.g.performanceData&&(n.g.performanceData.dataStart=+new Date);var c=r.firstData?.[0]||r.chunkData?.[0];if(!c?.workbook)return void n.g.log?.warn(l.w.DataFlow,"WorkbookApplyMiddleware \u6CA1\u6709 Workbook \u6570\u636E\uFF0C\u8DF3\u8FC7 SDK \u7684 Workbook \u521D\u59CB\u5316");var u=e.response?.firstChunk?.loader?.name==="OFFLINE"&&this._FQ.getOtherWorkbookByAcceptedData&&this._FQ.mergeWorkbook;u&&(i=this._FQ.getOtherWorkbookByAcceptedData?.(c.acceptedData)||[],o=this._FQ.mergeWorkbook?.(i,c.workbook,!r.noCompress)||""),"loadDocument"===e.request.type&&(n.g.log?.info(l.w.DataFlow,"WorkbookApplyMiddleware \u5F00\u59CB\u6267\u884C SDK \u7684 Workbook \u521D\u59CB\u5316"),this._Fc.containerModel.setActiveSheetId(t)),this._FQ.applyWorkbook({workbookData:u?o:c.workbook,activeSheetId:t,isCompressed:!r.noCompress,baseVersion:h.q.getConfig("rev"),isOfflineOpen:e.response?.firstChunk?.loader?.name==="OFFLINE",isFirstChunk:!0,notSetActiveSheet:"loadDocument"!==e.request.type}),"loadDocument"===e.request.type&&this._Fc.containerStatus.statusSetter.updateWorkbookStatus(),this._FQ.isBigDataMode?.()&&this._Fc.containerStatus.statusSetter.activeBigDataStatus(),"loadDocument"===e.request.type&&n.g.performanceData&&(n.g.performanceData.dataEnd=+new Date)}},t._Acq=function(e,t){if(!n.g.isContainer)return!0;var r=this._Fc.documentManager?.notifyNativeSingleDocVersionMap(new URL(location.href).pathname.split("/").pop()||"",e);return!!(0,u.bG)(e,t)||(n.g.log?.error(l.w.DataFlow,"WorkbookApplyMiddleware FATAL: dver \u4E0E\u4EE3\u7801\u7248\u672C\u4E0D\u4E00\u81F4\uFF01",e,t),r?.then(()=>n.g.location.reload()),!1)},e}();g=(0,i.__decorate)([(0,i.__param)(0,a.P),(0,i.__param)(1,c.O),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[void 0===a.P?Object:a.P,void 0===c.O?Object:c.O])],g);var R=(0,o.y)("WorkbookApplyMiddleware");(0,s.dR)(R,g)},51122:function(e,t,n){n.d(t,{m:function(){return r}});var r=(0,n(730635).y)("ISpreadsheetApp")},972973:function(e,t,n){var r=n(758699),i=n(209787),o=n(976037),a=n(518215),s=n(673798),c=n(149344),l=function(){function e(e,t){this.workbook=e,this.mutationApi=t,this.event=o.ZP}var t=e.prototype;return t.initEmitter=function(e){this.emitter=e},t.initMessageCenterService=function(e){this.messageCenterService=e},t.initSheetStatus=function(e){this.sheetStatus=e},t.initExternalDataController=function(e){this._CgX=e},t.initCalculateApi=function(e){this.calculateApi=e},t.initLogin=function(e){this.login=e},t.initDataCenterService=function(e){this.dataCenterService=e},t.initUndoRedoService=function(e){this.undoRedoService=e},t.initBigDataService=function(e){this.bigDataService=e},t.initBehaviorApi=function(e){this.behaviorApi=e},t.initSheetApi=function(e){this.sheetApiLoader=e},t.initView=function(e){this.view=e,e.onAfterFirstRender(()=>{o.ZP.init.trigger(c.W1.AFTER_FIRST_RENDER)}),e.onAfterSwitchSheetFirstRender(()=>{o.ZP.init.trigger(c.W1.AFTER_SWITCH_SHEET_FIRST_RENDER)}),this.emitter?.on(this.EVENT.NEW_DOC_SPREAD_SHEET_PART_INTERACTIVE,e=>{this.view.render(e,void 0)})},t.initAppConfigInstance=function(e){this.appConfigInstance=e},t.initOfflineOpenService=function(e){this.offlineOpenService=e},t.initOfflineEditService=function(e){this.offlineEditService=e},t.initLocalEditCommitService=function(e){this.localEditCommitService=e},t.initCommitService=function(e){this.commitService=e},(0,r._)(e,[{key:"EVENT",get:function(){return e.EVENT}}]),e}();l.EVENT=s.q,t.Z=(0,i.__decorate)([(0,i.__param)(0,a.lc),(0,i.__param)(1,a.PR),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[void 0===a.lc?Object:a.lc,void 0===a.PR?Object:a.PR])],l)},673798:function(e,t,n){n.d(t,{q:function(){return r}});var r={CORE_BEHAVIOR_API_INITED:"CORE_BEHAVIOR_API_INITED",BEHAVIOR_API_INITED:"BEHAVIOR_API_INITED",PAGE_LOAD_START:"PAGE_LOAD_START",SPREAD_SHEET_SDK_CORE_START:"SPREAD_SHEET_SDK_CORE_START",SPREAD_SHEET_SDK_CORE_END:"SPREAD_SHEET_SDK_CORE_END",SPREAD_SHEET_PART_INTERACTIVE_START:"SPREAD_SHEET_PART_INTERACTIVE_START",SPREAD_SHEET_PART_INTERACTIVE_END:"SPREAD_SHEET_PART_INTERACTIVE_END",SPREAD_SHEET_MESSAGE_END:"SPREAD_SHEET_MESSAGE_END",SPREAD_SHEET_ALL_CHUNK_READY:"SPREAD_SHEET_ALL_CHUNK_READY",SPREAD_SHEET_EDITABLE:"SPREAD_SHEET_EDITABLE",WORKBENCH_FEATURE_LOADED:"WORKBENCH_FEATURE_LOADED",SPREAD_SHEET_PLUGINS_START:"SPREAD_SHEET_PLUGINS_START",SPREAD_SHEET_PLUGINS_END:"SPREAD_SHEET_PLUGINS_END",PAGE_LOAD_FINISHED:"PAGE_LOAD_FINISHED",NEW_DOC_SPREAD_SHEET_PART_INTERACTIVE:"NEW_DOC_SPREAD_SHEET_PART_INTERACTIVE",DESTROY:"DESTROY",RESTART:"RESTART",START_DESTROY:"START_DESTROY",RESTART_END:"RESTART_END",START_LOAD_DATA:"START_LOAD_DATA",AFTER_LOAD_DATA:"AFTER_LOAD_DATA",SYNC_OFFLINE_DATA_FINISHED:"SYNC_OFFLINE_DATA_FINISHED",AFTER_CLIENTVARS:"AFTER_CLIENTVARS",SPREAD_SHEET_APPLY_WORKBOOK:"SPREAD_SHEET_APPLY_WORKBOOK"}},659912:function(e,t,n){n.d(t,{DA:function(){return d},p5:function(){return f},qn:function(){return A}});var r=n(434902),i=n(307456),o=n(976037),a=n(149344),s=n(318783),c=n(148156),l=n(181342),u=n(48407),h=n(470484),_=[u.D.SetSingleValue,u.D.PasteData,u.D.SetLink];function A(e,t){return!!t&&_.includes(t)&&e&&!(0,h.C1)()}function d(e){return!(0,i.Z)(e)&&(0,s.qh)()}function f(e){return E.apply(this,arguments)}function E(){return(E=(0,r._)(function*(e){e&&c.Ni.invokeFunction((0,r._)(function*(t){var n=t.get(l.D),r=yield n.getInstance();r.init(),o.ZP.titleEvent.trigger(a.W1.TITLE_AUTO_CHANGE),r.setTitle(e)}))})).apply(this,arguments)}},801989:function(e,t,n){n.d(t,{Es:function(){return A},hX:function(){return a}});var r=n(758699);n(575739),n(738355);var i=n(45865),o={MARK:"mark",LIFE_CYCLE:"lifeCycle",RESOURCE:"resource",CGI:"cgi",IMG:"img",MEASURE:"measure"},a={LCP:"LCP",TTI:"TTI",TTE:"TTE",HTML:"html",OPEN_DOC:"opendoc",PAGE_LOAD_FINISHED:"PAGE_LOAD_FINISHED",ENTRY_START:"entryStart"},s={xmlhttprequest:o.CGI,img:o.IMG,script:o.RESOURCE,link:o.RESOURCE},c=i.Z.getConfig("runtime.domainName"),l=[c],u={low:0,high:1},h=[{name:`//${c}/dop-api/opendoc`,alias:"opendoc",weight:u.high}],_=function(){function e(e,t,n,r,i){this.name=e,this.entryType=t,this.startTime=n,this.duration=r,this.alias=i?.alias??this._NT(e),this.weight=i?.weight??u.low,this.decodedBodySize=i?.decodedBodySize,this.encodedBodySize=i?.encodedBodySize,this.transferSize=i?.transferSize}var t=e.prototype;return t._CBk=function(e){this.duration=e-this.startTime},t.toJSON=function(){return{name:this.name??this.alias,alias:this.alias??this.name,entryType:this.entryType,startTime:this.startTime,endTime:this.startTime+this.duration,duration:this.duration,weight:this.weight,decodedBodySize:this.decodedBodySize??0,encodedBodySize:this.encodedBodySize??0,transferSize:this.transferSize??0}},t._NT=function(e){var t=e;switch(this.entryType){case o.RESOURCE:var n=e.lastIndexOf("/");n>0&&(t=e.substring(n+1)),t=this._Nu(t);break;case o.CGI:var r=e.lastIndexOf("?");r>0&&(t=e.substring(0,r));break;case o.IMG:var i=e.lastIndexOf("?");i>0&&(t=e.substring(0,i))}return t},t._Nu=function(e){var t=e.split("~");if(e.length>50&&t.length>0){for(var n=t[t.length-1],r=t.length-2;r>=0&&!(n.length+t[r].length>50);r--)n=`${t[r]}~${n}`;return n}return e},(0,r._)(e,[{key:"endTime",get:function(){return this.startTime+this.duration}}]),e}(),A=function(){function e(){this._Nv=Object.keys(Object.getPrototypeOf(this._NX())).filter(e=>"toJSON"!==e),this._NU=[],this._NY()}var t=e.prototype;return t.getEntries=function(){return this._NU.sort((e,t)=>e.startTime-t.startTime)},t._CBl=function(e,t){return this.getEntries().filter(n=>(n.name===e||n.alias===e)&&(!t||n.entryType===t))},t._CBL=function(e,t){return this._CBl(e,t)?.[0]},t.getEntriesByType=function(e,t){return void 0===t&&(t=u.low),this.getEntries().filter(n=>n.entryType===e&&n.weight>=t)},t._CBK=function(e){return this.getEntriesByType(e)?.[0]},t.mark=function(e,t){if(!t||void 0!==t.startTime){this._Nz();var n=new _(e,t?.entryType??o.MARK,t?.startTime??this.now(),0);return this._NU=this._NU.filter(t=>t.name!==e),this._NU.push(n),n}},t._CBM=function(e,t){return this.mark(e,{startTime:t?.startTime??this.now(),entryType:o.LIFE_CYCLE})},t._CBn=function(){this._NV(o.MARK)},t.measure=function(e,t){if(!t||void 0!==t.startTime||void 0!==t.endTime){var n=this._NX().navigationStart,r=this.now(),{startTime:i,endTime:a,entryType:s,...c}=t??{},l=new _(e,s??o.MEASURE,i??n,(a??r)-(i??n),c);return this._NU.push(l),l}},t._CBN=function(e,t){var n=new _(e,o.MEASURE,t,0);return this._NU.push(n),n},t._CBo=function(e,t){var n=this._CBl(e,o.MEASURE);if(0===n.length)throw Error(`\u{4E0D}\u{5B58}\u{5728} name \u{4E3A}${e}\u{7684} entry\u{FF0C}\u{8BF7}\u{786E}\u{8BA4}\u{662F}\u{5426}\u{6709}\u{5148}\u{8C03}\u{7528} measureStart\u{3002}`);if(n.length>1)throw Error(`\u{5B58}\u{5728}\u{591A}\u{4E2A} name \u{4E3A}${e}\u{7684} entry\u{FF0C}\u{8BF7}\u{786E}\u{8BA4}\u{662F}\u{5426}\u{5BF9}\u{540C}\u{4E2A} name \u{591A}\u{6B21}\u{8C03}\u{7528} measureStart\u{3002}`);return n[0]._CBk(t),n},t._CBO=function(e){this._NV(o.MEASURE,e)},t.now=function(){return Date.now()},t.toJSON=function(){return{...this.timing,customEntries:this._NU}},t._CBp=function(){return this.timing.clickStart??this.timing.navigationStart},t._CBP=function(){var e=this._CBp(),t=this._Ny(a.LCP,e),r=this._Ny(a.TTI,e),i=this._Ny(a.TTE,e),o=this._CBl(a.HTML)[0],s=this._CBl(a.OPEN_DOC)[0],c=this._Ny(a.PAGE_LOAD_FINISHED,e),l=this._Ny(a.ENTRY_START,e);return{LCP:t-e,TTI:r-e,TTE:i-e,HTML:o?.endTime-o?.startTime,OPENDOC:s?.endTime-s?.startTime,PAGE_LOAD_FINISHED:c-e,ENTRY_START:l-e,WORKBOOK_REVISION_DESERIALIZE:n.g.performanceData.workbookRevisionDeserialize,WORKSHEET_REVISION_DESERIALIZE:n.g.performanceData.worksheetRevisionDeserialize}},t._CBq=function(){var{entryStart:e,PAGE_LOAD_FINISHED:t}=this.timing;return this.getEntries().filter(n=>n.startTime>=e&&n.startTime<=t).map(e=>e.toJSON())},t._CBQ=function(){var{entryStart:e,TTE:t}=this.timing;return this.getEntries().filter(n=>n.startTime>=e&&n.startTime<=t).map(e=>e.toJSON())},t._CBr=function(){var{entryStart:e,SPREAD_SHEET_EDITABLE:t}=this.timing;return this.getEntries().filter(n=>n.startTime>=e&&n.startTime<=t).map(e=>e.toJSON())},t._CBs=function(){var e=this.timing.TTE;return this.getEntries().filter(t=>t.startTime<=e).map(e=>e.toJSON())},t._CBS=function(){return this.getEntries().map(e=>e.toJSON())},t._CBm=function(){return this.getEntries().filter(e=>!this._Nx(e)).map(e=>e.toJSON())},t._NV=function(e,t){this._NU=this._NU.filter(n=>n.entryType!==e||!!t&&n.name!==t)},t._Nw=function(e){if(-1===[o.CGI,o.IMG].indexOf(s[e.initiatorType]))return!1;var t=new URL(e.name);return -1===l.indexOf(t.host)},t._NW=function(e){for(var t of h)if(0===e.name.indexOf(t.name))return{alias:t.alias??t.name,weight:t.weight};return{weight:u.low}},t._Nx=function(e){return e.weight!==u.low&&e.entryType===o.RESOURCE},t._NX=function(){return window.performance?.timing?window.performance.timing:{navigationStart:this.now()}},t._Ny=function(e,t){return this._CBL(e)?.startTime??t},t._NY=function(){window.performance&&window.performance.setResourceTimingBufferSize?.(2e3)},t._Nz=function(){this._NU.length>1e4&&this._NU.splice(0,this._NU.length-1e4)},(0,r._)(e,[{key:"timing",get:function(){var e=[o.MARK,o.LIFE_CYCLE],t=this.getEntries().filter(t=>e.includes(t.entryType)).reduce((e,t)=>({...e,[t.name]:t.startTime}),{});return{...this._Nv.reduce((e,t)=>{var n=this._NX()[t];return{...e,[t]:n}},{}),...t}}}]),e}()},749718:function(e,t,n){n.d(t,{F:function(){return s},O:function(){return a}});var r=n(27638),i=n(509234),o={};function a(e){var t=i.QI.invokeFunction(e=>e.get(i.PH)).containerModel.sheetListManager.getSheetBySheetId(e),a={allNum:0,dataNum:0,isLarge:0,rowCount:0,colCount:0,usedCol:0,usedRow:0};if(t?.sheetType!==r.Z.Grid)return o[e]=a,a;if(t){var{startRowIndex:s,startColIndex:c,endRowIndex:l,endColIndex:u,rowCount:h,colCount:_}=i.QI.invokeFunction(e=>e.get(i.y9)).getAdapterBySheetTypeSync(r.Z.Grid).getSheetProperties(t.sheetId),A=u-c+1,d=l-s+1;a.allNum=h*_,a.dataNum=A*d,a.rowCount=h,a.colCount=_,a.usedRow=d,a.usedCol=A,a.isLarge=+(a.allNum>=26e4)}return n.g.SpreadsheetAppInitComplete&&(o[e]=a),a}function s(e,t){return t||!o[e]?a(e):o[e]}},770460:function(e,t,n){var r=n(524112),i=n(976037),o=n(183873),a=window;t.Z={window:a,document:a.document,event:i.ZP,setHash:function(e){a.location.hash=e},getXsrf:o.f,getUrl:function(){return a.clientVars.shortLink},getQuery:r.IZ,resized:function(e){i.ZP.windowEvent.listen("resize",()=>{e()})},sheetNode:a.sheetNode,clientVars:a.clientVars,windowEvent:i.ZP.windowEvent,bodyEvent:i.ZP.bodyEvent,pad:a.pad,History:{replace:e=>{var t=a.location.href.split("?")[1],n="",{hash:r}=a.location;n=t&&(t=(t=t.split("&")).filter(e=>e.indexOf("tab=")<0&&e.indexOf("#")<0)).length?`?${t.join("&")}&tab=${e}`:`?tab=${e}`,r&&(n+=r),a.history.replaceState(e,"",n)},pop:e=>{i.ZP.windowEvent.listen("popState",e)}}}},311792:function(e,t,n){function r(e,t){for(var{rowData:r}=n.g.SpreadsheetApp.preview.previewsheet.sheets[e].data,i=!1,o=0;o<r.length;o++)if(r[o])for(var a=0;a<r[o].values.length;a++){var s=r[o].values[a];if(s){var{effectiveValue:c}=s;c?.value&&c.value}}}function i(e,t){var n=e.split("."),r=t.split(".");return n[0]===r[0]&&n[1]===r[1]}n.d(t,{NU:function(){return r},QU:function(){return o},U6:function(){return a},bG:function(){return i}}),n(115089),n(524112);var o="rangeAuthError",a="dataUpgrade"},535620:function(e,t,n){n.d(t,{H:function(){return i},p:function(){return o}});var r=n(730635),i=(0,r.y)("IBehaviorApi"),o=(0,r.y)("IBehavior")},376915:function(e,t,n){n.d(t,{BE:function(){return m},C6:function(){return g},I2:function(){return E},II:function(){return A},IS:function(){return v},L7:function(){return h},Xz:function(){return u},d:function(){return C},fM:function(){return R},iW:function(){return f},zX:function(){return d}});var r=n(674590),i=n(27638),o=n(127780),a=n(48407),s=n(85264),c=n(393743);function l(e){return e.every(e=>!e||!!Array.isArray(e)&&e.every(e=>!e))}function u(e,t,n,o){var{changesetType:a,mutations:c}=t,{changesetType:u,mutations:h}=n,_=e.getAdapterBySheetTypeSync(i.Z.Smartsheet),A=e.getAdapterBySheetTypeSync(i.Z.Grid);if(a===u){if(u===s.j.SMARTSHEET){var d=[[]];return _&&(d=_.getModalApi.followRequestMutations?.(c,h,o)),{changesetType:l(d)?s.j.EMPTY:u,mutations:d}}var f=A.getModalApi.follow?.((0,r.default)(h),(0,r.default)(c),!o);return{changesetType:l(f)?s.j.EMPTY:u,mutations:[f]}}return s.j.SMARTSHEET,{changesetType:u,mutations:h}}function h(e){return(t,r,o)=>{var{changesetType:l,changeset:h}=t,{changesetType:A,changeset:d}=r;n.g.log?.info(c.w.Follow,"multiTypeFollowChangeset A:",h),n.g.log?.info(c.w.Follow,"multiTypeFollowChangeset B:",d);var f={changesetType:l,mutations:_(e,h,l)},E={changesetType:A,mutations:_(e,d,A)},{changesetType:g,mutations:R}=u(e,f,E,o),C=function(e,t,n){if(n!==s.j.SMARTSHEET)return m(e,t.map(e=>({commandType:a.D.Empty,mutations:e})));var r=e.getAdapterBySheetTypeSync(i.Z.Smartsheet);return r?JSON.stringify(t.map(e=>e.map(e=>r.getModalApi.serializeMutation?.(e)))):""}(e,R,g);return{changesetType:g,changeset:C}}}function _(e,t,n){if(n===s.j.SMARTSHEET){var r=e.getAdapterBySheetTypeSync(i.Z.Smartsheet);return r?JSON.parse(t).map(e=>e.map(e=>r.getModalApi.deserializeMutation?.(e))):[[]]}return f(e,t)?.map(e=>{var{mutations:t}=e;return t})||[[]]}function A(e,t){var n=e.getAdapterBySheetTypeSync(i.Z.Smartsheet);return n&&n.getModalApi.deserializeMutation?.(t)||null}function d(e,t){var n=e.getAdapterBySheetTypeSync(i.Z.Grid);return n?.getModalApi.deserializeToMutations?.(t)||null}function f(e,t){var n=e.getAdapterBySheetTypeSync(i.Z.Grid);return n?.getModalApi.deserializeToCommandDatas?.(t)}function E(e,t){var n=e.getAdapterBySheetTypeSync(i.Z.Smartsheet);if(!n)return[[]];var r=JSON.parse(t);return n.getModalApi.deserializeRequests?.(r)}function g(e,t,n){return t===s.j.SMARTSHEET?E(e,n)||[[]]:f(e,n)?.map(e=>e?.mutations)||[[]]}function R(e,t,n,r,c){var l,u,h,_,A,d,f,E;return!(t.length<=0)&&(c===s.j.SMARTSHEET?(l=e,u=t,h=l.getAdapterBySheetTypeSync(i.Z.Smartsheet),h?.runMutations(u,T)):(_=e,A=t,d=n,f=r,E=_.getAdapterBySheetTypeSync(i.Z.Grid),E?.runMutations(A,o.J.Collab,d.length?d[0]:a.D.Empty,f)),!0)}function C(e,t,n){if(n===s.j.SMARTSHEET){var r,o,a;return void(r=e,o=t,a=r.getAdapterBySheetTypeSync(i.Z.Smartsheet),a?.runMutations(o,p))}}var T=3,p=4;function v(e,t){var n=e.getAdapterBySheetTypeSync(i.Z.Smartsheet);return n?.getModalApi.serializeMutation?.(t)}function m(e,t){var n=e.getAdapterBySheetTypeSync(i.Z.Grid);return n?.getModalApi.serializeCommandDatasToString?.(t)||""}},651260:function(e,t,n){n.d(t,{j6:function(){return a},y2:function(){return o}});var r=n(27638);function i(e){return!("number"!=typeof e||isNaN(e))&&!(e<0)}function o(e,t){return i(e)&&i(t)}function a(e){switch(e.substring(0,3)){case"ss_":return r.Z.Smartsheet;case"sc_":return r.Z.Smartcanvas;default:return r.Z.Grid}}},339632:function(e,t,n){n.d(t,{B4:function(){return s},iu:function(){return c},p_:function(){return l}}),n(738355);var r=n(850934),i=n(980931),o=n(808856),a=n(971433);function s(e,t,n){var{sheetId:o,rowIndex:a,colIndex:s,cellImage:c}=n,l=e.worksheetManager.getSheetBySheetId(o);if(!l)throw Error("sheet \u4E0D\u5B58\u5728");var u={sheetId:o,rowIndex:a,colIndex:s,tinyId:t,extendedValue:new r.x(c).serialize()};return u.newRowHeight=(0,i.KK)(l,a),u}function c(e,t,n,r){var i=e.worksheetManager.getSheetBySheetId(t),o=i?.getCellDataAtPosition(n,r);return o?.getCellHyperlinksInfo()?.hyperlinksInfo}function l(e){return(e?.type===o.n.Image||e?.type===o.n.AttachmentVideo||e?.type===o.n.Video)&&e?.displayType===a.T.PreviewImage}},54464:function(e,t,n){if(n.d(t,{C:function(){return i}}),10430==n.j)var r=n(888514);function i(e){var t={keyframe:[],actions:[],lastKeyFrameActions:[],hasKeyFrame:!1};if((0,r.Z)(e))try{e=JSON.parse(e)}catch(e){n.g.log?.error("transKeyFrame text",e?.message,e?.stack)}if((0,r.Z)(e[0].smartsheet))try{t.actions=[JSON.parse(e[0].smartsheet)]}catch(e){n.g.log?.error("transKeyFrame action",e?.message,e?.stack)}else t.actions=e[0].smartsheet;return t}},719957:function(e,t,n){if(n.d(t,{Bt:function(){return C},Of:function(){return T},bV:function(){return p},lT:function(){return m}}),7719==n.j)var r=n(661999);n(575739);var i=n(127780),o=n(582557);if(7719==n.j)var a=n(376915);if(7719==n.j)var s=n(48407);var c=n(522095),l=n(675447);if(7719==n.j)var u=n(900366);var h=n(384605),_=n(85264),A=n(393743),d=n(450586),f=n(167091);if(7719==n.j)var E=n(938547);var g=n(460725),R=n(524112);function C(e,t){var n=[];for(var r of e)if(r?.block_datas?.length&&r.block_datas.forEach(e=>{var r=(0,o.tq)(e.related_sheet,t);n.push(r)}),r.related_sheet?.length||r.revision){var i=r.revision??(0,o.tq)(r.related_sheet,t);n.push(i)}return n}function T(e,t,r,a,s,h){(0,R.UL)()||(n.g?.log.info(A.w.DoMutation,"\u79BB\u7EBF\u6570\u636E\u9700\u8981\u5E94\u7528\u5728\u771F\u5B9E\u8868"),S(t,r),I(t),function(e){var{spreadsheetApp:t,containerApp:r,localUserChangeMutationQueue:a,affectedSheetId:s,onlyWorksheet:h}=e;if(a.length){var _=[],d=[];a.forEach(e=>{var a="string"!=typeof e?e:(0,o.tq)(e);a.commands?.forEach(e=>{if(e.mutations?.length){_.push(e.type);var o=(0,l.wi)(e.mutations),a={mutationSource:i.J.Offline,affectedSheetId:s,requestType:e.type,requestOperateType:e.operateType};h&&(n.g.log?.info(A.w.OfflineModule,"\u8FDB\u5165\u79BB\u7EBF\u6253\u5F00\u6A21\u5F0F\uFF0C\u8DF3\u8FC7 workbook \u8FD0\u884C"),o=o.filter(e=>!c.tu.includes(e.type))),t.mutationApi.applyMutations(t.workbook,o,a),o.forEach(e=>{if(d.push(e.type),e.type===u.D.InsertSheet){var n=e.id;r.dataFlowController.loadSheetStatus.finishLoading(n);var i=t.workbook.worksheetManager.getSheetBySheetId(n);i&&(i.setIsInitialized(!0),i.highWaterMark.updateMark(new g.GridRange({sheetId:i.getSheetId(),startRowIndex:0,endRowIndex:i.getRowCount()-1,startColIndex:0,endColIndex:i.getColCount()-1})))}})}})}),n.g.log?.info(A.w.OfflineModule,`\u{5E94}\u{7528}\u{79BB}\u{7EBF}\u{6570}\u{636E}\u{5230}\u{771F}\u{5B9E}\u{8868}, commandType: ${_.join(",")}; mutationType: ${d.join(",")}`)}}({spreadsheetApp:e,containerApp:t,localUserChangeMutationQueue:a,affectedSheetId:s,onlyWorksheet:h}),t.offlineEditAdapter?.changesCache.clearOfflineRevision(),t.setDidEditable(!0))}function p(e,t,n){var r=[].concat(e,t);return r.length||(r=n),v(r)}var v=e=>{var t=[];return e.forEach(e=>{if(!e.changesetType||e.changesetType===_.j.EMPTY){n.g.log?.info(A.w.DoMutation,"localUserChange baseRev: ",e.getBaseVersion?.());var r=e.getChangeset?.(),i=e.mutations;n.g.log?.info(A.w.DoMutation,"offlineUserChange baseRev: ",e.firstCommitRev);try{t.push((0,o.tq)(r??i))}catch(e){n.g.log?.error(A.w.DoMutation,"getSheetLocalUserChangeMutationQueue deserializeRevision failed.",e)}}}),t};function m(e,t){(0,R.UL)()||(S(e,t),I(e),(e.offlineEditAdapter?.changesCache.getOfflineChanges()||[]).forEach(e=>{if(e.changesetType&&e.changesetType!==_.j.EMPTY&&e.changesetType!==_.j.SMARTCANVAS){var n=(0,a.C6)(t,e.changesetType,e.mutations),r=[];n.forEach(e=>{r=r.concat(e)}),(0,a.d)(t,r,e.changesetType)}}))}function S(e,t){try{for(var i of e.offlineEditAdapter?.changesCache.getMissChanges()){var o=function(n){var{changesetType:r,changeset:i,author:o,newRev:s}=n,c=void 0,l=[];if(r===_.j.SMARTCANVAS)return{v:void 0};c=r===_.j.SMARTSHEET?(0,a.I2)(t,i):(l=(0,a.iW)(t,i)||[]).map(e=>e.mutations);var u=[],h=[];c?.forEach((e,t)=>{l.length&&h.push(l[t].commandType),u=u.concat(e)}),(0,a.fM)(t,u,h,o,r),e.messageCenterAdapter.updateVersion(s)}(i);if("object"===(0,r._)(o))return o.v}e.offlineEditAdapter?.changesCache.clearMissChanges()}catch(e){n.g.log?.error(A.w.DoMutation,"applyMissChanges Error",e.message)}}var w=!1;function I(e){if(n.g.log?.info(A.w.DoMutation,"\u5F00\u59CB\u63D0\u4EA4\u79BB\u7EBF\u6570\u636E",w),!w)try{var t=e.offlineEditAdapter?.changesCache.getOfflineChanges(),r=[];t?.forEach(e=>{var t={sheetId:e.subId,taskId:e.taskId,commandDatas:[],changesetType:e.changesetType,isOfflineMessage:!0,createTime:e.createTimestamp,syncToOffline:!1};if(e.changesetType===_.j.SMARTSHEET)t.commandDatas.push({commandType:s.D.Empty,mutations:JSON.parse(e.mutations)});else if(e.changesetType!==_.j.SMARTCANVAS){var n=(0,o.tq)(e.mutations);n.commands?.forEach(e=>{var{mutations:n}=e;if(n?.length){var r=(0,l.wi)(n);t.commandDatas.push({commandType:e.type,mutations:r})}})}r.push(t)}),r.length&&(n.g.log?.info(A.w.OfflineModule,"\u63D0\u4EA4\u79BB\u7EBF\u6570\u636E\u81F3\u7F51\u7EDC\u5C42\uFF0C\u957F\u5EA6\u4E3A:",r.length),e.messageCenterAdapter.addUserChange(r)),w=!0}catch(t){n.g.log?.error(A.w.DoMutation,"commitOfflineChanges Error",t.message),e.messageCenterAdapter||n.g.log?.report("messageServiceInitError"),n.g.log?.report(f.ENTERPRISE_WEBLOG_REPORT_KEY.commitOfflineChangeFail),e.messageCenterAdapter?.shutDown(h.B.OFFLINE_SYNC_ERROR),d.ZP.wdocs({module:f.ENTERPRISE_REPORT_MODULE.OFFLINE_DATA,action:f.ENTERPRISE_REPORT_ACTION.FAIL,scene:"commitOfflineChanges",str1:(0,E.Q)(t)})}}},532042:function(e,t,n){if(n.d(t,{r:function(){return d}}),7719==n.j)var r=n(434902);n(738355);var i=n(430327),o=n.n(i),a=n(183873),s=n(115089);if(7719==n.j)var c=n(815944),l=n.n(c);var u=n(45865),h=n(470484),_=`//${u.Z.getConfig("runtime.domainName")}/cgi-bin/online_docs/doc_info`,A={doc_meta:{doc_type:1,create_ts:s.q.getConfig("createdTime"),tenant_id:"",wedrive_info:{}},doc_url:`//${u.Z.getConfig("runtime.domainName")}/sheet/local_edit`,owner_nick:s.q.getConfig("ownerNick"),owner_avatar:s.q.getConfig("ownerAvatar"),owner_corp_id:"",owner_corp_name:"",owner_uid_source:s.q.getConfig("uidSource"),is_collected:0,is_added_my:0,retcode:0,creator_nick:s.q.getConfig("ownerNick"),last_modify_nick:s.q.getConfig("ownerNick")};function d(){return f.apply(this,arguments)}function f(){return(f=(0,r._)(function*(){if((0,h.$0)())return A;var{data:e}=yield o().post(_,l().stringify({domainId:s.q.getConfig("domainId"),localPadId:s.q.getConfig("padId"),getCollected:1,getIsAddedMy:1,xsrf:(0,a.f)()}));if(0!==e.retcode)throw Error("doc_info retcode error");return e})).apply(this,arguments)}},685570:function(e,t,n){if(n.d(t,{J:function(){return o}}),7719==n.j)var r=n(434902);if(7719==n.j)var i=n(532042);function o(e){return a.apply(this,arguments)}function a(){return(a=(0,r._)(function*(e){try{var t=yield(0,i.r)(),r={docType:t.doc_meta.doc_type,docUrl:t.doc_url,createTime:1e3*t.doc_meta.create_ts,createNick:t.creator_nick,ownerName:t.owner_nick,ownerCorpId:t.owner_corp_id,ownerCorpName:t.owner_corp_name,ownerAvatar:t.owner_avatar,ownerUidSource:t.owner_uid_source,isCollected:t.is_collected,isAddedMy:t.is_added_my,tenantId:t.doc_meta.tenant_id,ownerIsMigrate:t.doc_meta.wedrive_info.owner_is_migrate,lastModifyNick:t.last_modify_nick,certification:{isCertification:!!t.doc_meta.official_auth_info,...t.doc_meta.official_auth_info}};e?.(r)}catch(e){console.error(e),n.g.log?.error("[DocInfo] \u83B7\u53D6DocInfo\u5931\u8D25",e)}})).apply(this,arguments)}},316392:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(758699),i=n(112230),o=n(434902),a=n(422063),s=n(951924),c=n(602751),l=n(556019),u=n(977515),h=function(){function e(e,t){this._zi=e,this._ms=t}var t=e.prototype;return t.transferToImage=function(e){return(0,o._)(function*(){var t=l.Ni.invokeFunction(e=>e.get(c.TO)),n=yield t.getInstance();n?.showExportImageComponents({source:e.position??"titlebar",onClose:e.onCancel})})()},t.showSearchReplace=function(e){var t=this;return(0,o._)(function*(){var n=t._zi.sheetStatus.canEdit(t._zi.view.getSelectionRanges())?a.N.ADVANCED_SEARCH:a.N.BASIC_SEARCH;(0,u.D)()?.show(e?.searchMode||n)})()},t.registerMentionCallbacks=function(e,t){n.g.log.info("openApi-registerMentionCallbacks",e,t),this.onAtInput=()=>e(void 0,void 0),this.onProfileClick=e=>t(e,void 0)},t.removeMentionCallbacks=function(){n.g.log.info("openApi-removeMentionCallbacks"),this.onAtInput=void 0,this.onProfileClick=void 0},t.insertMention=function(e){if(n.g.log.info("openApi-insertMention",e),!e)return void n.g.log.error("openApi-insertMention-error",e);var t=Array.isArray(e)?e:[e],{mentionCenter:r}=this._zi.view.canvas;r.broker.chooseCallback(t)},t.cancelInsertMention=function(){n.g.log.info("openApi-cancelInsertMention")},t.expandMobileOptionsMenu=function(e){},t.getAllSheetName=function(){return this._zi.workbook.worksheetManager.getSheetNameList()},t.gtCurrentSheetName=function(){return this._zi.workbook.activeSheet.getSheetName()},t.jumpTo=function(e){var t="";return t="number"==typeof e?this._zi.workbook.worksheetManager.getSheetBySheetIndex(e)?.getSheetId()||"":e,this._ms.triggerSwitchSheet(t,this._zi.workbook.activeSheetId,{source:s.o.API})},t.viewZoom=function(e){this._zi.view.canvas.scale.scaleTo(e)},(0,r._)(e,[{key:"iconUrl",get:function(){return this.driveFileIconUrl}},{key:"title",get:function(){return this.driveFileTitle}},{key:"ext",get:function(){return this.driveFileExt}}]),e}(),_=n(985437),A=n(707521),d=function(){function e(){this._AmD=!1}return e.prototype.init=function(e){var{spreadsheetApp:t,sdkSheetsBarService:r,containerSdk:o,containerApp:a,containerAdapterManager:s}=e;if(!this._AmD){this.api=new h(t,r);var c=new A.Z(o,a,s);_.W.getInstance().inject(c,!1),this._caX=new i.ak(this.api),this._caX.configure(n.g),this._AmD=!0}},e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},(0,r._)(e,[{key:"isThirdPartyEnvironment",get:function(){return!!n.g.openApi?.registerMentionCallbacks}}]),e}()},328432:function(e,t,n){n.d(t,{B7:function(){return a},FM:function(){return o},Fw:function(){return i},Xc:function(){return s},_4:function(){return r}});var r={isSupportBigDataCommit:!0,minContentLength:2097152,maxContentLength:0x1380000},i=2e4,o=60,a=61,s=0xf00000},161284:function(e,t,n){n.d(t,{f:function(){return r}});var r=Object.values(n(432416).p).filter(e=>"number"==typeof e).map(e=>String(e))},990212:function(e,t,n){n.d(t,{t:function(){return r}});var r={WATING:0,COMMITING:1,ACCEPT:2}},514037:function(e,t,n){n.d(t,{e:function(){return eV}});var r=n(434902),i=n(758699),o=n(921734),a=n(209787);n(575739);var s=n(445497),c=n(696030),l=n(615301),u=n(44488),h=n(524112),_=n(450586),A=n(167091),d=n(976037),f=n(673798),E=n(115089),g=n(328432),R=function(){function e(){this._ba=new Map}var t=e.prototype;return t.startLoadSheet=function(e,t){if(void 0===t&&(t=!1),!t&&this._ba.has(e))return n.g.log.warn("messageCenter",`PendingControl - ${e} is already added`),!1;var r=this._ba.get(e);return r||(r={count:0},this._ba.set(e,r)),r.count=t?r.count+1:1,1===this.loadingCount},t.finishLoadSheet=function(e,t){void 0===t&&(t=!1);var r=this._ba.get(e);return r?(r.count=t?r.count-1:0,r.count<=0&&this._ba.delete(e),0===this.loadingCount):(n.g.log.warn("messageCenter",`PendingControl - ${e} does not exist`),!1)},(0,i._)(e,[{key:"loadingCount",get:function(){var e=0;return this._ba.forEach(t=>{e+=t.count}),e}}]),e}(),C=n(698317),T=n(760590),p=n(509234),v=n(291698),m=n(330521),S=n(966736),w=n(963248),I=n(393743),O=n(127982),b=n(45865),y=n(376915),D=n(340576),N=function(){this.onApplyLocalUserChangesEmitter=new D.Q5,this.onApplyLocalUserChanges=this.onApplyLocalUserChangesEmitter.event,this.onApplyServerUserChangesEmitter=new D.Q5,this.onApplyServerUserChanges=this.onApplyServerUserChangesEmitter.event,this.onCommitSuccessEmitter=new D.Q5,this.onCommitSuccess=this.onCommitSuccessEmitter.event,this.onCommitFailEmitter=new D.Q5,this.onCommitFail=this.onCommitFailEmitter.event,this.onRoomOpenEmitter=new D.Q5,this.onRoomOpen=this.onRoomOpenEmitter.event,this.onVersionChangeEmitter=new D.Q5,this.onVersionChange=this.onVersionChangeEmitter.event},M=n(384605),L=n(115168),k=n(147634),F=n(339622),P=n(938547),x=function(){function e(e,t,r,i,o){this._bAD=!1,this._bAe=!1,this._Fc=e,this._FT=t,this.messageCenter=r,this._AJq=i,this._AEw=o,this._AJk=new D.Q5,this.containerID=n.g.containerID,this._cau=this._AJk.event}var t=e.prototype;return t.applyServerUserChanges=function(e){var t=e.userChangesOrigin;if(!this._bAe){if(this._bAD)return void n.g.log.error("messageCenter","D0001 \u540E\u4ECD\u6709\u534F\u540C\u6D88\u606F",e.changeset,this._Fc.messageCenterAdapter.getCurrentVersion(),e.newRev);var r=new L.Z(e);if(r.newVersion<=this.messageCenter.versionManager.getCurrentVersion())return void _.ZP.run(A.CONFIG.APPLY_NEWCHANGES_VERROR,[this.containerID,t,r],t);if(r.revert||r.isRevert){this._bAe=!0,this._AEw.handleRevert();return}this.applyNewChanges(this._FT,r),this._AJq.onApplyServerUserChangesEmitter.fire({changeInfo:r})}},t.applyNewChanges=function(e,t){_.ZP.jankMonitor.handleJankPathStack({moduleValue:"ReceiveMessageCenterAdapter",actionValue:"applyNewChanges"});try{var r,{changesetType:i,changeset:o,author:a}=t,s=[];r=i===u.CHANGESET_TYPE.SMARTSHEET?(0,y.I2)(e,o):(s=(0,y.iW)(e,o)||[]).map(e=>e.mutations);var c=[],l=[];r?.forEach((e,t)=>{s.length&&l.push(s[t].commandType),c=c.concat(e)}),(0,y.fM)(e,c,l,a,i),this._bAf(c,i),this.messageCenter.versionManager.updateVersion(t.newVersion),_.ZP.run(A.CONFIG.APPLY_NEWCHANGES,[this.containerID,t.newVersion])}catch(e){n.g.log.error("MessageCenter",e),this._bAE(t,e)}},t._bAE=function(e,t){var i=this;return(0,r._)(function*(){k.CL.applyNewChangesFail(M.B.APPLY_NEW_CHANGE_ERROR),_.ZP.run(A.CONFIG.APPLY_NEWCHANGES_CATCH_ERROR,[i.containerID,e,t]),_.ZP.wdocs({module:A.ENTERPRISE_REPORT_MODULE.MESSAGECENTER,action:A.ENTERPRISE_REPORT_ACTION.APPLY,str1:(0,P.Q)(t)});try{(0,h.YR)(JSON.stringify(e),3500).forEach((e,t)=>{n.g.log.error(`get changeInfo D0001 index: ${t}: changeChunk:`,e)})}catch(e){n.g.log.error("log offline data fail",e)}try{window.log?.error("messageCenter",t?.message),window.log?.error("messageCenter",JSON.stringify(t?.stack))}catch(e){n.g.log.error("log error fail",e)}i._BJi()})()},t._BJi=function(){this._bAD||(this._bAD=!0,this._AJk.fire(M.B.APPLY_NEW_CHANGE_ERROR),setTimeout(()=>{n.g.log?.report(A.ENTERPRISE_WEBLOG_REPORT_KEY.applyMutationError)},1500))},t._bAf=function(e,t){var n=F.J[F.$.SHEET];t===u.CHANGESET_TYPE.SMARTSHEET?n="smartsheet":t===u.CHANGESET_TYPE.SMARTCANVAS&&(n="smartcanvas");var r=this._Fc.undoRedoStack.createItem({docType:n,canUndoRedo:!1,redoCommand:{mutations:e},undoCommand:{mutations:[]}});r&&this._Fc.undoRedoStack.push(r)},e}(),Z=function(){function e(){this.handleReport=e=>{var{type:t,remark:n,data:r}=e;this._OS({type:t,remark:n,data:r}),this._Os({type:t,remark:n,data:r}),this._Or({type:t,remark:n,data:r}),this._OQ({type:t,remark:n,data:r}),this._OR({type:t,remark:n,data:r}),this._OT({type:t})}}var t=e.prototype;return t._OQ=function(e){var{type:t,data:n}=e;switch(t){case l.REPORT_MONITOR_TYPE.RETRY_COMMIT:_.ZP.run(A.CONFIG.RETRY_SENDMESSAGE,[n?.currentTime,n?.commitingQueue?.[0]?.taskId]);break;case l.REPORT_MONITOR_TYPE.COMMITING_BLOCK_ERROR:_.ZP.run(A.CONFIG.COMMITING_QUEUE_BLOCK,[n?.commitingQueue,n?.lastRequestTime,n?.currentTime,n?.waitingQueue?.length]);break;case l.REPORT_MONITOR_TYPE.SEND_USERCHANGE:_.ZP.run(n.isFirstCommit?A.CONFIG.SEND_USERCHANGE:A.CONFIG.SEND_USERCHANGE_1,[n?.userChange?.taskId,n?.userChange]);break;case l.REPORT_MONITOR_TYPE.HANDLE_TASK_DUPLICATE_VERSION_ERROR:_.ZP.run(A.CONFIG.TASK_DUPLICATE_VERSION_TOO_LOW,[n?.packet?.taskId,n?.packet?.cmd,n?.packet?.result,n?.currentVersion])}},t._Or=function(e){var{type:t,data:n}=e;t===l.REPORT_MONITOR_TYPE.HANDLE_NEW_CHANGES&&_.ZP.run(A.CONFIG.HANDLE_NEW_CHANGES,[n?.newRev,n?.body?.data?.commitId,n?.socketId,n?.ts])},t._OR=function(e){var{type:t,data:n}=e;t===l.REPORT_MONITOR_TYPE.UPDATE_VERSION_ERROR&&_.ZP.run(A.CONFIG.UPDATE_BASEVERSION_ERROR,[n?.currentVersion,n?.newVersion])},t._Os=function(e){var{type:t,data:n}=e;switch(t){case l.REPORT_MONITOR_TYPE.GET_MISS_CHANGE_ERROR:this._Ot(n);break;case l.REPORT_MONITOR_TYPE.MISS_CHANGE_VERSION_ERROR:_.ZP.run(A.CONFIG.FETCH_USERCHANGES_ERROR,[n?.userChange?.data?.newRev,n?.preNewVersion])}},t._OS=function(e){var{type:t,data:n}=e;switch(t){case l.REPORT_MONITOR_TYPE.APPLY_COLLAB_CHANGE_VERSION_BREAK:_.ZP.run(A.CONFIG.APPLY_NEWCHANGES_VERROR2,[n?.newVersion,n?.currentVersion]);break;case l.REPORT_MONITOR_TYPE.APPLY_COLLAB_CHANGE_VERSION_REPEAT:_.ZP.run(A.CONFIG.APPLY_NEWCHANGES_VERROR5,[n?.newVersion,n?.currentVersion]);break;case l.REPORT_MONITOR_TYPE.APPLY_COLLAB_CHANGE_VERSION_BELOW:_.ZP.run(A.CONFIG.APPLY_NEWCHANGES_VERROR6,[n?.newVersion,n?.currentVersion])}},t._Ot=function(e){void 0===e&&(e={});var{options:t,result:n}=e;switch(n.errorDescription){case l.MISS_CHANGE_ERROR_TYPE.AJAX_ERROR:k.CL.getMissChangeError(l.MISS_CHANGE_ERROR_TYPE.AJAX_ERROR);break;case l.MISS_CHANGE_ERROR_TYPE.RESULT_CHANGES_EMPTY:k.CL.getMissChangeError(l.MISS_CHANGE_ERROR_TYPE.RESULT_CHANGES_EMPTY);break;case l.MISS_CHANGE_ERROR_TYPE.RESULT_DATA_UNDEFINED:_.ZP.run(A.CONFIG.FETCH_USERCHANGES_3,[n?.data?.status,n?.data]);break;case l.MISS_CHANGE_ERROR_TYPE.FROM_BELOW_TO_ERROR:_.ZP.run(A.CONFIG.FETCH_USERCHANGE_ARGUMENT,[t?.form,t?.to]);break;case l.MISS_CHANGE_ERROR_TYPE.RETCODE_ERROR:(0,T._7)(n?.retcode)}},t._OT=function(e){var t={[l.REPORT_MONITOR_TYPE.TASK_QUEUE_NOT_RESUME_AFTER_60_SECOND]:()=>void(O.$.report(l.REPORT_MONITOR_TYPE.TASK_QUEUE_NOT_RESUME_AFTER_60_SECOND),_.ZP.galileo.reportEvent({name:l.REPORT_MONITOR_TYPE.TASK_QUEUE_NOT_RESUME_AFTER_60_SECOND,custom_status:1}))};t[e.type]?.()},e}(),B=n(388896),H=n(96821),U=n(311792),V=n(990212),G=n(362501),K=n(715622),W=n(986396),Q=n(432416),Y=n(257443),q=n(651765),J=n(384341),j=n(926584),X=n(71475),z=function(){function e(e,t,r,i,o){this._AJK=0,this._AJL=!1,this._Fc=e,this.messageCenter=t,this._AJP=r,this._AJq=i,this._ACq=o,this._AJk=new D.Q5,this.containerID=n.g.containerID,this._cau=this._AJk.event,this._fU()}var t=e.prototype;return t.addUserChange=function(e){_.ZP.jankMonitor.handleJankPathStack({moduleValue:"SendMessageCenterAdapter",actionValue:"addUserChange"}),n.g.clientVars?.hotDocs&&this.messageCenter.networkStatusManager.getRoomStatus()!==u.RoomState.OPENED&&this.messageCenter.openRoom();var t=Array.isArray(e)?e:[e];if(t.length<=0)return q.u.SUCCESS;var[{isOfflineMessage:r}]=t;this.messageCenter.networkStatusManager&&this.messageCenter.networkStatusManager.getRoomStatus()===u.RoomState.OPENED||!this._AJP.onceOpened||r||this._Fc.networkStatus.setSocketOnline(!1);var i=this.messageCenter?.sendMessageManager.getIsPause()&&this.messageCenter?.taskQueueManager.getStatus()===l.QUEUE_STATUS.PAUSE,o=[];for(var a of t){var{sheetId:s,taskId:c,commandDatas:h,isOfflineMessage:d=!1,createTime:f=Date.now(),syncToOffline:R=!0,changesetType:C,onSuccess:T}=a,p=null,v={globalPadId:E.q.getConfig("globalPadId"),sheetId:s,baseVersion:this.messageCenter.versionManager.getCurrentVersion(),changesetType:C,commandDatas:h,taskId:c,isOfflineMessage:d,msgInfo:{pauseMsg:i??!1},time:f};p=new G.Z(v);var m=(0,K.uT)(p);this._AJq.onApplyLocalUserChangesEmitter.fire({userChange:(0,j.Z)(p),syncToOffline:R,requestKey:a.requestKey,userChangePBString:m}),_.ZP.run(A.CONFIG.ADD_USER_CHANGE,[this.containerID,s,p.taskId,h?.length]);var S=!1;if(d||(S=(0,K.nD)(p)),p.commandDatas.length){var w=(0,K.HJ)(p,S?void 0:m);if(w.changeset.length>g.Xc)return q.u.COMMIT_PRECHECK_ERROR_OVERSIZE;o.push({...w,onSuccess:T})}}return this.messageCenter.addUserChange(o),q.u.SUCCESS},t.hasUncommitSmartsheetChanges=function(){var e=this.messageCenter.localUserChangeManager.getCommitingQueue(),t=this.messageCenter.localUserChangeManager.getWaitingQueue();return e.some(e=>e.changesetType===u.CHANGESET_TYPE.SMARTSHEET)||t.some(e=>e.changesetType===u.CHANGESET_TYPE.SMARTSHEET)},t.acceptCommit=function(e,t,n){var r=n.offlineMsg?"acceptOfflineCommit":"acceptCommit",{taskId:i}=n;k.CL.commitResponse(!0,""),_.ZP.run(A.CONFIG.ACCEPT_COMMIT_2,[this.containerID,e,t,i],r),this._AJn(),this._AJq.onCommitSuccessEmitter.fire({sheetId:e,newVersion:t,userChange:(0,K.fT)(n,E.q.getConfig("globalPadId"),V.t.ACCEPT)}),d.ZP.network.trigger("commitSuccess"),this._AJO()},t._caU=function(e){var{errorCode:t,commitingQueue:r,cmd:i,result:o}=e,a=null;try{a=r.length?(0,K.fT)(r[0],E.q.getConfig("globalPadId"),V.t.COMMITING):null,k.CL.commitResponse(!1,t),_.ZP.run(A.CONFIG.HANDLE_COMMIT_ERROR,[this.containerID,a?.taskId,i,o],t,a?.isOfflineMessage)}catch(e){n.g.log?.error("messageCenter","commitError runtime error",e.message)}var s=o?.response?.body?.data?.msg??"";switch(t){case 102:this._ACq.handleErrorCode("102");break;case 103:case 105:case 107:break;case 52003:case Y.h.ERR_OVERSIZE_COMMIT:case 18001:case 18002:case 40006:case 40035:case 60018:case 60019:case 60020:this._AJk.fire({errorCode:t});break;case Y.h.ERR_COMMIT_BASEVER_TOO_LOW:this._AJm(String(t)),this._AJM();break;case 1e4:case 10001:case 4e4:case 40001:case 40002:case 40003:case 40005:case 40020:case 40022:case 40023:case 40024:case 40025:case 40026:case 40028:case 40030:case 40034:case 40036:case 40037:case 40038:case 40040:case 40100:case 41001:case 41002:case 60003:case 60007:case 60008:case 60016:case 60017:case 60015:case Y.h.ERR_INCOMPLETE_COMMIT_ATTRIBUTES:case Y.h.ERR_TRANSFORM_CGO:case 60002:case 60004:case 60005:case 60011:case 60013:case 60014:case 60021:case 60022:this._AJk.fire({errorCode:t});break;case Q.p.SHEET_ERROR_CANNOT_EDIT_SHEET:d.ZP.rangeAuthEvent.trigger(Q.p.SHEET_ERROR_CANNOT_EDIT_SHEET,a,Q.p.SHEET_ERROR_CANNOT_EDIT_SHEET);break;case Q.p.SHEET_ERROR_CANNOT_EDIT_RANGE:d.ZP.rangeAuthEvent.trigger(Q.p.SHEET_ERROR_CANNOT_EDIT_RANGE,a,Q.p.SHEET_ERROR_CANNOT_EDIT_RANGE);break;case Q.p.SHEET_ERROR_BASE:case Q.p.SHEET_ERROR_UNKNOWN:case Q.p.SHEET_ERROR_MUT_INVALID_ARGUMENT:case Q.p.SHEET_ERROR_MUT_SHEET_NOT_FOUND:case Q.p.SHEET_ERROR_MUT_OUT_OF_RANGE:case Q.p.SHEET_ERROR_MUT_INVALID_SHEET_INDEX:case Q.p.SHEET_ERROR_MUT_REPEAT_SHEET_ID_ERROR:case Q.p.SHEET_ERROR_MUT_REPEAT_SHEET_NAME:case Q.p.SHEET_ERROR_MUT_SHEET_LIMITED:case Q.p.SHEET_ERROR_MUT_SHEET_LEASTED:case Q.p.SHEET_ERROR_MUT_ALL_SHEET_HIDDEN:case Q.p.SHEET_ERROR_MUT_COMMENT_GROUP_NOT_FOUND:case Q.p.SHEET_ERROR_MUT_REPEAT_COMMENT_GROUP:case Q.p.SHEET_ERROR_MUT_SHEET_VIEW_NOT_FOUND:case Q.p.SHEET_ERROR_MUT_REPEAT_SHEET_VIEW_GUID:case Q.p.SHEET_ERROR_MUT_INVALID_CF_PRIORITY_ERROR:case Q.p.SHEET_ERROR_MUT_REPEAT_CF_ID:case Q.p.SHEET_ERROR_MUT_CF_NOT_FOUND:case Q.p.SHEET_ERROR_MUT_DIMENSION_LIMITED:case Q.p.SHEET_ERROR_MUT_DIMENSION_LEASTED:case Q.p.SHEET_ERROR_MUT_REPEAT_WORKBOOK_RANGEID:case Q.p.SHEET_ERROR_MUT_WORKBOOK_RANGE_NOT_FOUND:case Q.p.SHEET_ERROR_MUT_LINKED_RANGE_EQUA_LNAMED:case Q.p.SHEET_ERROR_MUT_REPEAT_DRAWING_ID:case Q.p.SHEET_ERROR_MUT_DRAWING_NOT_FOUND:case Q.p.SHEET_ERROR_MUT_DUPLICATED_CHART_ID:case Q.p.SHEET_ERROR_MUT_CHART_NOT_FOUND:case Q.p.SHEET_ERROR_MUT_ADDON_NOT_FOUND:case Q.p.SHEET_ERROR_MUT_DUPLICATED_ADDON_ID:case Q.p.SHEET_ERROR_INVALID_INTERSECTS_NUM:case Q.p.SHEET_ERROR_MUT_GRID_RANGE_NOT_MERGED:case Q.p.SHEET_ERROR_CANNOT_VIEW_FILE:case Q.p.SHEET_ERROR_CANNOT_EDIT_FILE:case Q.p.SHEET_ERROR_CANNOT_EDIT_COMMENT:case Q.p.SHEET_ERROR_PIVOT_CACHE_NOT_FOUND:case Q.p.SHEET_ERROR_PIVOT_TABLE_NOT_FOUND:case Q.p.SHEET_ERROR_TABLE_RANGE_CONFLICT:case Q.p.SHEET_ERROR_DUPLICATED_PIVOT_TABLE_ID:case Q.p.SHEET_ERROR_TABLE_CANNOT_CHANGE_CACHE:case Q.p.SHEET_ERROR_CACHE_HAS_BEEN_REFERRED:case Q.p.SHEET_ERROR_TABLE_NOT_MATCH_CACHE:case Q.p.SHEET_ERROR_INVALID_DELETE_RANGE_MAPPING:case Q.p.SHEET_ERROR_FORBID_COMMIT:case Q.p.SHEET_ERROR_FORBID_COMMIT_RESULT:case Q.p.SHEET_ERROR_MUT_EMPTY_DRAWING_INFO:case Q.p.SHEET_ERROR_MUT_DUPLICATED_FILTER_ERROR:case Q.p.SHEET_ERROR_MUT_SHEET_TYPE_INVALID:case Q.p.SHEET_ERROR_INVALID_FILTER_SYNC_PARAM:case Q.p.SHEET_ERROR_RANGE_INTERSECTED_WITH_PIVOT_TABLES:case Q.p.SHEET_ERROR_RANGE_CONTAINED_BY_PIVOT_TABLES:case Q.p.SHEET_ERROR_RANGE_INTERSECT_WITH_PIVOT_TABLE:case Q.p.SHEET_ERROR_MUT_CF_FORMULA_ERROR:case Q.p.SHEET_ERROR_INVALID_GRID_RANGE:case Q.p.SHEET_ERROR_MUT_SHEET_NOT_LOADED:case Q.p.SHEET_ERROR_MUT_COL_FROM_INTERSECT_MERGED_CELL:this._AJk.fire({errorCode:t,info:s});default:this._AJk.fire({errorCode:t})}this._AJq.onCommitFailEmitter.fire({errCode:t})},t._AJm=function(e){this._AJK+=1,2!==this._AJK||this._AJl||H.Z.server.showCommitVersionBreakTips(e,{onShow:e=>this._AJl=e,onClose:()=>{this._AJl=null}})},t._AJM=function(){this.messageCenter.sendMessageManager.commitAfterUpdateVersionToLatest(void 0,0)},t._AJn=function(){if(this._AJl){var e=this.messageCenter.localUserChangeManager.getCommitingQueue(),t=this.messageCenter.localUserChangeManager.getWaitingQueue();0===e.length&&0===t.length&&(this._AJK=this._AJK<2?0:this._AJK,this._AJl?.close?.(),this._AJl=null)}},t._fU=function(){d.ZP.spreadsheetEvent.listen("onShowHowToHandleDataLostModal",()=>{var e=this.messageCenter.localUserChangeManager.getCommitingQueue(),t=this.messageCenter.localUserChangeManager.getWaitingQueue(),n=[].concat(e,t).length;_.ZP.run(A.CONFIG.CLEAR_OFFLINE_DATA_SIZE,n,[this.containerID,e.length,t.length])}),this._AJN()},t._AJN=function(){var e=this;return(0,r._)(function*(){window.addEventListener("beforeunload",t=>{if(e._AJo()&&!(!e._Fc.networkStatus.isOnline()&&J.default.isElectronTencentDocsClient)){if(e._Fc.offlineEditAdapter.getLastCanWrite(),(0,W._O)(1e3),n.g.refreshReason===U.QU||n.g.refreshReason===U.U6)return;return t.returnValue=B.ZP.t("\u6587\u6863\u5B58\u5728\u672A\u4FDD\u5B58\u4FEE\u6539\uFF0C\u5982\u679C\u5173\u95ED\uFF0C\u4FEE\u6539\u5C06\u4E0D\u4F1A\u88AB\u4FDD\u5B58\u3002\u60A8\u662F\u5426\u786E\u5B9A\u5173\u95ED\uFF1F")}_.ZP.jankMonitor.handleJankPathStack({moduleValue:"page",actionValue:"refresh"})})})()},t._AJo=function(e){var t=[].concat(this.messageCenter.localUserChangeManager.getCommitingQueue(),this.messageCenter.localUserChangeManager.getWaitingQueue());return e?!!t.find(t=>t?.getOtherOptions()?.sheetId===e):t.length>0},t._AJO=function(){if(!this._AJL){this._AJL=!0;try{var e=(0,X.X)();_.ZP.tdwReport({opername:"doc_core",module:"edit",action:"edit_text",source3:e>0?e:localStorage?.getItem("tdsourcetag")??""})}catch(e){n.g.log?.error(I.w.Report,"\u4E0A\u62A5\u9996\u6B21\u7F16\u8F91\u5931\u8D25",e)}}},e}();n(738355),n(271599);var ee=n(234153),et=n(318783),en=n(471917),er=n(311759),ei=n(869243),eo=n(25396),ea=n(470484),es=!1,ec=n(47011),el=n(608965),eu=n(365664),eh=E.q.getConfig("isOwner")||E.q.getConfig("isAdmin"),e_=[u.RoomWebsocketErrorCode.SOCKET_USER_AUTH_FAILED],eA=[l.CollabErrorCode.TASK_ERROR],ed=[u.RoomWebsocketErrorCode.SOCKET_SERVER_ERROR,u.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_TIMEOUT,u.RoomWebsocketErrorCode.SOCKET_CLIENT_NOT_READY_ERROR,u.RoomWebsocketErrorCode.SOCKET_DOC_PRIVILEGE_FAILED,u.RoomWebsocketErrorCode.SOCKET_SERVER_WAITTING_TIMEOUT,18001,u.RoomWebsocketErrorCode.SOCKET_AUTH_TIMEOUT,u.RoomErrorCode.ROOM_CLOSE,60037],ef=function(){function e(e,t,i,o,a,s){var c=this;if(this.onceOpened=!1,this._AEP=!1,this._Fc=e,this._FQ=t,this.messageCenter=i,this._ACq=o,this._AEw=a,this._FT=s,this.reopenAfterShutdown=e=>(_.ZP.wdocs({module:A.ENTERPRISE_REPORT_MODULE.REOPEN_AFTER_SHUTDOWN,action:A.ENTERPRISE_REPORT_ACTION.START,str2:String(e)}),n.g.log?.info(`reopenAfterShutdown start ${e}`),new Promise((t,r)=>{if(this.messageCenter.isConnected())return this._Fc.containerStatus.statusSetter.setWorkbookStatusTryingToReconnect(!1),n.g.log?.info("reopenAfterShutdown success"),t(!0);var i=Date.now();this.messageCenter.forceResume(),this.messageCenter.reconnect();var o=0,a=setInterval(()=>(o+=1,this.messageCenter.isConnected())?(clearInterval(a),n.g.log?.info(`reopenAfterShutdown success messageCenter reopen after ${o}times `),this._Fc.containerStatus.statusSetter.setWorkbookStatusTryingToReconnect(!1),_.ZP.wdocs({module:A.ENTERPRISE_REPORT_MODULE.REOPEN_AFTER_SHUTDOWN,action:A.ENTERPRISE_REPORT_ACTION.SUCCESS,str2:String(e),str3:String(Date.now()-i)}),t(!0)):o>=20?(clearInterval(a),n.g.log?.error("reopenAfterShutdown fail"),this._Fc.containerStatus.statusSetter.setWorkbookStatusTryingToReconnect(!1),_.ZP.wdocs({module:A.ENTERPRISE_REPORT_MODULE.REOPEN_AFTER_SHUTDOWN,action:A.ENTERPRISE_REPORT_ACTION.FAIL,str2:String(e),str3:String(Date.now()-i),str4:String(this.messageCenter.getIsOnline()),str5:this.messageCenter.networkStatusManager.getRoomStatus()}),r(!1)):void 0,1e3)})),this._AAb=e=>{this._AEv(e)},this._AAB=e=>{ei.default.show({id:"network",type:"info",message:B.ZP.t("\u6587\u6863\u5F00\u5C0F\u5DEE\u4E86\uFF0C\u5237\u65B0\u540E\u66F4\u65B0\u6700\u65B0\u5185\u5BB9"),duration:3e3}),this._AEv(e)},this._BJM=(0,r._)(function*(e){throw c._Fc.containerStatus.statusSetter.setWorkbookStatusTryingToReconnect(!1),n.g.log?.error("renew ticket error reach max try"),Error(`${e}`)}),this._BJo=()=>{ec.e.destroy(),this._Fc.containerStatus.statusSetter.setWorkbookStatusTryingToReconnect(!1),this._Fc.containerStatus.statusSetter.activeShutdownStatus(!0),this._BJK=void 0},n.g.log.info("messageCenter","new SocketAdapter()"),this.containerID=n.g.containerID,!n.g.WebSocket?.prototype?.send)return void k.CL.unsupportedWebsocket();this._AEt()}var t=e.prototype;return t.dispose=function(){this._AEr()},t.handleSocketOpen=function(){this.onceOpened||this._AEP||_.ZP.galileo.reportEvent({name:A.CORE_LINK_ZZS_POINTER.NO_SOCKET_AFTER_90S,custom_status:0}),this.onceOpened&&this._AEu(),this.onceOpened=!0},t.handleSocketClose=function(e){this._AEQ||(this._AEQ=n.g.setTimeout(()=>{this._AET(e)},1e4))},t.handleRoomStateChange=function(e){var{status:t,moreInfo:n}=e;switch(_.ZP.run(A.CONFIG.ROOM_STATE_CHANGE,[t,n],t),t){case u.RoomState.RECONNECTING_IN_CLOSED:this.handleSocketClose(n);break;case u.RoomState.OPENED:this._AEu()}},t.handleShutDown=function(e,t){var r=e;try{var{info:i}=JSON.parse(e);i&&(e=i)}catch(e){n.g.log.error("messageCenter","handleShutDown",e)}if((0,k.B0)(t??e,r),k.CL.socketShutdown(t??e),e===l.REPORT_MONITOR_TYPE.HANDLE_TASK_DUPLICATE_VERSION_ERROR)return void this._AEs(e);if(_.ZP.run(A.CONFIG.HANDLE_SHUTDOWN,t||e),!this._AES(e,t)){if(e===M.B.LONG_TIME_HIDDEN){this._Fc.containerStatus.statusSetter.activeShutdownStatus(!1),this._Fc.containerStatus.statusSetter.activeTempStatus(!1);return}_.ZP.idkey(291727,53),n.g.log.info("messageCenter","shutdownRequestType",this._Fc.undoRedoStack?.undoStack[0]?.redoCommand?.requestType),n.g.log.info("messageCenter","SocketshutDownCommitingQueue",this.messageCenter.localUserChangeManager.getCommitingQueue()),n.g.log.info("messageCenter","SocketshutDownWaitingQueue",this.messageCenter.localUserChangeManager.getWaitingQueue().slice(0,3)),this._Fc.containerStatus.statusSetter.setWorkbookStatusTryingToReconnect(!0),this._BJJ.tryRecover(Number(t)||0,()=>{if(!this._BJK||this._BJK!==t&&this._BJK!==e){for(var n of(this._BJK=t||e,this._Fc.containerStatus.statusSetter.setWorkbookStatusTryingToReconnect(!1),this._Fc.containerStatus.statusSetter.activeShutdownStatus(!1),this._ACq.getErrorCodeList()))if(!(String(t)!==n&&(isNaN(Number(n))&&-1===e.indexOf(n)||!isNaN(Number(n))&&-1===e.indexOf(`:${n},`))))return void this._ACq.handleErrorCode(n);this._ACq.handleErrorCode(String(t))}},this._BJo)}},t.handleMessageFromServer=function(e){var{type:t,data:n}=e;(t===l.SERVER_MESSAGE_TYPE.CODEREV_NEW||t===l.SERVER_MESSAGE_TYPE.LAST_REVERSION||t===l.SERVER_MESSAGE_TYPE.RIGHT_MESSAGE||t===l.SERVER_MESSAGE_TYPE.REVERT_MESSAGE)&&_.ZP.run(A.CONFIG.ACCEPT_MESSAGE,[t,n]),this._AEw.handleServerMessage({type:t,data:n})},t.handleNetReconnectedFail=function(){var e=this;return(0,r._)(function*(){J.default.isIOS&&!(0,en.j)()&&(e._AEV(e._Fc.containerStatus.statusChecker.canEditDocument&&(yield e._Fc.offlineEditAdapter.canWrite()),t=>{e._AEq=t}),k.CL.reconnectedFail())})()},t.isUnavailableTimeout=function(){return this._AEP&&this.messageCenter.networkStatusManager?.getRoomStatus()!==u.RoomState.OPENED},t._AEr=function(){n.g.log?.debug("messageCenter","socket destroy()",this.containerID),this.messageCenter.shutDown("LOAD_NEW_DOC"),this.onceOpened=!1,es=!1,this._AEq=void 0},t._FC=function(){n.g.clientVars?.querydata&&!eh&&this._AEU(),(!n.g.clientVars?.hotDocs||eh)&&(this.messageCenter.openRoom(),this._BJJ=new l.ConnectionRecoverHelper({actions:[].concat(window.tdocs?.docLogin?[{codes:e_,retry:e=>this._BJM(e),retryLimit:1,retryInterval:1e4,retryImmeOnFirstVisible:!0}]:[],[{codes:ed,retry:this.reopenAfterShutdown,retryLimit:1,retryInterval:1e4,retryImmeOnFirstVisible:!1,maxRetry:2},{codes:eA,retry:this.reopenAfterShutdown,retryLimit:1,retryInterval:5e3,retryImmeOnFirstVisible:!0,maxRetry:4}]),listenVisibleChange:e=>{window.tdocs?.onFocusWedocsWindow&&window.tdocs?.onBlurWedocsWindow&&(window.tdocs.onFocusWedocsWindow(()=>{n.g.log?.info("tdocsJSAPI:onFocusWedocsWindow"),e?.(!0)}),window.tdocs.onBlurWedocsWindow(()=>{n.g.log?.info("tdocsJSAPI:onBlurWedocsWindow"),e?.(!1)}))}}))},t._AER=function(){this._AEq?.close?.()},t._AEs=function(e){this._Fc.containerStatus.statusSetter.activeShutdownStatus(!1),d.ZP.spreadsheetEvent.trigger("clearOfflineStore",{type:eo.N.UN_COMMITTED}),this._ACq.handleErrorCode(M.B.TASK_DUPLICATE_VERSION_TOO_LOW),_.ZP.run(A.CONFIG.TASK_DUPLICATE_VERSION_TOO_LOW,[e])},t._AES=function(e,t){return e===M.B.LOAD_NEW_DOC||e===el.Z.SELF_LEAVE||e===M.B.SOCKET_NOT_SET_UP||1000001===t},t._AEt=function(){E.q.getConfig("isOverConNum")&&!E.q.getConfig("isCreator")||E.q.getConfig("isPreview")||E.q.getConfig("isFormPreview")||(0,et.qh)()||E.q.getConfig("upid")===eu.Lf||!E.q.getConfig("isOwner")&&(0,ea.C1)()||!1===b.Z.getConfig("custom.editRoomConnection")||(this._FC(),ee.Z.wait(6e4).run(()=>{if((!n.g.clientVars?.hotDocs||eh)&&this.messageCenter.networkStatusManager?.getRoomStatus()!==u.RoomState.SHUTDOWN&&(!this.messageCenter.networkStatusManager||!this.onceOpened)){var e={attrid:A.CORE_LINK_ZZS_POINTER.NO_SOCKET_AFTER_90S,status:1,dimensions:[`this.messageCenter.networkStatusManager:${this.messageCenter.networkStatusManager}_this.onceOpened:${this.onceOpened}`]};(0,er.G)(this._Fc.containerModel.activeSheet.sheetType)&&(e.project=this._Fc.containerModel.activeSheet.sheetType),O.$.report("NO_SOCKET_AFTER_90S"),_.ZP.galileo.reportEvent({name:A.CORE_LINK_ZZS_POINTER.NO_SOCKET_AFTER_90S,custom_status:1}),this._AEP=!0,d.ZP.spreadsheetEvent.trigger("socketTimeout")}}))},t._AET=function(e){var t=this;return(0,r._)(function*(){t.onceOpened&&!es&&(t._Fc.networkStatus.setSocketOnline(!1),J.default.isIOS&&e&&-1!==e.indexOf("socket io error")||t._Fc.offlineEditAdapter&&!(0,en.j)()&&t._AEV(t._Fc.containerStatus.statusChecker.canEditDocument&&(yield t._Fc.offlineEditAdapter.canWrite()),e=>{t._AEq=e}))})()},t._AEu=function(){this._AEQ&&(n.g.clearTimeout(this._AEQ),this._AEQ=void 0),this._AER(),d.ZP.spreadsheetEvent.trigger("socketOnline"),this._Fc.networkStatus.setSocketOnline(!0),es=!1},t._AEU=function(){var e=this._Fc.dataFlowController.loopFetchVersionData({sheetId:this._Fc.containerModel.activeSheetId,onFail:this._AAB,onSuccess:this._AAb});this.messageCenter.eventManager.onRoomOpen(e.stop.bind(e))},t._AEv=function(e){var{isSuccess:t,error:r}=e;_.ZP.galileo.reportEvent({name:A.CORE_LINK_ZZS_POINTER.HOTDOCS_FETCH_DATA_FAIL,custom_status:+!t,custom_error:r}),t||(O.$.report("HOTDOCS_FETCH_DATA_FAIL"),n.g?.log.error(A.CORE_LINK_ZZS_POINTER.HOTDOCS_FETCH_DATA_FAIL,r))},t._AEV=function(e,t){if(!es){var n,r=this._FT.getAdapterBySheetTypeSync(this._Fc.containerModel.activeSheet.sheetType);if(r?.isEditing?.())return void(void 0===(n=e)&&(n=!0),!es&&(H.Z.client.showNetworkOfflineTip(n,t),es=!0))}},e}(),eE=n(674590),eg=n(579114);function eR(e){_.ZP.run(A.CONFIG.MESSAGECENTER_DATA_ERROR_TIP_IMPORTANT,"dataErrorTip",e),_.ZP.wdocs({module:"dataErrorTip",action:String(e)})}var eC=n(111152),eT=n(877015),ep=n(756328),ev=n(46058),em=n(161284),eS=function(){function e(e){this._Fc=e}var t=e.prototype;return t._cCq=function(e){var t=[{code:["60000"],callback:()=>{H.Z.server.showServerErrorTip(e)}},{code:["60002"],callback:e=>{H.Z.server.showServerConnectTimeout(e)}},{code:["40001"],callback:e=>{H.Z.client.showFileNotExsitErrorTip(e,this._Fc)}},{code:["60003","60016","60017","40002","40003","40030"],callback:e=>{reportError(e),H.Z.client.showSaveFrontEndErrorTip(e,this._Fc)}},{code:["102"],callback:e=>{H.Z.client.showSaveFrontEndErrorTip(e,this._Fc)}},{code:["40028","60004","60005","60011","60013","60018","60019","60020","60022"],callback:e=>{H.Z.server.showServerTaskTimeout(e)}},{code:["60030","60031","60032","60033"],callback:e=>{H.Z.server.showBlacklistBlock(e,this._Fc)}},{code:["608638"],callback:e=>{H.Z.server.showAfterRevertCommitTip(e,this._Fc)}},{code:["60006","60021","LOGIN_INVALIDATE"],callback:(0,r._)(function*(){H.Z.client.showLoginExpiredTip(e)})},{code:[`${Q.p.SHEET_ERROR_CANNOT_EDIT_SHEET}`,`${Q.p.SHEET_ERROR_CANNOT_EDIT_RANGE}`],callback:e=>{window.log?.report("sheet_12034_range_auth_error"),H.Z.client.showEnterpriseUnAuthTip(e)}},{code:["60007","60015"],callback:e=>{H.Z.client.showEnterpriseAuthChanged(e)}},{code:["60037"],callback:e=>{H.Z.server.showEnterpriseTryAgainTips(e)}},{code:["60008","40026","52003",`${Y.h.ERR_OVERSIZE_COMMIT}`],callback:e=>{reportError(e),H.Z.server.showEnterpriseFailedToSubmitOfflineData(e,this._Fc)}},{code:["60010"],callback:()=>{var e=n.g.SpreadsheetApp?.serviceCollection,t=e?.services.get(e.CONFIG.FULL_MEMBER)&&e.services.get(e.CONFIG.FULL_MEMBER).instance;t?.turnOnFullMember()}},{code:["INACTIVE"],callback:()=>{var e=n.g.SpreadsheetApp?.serviceCollection,t=e?.services.get(e.CONFIG.FULL_MEMBER)&&e.services.get(e.CONFIG.FULL_MEMBER).instance;t?.setIsINACTIVE(!0)}},{code:["60014"],callback:e=>{H.Z.server.showFrequentEditTip(e)}},{code:["10000","10001"],callback:e=>{reportError(e),H.Z.server.showEnterpriseFailedToSubmitOfflineData(e,this._Fc)}},{code:[`${Q.p.SHEET_ERROR_MUT_DIMENSION_LIMITED}`],callback:e=>{H.Z.server.showEnterpriseFailedToSubmitOfflineData(e,this._Fc)}},{code:em.f,callback:e=>{reportError(e),H.Z.server.showEnterpriseFailedToSubmitOfflineData(e,this._Fc)}},{code:[`${Y.h.ERR_INCOMPLETE_COMMIT_ATTRIBUTES}`],callback:e=>{reportError(e),H.Z.server.showEnterpriseFailedToSubmitOfflineData(e,this._Fc)}},{code:["18001"],callback:e=>{reportError(e),H.Z.server.showEnterpriseTryAgainTips(e)}},{code:["40039"],callback:e=>{H.Z.server.showEnterpriseFailedToSubmitOfflineData(e,this._Fc)}},{code:["40024","40029","40034"],callback:e=>{H.Z.server.showUpgradeTip(e)}},{code:["40025"],callback:e=>{H.Z.client.showSecurityTip(e)}},{code:["64010"],callback:e=>{H.Z.server.meetingErrorTips(e)}},{code:["1000006"],callback:()=>{d.ZP.docQuitNoticeEvent.trigger("docQuitNotice")}},{code:["40037"],callback:e=>{this._Fc.messageCenterAdapter?.hasUncommitSmartsheetChanges?.()&&H.Z.server.showEnterpriseFailedToSubmitOfflineData(e,this._Fc)}},{code:["40203"],callback:e=>{this._Fc.messageCenterAdapter?.hasUncommitSmartsheetChanges?.()&&H.Z.client.showEnterpriseAuthChanged(e)}}],i=!0;for(var{code:o,callback:a}of t)if(o.indexOf(e)>-1){a(e),i=!1;break}return!i},t.showError=function(e){var t=this;return(0,r._)(function*(){t._cCq(e)})()},e}(),ew=function(){function e(e){this._Fc=e}var t=e.prototype;return t._cCq=function(e,t){void 0===t&&(t={});var n=this,i=[{code:[M.B.APPLY_NEW_CHANGE_ERROR],callback:()=>{H.Z.server.showApplyNewChangeErrorTip(M.B.APPLY_NEW_CHANGE_ERROR)}},{code:[M.B.REQUEST_SIZE_LIMIT],callback:()=>{H.Z.client.showEnterpriseBigDataFromFrontTip(M.B.REQUEST_SIZE_LIMIT,t?.message)}},{code:[M.B.KICK,M.B.DATA_VERSION_TOO_LOW],callback:()=>{H.Z.server.showUpgradeTip(e)}},{code:[M.B.TASK_DUPLICATE_VERSION_TOO_LOW],callback:()=>{H.Z.server.showEnterpriseFailedToSubmitOfflineData(e,this._Fc)}},{code:[M.B.KEYFRAME_UNZIP_ERROR],callback:()=>{H.Z.client.showCommonCrashAndFeedBackModal(M.B.KEYFRAME_UNZIP_ERROR)}},{code:[M.B.DATABASE_ERROR],callback:()=>{H.Z.client.showDatabaseErrorModal(M.B.DATABASE_ERROR)}},{code:[M.B.MUTATION_SHEET_ID_NOT_MATCH_SHEET,M.B.SHEET_ID_NOT_EXIST,M.B.MUTATION_SHEET_ID_NOT_BELONG_TO_WORKBOOK],callback:()=>{H.Z.client.showSaveFrontEndErrorTip(e,this._Fc)}},{code:[M.B.SHEET_ID_INIT_OLD_DUPLICATE],callback:()=>{console.error(e)}},{code:[M.B.SHEET_ID_SHEET_BAR_OLD_DUPLICATE],callback:()=>{H.Z.client.showSheetBarDuplicateSheetId(M.B.SHEET_ID_SHEET_BAR_OLD_DUPLICATE,t.actionType)}},{code:[M.B.SHEET_ID_SHEET_BAR_NEW_DUPLICATE],callback:()=>{H.Z.client.showSheetBarDuplicateSheetId(M.B.SHEET_ID_SHEET_BAR_NEW_DUPLICATE,t.actionType)}},{code:[M.B.SOCKET_NOT_SET_UP],callback:()=>{H.Z.client.showServerConnectFailTip(M.B.SOCKET_NOT_SET_UP)}},{code:[M.B.OFFLINE_SYNC_SERVER_EDIT_LOCK],callback:()=>{H.Z.client.showServerEditLockErrorTip(M.B.OFFLINE_SYNC_SERVER_EDIT_LOCK)}},{code:[M.B.TRANSFORM_MUTATION_ERROR,M.B.RUN_MUTATION_ERROR],callback:(0,r._)(function*(){0===((yield(0,ep.IP)(n._Fc)).data||[]).length?H.Z.client.showEnterpriseApplyMutaionError(e):H.Z.client.showHowToHandleDataLostModal(e,n._Fc)})},{code:[M.B.OFFLINE_INDEXDB_NOT_AVAILABLE],callback:()=>{H.Z.client.showNetOfflineErrorTip(M.B.OFFLINE_INDEXDB_NOT_AVAILABLE)}},{code:M.B.COMMIT_ERROR_CODE_UNDEFINED,callback:()=>{H.Z.server.showUpdatePadTip(e)}},{code:[M.B.COMMITING_QUEUE_BLOCK],callback:()=>{H.Z.client.showSaveFrontEndErrorTip(M.B.COMMITING_QUEUE_BLOCK,this._Fc)}},{code:[M.B.FRONTEND_SOCKET_ERROR_CODE_UNDEFINED],callback:()=>{H.Z.client.showCommonErrorModal1(M.B.FRONTEND_SOCKET_ERROR_CODE_UNDEFINED)}},{code:[M.B.PERMISSION_CHANGE],callback:()=>{H.Z.client.showPermissionChangesTip(this._Fc,M.B.PERMISSION_CHANGE)}},{code:[M.B.RESPONSE_NOT_CONTINUE,M.B.TO_LESS_THAN_FROM,M.B.CGI_HTTP_ERROR,M.B.RESPONSE_DATA_EMPTY,M.B.RESPONSE_ARRAY_EMPTY,M.B.RESPONSE_ERROR_CODE,M.B.RUN_REQUEST_ERROR,el.Z.SELF_LEAVE,ev.Z.COPY_OFFLINE_DATA],callback:()=>{console.error(e)}},{code:[M.B.TASK_RUN_ERROR],callback:()=>{H.Z.server.showUpdatePadTip(e)}},{code:[el.Z.REVERT],callback:()=>{H.Z.client.showHowToHandleDataLostModal(e,this._Fc,!1,`${B.ZP.t("\u6587\u6863\u5DF2\u88AB\u5176\u4ED6\u534F\u4F5C\u8005\u8FD8\u539F")}${B.ZP.t("\uFF0C")}${B.ZP.t("\u672C\u5730\u5B58\u5728\u672A\u4FDD\u5B58\u7684\u6570\u636E")}${B.ZP.t("\uFF0C")}${B.ZP.t("\u8BF7\u5907\u4EFD\u6570\u636E")}${B.ZP.t("\u3002")}`)}},{code:[M.B.OFFLINE_SYNC_RANGE_AUTH_CHANGED],callback:()=>{H.Z.client.showOfflineSyncError(e,this._Fc,!0,B.ZP.t("\u7F16\u8F91\u533A\u57DF\u5DF2\u88AB\u8BBE\u7F6E\u4FDD\u62A4\u8303\u56F4\uFF0C\u65E0\u6CD5\u63D0\u4EA4\u7F16\u8F91\u7684\u5185\u5BB9\uFF0C\u8BF7\u5907\u4EFD\u6570\u636E\u540E\u4FEE\u590D\u3002"))}},{code:[M.B.OFFLINE_SYNC_FILE_AUTH_CHANGED],callback:()=>{H.Z.client.showOfflineSyncError(e,this._Fc,!0,B.ZP.t("\u4F60\u7684\u6587\u6863\u6743\u9650\u5DF2\u88AB\u8BBE\u4E3A\u4EC5\u6D4F\u89C8\uFF0C\u65E0\u6CD5\u63D0\u4EA4\u7F16\u8F91\u7684\u5185\u5BB9\uFF0C\u8BF7\u5907\u4EFD\u6570\u636E\u540E\u4FEE\u590D\u3002"))}},{code:[M.B.OFFLINE_SYNC_ERROR],callback:()=>{H.Z.client.showOfflineSyncError(e,this._Fc,!0)}},{code:[`${l.CollabErrorCode.TASK_ERROR}`],callback:()=>{H.Z.server.showEnterpriseTryAgainTips(e,!0)}}],o=!0;for(var{code:a,callback:s}of i)if(a.indexOf(e)>-1){s(),o=!1;break}return!o},t.showError=function(e,t){this._cCq(e,t)},e}(),eI=function(){function e(e,t){var n=this;this._Acu=null,this._Fc=e,this._Acv=t,this._Act={[eT.N.DATA_DOC_NOT_EXIST]:{errorCodeList:[`${u.RoomWebsocketErrorCode.SOCKET_DATA_DOC_NOT_EXIST}`],callback:e=>{H.Z.client.showFileNotExsitErrorTip(e,this._Fc)}},[eT.N.SERVER_ERROR]:{errorCodeList:[`${u.RoomWebsocketErrorCode.SOCKET_SERVER_ERROR}`],callback:e=>{H.Z.server.showServerErrorTip(e)}},[eT.N.LAYER_ERROR]:{errorCodeList:[`${u.RoomWebsocketErrorCode.SOCKET_LAYER_ERROR}`],callback:e=>{eg.default.status===eg.NETWORK_STATUS.ONLINE?H.Z.server.showServerErrorTip(e):H.Z.client.showNetworkOfflineTip()}},[eT.N.CLIENT_NOT_READY_ERROR]:{errorCodeList:[`${u.RoomWebsocketErrorCode.SOCKET_CLIENT_NOT_READY_ERROR}`],callback:e=>{H.Z.server.showServerConnectTimeout(e)}},[eT.N.FRONT_SAVE_ERROR]:{errorCodeList:[`${u.RoomErrorCode.PARA_ERROR}`,`${u.RoomWebsocketErrorCode.SOCKET_CLIENT_DATA_ERROR}`,`${u.RoomWebsocketErrorCode.SOCKET_USER_CHANGE_PARAM_ERROR}`,`${u.RoomWebsocketErrorCode.SOCKET_COMMAND_NOT_SUPPORTED}`,`${u.RoomWebsocketErrorCode.SOCKET_DATA_SUBID_ERROR}`,`${u.RoomWebsocketErrorCode.SOCKET_DATA_ACTION_LENGTH}`,`${u.RoomWebsocketErrorCode.SOCKET_JS_TOO_OLD}`,M.B.TASK_DUPLICATE_VERSION_TOO_LOW],callback:e=>{eR(e),H.Z.client.showSaveFrontEndErrorTip(e,this._Fc)}},[eT.N.SERVER_TIMEOUT]:{errorCodeList:[`${u.RoomWebsocketErrorCode.SOCKET_DATA_EASYSYNC_TIMEOUT}`,`${u.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_TIMEOUT}`,`${u.RoomWebsocketErrorCode.SOCKET_COLLAB_SERVER_TIMEOUT}`,`${u.RoomWebsocketErrorCode.SOCKET_SERVER_STORAGE_TIMEOUT}`,`${u.RoomWebsocketErrorCode.SOCKET_SERVER_CGI_TIMEOUT}`,`${u.RoomWebsocketErrorCode.SOCKET_HACKPAD_TIMEOUT}`,`${u.RoomWebsocketErrorCode.SOCKET_SERVER_WAITTING_TOO_LONG}`,`${u.RoomWebsocketErrorCode.SOCKET_SERVER_WAITTING_TIMEOUT}`,`${u.RoomWebsocketErrorCode.SOCKET_GET_PRIVILEGE_TIMEOUT}`],callback:e=>{H.Z.server.showServerTaskTimeout(e)}},[eT.N.BLACK_LIST_BLOCK]:{errorCodeList:[`${u.RoomWebsocketErrorCode.SOCKET_IP_BLACK_LIST}`,`${u.RoomWebsocketErrorCode.SOCKET_USER_BLACK_LIST}`,`${u.RoomWebsocketErrorCode.SOCKET_DOCMENT_BLACK_LIST}`,`${u.RoomWebsocketErrorCode.SOCKET_USERAGENT_BLACK_LIST}`],callback:e=>{H.Z.server.showBlacklistBlock(e,this._Fc)}},[eT.N.LOGIN_EXPIRED]:{errorCodeList:[`${u.RoomWebsocketErrorCode.SOCKET_USER_AUTH_FAILED}`,`${u.RoomWebsocketErrorCode.SOCKET_AUTH_TIMEOUT}`,"LOGIN_INVALIDATE"],callback:(0,r._)(function*(e){H.Z.client.showLoginExpiredTip(e)})},[eT.N.NO_AUTH]:{errorCodeList:["40203",`${u.RoomWebsocketErrorCode.SOCKET_DOC_PRIVILEGE_FAILED}`,`${u.RoomWebsocketErrorCode.SOCKET_USER_DOC_NOPRIVILEGE}`,`${Q.p.SHEET_ERROR_CANNOT_EDIT_SHEET}`,`${Q.p.SHEET_ERROR_CANNOT_EDIT_RANGE}`],callback:e=>{H.Z.client.showUnAuthTip(this._Fc,e)}},[eT.N.COMMIT_OVERSIZE]:{errorCodeList:[`${u.RoomWebsocketErrorCode.SOCKET_PACKAGE_SIZE_TOO_LARGE}`,`${u.RoomWebsocketErrorCode.SOCKET_DATA_CONTENT_LIMIT}`,"52003",`${Y.h.ERR_OVERSIZE_COMMIT}`],callback:e=>{eR(e),H.Z.server.showBigDataFromServerTip(e,this._Fc)}},[eT.N.ROOM_MEMBER_FULL]:{errorCodeList:[`${u.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_MEMBER_FULL}`],callback:()=>{var e=p.Ni.invokeFunction(e=>e.get(eC.q)).instance;e?.turnOnFullMember()}},[eT.N.INACTIVE]:{errorCodeList:["INACTIVE"],callback:()=>{var e=p.Ni.invokeFunction(e=>e.get(eC.q)).instance;e?.setIsINACTIVE(!0)}},[eT.N.FREQUENT_LIMIT]:{errorCodeList:[`${u.RoomWebsocketErrorCode.SOCKET_FREQUENCY_LIMIT}`],callback:e=>{H.Z.server.showFrequentEditTip(e)}},[eT.N.SERVER_SAVE_ERROR]:{errorCodeList:[`${u.RoomWebsocketErrorCode.SOCKET_DATA_SERVER_UNKNOWN_ERROR}`,`${u.RoomWebsocketErrorCode.SOCKET_DATA_PROTOCOL_FIELD_LACK}`,`${u.RoomWebsocketErrorCode.SOCKET_DATA_SERVER_ERROR}`,`${u.RoomWebsocketErrorCode.SOCKET_DATA_CHANGESET_EASYSYNC}`,`${u.RoomWebsocketErrorCode.SOCKET_DATA_SAVE_FAIL}`,`${u.RoomWebsocketErrorCode.SOCKET_DATA_READ_FAIL}`,`${u.RoomWebsocketErrorCode.SOCKET_DATA_NOT_SUPPORTED_TYPE}`,`${u.RoomWebsocketErrorCode.SOCKET_DATA_NOT_SUPPORTED_PROTO}`,`${u.RoomWebsocketErrorCode.SOCKET_SHEET_COMMIT_MIDDLE_SERVER_ERROR}`,`${u.RoomWebsocketErrorCode.SOCKET_SHEET_COMMIT_MUTATION_FORMAT_ERROR}`,`${u.RoomWebsocketErrorCode.SOCKET_SHEET_COMMIT_MUTATION_APPLY_ERROR}`,`${u.RoomWebsocketErrorCode.SOCKET_DATA_PROTOCOL_FIELD_LACK}`,"40040",`${u.RoomWebsocketErrorCode.SOCKET_DATA_DOCID_ERROR}`,`${u.RoomWebsocketErrorCode.SOCKET_DATA_PROTOCOL_TYPE_ERROR}`],callback:e=>{eR(e),H.Z.server.showSaveBackEndErrorTip(e,this._Fc)}},[eT.N.SAVE_OVERFLOW]:{errorCodeList:["18001"],callback:e=>{eR(e),H.Z.server.showSaveOverflowErrorTip(e)}},[eT.N.COMMIT_IN_POOR_NETWORK]:{errorCodeList:["18002"],callback:e=>{eR(e),H.Z.server.showPoorNetWorkCommitErrorTip(e)}},[eT.N.CODE_UPGRADE]:{errorCodeList:[`${u.RoomWebsocketErrorCode.SOCKET_GRAY_VERSION_INCONFORMITY}`,`${u.RoomWebsocketErrorCode.SOCKET_CLIENT_VERSION_TOO_OLD}`,`${u.RoomWebsocketErrorCode.SOCKET_COMMIT_DVER_INCONFORMITY}`,M.B.KICK],callback:e=>{H.Z.server.showUpgradeTip(e)}},[eT.N.COLLAB_LIMIT]:{errorCodeList:[`${u.RoomWebsocketErrorCode.SOCKET_DOCUMENT_EDIT_COLLAB_LIMIT}`],callback:e=>{H.Z.client.showSecurityTip(e)}},[eT.N.MEETING_ERROR]:{errorCodeList:["64010"],callback:e=>{H.Z.server.meetingErrorTips(e)}},[eT.N.APPLY_NEW_CHANGE_ERROR]:{errorCodeList:[M.B.APPLY_NEW_CHANGE_ERROR],callback:e=>{eR(e),H.Z.server.showApplyNewChangeErrorTip(e)}},[eT.N.PERMISSION_CHANGE]:{errorCodeList:[M.B.PERMISSION_CHANGE],callback:e=>{H.Z.client.showPermissionChangesTip(this._Fc,e)}},[eT.N.OVER_LIMIT]:{errorCodeList:[`${Q.p.SHEET_ERROR_MUT_DIMENSION_LIMITED}`,`${Y.h.ERR_INCOMPLETE_COMMIT_ATTRIBUTES}`],callback:e=>{H.Z.server.showOverMaxAmountFromServerTip(e,this._Fc)}},[eT.N.REVERT_IN_MISS_REVISIONS]:{errorCodeList:[],callback:e=>{H.Z.server.showAfterRevertCommitTip(e,this._Fc)}},[eT.N.ILLEGAL_PARAM]:{errorCodeList:["6086047"],callback:e=>{H.Z.server.showSaveOverflowErrorTip(e,this._Fc)}},[eT.N.OFFLINE_SYNC_ERROR]:{errorCodeList:[M.B.OFFLINE_SYNC_ERROR],callback:e=>{H.Z.client.showOfflineSyncError(e,this._Fc,!0)}},[eT.N.OFFLINE_SYNC_RANGE_AUTH_CHANGED]:{errorCodeList:[M.B.OFFLINE_SYNC_RANGE_AUTH_CHANGED],callback:e=>{H.Z.client.showOfflineSyncError(e,this._Fc,!0,B.ZP.t("\u7F16\u8F91\u533A\u57DF\u5DF2\u88AB\u8BBE\u7F6E\u4FDD\u62A4\u8303\u56F4\uFF0C\u65E0\u6CD5\u63D0\u4EA4\u7F16\u8F91\u7684\u5185\u5BB9\uFF0C\u8BF7\u5907\u4EFD\u6570\u636E\u540E\u4FEE\u590D\u3002"))}},[eT.N.OFFLINE_SYNC_FILE_AUTH_CHANGED]:{errorCodeList:[M.B.OFFLINE_SYNC_FILE_AUTH_CHANGED],callback:e=>{H.Z.client.showOfflineSyncError(e,this._Fc,!0,B.ZP.t("\u4F60\u7684\u6587\u6863\u6743\u9650\u5DF2\u88AB\u8BBE\u4E3A\u4EC5\u6D4F\u89C8\uFF0C\u65E0\u6CD5\u63D0\u4EA4\u7F16\u8F91\u7684\u5185\u5BB9\uFF0C\u8BF7\u5907\u4EFD\u6570\u636E\u540E\u4FEE\u590D\u3002"))}},[eT.N.RUN_MUTATION_ERROR]:{errorCodeList:[M.B.TRANSFORM_MUTATION_ERROR,M.B.RUN_MUTATION_ERROR],callback:(0,r._)(function*(e){0===((yield(0,ep.IP)(n._Fc)).data||[]).length?H.Z.client.showCommonErrorModal1(e,n._Fc):H.Z.client.showHowToHandleDataLostModal(e,n._Fc)})},[eT.N.COLLAB_TASK_ERROR]:{errorCodeList:[`${l.CollabErrorCode.TASK_ERROR}`],callback:e=>{H.Z.server.showUpdatePadTip(e)}},[eT.N.UNEXPECTED_ERROR]:{errorCodeList:["60037"],callback:e=>{H.Z.client.showUnAuthTip(this._Fc,e)}},[eT.N.REVERT]:{errorCodeList:[el.Z.REVERT],callback:e=>{H.Z.client.showHowToHandleDataLostModal(e,this._Fc,!1,`${B.ZP.t("\u6587\u6863\u5DF2\u88AB\u5176\u4ED6\u534F\u4F5C\u8005\u8FD8\u539F")}${B.ZP.t("\uFF0C")}${B.ZP.t("\u672C\u5730\u5B58\u5728\u672A\u4FDD\u5B58\u7684\u6570\u636E")}${B.ZP.t("\uFF0C")}${B.ZP.t("\u8BF7\u5907\u4EFD\u6570\u636E")}${B.ZP.t("\u3002")}`)}},[eT.N.IGNORE_TIPS]:{errorCodeList:[M.B.RUN_REQUEST_ERROR,el.Z.SELF_LEAVE,ev.Z.COPY_OFFLINE_DATA,`${u.RoomWebsocketErrorCode.SOCKET_USER_CHANGE_PARAM_ERROR}`],callback:()=>{}}},this._AcT=[],this._AqB=new eS(this._Fc),this._Aqc=new ew(this._Fc)}var t=e.prototype;return t.handleErrorCode=function(e){var t=()=>{for(var{errorCodeList:t,callback:n}of this._AcU())if(t.includes(e))return void n(e);H.Z.server.showUpdatePadTip(e)};H.Z.server.checkVipToast(e,e=>{if(e){this._Fc.containerStatus.statusSetter.activeShutdownStatus(!1),this._Fc.containerStatus.statusSetter.setWorkbookStatusFull(!0);return}t()})},t.addErrorTypeMap=function(e){for(var t of Object.keys(e)){var n=this._Act[t]?.errorCodeList,r=e[t];n&&r&&n.push.apply(n,[].concat(r))}this._Acu=null},t.addErrorCodeHandlers=function(e){var t;(t=this._AcT).push.apply(t,[].concat(e)),this._Acu=null},t.getErrorCodeList=function(){if(this._Acu)return this._Acu;var e=this._AcU(),t=(0,eE.default)(e.map(e=>{var{errorCodeList:t}=e;return t}));return this._Acu=t,t},t._AcU=function(){return Object.values(this._Act).concat(this._AcT)},e}(),eO=n(803073),eb=n(616113),ey=n(797218),eD=n(755877);n(995767);var eN=n(905252),eM=n(946868),eL=n(176369),ek=n(474629),eF=n(537769),eP=n(60452),ex=n(181342),eZ=n(88092),eB=n(631079),eH=n(87459),eU=function(){function e(e,t,n,r){this._Fc=e,this._Acv=t,this._ACq=n,this._Jn=r,this._AcV={[l.SERVER_MESSAGE_TYPE.COMM_NOTICE]:this._Acy.bind(this),[l.SERVER_MESSAGE_TYPE.USER_NEWINFO]:this._AcY.bind(this),[l.SERVER_MESSAGE_TYPE.USER_NEWINFOS]:this._Acz.bind(this),[l.SERVER_MESSAGE_TYPE.USER_LEAVE]:this._wV.bind(this),USER_LEAVES:this._AcZ.bind(this),[l.SERVER_MESSAGE_TYPE.CURSOR_MESSAGES]:this._ACa.bind(this),[l.SERVER_MESSAGE_TYPE.RIGHT_MESSAGE]:this._ACA.bind(this),[l.SERVER_MESSAGE_TYPE.TITLE_MESSAGE]:this._ACb.bind(this),[l.SERVER_MESSAGE_TYPE.HANDLE_DELETE]:this._ACB.bind(this),[l.SERVER_MESSAGE_TYPE.CODEREV_NEW]:this._ACc.bind(this),[l.SERVER_MESSAGE_TYPE.REVERT_MESSAGE]:this.handleRevert.bind(this),COMMERCIALIZE_MESSAGE:this._ACC.bind(this),[l.SERVER_MESSAGE_TYPE.MARK_MESSAGE]:this._ACd.bind(this),[l.SERVER_MESSAGE_TYPE.PRESENT_INFO]:this._ACD.bind(this),CHANGE_PRESENTER:this._ACe.bind(this),UPDATE_FILE_UPLOAD:this._ACE.bind(this),EXTERNAL_DATA_MESSAGE:this._ACf.bind(this),COMMIT_UPLOAD:this._ACk.bind(this),[eH.B3.FormulaResult]:this._ACF.bind(this),[eH.B3.ImportAsSubSheet]:this._AqF.bind(this)},this._Acw={[l.SERVER_MESSAGE_TYPE.CURSOR_MESSAGE]:this._AaH.bind(this)},this._AcW={push_message:this._ACg.bind(this),RELOAD:this._ACG.bind(this),RANGE_PRIV_CHANGE:this._ACM.bind(this),ASSOCIATE_DOC:this._ACN.bind(this),DISASSOCIATE_DOC:this._ACo.bind(this),comment_update:this._ACh.bind(this),collab_update:this._ACH.bind(this),discussion_update:this._ACi.bind(this),FORM_RELATION_CHANGE:this._ACn.bind(this),DOCTOPINFO_CHANGE:this._ACj.bind(this),ACCT_VIP_INFO_CHANGE:this._Aqd.bind(this),rollback:this._ACJ.bind(this),doc_position_change:this._Aqe.bind(this),sheet_deprecated:this._AqE.bind(this),sheet_reused:this._Aqf.bind(this)},this._AcX=()=>{J.default.isTencentDocsApp&&J.default.isTencentDocsAppVersionAboveOrEqual("3.9.5")&&window.mqq&&window.mqq.invoke("docx","refreshDocInfo"),ei.default.show({id:"shareContainer",message:B.ZP.t("\u52A0\u5BC6\u6587\u6863\u72B6\u6001\u53D1\u751F\u53D8\u5316"),style:{zIndex:10005},autoClose:!1,action:B.ZP.t("\u70B9\u51FB\u5237\u65B0"),onClickAction:()=>{(0,ey.tencentDocOpenUrlReload)()}})}}var t=e.prototype;return t.handleServerMessage=function(e){var{type:t,data:n}=e;if((0,eO.Z)(n)&&0!==n.length){var[r]=n;this._AcV[t]?.(r),this._Acw[t]?.(n)}},t.handleRevert=function(e){var{uid:t}=e?.body||{};this._Fc.messageCenterAdapter?.pause(),this._Fc.containerStatus.statusSetter.activeTempStatus(!1);var r=n.g.SpreadsheetApp;if(r.view.canvas.inputManager?.isInputtingState()&&r.view.canvas.inputManager?.isInputtingState()&&r.view.canvas.inputManager?.handleExitInput(),t===E.q.getConfig("tinyid")){var i=this._Jn||p.Ni.invokeFunction(e=>e.get(ek.A));i?.instance?.showing||(0,ey.tencentDocOpenUrlReload)(),this._Fc.messageCenterAdapter?.resume();return}eN.default.confirm({title:B.ZP.t("\u6587\u6863\u5DF2\u88AB\u8FD8\u539F"),content:`${B.ZP.t("\u6587\u6863\u5DF2\u88AB\u5176\u4ED6\u534F\u4F5C\u8005\u8FD8\u539F")}${B.ZP.t("\uFF0C")}${B.ZP.t("\u8BF7\u5237\u65B0")}${B.ZP.t("\u3002")}`,cancelText:null,okText:B.ZP.t("\u5237\u65B0"),closable:!1,maskClosable:!1,onOk:()=>((0,eZ.l7)()||(0,ey.tencentDocOpenUrlReload)(),!1),zIndex:10006})},t._Acy=function(e){var t=e?.body?.notice;t&&this._AcW[t.type]?.(t)},t._AcY=function(e){d.ZP.network.trigger("userNewInfo",[e.body.notice],e.body.notice?.mem_count)},t._Acz=function(e){d.ZP.network.trigger("userNewInfo",e.body.notices,e.body.mem_count)},t._wV=function(e){d.ZP.network.trigger("userLeave",[e.body.notice],e.body.notice?.mem_count)},t._AcZ=function(e){d.ZP.network.trigger("userLeave",e.body.notices,e.body.mem_count)},t._AaH=function(e){e.forEach(e=>{d.ZP.network.trigger("cursor",[e.body?.notice])})},t._ACa=function(e){d.ZP.network.trigger("cursor",e.body.notices)},t._ACA=function(e){this._ACK(e?.body?.notice),this._ACl()},t._ACb=function(e){e?.body?.notice?.title&&p.Ni.invokeFunction((0,r._)(function*(t){var n=t.get(ex.D);(yield n.getInstance()).setTitle(e.body.notice.title,!0)}))},t._ACB=function(){d.ZP.network.trigger("deletePad")},t._ACc=function(e){var t=this;return(0,r._)(function*(){if(e?.body?.notice){var r,i,o,a,s,{notice:c}=e.body,{code_ver:l,dver:u}=c;if(r=u,i=n.g._grayVersion,o=/^\d+\.\d+/gi,a=r.match(o),s=i.match(o),!a||!s||(r=a[0])!==(i=s[0])||l!==E.q.getConfig("pver")){var h=location.pathname.replace(RegExp(`/${(0,eD.H)()}/(history/)?`),"");t._Fc.documentManager?.notifyNativeSingleDocVersionMap(h,u,!0),n.g.__SUPPORT_FULL_OFFLINE_MODE&&(yield eb.OfflineAPI.clearDocumentCache(h,E.q.getConfig("uid"))),t._Acv.shutDown(M.B.KICK),t._Fc.containerStatus.statusSetter.activeShutdownStatus(!1)}}})()},t._ACC=function(e){e?.body?.notice?.type==="docMode"&&d.ZP.network.trigger("docModeChange",e?.body?.notice);var t=d.ZP.network,r=()=>{n.g.CollaboratorListInit?document.dispatchEvent(new CustomEvent("commercializeMessage",{detail:e})):ee.Z.wait(3e3).run(()=>{r()})};t.trigger("commercializeMessage",e.body),n.g.CollaboratorListInit?document.dispatchEvent(new CustomEvent("commercializeMessage",{detail:e})):r()},t._ACd=function(e){d.ZP.network.trigger("newWatermark",e?.body?.notice)},t._ACD=function(e){(0,eP.isFromTencentMeetingSharing)()&&d.ZP.network.trigger("presentData",e?.body?.notice?.syncData,e?.body?.notice?.bizid)},t._ACe=function(e){(0,eP.isFromTencentMeetingSharing)()&&d.ZP.network.trigger("presentData",e?.body?.notice?.syncData)},t._ACE=function(e){d.ZP.network.trigger("updateFileUpload",e.body?.notices)},t._ACf=function(e){d.ZP.network.trigger(eH.v5.ExternalDataMessage,e.body?.notice)},t._ACF=function(e){d.ZP.network.trigger(eH.v5.FormulaCalcResult,e,eH.jy.Server)},t._ACg=function(e){if(e.message){var t=null,r="";try{r=(t=JSON.parse(e.message)).type}catch(t){n.g.log?.error(e.message,t.stack)}if("unbind"===r){var i=(0,h.ej)("utype");"wx"===t.unbind&&"wx"===i&&this._Acv.shutDown("TX-LOGIN-PSKEY-EXPIRED")}$(window).trigger("notification_message",[e.message])}},t._ACG=function(){this._ACq.handleErrorCode(M.B.RELOAD),this._Fc.containerStatus.statusSetter.activeShutdownStatus(!1)},t._ACh=function(e){d.ZP.commentEvent.trigger("commentUpdate",e)},t._ACH=function(e){d.ZP.collabEvent.trigger("collabUpdate",e)},t._ACi=function(e){d.ZP.discussionEvent.trigger("discussionUpdate",e)},t._ACj=function(e){d.ZP.spreadsheetEvent.trigger("docTopInfoChange",e)},t._Aqd=function(e){d.ZP.wecomVipChangeEvent.trigger("wecomVipChange",e)},t._ACJ=function(){eN.default.confirm({title:B.ZP.t("\u6587\u6863\u5DF2\u88AB\u8FD8\u539F"),content:`${B.ZP.t("\u6587\u6863\u5DF2\u88AB\u5176\u4ED6\u534F\u4F5C\u8005\u8FD8\u539F")}${B.ZP.t("\uFF0C")}${B.ZP.t("\u8BF7\u5237\u65B0")}${B.ZP.t("\u3002")}`,cancelText:null,okText:B.ZP.t("\u5237\u65B0"),closable:!1,maskClosable:!1,onOk:()=>{(0,eZ.l7)()},zIndex:10006})},t._Aqe=function(e){d.ZP.docPositionChangeEvent.trigger("docPositionChange",e)},t._AqE=function(e){var{ss_doc_id:t,operator_name:n}=e;E.q.setConfig({deprecated_by_ss_info:{ss_doc_id:t,operator_name:n,operator_vid:0}}),d.ZP.sheetDeprecatedEvent.trigger("sheetDeprecated")},t._Aqf=function(){d.ZP.sheetDeprecatedEvent.trigger("sheetReused")},t._ACk=function(e){if(this._Fc.containerStatus.statusSetter.activeShutdownStatus(!1),e?.body?.data?.author===E.q.getConfig("tinyid")&&n.g.__hasUploadedNewVersion)location.reload();else{var t=new URL(location.href);t.searchParams.set("isFileReuploaded","1"),location.href=t.toString()}},t._ACK=function(e){try{if(e?.action===eH.ag.MoveToSafe||e?.action===eH.ag.SafeToPrivate)return void this._AcX();if(""===e.payload||null===e.payload)return void n.g.SLR?.dispatch("TX-AUTH-UPDATED");var t=JSON.parse(e.payload);if(null===t)return;var r=n.g.clientVars||{};void 0===r.msgFilterData&&(n.g.clientVars.msgFilterData={}),1!==t.action&&2!==t.action&&this._ACm(t)}catch(e){}},t._ACl=function(){this._Acv.sendMessage({cmd:l.Command.GET_PRIVILEGE,taskId:(0,l.generateMessageTaskId)(),data:JSON.stringify({}),onsend:(e,t,n,r)=>{if(0===r.errCode&&r.response?.onpost?.result===0){var i=this._ACP(r.response.onpost.privilege_attribute),{docx_attribute:o}=i,a=!!E.q.getConfig("canEdit"),s=!!E.q.getConfig("canRead"),c=!!E.q.getConfig("canEditTitle"),l=!!E.q.getConfig("canEditTab"),u=!!E.q.getConfig("canComment"),h=!!E.q.getConfig("canCopy"),_=!!E.q.getConfig("canCopyDoc"),A=!!E.q.getConfig("canExportDoc"),d=!!E.q.getConfig("canPrint"),f=!!E.q.getConfig("canSaveAsTemplateDoc");(a!==i.can_edit||s!==i.can_read||c!==i.can_edit_title||l!==i.can_edit_tab||_!==o?.can_copy_doc||A!==o?.can_export||d!==o?.can_print||f!==o?.can_save_template)&&(this._Acv.shutDown(M.B.PERMISSION_CHANGE),this._Fc.containerStatus.statusSetter.activeShutdownStatus(!1)),u!==i.can_comment&&(this._Fc.containerStatus.statusSetter.setWorkbookStatusCanComment(!1),this._Acv.shutDown(M.B.PERMISSION_CHANGE)),h!==i.can_copy&&(this._Fc.containerStatus.statusSetter.setWorkbookStatusCanCopy(!1),this._Acv.shutDown(M.B.PERMISSION_CHANGE)),_!==i.can_copy_doc&&void 0!==i.can_copy_doc&&E.q.setConfig({canCopyDoc:i.can_copy_doc});var{can_edit_title:g,can_apply_edit:R,can_copy_doc:C,can_export:T}=o;E.q.setConfig({privilegeAttribute:i.docx_attribute}),E.q.getConfig("canCopyDoc")!==C&&(E.q.setConfig({canCopyDoc:C}),this._Fc.containerStatus.statusSetter.setWorkbookStatusPrivilegeAttribute({canCopyDoc:C})),E.q.getConfig("canEditTitle")!==g&&(E.q.setConfig({canEditTitle:g}),this._Fc.containerStatus.statusSetter.setWorkbookStatusPrivilegeAttribute({canEditTitle:g})),E.q.getConfig("canApplyEdit")!==R&&(E.q.setConfig({canApplyEdit:R}),this._Fc.containerStatus.statusSetter.setWorkbookStatusPrivilegeAttribute({canApplyEdit:R})),E.q.getConfig("canExportDoc")!==T&&(E.q.setConfig({canExportDoc:T}),this._Fc.containerStatus.statusSetter.setWorkbookStatusPrivilegeAttribute({canExportDoc:T}));var p=r.response.onpost.privilege_attribute;if(p?.wecom_allow_op){var v=(0,eM.dD)(p?.wecom_allow_op),m=E.q.getConfig("wecomAllowOperations");if(v?.canClone!==m?.canClone){var S=+!!v?.canClone;E.q.setConfig({canCopyDoc:S})}if(v?.canHistory!==m?.canHistory){var w=+!!v?.canHistory;E.q.setConfig({canHistory:w})}if(v?.canShare!==m?.canShare){var I=+!!v?.canShare;E.q.setConfig({canShare:I})}if(v?.canPrint!==m?.canPrint){var O=+!!v?.canPrint;E.q.setConfig({canPrint:O})}E.q.setConfig({wecomAllowOperations:v})}}},onError:()=>{}})},t._ACL=function(e){d.ZP.spreadsheetEvent.trigger("authUpdate",e)},t._ACm=function(e){return(0,r._)(function*(){if("undefined"!==e.exptime&&"undefined"!==e.settime&&"undefined"!==e.starttime){var t=e.exptime-e.starttime;if(t&&t>0){var n={};n.exptime=e.exptime,n.remaintime=t,n.settime=t,n.starttime=e.starttime;var r=p.Ni.invokeFunction(e=>e.get(eL.xP)),i=yield r.getInstance();i?.onUpdateAuthExpInfo(n)}else console.error("\u6709\u6548\u671F\u53D8\u66F4\u9519\u8BEF")}})()},t._ACM=function(e){d.ZP.rangeAuthEvent.trigger("rangeAuthChange",e)},t._ACn=function(e){d.ZP.formRelationEvent.trigger("formRelationChange",e)},t._ACN=function(e){var{payload:t}=e,n=this._ACO(t);if(n){var{sheetFile:r,relateFile:i}=n,{sub_id:o}=r,{doc_id:a,doc_url:s,sub_id:c}=i,l=this._Fc.containerModel.sheetListManager?.getSheetBySheetId(c)?.sheetType,u={docId:function(e){var[t,n]=e.split("$");return{domain_id:+t,pad_id:n}}(a),docUrl:s,subId:c};if(void 0!==l){this._Acx={...u,subType:eF.X[l]},this._ACp(i,!0,o);return}var h=this._Fc.containerModel.onSheetListChange(()=>{void 0!==(l=this._Fc.containerModel.sheetListManager?.getSheetBySheetId(c)?.sheetType)&&(this._Acx={...u,subType:eF.X[l]},this._ACp(i,!0,o),h?.dispose())})}},t._ACo=function(e){var{payload:t}=e,n=this._ACO(t);if(n){var{sheetFile:r,relateFile:i}=n,{sub_id:o}=r;this._ACp(i,!1,o)}},t._ACO=function(e){var{file:t,rel_file:n}=e;return t.doc_type===F.$.SHEET?{sheetFile:t,relateFile:n}:n.doc_type===F.$.SHEET?{sheetFile:n,relateFile:t}:t.doc_type===F.$.UNKNOWN?{sheetFile:t,relateFile:n}:void 0},t._ACp=function(e,t,n){var{doc_type:r}=e;switch(r){case F.$.UNKNOWN:case eB.Z.FORM:if(t){this._Acx&&this._Fc.containerFeature.relateForm?.bindRelatedFormToSubSheet?.(n,this._Acx);return}this._Fc.containerFeature.relateForm?.unbindSubSheetRelatedForm?.(n)}},t._ACP=function(e){var t={};return Object.keys(e).forEach(n=>{(0,h.Kn)(e[n])?t[n]=this._ACP(e[n]):t[n]=!!e[n]}),t},t._AqF=function(e){e?.body?.data?.author!==E.q.getConfig("tinyid")&&eN.default.confirm({title:B.ZP.t("\u63D0\u793A\uFF1A\u6709\u65B0\u6570\u636E\u5BFC\u5165"),content:B.ZP.t("\u5176\u4ED6\u534F\u4F5C\u8005\u5BFC\u5165\u4E86\u6570\u636E\u81F3\u65B0\u5DE5\u4F5C\u8868\uFF0C\u5237\u65B0\u9875\u9762\u540E\u540C\u6B65"),okText:B.ZP.t("\u5237\u65B0"),cancelText:null,closable:!1,onOk:()=>{(0,ey.tencentDocOpenUrlReload)()}})},e}(),eV=function(e){function t(t,r,i,o){var a;return(a=e.call(this)||this).containerApp=t,a._FQ=r,a._FT=i,a._ZZ=o,a.messageCenterEventManager=new N,a._bAh=[],a._bAj=()=>({uid:E.q.getConfig("uid")===s.Dr?"":E.q.getConfig("uid"),serverVars:E.q.getConfig("collab_client_vars"),userid:E.q.getConfig("userId"),uuId:"",module:E.q.getConfig("padType"),config:{isUseAllCookie:!1,bigDataCommitConfig:g._4,headerGeneralPacket:(0,C.d)(a.containerApp),messagePriority:new Map([[u.Command.CURSOR_MESSAGE,u.MessagePriority.LOW]]),location:{host:b.Z.getConfig("runtime.domainName")},bigCollabCommitConfig:{syncCommit:!!(0,h.IZ)("syncCommit")}}}),a._bAJ=e=>{var{name:t,isIncremental:r}=e;a.pendingControl.startLoadSheet(t,r)&&(a._bAn(),a.messageCenter.pause(),n.g.log.info("messageCenter",`[startLoadData]-messageCenter pause(), sheetId=${t}`))},a._bAk=e=>{var{name:t,isIncremental:r}=e;a.pendingControl.finishLoadSheet(t,r)&&(n.g.clearTimeout(a._bAH),a.messageCenter.resume(),n.g.log.info("messageCenter",`[afterLoadData]-messageCenter resume(), sheetId=${t}`))},a._bAK=e=>{a.messageCenter.forceResume(),a.messageCenter.sendMessageManager.commitAfterUpdateVersionToLatest(e)},n.g.log.info("messageCenter","new MessageCenterAdapter()"),a.containerApp=t,a._FQ=r,a._ZZ=o,a.pendingControl=new R,a._FC(),a._dc(),a}(0,o._)(t,e);var a=t.prototype;return a.destroy=function(){n.g.log.info("messageCenter","MessageCenterAdapter destroy()"),this._bAh.length=0,this.messageCenter.dispose()},a.pause=function(e){return this.messageCenter.pause(e)},a.resume=function(e){return this.messageCenter.resume(e)},a.getCurrentVersion=function(){return this.messageCenter.versionManager.getCurrentVersion()},a.shutDown=function(e,t){return this.messageCenter.shutDown(e,t)},a.getRoomStatus=function(){return this.messageCenter.networkStatusManager.getRoomStatus()},a.sendMessage=function(e){return this.messageCenter.sendMessage(e)},a.getTaskQueueStatus=function(){return this.messageCenter.taskQueueManager.getStatus()},a.setGlobalVars=function(e){return this.messageCenter.setGlobalVars(e)},a.reConnect=function(e){this.messageCenter.setGlobalVars(this._bAj()),this.messageCenter.versionManager.updateVersion(E.q.getConfig("rev"));var t=e||this._bAj();return this.messageCenter.reconnect(t)},a.addUserChangeObserver=function(e){this._bAh.push(e)},a.openRoom=function(){this.messageCenter.openRoom()},a.updateVersion=function(e){return this.messageCenter.versionManager.updateVersion(e)},a.addUserChange=function(e){return this._bAF.addUserChange(e)},a.getCommitingQueue=function(){return this.messageCenter.localUserChangeManager.getCommitingQueue()},a.getWaitingQueue=function(){return this.messageCenter.localUserChangeManager.getWaitingQueue()},a.reopenAfterShutdown=function(){this.messageCenter.forceResume(),this.messageCenter.reconnect()},a.clearAllUserChangeQueue=function(){return this.messageCenter.localUserChangeManager.clearAllUserChangeQueue()},a.isWaitingEmpty=function(){return this.messageCenter.localUserChangeManager.isWaitingEmpty()},a.isCommittingEmpty=function(){return this.messageCenter.localUserChangeManager.isCommittingEmpty()},a.isPendingControl=function(){return this.pendingControl.loadingCount>0},a.resetPendingControl=function(){this.pendingControl=new R},a.isUnavailableTimeout=function(){return this.socketAdapter.isUnavailableTimeout()},a.isPaused=function(){return this.messageCenter.taskQueueManager.getStatus()===l.QUEUE_STATUS.PAUSE},a.hasUncommitSmartsheetChanges=function(){return this._bAF.hasUncommitSmartsheetChanges?.()},a._FC=function(){this._bAG=new Z,this.messageCenter=new l.MessageCenter(E.q.getConfig("rev"),{...l.defaultMessageCenterOption,isSplitMissTask:!0,taskPriority:l.TASK_PRIORITY.SLICE}),n.g.log.debug("messageCenter","bigCollabCommitConfig syncCommit: ",!!(0,h.IZ)("syncCommit")),this.messageCenter.setGlobalVars(this._bAj()),this.errorCodeCenter=new eI(this.containerApp,this.messageCenter),this._AEw=new eU(this.containerApp,this.messageCenter,this.errorCodeCenter),this._bAg=new x(this.containerApp,this._FT,this.messageCenter,this.messageCenterEventManager,this._AEw);var e=(0,y.L7)(this._FT);this.messageCenter.setOptionalFunction({getMissChangesUrl:this._bAo,checkIfNeedFollow:this._bAN,multiTypeFollow:e,applyServerUserChanges:this._bAg.applyServerUserChanges.bind(this._bAg)}),this.messageCenter.start(),this.socketAdapter=new ef(this.containerApp,this._FQ,this.messageCenter,this.errorCodeCenter,this._AEw,this._FT),this._bAF=new z(this.containerApp,this.messageCenter,this.socketAdapter,this.messageCenterEventManager,this.errorCodeCenter)},a._dc=function(){this._bAl(),this._bAL(),this._bAm(),this._bAM(),d.ZP.default.listen(f.q.START_LOAD_DATA,this._bAJ),d.ZP.default.listen(f.q.AFTER_LOAD_DATA,this._bAk),this._bAi=this._ZZ.onDataVersionChange(this._bAK),this._register((0,c.toDisposable)(()=>{d.ZP.default.remove(f.q.START_LOAD_DATA,this._bAJ),d.ZP.default.remove(f.q.AFTER_LOAD_DATA,this._bAk),this._bAi.dispose()}))},a._bAl=function(){var e=this;this._register(this.messageCenter.eventManager.onAcceptCommit(e=>{var{newVersion:t,data:n}=e;this._bAF.acceptCommit(E.q.getConfig("globalPadId"),t,n)})),this._register(this.messageCenter.eventManager.onCommitError(function(){for(var t,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=e._bAF)._caU.apply(t,[].concat(r))})),this._register(this.messageCenter.eventManager.onConnectionStatusChange(function(){for(var t,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=e.socketAdapter).handleRoomStateChange.apply(t,[].concat(r))})),this._register(this.messageCenter.eventManager.onRoomOpen(()=>{this.messageCenterEventManager.onRoomOpenEmitter.fire(),this.socketAdapter.handleSocketOpen()})),this._register(this.messageCenter.eventManager.onClosed(e=>{var{reason:t}=e;this.socketAdapter.handleSocketClose(t.reason)})),this._register(this.messageCenter.eventManager.onNetReconnectedFail(()=>{this.socketAdapter.handleNetReconnectedFail()})),this._register(this.messageCenter.eventManager.onReceiveOtherMessage(function(){for(var t,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=e.socketAdapter).handleMessageFromServer.apply(t,[].concat(r))})),this._register(this.messageCenter.eventManager.onShutdown(e=>{var{reason:t}=e;this.socketAdapter.handleShutDown(t.reason,t.errCode)})),this._register(this.messageCenter.eventManager.onCommitBlock(e=>{var{changeset:t}=e[0];t.length<=0x1300000?this._bAF._caU({errorCode:18002,commitingQueue:e}):this._bAF._caU({errorCode:18001,commitingQueue:e}),n.g.log.info("messageCenter","onCommitBlock",e)})),this._register(this.messageCenter.eventManager.onVersionChange(e=>{this.messageCenterEventManager.onVersionChangeEmitter.fire(e);var{newVersion:t,currentVersion:n}=e;_.ZP.run(A.CONFIG.UPDATE_BASEVERSION,[n,t])})),this._register(this.messageCenter.eventManager.onQueueChange(e=>{var{waitingQueue:t,commitingQueue:n}=e;this._bAh.forEach(e=>e.onQueueChange?.({waitingQueue:t,commitingQueue:n}))}))},a._bAL=function(){this._register(this._bAF._cau(e=>this.messageCenter.shutDown(e.info??String(e.errorCode),e.errorCode))),this._register(this.messageCenterEventManager.onCommitSuccess(e=>{this._bAh.forEach(t=>t.onAcceptCommit?.(e))})),this._register(this.messageCenterEventManager.onCommitFail(e=>{this._bAh.forEach(t=>t.handleCommitErrorCode?.(e))}))},a._bAm=function(){this._register(this._bAg._cau(e=>this.messageCenter.shutDown(e))),this._register(this.messageCenterEventManager.onApplyServerUserChanges(e=>{this._bAh.forEach(t=>t.onAfterApplyNewChanges?.(e))}))},a._bAM=function(){this._register(this.messageCenter.eventManager.onLog(e=>{var t,r,i,o,{type:a,data:s}=e;switch(a){case l.LOG_TYPE.INFO:(t=n.g.log).info.apply(t,[].concat([I.w.MessageCenter],s));break;case l.LOG_TYPE.DEBUG:(r=n.g.log).debug.apply(r,[].concat([I.w.MessageCenter],s));break;case l.LOG_TYPE.WARN:(i=n.g.log).warn.apply(i,[].concat([I.w.MessageCenter],s));break;case l.LOG_TYPE.ERROR:(o=n.g.log).error.apply(o,[].concat([I.w.MessageCenter],s))}})),this._register(this.messageCenter.eventManager.onReport(this._bAG.handleReport))},a._bAn=function(){n.g.clearTimeout(this._bAH),this._bAH=n.g.setTimeout(()=>{O.$.report("TASK_QUEUE_NOT_RESUME_AFTER_300_SECOND")},3e5)},a._bAN=function(e){try{if(e.revert)return!1;if(e.changeset)return!0;return!1}catch(e){return n.g.log.error("messageCenter","\u89E3\u6790misschange\u5931\u8D25",e),!1}},a._bAo=function(e){return(0,r._)(function*(){return yield(0,T.mb)({padId:e.globalPadId,revLower:e.from,revUpper:e.to})})()},(0,i._)(t,[{key:"connectionController",get:function(){return this.messageCenter.connectionController}}]),t}(c.Disposable);eV=(0,a.__decorate)([(0,a.__param)(0,v.P),(0,a.__param)(1,w.O),(0,a.__param)(2,p.y9),(0,a.__param)(3,m.J),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[void 0===v.P?Object:v.P,void 0===w.O?Object:w.O,void 0===p.y9?Object:p.y9,void 0===S.i?Object:S.i])],eV)},877015:function(e,t,n){n.d(t,{N:function(){return r}});var r={DATA_DOC_NOT_EXIST:"DATA_DOC_NOT_EXIST",SERVER_ERROR:"SERVER_ERROR",LAYER_ERROR:"LAYER_ERROR",CLIENT_NOT_READY_ERROR:"CLIENT_NOT_READY_ERROR",FRONT_SAVE_ERROR:"FRONT_SAVE_ERROR",SERVER_SAVE_ERROR:"SERVER_SAVE_ERROR",SERVER_TIMEOUT:"SERVER_TIMEOUT",BLACK_LIST_BLOCK:"BLACK_LIST_BLOCK",LOGIN_EXPIRED:"LOGIN_EXPIRED",NO_AUTH:"NO_AUTH",COMMIT_OVERSIZE:"COMMIT_OVERSIZE",ROOM_MEMBER_FULL:"ROOM_MEMBER_FULL",INACTIVE:"INACTIVE",FREQUENT_LIMIT:"FREQUENT_LIMIT",SAVE_OVERFLOW:"SAVE_OVERFLOW",CODE_UPGRADE:"CODE_UPGRADE",COLLAB_LIMIT:"COLLAB_LIMIT",MEETING_ERROR:"MEETING_ERROR",APPLY_NEW_CHANGE_ERROR:"APPLY_NEW_CHANGE_ERROR",PERMISSION_CHANGE:"PERMISSION_CHANGE",OVER_LIMIT:"OVER_LIMIT",REVERT_IN_MISS_REVISIONS:"REVERT_IN_MISS_REVISIONS",COMMIT_IN_POOR_NETWORK:"COMMIT_IN_POOR_NETWORK",ILLEGAL_PARAM:"ILLEGAL_PARAM",RUN_MUTATION_ERROR:"RUN_MUTATION_ERROR",COLLAB_TASK_ERROR:"COLLAB_TASK_ERROR",UNEXPECTED_ERROR:"UNEXPECTED_ERROR",OFFLINE_SYNC_RANGE_AUTH_CHANGED:"OFFLINE_SYNC_RANGE_AUTH_CHANGED",OFFLINE_SYNC_FILE_AUTH_CHANGED:"OFFLINE_SYNC_FILE_AUTH_CHANGED",REVERT:"REVERT",OFFLINE_SYNC_ERROR:"OFFLINE_SYNC_ERROR",IGNORE_TIPS:"IGNORE_TIPS"}},651765:function(e,t,n){n.d(t,{u:function(){return i}});var r=n(730635),i={SUCCESS:"SUCCESS",COMMIT_PRECHECK_ERROR_CHANNEL_SHUTDOWN:"COMMIT_PRECHECK_ERROR_CHANNEL_SHUTDOWN",COMMIT_PRECHECK_ERROR_OVERSIZE:"COMMIT_PRECHECK_ERROR_OVERSIZE"};(0,r.y)("IMessageCenterAdapter")},115168:function(e,t){t.Z=function(e){this.commitId=e.commitId,this.sheetId=e.subId,this.newVersion=e.newRev,this.changeset=e.changeset,this.changesetType=e.changesetType,this.revert=e.revert,this.author=e.author,this.isRevert=e.isRevert}},362501:function(e,t,n){var r=n(990212),i=n(615301);t.Z=function(e){this.status=r.t.WATING,this.taskId=0,this.isOfflineMessage=!1,this.globalPadId=e.globalPadId,this.baseVersion=e.baseVersion,this.sheetId=e.sheetId,this.changesetType=e.changesetType,this.commandDatas=[],e.commandDatas&&(this.commandDatas=e.commandDatas||[]),this.time=e.time||new Date().getTime(),this.status=e.status||r.t.WATING,this.taskId=e.taskId||(0,i.generateMessageTaskId)(),this.isOfflineMessage=e.isOfflineMessage||!1,this.dver=e.dver||n.g.__globalCodeVersion,this.msgInfo=e.msgInfo||{}}},87459:function(e,t,n){n.d(t,{B3:function(){return r},ag:function(){return i},jy:function(){return a},v5:function(){return o}});var r={FormulaResult:"FORMULA_RESULT",ImportAsSubSheet:"IMPORT_AS_SUB_SHEET"},i={MoveToSafe:"move_to_safe",SafeToPrivate:"safe_to_private"},o={FormulaCalcResult:"FORMULA_CALC_RESULT",ExternalDataMessage:"EXTERNAL_DATA_MESSAGE"},a={Client:"Client",Server:"Server"}},698317:function(e,t,n){n.d(t,{d:function(){return r}});var r=function(e){var t={};return n.g.__globalReleaseVersion&&(t.rel_rev=n.g.__globalReleaseVersion),n.g.__globalCodeVersion&&(t.dver=n.g.__globalCodeVersion),t.right_tag=+!!e.containerStatus.workbookStatus.canEdit,t}},760590:function(e,t,n){n.d(t,{Hb:function(){return v},Tn:function(){return C},_7:function(){return p},mb:function(){return d}});var r=n(434902);n(575739);var i=n(430327),o=n.n(i),a=n(524112),s=n(450586),c=n(183873),l=n(167091),u=n(384605),h=n(115168),_=n(147634),A=n(45865);function d(e){return f.apply(this,arguments)}function f(){return(f=(0,r._)(function*(e){var t=(0,c.f)(),n=(0,a.IZ)("snaptk"),r=(0,a.IZ)("snapts"),i=void 0===e.revUpper?"":`&to=${e.revUpper}`,o=`//${A.Z.getConfig("runtime.domainName")}`,s=`${o}/dop-api/get/changes?padId=${e.padId}&from=${e.revLower}${i}&xsrf=${t}&snpatk=${n}&snapts=${r}`;return e.needFormula&&(s+=`&needs_formula=${e.needFormula}`),s})).apply(this,arguments)}function E(){return(E=(0,r._)(function*(e){try{var t=yield o()({method:"get",url:e,responseType:"json"});if(t.data?.retcode!==0)return{isSuccess:!1,data:t};return{isSuccess:!0,data:t}}catch(e){return n.g.log.error("messageCenter","sendMissChangesRequest catch error.",e?.stack),{isSuccess:!1,data:void 0}}})).apply(this,arguments)}function g(){return(g=(0,r._)(function*(e,t){void 0===t&&(t=2);for(var n={isSuccess:!1,data:void 0},r=0;r<t&&!(n=yield function(e){return E.apply(this,arguments)}(e)).isSuccess;)yield new Promise(e=>{setTimeout(()=>{e(void 0)},1e3)}),r+=1;return n})).apply(this,arguments)}function R(){return(R=(0,r._)(function*(e){if(void 0!==e.revUpper&&e.revUpper<e.revLower)return{isSuccess:!1,data:void 0,errorCode:u.B.RESPONSE_DATA_EMPTY,errorMessage:"\u53C2\u6570to\u5C0F\u4E8Efrom",reportCode:l.CONFIG.FETCH_USERCHANGE_ARGUMENT,reportOptions:[e.revLower,e.revUpper]};s.ZP.run(l.CONFIG.FETCH_USERCHANGES,[e.revLower,e.revUpper,0]);var t=yield d(e),{isSuccess:n,data:r}=yield function(e){return g.apply(this,arguments)}(t);return n?function(e,t){void 0===t&&(t=!1);var{status:n,data:r,statusText:i="response is void"}=e||{};if(void 0===r)return{isSuccess:!1,data:void 0,errorCode:u.B.RESPONSE_DATA_EMPTY,errorMessage:i,reportCode:l.CONFIG.FETCH_USERCHANGES_3,reportOptions:[n,r]};var{retcode:o,result:a}=r;if(0!==o)return p(r.retcode),{isSuccess:!1,data:void 0,errorCode:u.B.RESPONSE_ERROR_CODE,errorMessage:`retcode=${r.retcode}`};var{to:s,rev:c,changes:A,formulaChanges:d,formulaVersion:f}=a;if(0===A.length&&!t)return _.CL.getMissChangeError("changes_empty"),{isSuccess:!1,data:void 0,errorCode:u.B.RESPONSE_ARRAY_EMPTY,errorMessage:"userchanges\u957F\u5EA6\u4E3A0"};var E=A.map(e=>{var t=e.data;return new h.Z({...t,commitId:Number(t.commitId)})}),g=[];return Array.isArray(d)&&(g=d.map(e=>{var t=e.data;return new h.Z({...t,commitId:Number(t.commitId)})})),{isSuccess:!0,data:{maxRev:s,endRev:c,misschanges:E,formulaMisschanges:g,formulaVersion:f}}}(r,e.needFormula):{isSuccess:!1,data:void 0,errorCode:u.B.CGI_HTTP_ERROR,errorMessage:"fetch cgi error."}})).apply(this,arguments)}function C(e,t){return T.apply(this,arguments)}function T(){return(T=(0,r._)(function*(e,t){for(var n=[],r=[],i=Object.assign({},e);;){var o,a,c,l=yield function(e){return R.apply(this,arguments)}(i);if(!l.isSuccess){e.callback(!1,l.data,l.errorCode,l.errorMessage),void 0!==l.reportCode&&s.ZP.run(l.reportCode,l.reportOptions);return}n.push.apply(n,[].concat(l.data.misschanges)),t?.({pulledVersion:l.data.maxRev}),r.push.apply(r,[].concat(l.data.formulaMisschanges));var u=(o=e.revUpper,a=l.data.maxRev,c=l.data.endRev,void 0===o&&c>a?{isFinish:!1,revLower:a+1,revUpper:c}:void 0!==o&&o>a&&o<=c?{isFinish:!1,revLower:a+1,revUpper:o}:{isFinish:!0});if(u.isFinish)return void e.callback(!0,n,{misschanges:r,formulaVersion:l.data.formulaVersion});i=Object.assign(e,{revLower:u.revLower,revUpper:u.revUpper})}})).apply(this,arguments)}function p(e){e&&_.CL.getMissChangeError(e)}function v(e){return{commitId:e.commitId,subId:e.sheetId,newRev:e.newVersion,changeset:e.changeset,revert:e.revert,author:e.author}}},147634:function(e,t,n){n.d(t,{B0:function(){return u},CL:function(){return l},qB:function(){return c}});var r=n(450586),i=n(167091),o=n(127982),a=n(432416),s=n(938547),c={101:1,102:1,103:1,104:1,105:1,106:1,1e4:1,10001:1,4e4:1,40001:1,40002:1,40003:1,40004:1,40005:1,40006:1,40020:1,40022:1,40023:1,40024:1,40025:1,40026:1,40028:1,40029:1,40030:1,40031:1,40032:1,40033:1,40034:1,40035:1,40036:1,40037:1,40100:1,41001:1,41002:1,60007:1,60018:1,60019:1,60020:1,6e4:1,60002:1,60003:1,60004:1,60005:1,60006:1,60008:1,60010:1,60011:1,60013:1,60014:1,60015:1,60016:1,60017:1,60021:1,60022:1,60030:1,60031:1,60032:1,60033:1,[a.p.SHEET_ERROR_CANNOT_EDIT_SHEET]:1,[a.p.SHEET_ERROR_CANNOT_EDIT_RANGE]:1},l={socketShutdown(e){r.ZP.galileo.reportEvent({name:i.CORE_LINK_ZZS_POINTER.SOCKET_SHUTDOWN,custom_status:1,custom_error:e})},getMissChangeError(e){r.ZP.galileo.reportEvent({name:"missChange\u8865\u62C9\u5931\u8D25",custom_status:1,custom_error:e})},unsupportedWebsocket(){r.ZP.galileo.reportEvent({name:"\u4E0D\u652F\u6301websocket",custom_status:1})},reconnectedFail(){r.ZP.galileo.reportEvent({name:"websocket\u91CD\u8FDE\u5931\u8D25",custom_status:1})},commitResponse(e,t){var s={attrid:i.CORE_LINK_ZZS_POINTER.SOCKET_COMMIT_ERROR,status:+!e},c=-1!==[103,105].indexOf(Number(t));e||(s.dimensions=[t],n.g.log.error(i.CORE_LINK_ZZS_POINTER.SOCKET_COMMIT_ERROR,t)),c||(r.ZP.galileo.reportEvent({name:i.CORE_LINK_ZZS_POINTER.SOCKET_COMMIT_ERROR,custom_status:+!e,custom_error:t}),(t===a.p.SHEET_ERROR_CANNOT_EDIT_SHEET||t===a.p.SHEET_ERROR_CANNOT_EDIT_RANGE)&&o.$.report("SOCKET_COMMIT_ERROR"))},applyNewChangesFail(e){r.ZP.galileo.reportEvent({name:i.CORE_LINK_ZZS_POINTER.APPLY_NEW_CHANGES_ERROR,custom_status:1,custom_error:e}),o.$.report("APPLY_NEW_CHANGES_ERROR")}},u=(e,t)=>{r.ZP.wdocs({module:i.ENTERPRISE_REPORT_MODULE.ERROR_CODE_REASON,action:String(e),opername:"without_async_reason",str2:(0,s.Q)(t)})}},715622:function(e,t,n){n.d(t,{HJ:function(){return l},TB:function(){return A},fT:function(){return _},nD:function(){return h},r_:function(){return c},rg:function(){return u},uT:function(){return s}});var r=n(44488),i=n(362501),o=n(48407),a=n(582557);function s(e){if(e.commandDatas){if(e.changesetType===r.CHANGESET_TYPE.SMARTSHEET){var t=[];return e.commandDatas.forEach(e=>{t=t.concat(e.mutations)}),JSON.stringify(t)}var n=(0,a._e)(e.commandDatas);return(0,a.hw)(n)}return""}function c(e){var t={};t.baseVersion=e.baseVersion,t.sheetId=e.sheetId;var n=s(e),r={type:"USER_CHANGES",taskId:e.taskId,baseRev:e.baseVersion,mutations:n,subId:e.sheetId,pver:1,changesetType:e.changesetType};return t.isOfflineMessage=!0,t.data=r,t.time=e.time,t.status=e.status,t.dver=e.dver,t}function l(e,t){return{baseRev:e.baseVersion,changeset:t||s(e),changesetType:e.changesetType,subId:e.sheetId,offlineMsg:e.isOfflineMessage,taskId:e.taskId,time:e.time,msgInfo:e.msgInfo}}function u(e){var{userChange:t,userChangePBString:n}=e,r={globalPadId:t.globalPadId,baseVersion:t.baseVersion,sheetId:t.sheetId,status:t.status,changesetType:t.changesetType,taskId:t.taskId,time:t.time};return t.commandDatas&&(r.changeset=n||s(t)),r}function h(e){var t=!1;return e.commandDatas.forEach(e=>{e.mutations=e.mutations.filter(e=>!!e._CcV()||(t=!0,!1))}),e.commandDatas=e.commandDatas.filter(e=>e.mutations.length>0||(t=!0,!1)),t}function _(e,t,n){var s=e.changeset??"",c={globalPadId:t,status:n,sheetId:e.subId,baseVersion:e.baseRev,changesetType:e.changesetType,commandDatas:e.changesetType===r.CHANGESET_TYPE.SMARTSHEET?[{commandType:o.D.Empty,mutations:JSON.parse(s)}]:(0,a.l1)((0,a.tq)(s)),taskId:e.taskId,time:e.time,isOfflineMessage:e.offlineMsg};return new i.Z(c)}function A(e){return e.commandDatas.every(e=>e.mutations.every(e=>!e._CcV()))}},984135:function(e,t,n){n.d(t,{c:function(){return s}});var r=n(450586),i=n(167091),o=n(27638),a=n(127982),s={loadFirstSheetFirstChunkDataFail(e,t){var s=t?.info?.clientVars?.type??t?.info?.clientVars?.cgicode??t?.type??t?.code??-1;e===o.Z.Smartsheet?a.$.report("SMART_SHEET_OPENDOC_LOAD_FAIL"):(r.ZP.galileo.reportEvent({name:i.CORE_LINK_ZZS_POINTER.OPENDOC_LOAD_FAIL,custom_error:s,custom_status:1}),n.g.log.error(i.CORE_LINK_ZZS_POINTER.OPENDOC_LOAD_FAIL,t)),[1,2,3,4,5,6,8,9,10,11,12,13,14,15,20,21,30007,92003,200060,200047].includes(s)||a.$.report("OPENDOC_LOAD_FAIL")},loadFirstSheetOtherChunkDataFail(e){r.ZP.galileo.reportEvent({name:i.CORE_LINK_ZZS_POINTER.FIRST_SCREEN_CHUNK_DATA_LOAD_FAIL,custom_error:e.name||e.code,custom_status:1}),n.g.log.error(i.CORE_LINK_ZZS_POINTER.FIRST_SCREEN_CHUNK_DATA_LOAD_FAIL,e),r.ZP.tdwSingleReport({opername:"excel_error",module:"error",action:"chunk_data",ver5:e.type}),a.$.report(i.CORE_LINK_ZZS_POINTER.FIRST_SCREEN_CHUNK_DATA_LOAD_FAIL)},loadSheetDataFail(e){r.ZP.galileo.reportEvent({name:i.ZZS_REPORT_ATTR.LOAD_SHEET_FAIL,custom_status:1,custom_error:e}),n.g.log.error(i.ZZS_REPORT_ATTR.LOAD_SHEET_FAIL,e),a.$.report("LOAD_SHEET_FAIL")}}},404104:function(e,t,n){if(n.d(t,{I:function(){return i}}),7719==n.j)var r=n(434902);function i(){return o.apply(this,arguments)}function o(){return(o=(0,r._)(function*(){return yield n.e("17883").then(n.bind(n,638775))})).apply(this,arguments)}},465624:function(e,t,n){if(n.d(t,{P:function(){return i}}),7719==n.j)var r=n(434902);function i(e){return o.apply(this,arguments)}function o(){return(o=(0,r._)(function*(e){var{showPasswordModal:t}=yield n.e("39437").then(n.bind(n,521463));return yield t(e)})).apply(this,arguments)}},861592:function(e,t,n){n.d(t,{X:function(){return r}});function r(e){try{return e.split(".")[0]}catch(t){return n.g.log.error("datacenter"," \u6570\u636E\u7248\u672C\u53F7\u4E0D\u6B63\u786E",e,t.message),"-1"}}},25396:function(e,t,n){n.d(t,{N:function(){return r}});var r={ALL:"all",COMMITTED:"committed",UN_COMMITTED:"unCommitted"}},756328:function(e,t,n){n.d(t,{Ek:function(){return E},Gx:function(){return d},IP:function(){return C},bx:function(){return _},fK:function(){return A},hH:function(){return f},mj:function(){return R},yv:function(){return g}});var r=n(434902);n(738355);var i=n(717457),o=n(124243);if(7719==n.j)var a=n(760590);var s=n(990212),c=n(115089),l=n(167091),u="sheet.V1",h=new Map([[s.t.WATING,i.DOCUMENT_DATA_TYPE.waiting],[s.t.COMMITING,i.DOCUMENT_DATA_TYPE.committing],[s.t.ACCEPT,i.DOCUMENT_DATA_TYPE.accepted]]),_=function(e,t){return{modelVersion:u,subId:e.subId,offlineMsg:e.offlineMsg,type:h.get(t)||i.DOCUMENT_DATA_TYPE.waiting,taskId:e.taskId,version:e.baseRev,createTimestamp:e.time,mutations:e.changeset||"",changesetType:e.changesetType,subDocType:i.DOCUMENT_TYPE.sheet,dataVersion:c.q.getConfig("dver")}},A=function(e){var t;try{var r=JSON.parse(e.data);t={modelVersion:u,subId:e.subId,offlineMsg:r.isOfflineMessage,type:e.type,taskId:e.taskId,version:e.version,createTimestamp:e.createTimestamp,mutations:r.data.mutations,subDocType:i.DOCUMENT_TYPE.sheet}}catch(e){n.g.log?.error(`oldChangesToSheetChanges error: ${e}`)}return t},d=function(e){var{changeset:t,subId:n,newRev:r,commitId:o}=e;return{subId:n,version:r,taskId:o,mutations:t,changesetType:e.changesetType,createTimestamp:new Date().getTime(),type:i.DOCUMENT_DATA_TYPE.missChange,subDocType:i.DOCUMENT_TYPE.sheet}};function f(e){var{changeset:t,commitId:n,newVersion:r,author:o,revert:a,isRevert:s,sheetId:c,changesetType:l}=e;return{changeset:t,commitId:n,changesetType:l,newRev:r,new_rev:r,author:o,isRevert:s,revert:a,subId:c,type:i.DOCUMENT_DATA_TYPE.missChange,subDocType:i.DOCUMENT_TYPE.sheet}}var E=function(e,t,n,r){return new Promise(i=>{(0,a.Tn)({padId:e,revLower:t,revUpper:n,callback:(e,t,n)=>{e?i(new o.Result(void 0,t)):i(new o.Result(Error(n)))}},r)})};function g(e){return e.map(e=>{var{taskId:t,subId:n,oSubId:r,head:i,keydata:o,changesetType:a,changeData:s,mutations:c}=e;return{task_id:t,subId:n,oSubId:r??!1,head:i,keydata:o??!1,changeSetCount:s?1:c.length,changeset:`${JSON.stringify(s??c??"[]")}
`,changesetType:a}})}function R(e){return e.map(e=>{var{taskId:t,subId:n,changesetType:r,mutations:i}=e;return{task_id:t,subId:n,oSubId:!1,keydata:!1,changeSetCount:i.length,changeset:i,changesetType:r}})}var C=(0,r._)(function*(e){try{var t=e.messageCenterAdapter?.getCommitingQueue()||[],r=e.messageCenterAdapter?.getWaitingQueue()||[],i=[].concat(t.map(e=>_(e.getOriginData(),s.t.COMMITING)),r.map(e=>_(e.getOriginData(),s.t.WATING)));if(i.length)return new o.Result(void 0,i);return yield e.offlineEditAdapter.getLocalChanges()}catch(e){return n.g.log?.report(l.ENTERPRISE_WEBLOG_REPORT_KEY.getOfflineDataFail),n.g.log?.error("offlineEdit","get localChanges fail",e?.message),new o.Result(Error("get localChanges fail"))}})},583107:function(e,t,n){if(n.d(t,{D:function(){return i}}),7719==n.j)var r=n(900366);function i(e){return e.commands?.some(e=>{var{mutations:t}=e;return t?.some(e=>e.type===r.D.ReorderRange||e.type===r.D.AddFilter||e.type===r.D.RemoveFilter||e.type===r.D.AddCustomSheetView||e.type===r.D.UpdateCustomSheetView||e.type===r.D.RemoveCustomSheetView||e.type===r.D.CopyPaste||e.type===r.D.MergeCells)})}n(582557)},905912:function(e,t,n){n.d(t,{W:function(){return _}});var r=n(434902);n(575739),n(738355);var i=n(524112),o=n(479388),a=n(45865);function s(){}function c(e,t){return e+(e.indexOf("?")>=0?"&":`?${t}`)}function l(e,t){var n=t||{bubbles:!1,cancelable:!1,detail:void 0},r=document.createEvent("CustomEvent");return r.initCustomEvent(e,n.bubbles,n.cancelable,n.detail),r}"function"!=typeof window.CustomEvent&&(l.prototype=window.Event.prototype,n.g.CustomEvent=l);var u=(0,o.getRetryStrategy)(),h=u.getRetryCountLimit(),_={metadata:null,firstLoaded:{},asset:{React:{url:a.Z.getConfig("runtime.library.TENCENT_DOCS_LIBRARY__react"),state:-1}},assetLoaded:!1,events:{},cache:{},evtArr:[],init(e,t,n,r){void 0===t&&(t=s),void 0===n&&(n=s),void 0===r&&(r=0),this.assetLoaded||(r<=2?this.ajax({url:c(e,`_t=${Date.now()}`),success:e=>{this.metadata=e.data.metadata,delete e.data.metadata,delete e.data.ScriptLoader,Object.keys(e.data).forEach(t=>{if(this.asset[t]={url:e.data[t].js||null,state:-1},e.data[t].dependency){var n=e.data[t].dependency;this.asset[t].dep=n,Object.keys(n).forEach(e=>{this.asset[e]={url:n[e],state:-1}})}}),this.assetLoaded=!0,this.dispatch("SL-INIT"),t?.(),this.evtArr.forEach(e=>{this.dispatch(e.eventName,e.detail)})},fail:e=>{}}):n?.({code:1,msg:"load error"}))},load(e,t,n,r){void 0===t&&(t=s),void 0===n&&(n=s),void 0===r&&(r=0);var{asset:i,cache:o}=this;if(!this.assetLoaded&&"React"!==e)return void this.listen("SL-INIT",()=>{this.load(e,t,n,r)});this.tryload(i,o,e,t,n,r)},tryload(e,t,i,o,a,c){void 0===o&&(o=s),void 0===a&&(a=s),void 0===c&&(c=0);var l=this;return(0,r._)(function*(){try{if(void 0!==e[i])if(void 0===t[i]&&c<h){if(e[i].dep){var r=[];Object.keys(e[i].dep).forEach(s=>{if(n.g[s])t[s]=n.g[s],e[s].state=0;else if(void 0===t[s]&&-1===e[s].state){var u=l.loadScriptProcess({asset:e,cache:t,mod:s,parentModule:i},o,a,c);e[s].loading=u,r.push(u)}else{var h=e[s];h.loading&&r.push(h.loading)}}),yield Promise.all(r)}-1===e[i].state?l.loadScriptProcess({asset:e,cache:t,mod:i,parentModule:i},o,a,c):l.listenModuleLoad(i,()=>{o(l.cache[i],l.cache)})}else t[i]&&l.firstLoaded[i]&&l.checkAllLoaded(e,i)&&(o(t[i],t),l.firstLoaded[i]=!0);else console.error(`${i} is not found.`),a?.({code:1,msg:`${i} is not found.`})}catch(e){a?.({code:2,msg:e})}})()},loadScriptProcess(e,t,r,o){var{asset:a,cache:s,mod:c,parentModule:l}=e;return new Promise((e,_)=>{var A=(0,i.ej)("env_id")?a[c].url:u.findRequestUrl(a[c].url,o),d=null;d=this.createScript(A),a[c].state=1,d?.addEventListener("load",()=>{n.g[c]&&(u.emitLoadSuccessEvent(A,{resourceType:"JS",retryCount:o}),s[c]=n.g[c],a[c].state=0,!this.firstLoaded[l]&&this.checkAllLoaded(a,l)&&t(s[l],s),this.dispatch(`SL_MODULE_LOAD_${c}`),e())}),d?.addEventListener("error",()=>{u.emitLoadFailedEvent(A,{resourceType:"JS",retryCount:o}),o+1>=h?(a[c].state=2,_()):a[c].state=-1,a[c].url=A,this.load(c,function(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];t?.apply(null,r),e()},r,o+1),d&&this.removeScript(d),r?.({code:3,msg:"load error"})})})},checkAllLoaded(e,t){var r=e[t];if(0!==e[t].state)return!1;if(void 0!==r.dep){for(var i=Object.keys(r.dep),o=0,a=i.length;o<a;o++)if(!n.g[i[o]])return!1}return this.firstLoaded[t]=!0,!0},createScript(e){var t=document.createElement("script");return t.src=e,t.async=!1,t.type="text/javascript",t?.setAttribute("crossorigin","anonymous"),document.body.appendChild(t),t},removeScript(e){e?.parentNode&&e.parentNode.removeChild(e)},ajax(e){var t,n=((t={}).url=e.url,t.paramObj=e.param||{},t.success=e.success||s,t.fail=e.fail||s,t.method=String.prototype.toUpperCase.apply(e.ajaxType||"GET"),t),r=function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(`${n}=${encodeURIComponent(e[n])}`);return t.join("&")}(n.paramObj),i=c(n.url,r),o=function(){for(var e=null,t=[function(){return new XMLHttpRequest},function(){var{XDomainRequest:e}=window;return new e},function(){return new window.ActiveXObject("Msxml2.XMLHTTP")},function(){return new window.ActiveXObject("Msxml3.xmlhttp")},function(){return new window.ActiveXObject("Microsoft.XMLHTTP")}],n=0,r=t.length;n<r;n++){try{e=t[n]()}catch(e){continue}break}return e}();if(!o)throw Error("XMLHttp is not defined");o.open("GET",i,!0),o.onreadystatechange=()=>{if(4===o.readyState)if(200===o.status){var e=JSON.parse(o.responseText);n.success({data:e,code:0})}else n.fail({code:o.status})},o.onerror=()=>{n.fail({code:-1})},o.send()},dispatch(e,t){if(!this.assetLoaded)return void this.evtArr.push({eventName:e,detail:t});var r=new window.CustomEvent(e,{detail:t});n.g.dispatchEvent(r)},listen(e,t){void 0===t&&(t=s),this.events[e]||(this.events[e]=[]),this.events[e].push(t),window.addEventListener(e,t)},remove(e,t){if(this.events[e]){var n=this.events[e].indexOf(t);-1!==n&&(this.events[e].splice(n,1),window.removeEventListener(e,t))}},removeAllEvent(){Object.keys(this.events).forEach(e=>{this.events[e].forEach(t=>{this.remove(e,t)})})},listenModuleLoad(e,t){void 0===t&&(t=s),this.listen(`SL_MODULE_LOAD_${e}`,t)}};n.g.ScriptLoader||(n.g.ScriptLoader=_),n.g.SLR=n.g.ScriptLoader},431533:function(e,t,n){n.r(t),n.d(t,{showAlert:function(){return s}});var r=n(388896),i=n(496950),o=n(384341),a=function(){function e(e){this.buttonMenuDom=$(".hp-ui-button-menu"),this.menuDom=$(".hp-ui-button-menu-wrapper a"),this.type=e.type,this.title=e.title,this.content=e.content,this.inputMaxLength=e.inputMaxLength,this.inputOverflowTips=e.inputOverflowTips,this.buttons=e.buttons,this.onClose=e.onClose,this.dialogDom=null,this.dialogInputDom=null,this.dialogInputErrorDom=null,this.init()}var t=e.prototype;return t.createDom=function(e,t,n){var r=$(document.createElement(t));return r.addClass(n),e.append(r),r},t.show=function(){this.dialogDom=this.createDom($(document.body),"div","m-component-dialog"),this.dialogDom.on("touchmove",e=>{e.preventDefault()}),this.createDom(this.dialogDom,"div","m-component-dialog-mask").on("touchstart touchend",e=>{e.preventDefault()});var e=this.createDom(this.dialogDom,"div","m-component-dialog-body"),t=this.createDom(e,"div","m-component-dialog-title");this.title&&this.title.length>0&&t.text(this.title),t.on("touchstart touchend",e=>{e.preventDefault()});var n=this.createDom(e,"div","m-component-dialog-content");if("InputBox"===this.type){e.addClass("m-component-dialog-body-input"),document.body.clientHeight<500&&((0,i.gr)()?e.css("top",96):e.css("top",72));var r=this.createDom(n,"div","m-component-dialog-input-box"),o=r[0].clientWidth-28;this.dialogInputDom=this.createDom(r,"input","m-component-dialog-input"),this.dialogInputDom.css("width",o),this.dialogInputDom.attr("spellcheck","false"),this.dialogInputDom.attr("required","required"),this.content&&this.content.length>0&&this.dialogInputDom.val(this.content),this.bindInputListener(this.dialogInputDom);var a=this.createDom(r,"div","m-component-dialog-input-clear");this.addTap(a,()=>{this.dialogInputDom.val(""),this.inputBoxValChange()}),this.dialogInputErrorDom=this.createDom(n,"div","m-component-dialog-input-error-hidden");var s=document.createElement("p");this.dialogInputErrorDom.append(s),n.append(this.dialogInputErrorDom)}else this.content&&this.content.length>0&&this.createDom(n,"div","m-component-dialog-message").text(this.content);for(var c=this.createDom(e,"div","m-component-dialog-footer"),l=0;l<this.buttons.length;l++){var u=this.buttons[l];if(u.label&&u.label.length>0){var h=$(document.createElement("a"));h.addClass("m-component-dialog-button");var _="m-component-dialog-btn-default";"primary"===u.type?_="m-component-dialog-btn-primary":"danger"===u.type&&(_="m-component-dialog-btn-danger"),h.addClass(_),h.text(u.label),c.append(h),this.bindButtonListener(h,u)}}"InputBox"===this.type&&this.focusInputBox()},t.close=function(){this.onClose?.(),this.dialogDom.remove()},t.getInputText=function(){return this.dialogInputDom.val()},t.showInputErrorTips=function(e){this.dialogInputErrorDom.addClass("m-component-dialog-input-error"),this.dialogInputErrorDom.children("p").text(e),this.focusInputBox()},t.checkInputError=function(){var e=!1;if(this.inputMaxLength&&this.inputMaxLength>0&&this.dialogInputDom.val().length>this.inputMaxLength){var t=r.ZP.t("\u8F93\u5165\u5185\u5BB9\u8FC7\u957F\u3002");this.inputOverflowTips&&this.inputOverflowTips.length>0&&(t=this.inputOverflowTips),this.showInputErrorTips(t),e=!0}return e},t.focusInputBox=function(){o.default.isIOS?this.dialogInputDom.focus():setTimeout(()=>{this.dialogInputDom.focus().click()},100)},t.inputBoxValChange=function(){this.checkInputError()&&this.dialogInputErrorDom.removeClass("m-component-dialog-input-error")},t.bindInputListener=function(e){e.on("input propertychange change",()=>{this.inputBoxValChange()}),e.blur(()=>{if(o.default.isIOS)for(var e=0;e<this.buttons.length;e++){var t=this.buttons[e];if("primary"===t.type){t.onclick&&"function"==typeof t.onclick&&t.onclick(this);break}}})},t.bindButtonListener=function(e,t){var n=!1,r=e=>{n||(n=!0,t.onclick&&"function"==typeof t.onclick?t.onclick(this,e):this.close())};e.on("touchend",r),e.on("click",r)},t.addTap=function(e,t){e.on("touchstart",function(e){var t=e.originalEvent.touches[0];this.touchX=t.clientX,this.touchY=t.clientY,this.touchT=Date.now()}),e.on("touchend",function(e){e.preventDefault();var n=e.originalEvent.changedTouches[0],r=n.clientX,i=n.clientY;void 0===this.touchT||Date.now()>this.touchT+400||Math.abs(i-this.touchY)>30||Math.abs(r-this.touchX)>30||t()})},t.init=function(){this.buttonMenuDom.on("click",()=>{var e=this.buttonMenuDom;if(!e.attr("disabled")){$("#tooltip").remove();var t=e.hasClass("hp-ui-button-menu-reverse"),n=e.find(".hp-ui-button-menu-wrapper"),r=e.find(".hp-ui-button-list-ul"),i=e.find(".hp-ui-button-list-ul li"),o=-1;if(e.data("close",this.buttonCloseMenu),n.is(":visible"))this.buttonCloseMenu(e);else{r.css("min-width",`${e.outerWidth()}px`),n.show(),e.addClass("hp-ui-button-active");var a=Math.max(200,Math.min($("body").height()-r.offset().top-50,435));r.css("max-height",`${a}px`),t&&r.css("top",`-${r.outerHeight()+e.outerHeight()+10}px`),window.setTimeout(()=>{$("body").on("keydown.hp-ui-button-menu",t=>{if(n.is(":hidden"))return!0;var a=o;switch(t.keyCode){case 13:return r.find("li.hp-ui-button-menuitem-selected > a").trigger("click"),!1;case 27:return this.buttonCloseMenu(e),!1;case 38:o=o-1<0?i.length-1:o-1;break;case 40:o=(o+1)%i.length;break;default:return!0}return r.find(`li:nth-child(${a+1})`).removeClass("hp-ui-button-menuitem-selected"),r.find(`li:nth-child(${o+1})`).addClass("hp-ui-button-menuitem-selected"),!1}).on("click.hp-ui-button-menu",()=>{this.buttonCloseMenu(e)})},0)}}}),this.menuDom.on("click",()=>{if(!this.menuDom.hasClass("hp-ui-button-menu-disabled")){var e=this.menuDom.closest(".hp-ui-button");e.find(".hp-ui-button-menuitem-selected").removeClass("hp-ui-button-menuitem-selected"),this.buttonCloseMenu(e)}})},t.buttonCloseMenu=function(e){$("body").off(".hp-ui-button-menu"),e.find(".hp-ui-button-menu-wrapper").hide(),e.removeClass("hp-ui-button-active"),e.find(".hp-ui-button-menuitem-selected").removeClass("hp-ui-button-menuitem-selected"),e.trigger("menu-closed")},e}(),s=e=>{new a(e).show()}},409688:function(e,t,n){n.d(t,{W:function(){return u}});var r=n(388896),i=n(431533),o=n(976037),a=n(149344),s=n(384341),c=n(393743),l=n(905252),u={info:e=>{var t=l.default.confirm({okText:r.ZP.t("\u786E\u5B9A"),draggable:!1,destroyOnClose:!0,...e,cancelText:e.cancelText||null});return o.ZP.default.trigger(a.W1.UI_SHOW,a.Xs.DIALOG),t},alert:(e,t,l)=>{s.default.isMobilePhone||s.default.isAndroidPad||s.default.isIPad?(0,i.showAlert)({type:"MessageBox",title:e,content:t,buttons:[{type:"primary",label:r.ZP.t("\u786E\u5B9A"),onclick:(e,t)=>{l?.(t),e.close()}}]}):n.g.log.error(c.w.Common,"\u5386\u53F2\u903B\u8F91 showDialog2 \u5DF2\u7ECF\u79FB\u9664"),o.ZP.default.trigger(a.W1.UI_SHOW,a.Xs.DIALOG)},confirm:e=>{l.default.confirm({okText:r.ZP.t("\u786E\u5B9A"),draggable:!1,destroyOnClose:!0,...e,cancelText:e.cancelText||null}),o.ZP.default.trigger(a.W1.UI_SHOW,a.Xs.DIALOG)}}},719523:function(e,t,n){n.d(t,{ZP:function(){return h},zH:function(){return s}});var r=n(434902),i=n(758699),o=function(){function e(){this._ByD={spinner:"data:image/gif;base64,R0lGODlhEAAQAKUAAAQCBHR2dKyurERCRMzKzJSSlGRiZNza3CQmJLy+vKSipISGhFRSVNTS1HRydDQyNLS2tJyenGxqbOTi5MTGxKyqrIyOjDw6PAwKDISChLSytERGRMzOzJSWlGRmZNze3MTCxKSmpIyKjFRWVNTW1DQ2NOLi4gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQJCgAmACwAAAAAEAAQAAAGpUCT0HQQjjbC4nAYeoRMF4QJBJAshYnH4FCSDgCL4SREMDkei6gCgPhM3ITBZkG5eCKdACA0OXw+JiEMGyMNgCYTBB9+bkkiGVcmfxNCGR4eEgKRfYsfAQagFZF/jEIfGhGHYo1CFAsOAQ2UpgelHw4OBQQWFRwgDQl+fpQQICYCIhoQIcAUE2+zJg0WBachBwQgJJEgIgkmy7UJHJEm21MClKwmQQAh+QQJCgAqACwAAAAAEAAQAIUEAgR0dnSsrqxEQkTMysyUkpRcWlwcHhyEhoTc2ty8vrxMTkykoqRkZmR8fnzU0tQ0NjQMDgy0trRkYmQkJiSMjozk4uTExsRUVlSsqqwEBgR8enxERkTMzsycmpxcXlwkIiSMiozc3tzEwsRUUlSkpqRsamyEgoTU1tS8urzi4uIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGpECVUJUQTkhC1HAp4AhUHIjqQtkshSOOIRFVGQ6FoUVAUJ0GhWjmMBB1ECiC4VO4LAIlDwKU2UQAFSoCDQYmKCJCFh0cABomRUQFgVcbJCNCBQ6aKVcqIgmfIiEBGwESnRagoEIiChmISyIiFkMEHiEVKLSJoYiiIQwdGSkoD58WobQjFyojJcsjqsjIQyglrwQKsrKdHSVlFyOzq52QHRe0s0NBACH5BAkKACkALAAAAAAQABAAhQwKDHx6fLSytERGRMzOzJyanCQmJGRiZIyKjMTCxNza3BQWFKSmpDQyNFxaXHRydISChLy+vExOTNTW1KSipGxqbJSSlMzKzOTi5BweHDw6PAwODHx+fLS2tExKTNTS1JyenCwqLGRmZIyOjMTGxNze3BwaHKyurDQ2NOLi4gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAajwJQwpRA+DsLicNhxdFKOQYqk4SyFF4eoFE2JGoUhpkNIjRwgh+fU8JQ+lgnh8aAQDpATZdQ4IUIZYR0BDxwTJUIYBA4ZBgFKCgwgVykIIhdCFBabCZQICyYLAyAjpRGUEACqKIkXEYhLJSUYQx8nDAwKtIklCrIpJbgdEwkXGLK+yLQXHykECQS9srPHu8AJCdPHupQTERPAuhi+lMCJ5BjWQQAh+QQJCgAtACwAAAAAEAAQAIUEAgR0dnSsrqxERkSUkpTMysxcXlwkIiSEhoS8vrykoqTc2txsamw0MjR8fny0trRUUlScmpzU0tRkZmSMjozExsSsqqzk4uR0cnQ8OjwUEhR8eny0srRMSkyUlpTMzsxkYmQsKiyMiozEwsSkpqTc3txsbmw0NjSEgoS8urxcWlycnpzU1tTi4uIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGo8CWsFUSojDCxXCZwCRaDEOr0KEshQWMoxRtYQaK4SXBakUwluhjYLhIPAuWSCSQBDwcQWTwIGQaKy0JBCJwRUQSEw0nKIclHBZXLRQYFUIPFpkFkh4nDQ0qHCSjm1cUIQchEEIXLB8XVyYmZUkVCSMlsEIlBwAaIkQjCQULJbnGJRIGAAAkLSxKJcXSF9MpAYdE1NsLukvVRcYXyJItutTm2UEAIfkECQoAKwAsAAAAABAAEACFBAIEdHZ0tLK0PD48lJKUzM7MXFpchIaExMLEpKKkJCIk3NrcTEpMdHJ0fH58vLq8nJqcZGJkHB4cREZE1NbUjI6MzMrMrKqsPDo85OLkBAYEfHp8tLa0REJElJaU1NLUXF5cjIqMxMbEpKakLC4s3N7cTE5MhIKEvL68nJ6cZGZk4uLiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABqPAlXBVEhIOwuJwKAqJVqfAqgCCLIWfEKHkkJ4Ml2HGQlldQpzow9AoURIUymiEolRGD07CwEmZJmEWFyMXC0oZFAETDBULSQgPVysQDhZCFgiZZVcpHZ4qIggoCJtLHhioBkIZJSUZV1GlrSULGa9CFAMKJB4rrIYZwFwaCQ0SCgJEr7O0EAAkJQgHjqsLtbQlGAAhkrNErhwaEZK+SbVTSitBACH5BAkKACkALAAAAAAQABAAhQQCBHR2dKyurDw+PJSSlFxaXMzOzKSipGxqbISGhNza3CQiJLy+vExOTJyanGRiZISChNTW1KyqrHRydIyOjOTi5DQyNMTGxFRWVBweHHx6fLS2tERGRJSWlFxeXNTS1KSmpGxubIyKjNze3MTCxFRSVJyenGRmZDw6POLi4gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAaiwJQwNRIeHMLicGgAGVIdSuoTAC2FEZCkQpASJpthJaJIMQ6kKGmSGEUkihGDZFCANheSJEQCPQoCKREkcyMVQmMJBR4OSiMfT1cHIpEjIwpxVykgGJ0Bl5ZKSwcNpQiIlodLIhBlSaAVqoINFgMmKRWwcSYIIgsgGhYWYYZEcSgAFBkcIyQUrrhxFRYABiUZSFegKcgGDAsTmrhCJwtlBqJBACH5BAkKACsALAAAAAAQABAAhQQCBHR2dKyurDw+PJSSlMzKzFxeXISGhLy+vKSipNza3BweHExOTGxqbHx+fLS2tJyanNTS1GRmZIyOjMTGxKyqrOTi5DQyNFRWVBQWFHx6fLSytERGRJSWlMzOzGRiZIyKjMTCxKSmpNze3FRSVHRydISChLy6vJyenNTW1DQ2NOLi4gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAalwJVwZRE+NsLRcJkKpVYV0SoyQS5XCgTFEl0lQIihZVT0ICICUQHUsaQeirFiNAoV7g9QQaApPVZ0c2RJCh0lASJKRINXFRARhCNzVysCEg0SJpKblBUfBh8OQmOMQwQTCkN0kpNCCgYcJFJyIxEZDCIaBBcCBxwcJ4BFBgASJAsdFxgWFBCKKycAGSnHEQYXEJQEACArDAseIReilAVCGgOpEc9BACH5BAkKAC0ALAAAAAAQABAAhQQCBHR2dKyurERCRJSSlMzKzFxeXISGhLy+vKSipNza3BweHFRWVGxubHx+fLS2tExKTJyanNTS1DQyNGRmZIyOjMTGxKyqrOTi5CQmJAQGBHx6fLSytERGRJSWlMzOzGRiZIyKjMTCxKSmpNze3CQiJFxaXHRydISChLy6vExOTJyenNTW1OLi4gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAamwJawhREWLELScEkiFUWiFuuCWAoxiqYl+hgVhhhni5TdfkYcMsJJZpNYEstIkqqEos0spkhUJEIVaVdNVi0pIyxJWVmFDygODgRtjFYcARsBFUkoDApWKxGeQhcZABoWSkIKDSYUAi0KAAADAhMgFwcREBwEBiZRISstJwsbJhMrHRQkBQmpLSIlEywGEx8NHReFKwseLdUfFhAHhS0fQigQShLPQQAh+QQJCgAqACwAAAAAEAAQAIUMCgx8eny0srREQkTMzsyUlpRcXlwkIiTEwsSMiozc2tykpqQUFhRsbmy8urxUVlSEgoTU1tScnpw0MjTMysyUkpTk4uSsrqwcHhx0dnQMDgx8fny0trRERkTU0tRsamwkJiTExsSMjozc3tysqqwcGhx0cnS8vrxcWlykoqTi4uIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGpECVUGURjkbC4nB4LCqQCgRhmXwekZRTZGgZFUdWheIU6lK8YDTac1KEFguK6vjsJkecBQmBJB6pKhQOWyoDDAwlIoAIFY0LEwAAGgmADiKXKUYiHwpUJAudQgIDGCBnQwoQJgEcKgoYGCgcAx8CIgsGDhIZJiEqBRcqARMbDR0kKBkjBBd9KggTAxENAx4BKMFUjxIqHx0eIQYFgCpTKgkGUM5BACH5BAkKACsALAAAAAAQABAAhQQCBHR2dKyurERGRMzKzJSSlGRiZLy+vNza3KSipCwqLISGhFRSVLS2tNTS1JyanGxubBQSFHx+fExOTMTGxOTi5KyqrDQyNIyOjFxaXHx6fLSytExKTMzOzJSWlGRmZMTCxNze3KSmpIyKjFRWVLy6vNTW1JyenHRydBwaHDQ2NOLi4gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAaiwJVwVRGGQsLicHgsIpCV5zL5PCJD0uTosMIeEdFQJWSqHACAjKNpDTlAB9NqEQGkxMkK4QBaC00fJFMrDh1IKyQXig+DBBaPDRwKkx6DFCIiFg1GHgEIUw0NhysNExcqBKMhDyMFXAiKBiUMGg0PAgEgAiMjHSsnAnMDGBIZGygLFR0loxQcDAgaGSYYKJtTFgMiK9ImHSgJg4RCHhBIWStBACH5BAkKACsALAAAAAAQABAAhQQCBHx6fLSytERCRMzOzJSWlFxeXCQiJMTCxKSmpNza3IyKjFRWVGxqbBwaHLy6vJyenDQ2NExKTNTW1GRmZMzKzKyurOTi5JSSlAwODISChLS2tERGRNTS1JyanGRiZCwuLMTGxKyqrNze3IyOjFxaXHRydBweHLy+vKSipDw6POLi4gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAahwJVwNRGORsLLcOkBFFYjxepyXAo3AMekGkUmC4gVA9A4XhSjC/WCOB1MqAyHGqWjVwXQKUKQTqloaUITAQ1WUIIrHwOMKYcdCJEVDCoRKh6PKAgoFUYQGl5DIQihDx8cEgShIxYJIp0KHBxwFAsoCQ8kFbcJHSsJGysYJR4kJg8LHhcTIUpCFQYUCsYTKbaHAiUWK9QdJNuHRb+gKwrOK0EAIfkECQoAKgAsAAAAABAAEACFBAYEfHp8tLK0PD48zM7MlJaUXFpcJCIkxMLEpKak3NrcjIqMbGpsLC4svLq8TE5MnJ6cHB4chIKE1NbUZGZkzMrMrK6s5OLkNDY0DAoMfH58tLa0REJE1NLUnJqcXF5cLCosxMbErKqs3N7cjI6MdHJ0NDI0vL68VFZUpKKk4uLiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABp5AlVClEA4awstwmYqkVBGA6jIaLYWng0kRVY0U1iQEoaJENJHMBXyhXkImUyAEMhQWX+rX6jlyOkVeVGAjSioTEiVXXoVCJSiQIotVhBQPl09Xa3tJIiRhQx0Ehionjx8doBcIrBNeBgYSCBoFIQIhCaInCK4WDioQJQkpC7gCa6lDBCUaChALCgIpFYumGyrEExMJZIuuKgIFSgqkQQA7"},this._bCO={},this.init(this._ByD,this._bCO)}return e.prototype.init=function(e,t){for(var n=Object.keys(e),r=0;r<n.length;r++){var i=n[r],o=e[i];t[i]=o}},e}(),a=n(384341),s={CENTER:"CENTER",LEFT:"LEFT"},c={LEFT:8},l=function(){function e(e){var t=this;this._Awm=0,this._AwM=0,this._bAs=null,this.show=(0,r._)(function*(){var{spinner:e}=new o()._bCO;t._Avb();var n=t._bAR===s.LEFT?`${c[t._bAR]}px center`:"center center";Object.assign(t._bAp.style,{position:"absolute",backgroundColor:"E2E2E2",borderColor:"#E2E2E2",zIndex:1,background:`url("${e}") no-repeat`,backgroundPosition:n,display:"flex",alignItems:"center",justifyContent:"center"}),t._AWs=!0,t._Ry=!0,t._bAp.onclick=t._bAS,t._bAP.appendChild(t._bAp)}),this.hide=()=>{this._AWs=!1,this._bAP.contains(this._bAp)&&this._bAP.removeChild(this._bAp),this._AwP(!1)},this.cancelUpload=()=>{this._Ry=!1,this.hide()},this.getPositionInfo=()=>({row:this._kH,col:this._ki}),this._Awn=()=>{this._AWs=!0,this._bAp.style.display="flex"},this._AwN=()=>{this._AWs=!1,this._bAp.style.display="none"},this._Awp=e=>{if(e===this.sheetId)return this._Awn();this._AwN()},this._AwP=e=>{var{inputManager:t,areaData:n}=this._bAO;t.emitter[e?"on":"off"](t.EVENT.VALUE_CHANGE,this.cancelUpload),e?this._bAs=n.onUpdateOffset(this._AwQ):(this._bAs?.dispose(),this._bAs=null),e?(this._bAQ=this._ms.onSwitchSheetEvent(e=>this._Awp(e.sheetId)),this._bAr=this._ms.onAddSheetEvent(e=>this._Awp(e))):(this._bAr.dispose(),this._bAQ.dispose())},this._bAS=()=>{var{inputManager:e}=this._bAO;e.handleEnterInput(this._kH,this._ki),e.focus()},this._Avb=()=>{var{areaData:e,headSize:t,clientRect:n,transformTable:r}=this._bAO,{_ki:i}=this,{_kH:o}=this,a=r.getCellBackgroundHeight(this._kH,this._ki),s=r.getCellBackgroundWidth(this._kH,this._ki),c=e.getDisplayViewTopByRow(o),l=r.getMergeData(o,i);l&&(o+=l.rowCount-1);var u=e.getDisplayViewBottomByRow(o),h=n.height-t.displayColHeadHeight;this._bAp.style.bottom=`${h-c}px`,this._bAp.style.top=`${u-a}px`;var _=e.getDisplayViewLeftByCol(i);this._bAp.style.left=`${_}px`,this._bAp.style.width=`${s}px`,this._bAp.style.height=`${a}px`,this._Awm=e.getDisplayViewLeftByCol(i),this._AwM=e.getDisplayViewTopByRow(o)},this._AwQ=()=>{var{areaData:e,transformTable:t}=this._bAO,{_ki:n}=this,{_kH:r}=this,i=t.getMergeData(r,n);i&&(r+=i.rowCount-1);var o=e.getDisplayViewLeftByCol(n),a=e.getDisplayViewTopByRow(r);this._bAp.style.transform=`translate(${o-this._Awm}px, ${a-this._AwM}px)`},this._ms=e.sdkSheetsBarService,this._bAO=e.canvas,this._bAP=e.canvas.mainBoard.element,this._bAq=e.canvas.operateBoard.board,this._kH=e.row,this._ki=e.col,this.sheetId=e.sheetId,this._AWs=!1,this._bAp=document.createElement("div"),this._bAp.id=`loading-${this.sheetId}-${this._kH}-${this._ki}`,this._bAp.classList.add("copy-paste-loading"),this._bAR=e.loadingAlign,this._AwP(!0)}var t=e.prototype;return t._CGj=function(){this._CGJ(),this._bAt();var e=this._bAR===s.LEFT?`${c[this._bAR]}px center`:"center center";Object.assign(this._bAp.style,{position:"absolute",borderColor:"#E2E2E2",zIndex:1,backgroundPosition:e,display:"flex",alignItems:"center"}),this._AWs=!0,this._Ry=!0,this._bAq.appendChild(this._bAp)},t._CGJ=function(){var{inputManager:e}=this._bAO;e.emitter.off(e.EVENT.VALUE_CHANGE,this.cancelUpload)},t._CGk=function(){this._AWs=!1,this._bAq.contains(this._bAp)&&this._bAq.removeChild(this._bAp),this._AwP(!1)},t._CGK=function(){return this._bAp},t._bAt=function(){var{areaData:e,headSize:t,clientRect:n,transformTable:r}=this._bAO,{_ki:i}=this,{_kH:o}=this,s=r.getCellBackgroundHeight(this._kH,this._ki),c=r.getCellBackgroundWidth(this._kH,this._ki),l=e.getDisplayViewTopByRow(o),u=r.getMergeData(o,i);u&&(o+=u.rowCount-1);var h=e.getDisplayViewBottomByRow(o),_=n.height-t.displayColHeadHeight,A=2*!!a.default.isMobile;this._bAp.style.bottom=`${_-l}px`,this._bAp.style.top=`${h-s+t.displayColHeadHeight+A}px`;var d=e.getDisplayViewLeftByCol(i);this._bAp.style.left=`${d+t.displayRowHeadWidth}px`,this._bAp.style.width=`${c-A}px`,this._bAp.style.height=`${s-A}px`,this._Awm=e.getDisplayViewLeftByCol(i),this._AwM=e.getDisplayViewTopByRow(o)},(0,i._)(e,[{key:"isVisible",get:function(){return this._AWs}},{key:"isValid",get:function(){return this._Ry}}]),e}(),u=(e,t,n)=>`${n}-${e}-${t}`,h=function(){function e(){}return e.createInstance=function(t,n,r,i,o,a){void 0===a&&(a=s.CENTER);var c=new l({sdkSheetsBarService:t,canvas:n,row:r,col:i,sheetId:o,loadingAlign:a});return e.value.set(u(r,i,o),c),c},e.getInstance=function(t,n,r){return e.value.get(u(t,n,r))},e.removeInstance=function(t,n,r){var i=u(t,n,r),o=e.value.get(i);o&&(e.value.delete(i),o.hide())},e}();h.value=new Map},37260:function(e,t,n){if(n.r(t),n.d(t,{getToast:function(){return c},hideToast:function(){return d},initToast:function(){return A},showToast:function(){return l},showVipToast:function(){return h}}),7719==n.j)var r=n(434902);if(7719==n.j)var i=n(384341);var o=n(991880),a=n(846711),s=n(956361),c=()=>n.e("912").then(n.bind(n,75907)),l=(e,t,n,r)=>{c().then(i=>{i.showToast(e,t,n,r)})},u=null;function h(e){return new Promise(t=>{!function(e,t){_.apply(this,arguments)}(e,t)})}function _(){return(_=(0,r._)(function*(e,t){if(u)t(u.show(e));else{var n=i.default.isMobilePhone||i.default.isAndroidPad||i.default.isIPad?o.C.name:a.P.name;(0,s.f)()?.getExtension(n).then(n=>{t((u=n).show(e))})}})).apply(this,arguments)}var A=7719==n.j?c:null,d=()=>{c().then(e=>{e.hideToast()})}},676417:function(e,t,n){n.d(t,{RJ:function(){return o},Zm:function(){return c},fP:function(){return s}});var r=n(434902),i=n(890984);function o(){return a.apply(this,arguments)}function a(){return(a=(0,r._)(function*(){return yield(0,i.E)().getVipInfoForFetch()})).apply(this,arguments)}function s(){return(0,i.E)().getVipInfo()}function c(){switch(s().type){case"SUPER":return"svip_user";case"NORMAL":return"vip_user";default:return"novip_user"}}},150061:function(e,t,n){n.d(t,{AJ:function(){return E},L1:function(){return v},Lv:function(){return g},M$:function(){return A},ee:function(){return T},yc:function(){return f}});var r,i,o=n(434902);n(575739);var a=n(384341),s=n(465544),c=n(45865),l=n(450586),u=n(167091),h=n(938547);"undefined"!=typeof window&&(a.default.isMobilePhone&&(r=300),(a.default.isIPad||a.default.isAndroidPad)&&(i=600));var _=r||i||1500,A={CONTAIN:0,COVER:1},d=function(){function e(){var e=this;this._oa=16,this._oA=0,this._BS=[],this._ob=new s.Z(_),this._oB=0,this._oc=0,this._oC=new Set,this._cnE=(0,o._)(function*(t){try{return yield e._od(g(t),{shouldSkipCache:!0,shouldConsiderCORS:!0})}catch(e){throw l.ZP.wdocs({module:u.ENTERPRISE_REPORT_MODULE.GET_IMAGE,action:u.ENTERPRISE_REPORT_ACTION.FAIL,str1:(0,h.Q)(e),str2:e?.stack}),e}}),this._cnf=(0,o._)(function*(t,n,r){try{var i=g(t),o=e._cnA(i);if(!o)return yield e._od(i,{compressOptions:n,shouldSkipCache:!1,shouldConsiderCORS:!0,...r});if(!n||!p(i))return;var{naturalWidth:a,naturalHeight:s}=v(o),{width:c,height:_}=n;if(_<=s&&c<=a)return;var A=yield e._od(i,{compressOptions:n,shouldSkipCache:!1,shouldConsiderCORS:!0,...r});if(A.naturalWidth>a||A.naturalHeight>s)return A}catch(e){throw l.ZP.wdocs({module:u.ENTERPRISE_REPORT_MODULE.GET_IMAGE,action:u.ENTERPRISE_REPORT_ACTION.FAIL,str1:(0,h.Q)(e),str2:e?.stack}),e}}),this._od=(0,o._)(function*(t,n){return e._oA<e._oa?yield e._of(t,n):yield e._oe(t,n)})}var t=e.prototype;return t.loadImage=function(e,t){var n=this;return(0,o._)(function*(){var r,i=g(e),{shouldSkipCache:o=!1}=t||{};return!o&&(r=n._cnA(i))?r:yield n._od(i,t)})()},t._cCO=function(e){var t=this;return(0,o._)(function*(){try{var r=yield fetch(e,{method:"HEAD"});if(!r.ok)return t._oC.add(e),"";return r?.headers.get("Content-Type")||""}catch(r){return t._oC.add(e),n.g.log?.error(r),""}})()},t._cnA=function(e){return this._ob.get(g(e))},t.clearCache=function(){this._ob.clear(),this._oC.clear()},t._cnb=function(e){return this._oC.has(g(e))},t._oD=function(e,t){var n=this;return(0,o._)(function*(){var r,i=t;if("function"==typeof window.createImageBitmap)try{if(r=e,/\.svg/.test(r)){var{naturalWidth:o,naturalHeight:a}=t,s=document.createElement("canvas");s.width=o,s.height=a;var c=s.getContext("2d");c?.drawImage(t,0,0),i=yield createImageBitmap(s)}else i=yield createImageBitmap(t)}catch(e){console.error("createImageBitmap error: ",e)}n._ob.set(g(e),i)})()},t._oe=function(e,t){var n=this;return(0,o._)(function*(){return new Promise(r=>{n._BS.push({url:e,callback:e=>{r(e)},requestOptions:t})})})()},t._oE=function(){var e=this;return(0,o._)(function*(){var t=e._BS.pop();if(t){var n=yield e._of(t.url,t.requestOptions);t.callback(n)}})()},t._Bv=function(){this._oA-=1,this._BS.length>0&&this._oE()},t._of=function(e,t){void 0===t&&(t={});var n=this;return(0,o._)(function*(){var{shouldSkipCache:r=!1,shouldConsiderCORS:i=!0,compressOptions:a}=t;return new Promise((t,s)=>{var c=new Image;i&&(c.crossOrigin="anonymous"),c.onload=(0,o._)(function*(){n._oB+=1,n._Bv(),r||(yield n._oD(e,c)),t(c)}),c.onerror=()=>{n._oc+=1,c.onload=null,c.onerror=null,n._Bv(),n._oC.add(g(e)),s(`Get Image Error: ${e}`)},c.src=a?E(e,a,!0):e,n._oA+=1})})()},e}(),f=(e,t,r)=>{var{width:i,height:o}=e,{clipBottom:a=0,clipLeft:s=0,clipRight:c=0,clipTop:l=0}=e.clipInfo||{},u=i/o,h=(i+s+c)/i,_=(o+l+a)/o;return u>t/r?{width:t*h*n.g.devicePixelRatio,height:t/u*_*n.g.devicePixelRatio,strategy:A.COVER}:{width:r*u*h*n.g.devicePixelRatio,height:r*_*n.g.devicePixelRatio,strategy:A.COVER}},E=(e,t,n)=>{if(!n||!c.Z.getConfig("custom.imageThumbnail")||!C(e))return e;var r=e.match(/.*\.(\w+)\b/)?.[1]||"",i=c.Z.getConfig("custom.imageThumbnailIgnore");if(r&&i&&i.includes(r))return e;var{width:o,height:a,strategy:s}=t,l=50*Math.ceil(o/50),u=Math.round(l*a/o);return R(new URL(g(e)),l,u,s)};function g(e){return e?e.indexOf("//wdoc-75389.picgzc.qpic.cn/")<0?e:e.replace("//wdoc-75389.picgzc.qpic.cn/","//wdcdn.qpic.cn/"):""}var R=(e,t,n,r)=>{var i,o=Number(e.searchParams.get("w")),a=Number(e.searchParams.get("h"));if((!t||o<=t)&&(!n||a<=n))return e.href;if(T(e.href)){i=`${e.origin}${e.pathname}?imageView2`;var s=r===A.COVER?"3":"2";return`${i}/${s}${0===t?"":`/w/${t}`}${0===n?"":`/h/${n}`}|imageMogr2/ignore-error/1`}i=`${e.origin}${e.pathname}`;var l=c.Z.getConfig("custom.imageThumbnailPath");if(!l)return i;var u=0===t?"":`${t}`,h=0===n?"":`${n}`,_=l.replace(/\{width\}/,u).replace(/\{height\}/,h);return`${i}${_}`},C=e=>!!e&&!(e.length<1)&&e.search(/docimg([0-9]|10)\.docs\.qq\.com/)>=0,T=e=>!!e&&!(e.length<1)&&(e.indexOf("picgzc.qpic.cn")>0||e.indexOf("wdcdn.qpic.cn")>0),p=e=>C(e)||T(e);function v(e){return e instanceof HTMLImageElement?e:{naturalWidth:e.width,naturalHeight:e.height}}t.ZP=new d},484893:function(e,t,n){n.d(t,{C4:function(){return A},Fs:function(){return E},Gs:function(){return l},Ii:function(){return R},JE:function(){return d},KF:function(){return _},kx:function(){return h},p8:function(){return C},pB:function(){return u},ry:function(){return g},wc:function(){return f}});var r=n(881739),i=n(812746),o=n(735926),a=n(529207),s=n(32235),c=n(888065);function l(e){var t=e.match(/^([\d\\.]+)%$/);if(!t)return null;var n=Number(t[1]);return isNaN(n)||n<0||n>100?null:n}function u(e,t){if(e.activeSheet){var n=t.getActiveCell();if(n){var i=e.activeSheet.getCellDataAtPosition(n.rowIndex,n.colIndex);return i?(0,r.Q0)(i,e):(0,r.dH)(e.activeSheet,n.rowIndex,n.colIndex)}}}function h(e,t){if(e.activeSheet){var n=t.getActiveCell();if(n)return(0,c.Ud)(e.activeSheet,n.rowIndex,n.colIndex)}}function _(e,t){var n=u(e,t);return!!n?.getFontBold()}function A(e,t){var n=u(e,t);return!!n?.getFontItalic()}function d(e,t){var n=u(e,t);return n?.getFontUnderline()===a.U.Single}function f(e,t){var n=u(e,t);return!!n?.getFontStrike()}function E(e,t,n){var r=e.getCellDataAtPosition(t,n),i=r?.getMergeReference();return i?{row:i.startRowIndex,col:i.startColIndex}:{row:t,col:n}}function g(e,t,n){var i=(0,r.$e)(e,t,n);return!i||""===i.toString().replace(/[\u200B-\u200D\uFEFF]/g,"")}function R(e,t,n){var r=e.activeSheet.getCellDataAtPosition(t,n);return r?.getDataValidation()}function C(e){var t=e.getFormattedValue();return e?.getType()===o.d.Formula&&e.getCellFormulaResult()?.type===s.j.Error?i.z4[e.getCellFormulaResult()?.value]:e?.getType()===o.d.Error?i.z4[e.getValue()]:t?.value??""}},318783:function(e,t,n){n.d(t,{$4:function(){return u},WG:function(){return l},_H:function(){return c},bQ:function(){return s},qh:function(){return o},xS:function(){return a}});var r=n(115089),i=n(470484);function o(){return!!((0,i.$0)()||(0,i.Yw)())||a()}function a(){return -1!==["local","new"].indexOf(r.q.getConfig("padStatus"))}var s=()=>r.q.getConfig("preview"),c=()=>n.g.self!==n.g.top&&s(),l=()=>{try{return n.g.parent.__DRIVE_PAD_ID}catch(e){n.g.log.error("getDriverId error",e)}},u=()=>s()&&r.q.getConfig("isOwner")},837934:function(e,t,n){n.d(t,{EC:function(){return u},hR:function(){return l}});var r,i,o=n(388896),a=n(37260),s=n(895244),c=n(524112);function l(){return(0,c.gX)()?o.ZP.t("\u65E0\u6CD5\u590D\u5236\uFF0C\u7BA1\u7406\u5458\u5DF2\u7981\u6B62\u6210\u5458\u590D\u5236\u5185\u5BB9\u3002"):o.ZP.t("\u65E0\u6CD5\u590D\u5236\uFF0C\u7BA1\u7406\u5458\u5DF2\u7981\u6B62\u8BE5\u6743\u9650")}function u(e){return e?o.ZP.t("\u7531\u4E8E\u7BA1\u7406\u5458\u6743\u9650\u8BBE\u7F6E\uFF0C\u4EC5\u7BA1\u7406\u5458\u53EF\u5BFC\u51FA\u6587\u6863\u5185\u5BB9\u3002"):o.ZP.t("\u7531\u4E8E\u7BA1\u7406\u5458\u6743\u9650\u8BBE\u7F6E\uFF0C\u6587\u6863\u4EC5\u6D4F\u89C8\u6210\u5458\u65E0\u6CD5\u5BFC\u51FA\u6587\u6863\u5185\u5BB9\u3002")}var h=e=>{(0,a.showToast)(e,{},{showCloseBtn:!1,toolToastCloseTime:3e3})};r=()=>{(0,s.showSnackbar)({message:l(),type:"info",autoClose:!1,closable:!0,className:"only-tips mobile"})},i=!1,(e,t)=>i?(t&&h(t),!0):(r(e),i=!0,!1)},491820:function(e,t,n){n.d(t,{Y:function(){return s},q:function(){return a}});var r=n(388896);if(7719==n.j)var i=n(80295);var o=n(115089);function a(e){return!!e.activeSheet.customSheetViewManager.getActiveGuid()}function s(e){var t=e.activeSheet.customSheetViewManager.getAllCustomSheetViews(),n=o.q.getConfig("userName"),a=n.length>16?`${n.substring(0,16)}...`:n,s=r.ZP.t("{{userNick}} \u7684\u89C6\u56FE",{userNick:a}),c=-1;return t.forEach(e=>{var t=e.getName();if(t&&0===t.indexOf(s)){var n=Number(t.substring(s.length+1));(0,i.default)(n)||(c=Math.max(c,n))}}),-1===c?s:`${s} ${c+1}`}},260261:function(e,t,n){function r(e,t,n){var r=e.getCurrentViewAccessor(),i=t+n;if(-1===n){for(;i>=0;--i)if(!r.isRowHidden(i))return i}else for(;i<e.getRowCount();++i)if(!r.isRowHidden(i))return i;return -1}function i(e,t,n){var r=e.getCurrentViewAccessor(),i=t+n;if(-1===n){for(;i>=0;--i)if(!r.isColHiddenByUser(i))return i}else for(;i<e.getColCount();++i)if(!r.isColHiddenByUser(i))return i;return -1}function o(e,t){for(var n=e.getCurrentViewAccessor(),r=1;n.isRowHidden(t-r)&&t-r>=0;){if(n.isRowHiddenByUser(t-r))return!0;r+=1}return!1}function a(e,t){for(var n=e.getCurrentViewAccessor(),r=1;n.isRowHidden(t+r)&&t+r<e.getRowCount();){if(n.isRowHiddenByUser(t+r))return!0;r+=1}return!1}function s(e,t){var{rowColAccessor:n,paragraphAccessor:r,cellStyleAccessor:i,transformTable:o}=e.canvas,a={};for(var s of t)for(var c=s[0];c<=s[1];c++)if(void 0===a[c]){for(var l=0,u=0;u<n.getRowCount();u++){var h=r.getParagraph(u,c);if(h){var _=o.getMergeData(u,c),A=o.getMergeParent(u,c);if((!_||!(_.colCount>1))&&!A){var d=i.getCellPadding(u,c),f=d.left+d.right;l=Math.max(l,h.width+f)}}}0!==l&&(a[c]=l)}return a}n.d(t,{EM:function(){return s},Lu:function(){return o},dM:function(){return r},e5:function(){return a},jO:function(){return i}})},682809:function(e,t,n){n.d(t,{E:function(){return o}});var r=n(460725),i=n(828872);function o(e,t,n,o,a){if(null===e)return!1;if(!a?.ignoreTable&&function(e,t,n){if(!e)return!1;var r=(0,i.qn)({rowIndex:t,colIndex:n},e);if(!r||!(0,i.En)({rowIndex:t,colIndex:n},r)||!r.table?.workbookRangeId)return!1;var o=e.workbookReference.workbookRangeManager.getWorkbookRangeById(r.table.workbookRangeId)?.getProperty()?.filterProperty;return!o?.filterColumn?.[0]?.hiddenButton}(e,t,n))return!0;var s=e.getCurrentViewAccessor().getFilterManager();if(null==s)return!1;var c=o||e.getCellDataAtPosition(t,n),l=s.getFilterRange();if(!l)return!1;var u=c?.getMergeReference();if(u){var h=new r.GridRange({sheetId:l.sheetId,startRowIndex:l.startRowIndex,endRowIndex:l.startRowIndex,startColIndex:l.startColIndex,endColIndex:l.endColIndex});return t=u.startRowIndex,n=u.startColIndex,u.isIntersect(h)}return t===l.startRowIndex&&!!(n>=l.startColIndex)&&!!(n<=l.endColIndex)}},314036:function(e,t,n){n.d(t,{W:function(){return o}});var r=n(676417),i=n(271048);function o(){var e=(0,r.fP)(),t=e?.svipPlus?.status===i.gq.OPEN,n=e?.svip?.status===i.gq.OPEN,o=e?.vip?.status===i.gq.OPEN;return t||n?"svip_user":o?"vip_user":"novip_user"}},683461:function(e,t,n){n.d(t,{$r:function(){return k},F1:function(){return m},I_:function(){return b},b3:function(){return D},dK:function(){return P},jn:function(){return I},k4:function(){return H},kd:function(){return w},v8:function(){return Z},xl:function(){return S}});var r=n(434902);if(n(575739),7719==n.j)var i=n(384341);var o=n(850934),a=n(817755),s=n(82041),c=n(680465),l=n(211672),u=n(732158),h=n(27638),_=n(460725),A=n(954057),d=n(888065),f=n(980931),E=n(150061),g=n(430460),R=n(794535),C=n(511680),T=n(159427),p=n(693415),v=n(825747);function m(e){var{cellWidth:t,cellHeight:n,horizontalAlign:r,verticalAlign:i,dWidth:o,dHeight:a,marginX:l=0,marginY:u=0}=e,h=0,_=0;switch(r.value){case s.V.Left:h=l;break;case s.V.Center:h=(t-o)/2;break;case s.V.Right:h=t-o-l}switch(i.value){case c.M.SmlTop:_=u;break;case c.M.SmlCenter:_=(n-a)/2;break;case c.M.SmlBottom:_=n-a-u}return{dx:h,dy:_}}function S(e){var{image:t,cellWidth:n,cellHeight:r,horizontalAlign:i,verticalAlign:o,imageElement:a,fixedRatio:s,isPlaceHolder:c}=e,{width:l,height:u}=t,{clipBottom:h,clipLeft:_,clipRight:A,clipTop:d}=t.clipInfo,f=0,g=0,R=0,C=0;if(a){var{naturalWidth:T,naturalHeight:p}=(0,E.L1)(a);l||(l=T),u||(u=p);var v=l+_+A,S=u+d+h;f=T*l/v,g=p*u/S,R=T*_/v,C=p*d/S}var w=l/u,I=n/r,O=0,b=0;s?n<=r?b=(O=n*Math.min(s,1))/w:O=(b=r*Math.min(s,1))/w:w>I?b=(O=n)/w:O=(b=r)*w;var y=O/l;c&&(b=O=Math.min(n,r));var{dx:D,dy:N}=m({cellWidth:n,cellHeight:r,dWidth:O,dHeight:b,horizontalAlign:i,verticalAlign:o});return{dx:D,dy:N,dWidth:O,dHeight:b,scale:y,sx:R,sy:C,sWidth:f,sHeight:g}}function w(e){var{drawingInfo:t,imageItem:n,wh:r}=e,{location:{width:i,height:o},picture:{clipInfo:a}}=t,{clipBottom:s,clipLeft:c,clipRight:l,clipTop:u}=a,h=i+c+l,_=o+u+s,{naturalWidth:A,naturalHeight:d}=r||(0,E.L1)(n);return{x:A*c/h,y:d*u/_,width:A*i/h,height:d*o/_}}function I(e){if(!e||(e.getExtendedType()||e.getFormulaExtType())!==l.$.Image)return null;var t=e.getExtendedValue()||e.getFormulaExtValue();return t&&o.x.deserialize(t)||null}function O(){return(O=(0,r._)(function*(e,t,n,r,i){var o=(0,d.Ud)(t,n,r),a=I(o);if(o&&a){var{width:s,height:c}=function(e,t){var{startRowIndex:n,endRowIndex:r,startColIndex:i,endColIndex:o}=e;return{width:t.getGlobalRightByCol(o)-t.getGlobalLeftByCol(i),height:t.getGlobalBottomByRow(r)-t.getGlobalTopByRow(n)}}(o.getMergeReference()||new _.GridRange(t.getSheetId(),n,n,r,r),i),{dx:l,dy:h,scale:A}=S({image:a,cellWidth:s,cellHeight:c,horizontalAlign:(0,R.PE)(o,e),verticalAlign:(0,R.YW)(o,e)}),{clipLeft:f,clipRight:E,clipTop:g,clipBottom:C}=a?.clipInfo,T={location:{rowIndex:n,colIndex:r,offsetX:l,offsetY:h,width:a.width*A,height:a.height*A},rotate:0,picture:{url:a.url,clipInfo:{clipLeft:f*A,clipRight:E*A,clipTop:g*A,clipBottom:C*A}}};return(yield(0,p.c)())({drawingInfo:T,drawingType:u.X.Pic})}})).apply(this,arguments)}function b(e,t,n,r){return y.apply(this,arguments)}function y(){return(y=(0,r._)(function*(e,t,n,r){if(!n.length)return[];var{sheetId:i}=n[0],o=e.worksheetManager.getSheetBySheetId(i);if(o?.getSheetType()!==h.Z.Grid)return[];var s=[],c=[];return n.forEach(n=>{var r=function(n,r,i){if(!I(n))return"continue";var a=function(e,t,n,r,i){return O.apply(this,arguments)}(e,o,r,i,t);s.push(a.then(e=>{e&&c.push({rowIndex:r,colIndex:i,drawing:e})}))};for(var[i,l,u]of o.cellDataGrid.createIterable(a.t.ROW,(0,A.vf)(n,o)))r(i,l,u)}),yield Promise.all(s),1===n.length&&1===c.length&&r&&(c[0].drawingId=r),c})).apply(this,arguments)}function D(e,t,n,r){return N.apply(this,arguments)}function N(){return(N=(0,r._)(function*(e,t,n,r){if(!r.length)return[];var i=[],a=e.worksheetManager.getSheetBySheetId(n),s=yield(0,C.mD)(T.r2);return r.forEach(r=>{var c=e.drawingManager.getDrawingById(r);if(c?.drawingType===u.X.Pic&&c.sheetId===n){var l=(0,v.s)(c.drawing,t.canvas),{rotate:h,picture:_}=s.getDrawingInfoFromManager(c.drawingType,r)??{};if(_?.url){var{url:A,clipInfo:d}=_,{width:E,height:R}=l;(0,g.bP)(h)&&([E,R]=[R,E]);var{rowIndex:C,colIndex:T}=l,p=new o.x({url:A,clipInfo:d,width:E,height:R});i.push({rowIndex:C,colIndex:T,drawingId:c.drawingId,extendedValue:p.serialize(),newRowHeight:(0,f.KK)(a,C)})}}}),i})).apply(this,arguments)}var M=7719==n.j?{mp4:"video/mp4",mov:"video/quicktime",flv:"video/x-flv",avi:"video/x-msvideo",mkv:"video/x-matroska","3gp":"video/3gpp",wmv:"video/x-ms-wmv",webm:"video/webm",jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png",gif:"image/gif",bmp:"image/bmp",svg:"image/svg+xml"}:null;function L(){return(L=(0,r._)(function*(e){return new Promise((0,r._)(function*(t){var n=!1,r=e=>{n||(n=!0,t(e))};if(window.tdocs?.getDropFiles&&"drag"===e){var{files:i}=yield window.tdocs.getDropFiles();r(i?.map?.(e=>e.name||"")||[])}else if(window.tdocs?.readFileListFromClipBoard&&"paste"===e){var{fileUrls:o}=yield window.tdocs.readFileListFromClipBoard();r(o?.map?.(e=>decodeURIComponent(e||"").split(/[\\/]/).pop()||"")||[])}else r([]);setTimeout(()=>{r([])},500)}))})).apply(this,arguments)}function k(e,t){return F.apply(this,arguments)}function F(){return(F=(0,r._)(function*(e,t){try{if(!i.default.isMac||!i.default.isWxWork||!e.find(e=>!e.type))return e;var r=(yield function(e){return L.apply(this,arguments)}(t)).reduce((e,t)=>{var n=/^(.+)\.[a-z0-9]+$/i.exec(t);return n&&(e[n[1]]=t),e},{});return e.map(e=>{if(e.type||!r[e.name])return e;var t=r[e.name],n=t.split(".").pop()||"";return new File([e],t,{lastModified:e.lastModified,type:M[n]})})}catch(e){n.g.log.error(e)}return e})).apply(this,arguments)}function P(e){return x.apply(this,arguments)}function x(){return(x=(0,r._)(function*(e,t,r){return void 0===t&&(t="image/webp"),void 0===r&&(r=1),new Promise(i=>{e.toBlob(o=>{var a=new Image;a.setAttribute("crossOrigin","anonymous"),a.width=e.width,a.height=e.height;var s="";s=o?URL.createObjectURL(o):e.toDataURL(t,r),a.onload=()=>{i({img:a,url:s})},a.onerror=()=>{n.g.log.error("canvasToImage error,image load error"),i({img:null,url:s})},a.src=s},t,r)})})).apply(this,arguments)}function Z(e){return B.apply(this,arguments)}function B(){return(B=(0,r._)(function*(e,t,r){return void 0===t&&(t="image/webp"),void 0===r&&(r=1),new Promise(i=>{e.toBlob(e=>{if(!e)return i(void 0);var t=new Image,r=URL.createObjectURL(e);t.onload=()=>{i(r)},t.onerror=()=>{n.g.log.error("canvasToImageURL error,image load error"),i(void 0)},t.src=r},t,r)})})).apply(this,arguments)}function H(e){return U.apply(this,arguments)}function U(){return(U=(0,r._)(function*(e){return new Promise(t=>{var r=new Image;r.setAttribute("crossOrigin","anonymous"),r.src=e,r.onload=()=>{t(r)},r.onerror=()=>{n.g.log.error("urlToImage error,image load error"),t(null)}})})).apply(this,arguments)}},286530:function(e,t,n){n.d(t,{aD:function(){return o},fL:function(){return i}});var r=n(434902),i=(0,r._)(function*(){return(yield Promise.resolve().then(n.bind(n,869243))).default}),o=(0,r._)(function*(){return(yield Promise.resolve().then(n.bind(n,905252))).default})},122477:function(e,t,n){n.d(t,{Du:function(){return A},Gt:function(){return h},PQ:function(){return c},QH:function(){return l},zJ:function(){return _}});var r=n(727503),i=n(971433),o=n(808856),a=n(470484),s=n(45865),c=[o.n.AttachmentImage,o.n.AttachmentVideo,o.n.Video],l=[o.n.AttachmentVideo,o.n.Video];o.n.AttachmentDefault,o.n.AttachmentPlaceholder,o.n.AttachmentImage,o.n.AttachmentVideo,o.n.AttachmentExcel,o.n.AttachmentPpt,o.n.AttachmentPdf,o.n.AttachmentWord,o.n.AttachmentAudio;var u=[o.n.AttachmentDefault,o.n.AttachmentPlaceholder,o.n.AttachmentImage,o.n.AttachmentVideo,o.n.AttachmentExcel,o.n.AttachmentPpt,o.n.AttachmentPdf,o.n.AttachmentWord,o.n.AttachmentAudio,o.n.Video,o.n.Audio,o.n.AttachmentZip],h=!1!==s.Z.getConfig("custom.attachmentPreview"),_=e=>{if(!h)return!1;var t=e?.getCellHyperlinksInfo(),n=t?.hyperlinksInfo?.find(e=>c.includes(e.hyperlink.type)&&e.hyperlink.displayType===i.T.PreviewImage);return!!n&&(!(0,a.$0)()||(0,r.e)(n.hyperlink.url||""))},A=e=>{var t=e?.getCellHyperlinksInfo();if(!t)return!1;if(1===t.hyperlinksInfo.length){var{hyperlink:n}=t.hyperlinksInfo[0],r=n.type;return u.some(e=>e===r)}return!1}},471917:function(e,t,n){n.d(t,{j:function(){return i}});var r=n(384341),i=function(){return r.default.isSupportFullOfflineMode&&!0}},560155:function(e,t,n){n.d(t,{e:function(){return a},o:function(){return s}});var r=n(950804),i=[r.PivotCellType.filterButton,r.PivotCellType.rowName,r.PivotCellType.colName],o=[r.PivotCellType.rowParent,r.PivotCellType.colParent];function a(e,t,n,r){if(!e)return!1;var o=r||e.getCellDataAtPosition(t,n);if(!o?.getPivotTableRef())return!1;var a=o.getPivotTableRef();return i.includes(a.pivotCellType)}function s(e,t,n){var r=e.getCellDataAtPosition(t,n)?.getPivotTableRef();if(!r)return!1;var{pivotCellType:i,viewMergeReference:a,id:s}=r;if(a&&!a.startsWith(t,n))return!1;var{showDrill:c=!0}=e.workbookReference.pivotTableManager.getPivotTable(s)?.tableDefinition||{};return!!c&&o.includes(i)}},631079:function(e,t){t.Z={FORM:2,AIO:7,JOURNAL:8}},397235:function(e,t,n){n.d(t,{K:function(){return _}}),n(575739);var r=n(48329),i=n(727351),o=n(437121),a=n(684372),s=n(663113),c=n(881739),l=n(869855),u=n(979115),h=n(502556),_=function(){function e(e,t){this.textFormatRuns=[],this._Rj=e,t&&this._APK(t)}var t=e.prototype;return t.getText=function(){return this.text},t._Bwn=function(){return this.textFormatRuns},t.build=function(){var e=void 0;return this.textFormatRuns.length>0&&(e=this.textFormatRuns.map(e=>u.k.createProperty(h.u.CTRElt,{t:e.text,type:e.type,mention:e.mention,hyperlink:e.hyperlink,rPr:new s.CTRPrElt({egRPrElt:[this._APl(e.textFormat)]})}))),new r.CTRst({r:e})},t._cby=function(e){this.textFormatRuns=e.textFormatRuns||[],this.text=this.textFormatRuns?.map(e=>e.text||"").join("")},t._APK=function(e){this.text=(0,c.jU)(e),e.r?.forEach(e=>{var t=e.rPr?.egRPrElt?.[0],n={type:e.type,text:e.t??"",textFormat:this._APL(t),mention:e.mention||void 0,hyperlink:e.hyperlink||void 0};this.textFormatRuns.push(n)})},t._APl=function(e){if(e){var t="string"==typeof e.color?a.Color.createColor(e.color):e.color?a.Color._Chn(e.color):void 0;return new i.EGRPrElt({color:t,rFont:e.fontFamily,sz:e.fontSize,b:e.bold,i:e.italic,strike:e.strikethrough,u:e.underline})}},t._APL=function(e){if(e)return{color:(0,o.S)(e.color,this._Rj)||void 0,fontFamily:e.rFont||void 0,fontSize:e.sz||(0,c.th)(this._Rj),bold:e.b||l.BM.bold,italic:e.i||l.BM.italic,strikethrough:e.strike||l.BM.strikethrough,underline:e.u||l.BM.underline||void 0}},e}()},868611:function(e,t,n){n.d(t,{$G:function(){return _},Fy:function(){return u},H7:function(){return y},Lk:function(){return l},Nk:function(){return O},Oh:function(){return T},Rj:function(){return p},SL:function(){return g},YG:function(){return d},Y_:function(){return b},_S:function(){return A},bV:function(){return S},c8:function(){return m},ih:function(){return f},jF:function(){return R},oQ:function(){return C},oe:function(){return w},qq:function(){return E},tf:function(){return h},vz:function(){return I}}),n(575739);var r=n(881739),i=n(732158),o=n(460725),a=n(45007),s=n(425187),c=n(825747);function l(e){return new o.GridRange({sheetId:e.getSheetId(),startRowIndex:0,startColIndex:0,endRowIndex:e.getRowCount()-1,endColIndex:e.getColCount()-1})}function u(e,t){var n=t.getActiveCell();if(n&&!(n.rowIndex<0)&&!(n.colIndex<0)&&e.activeSheet)return e.activeSheet.getCellDataAtPosition(n.rowIndex,n.colIndex)}function h(e,t,n){var r=e?.getMergeReference();return!!r&&(t!==r.startRowIndex||n!==r.startColIndex)}function _(e,t){if(!e)return!1;var n=t.getCellDataAtPosition(e.startRowIndex,e.startColIndex),r=n?.getMergeReference();return!!r&&e.equals(r)}function A(e,t){if(!t)return!1;var n=t.getMergeReference();return!!n&&n.equals(e)}function d(e,t){var n=t.getSelectionRanges();if(n.length<=0)return!1;var r=n[0];return(0,a.sH)(e.activeSheet,r)}function f(e,t){var n=t.getSelectionRanges();if(n.length<=0)return!1;var r=n[0],i=e.activeSheet.mergeManager.mergeList;if(!i)return!1;for(var a=0;a<i.length;a++){var s=new o.GridRange(i[a].sheetId,i[a].startRowIndex,i[a].endRowIndex,i[a].startColIndex,i[a].endColIndex);if(r.isIntersect(s)&&!r.contains(s))return!0}return!1}function E(e,t){if(1!==e.length)return!1;var n=e[0];return!!(n.isSingle()||_(n,t))}function g(e){if(!e.canvas.normalSelectData)return!1;for(var{selectQueue:t}=e.canvas.normalSelectData,n=0;n<t.length;n++)if(t[n].selectRow)return!0;return!1}function R(e){if(!e.canvas.normalSelectData)return!1;for(var{selectQueue:t}=e.canvas.normalSelectData,n=0;n<t.length;n++)if(t[n].selectCol)return!0;return!1}function C(e){var t=e.getSelectionRanges();if(t.length<=0)return!1;var n=t[0];return{rows:n.endRowIndex-n.startRowIndex+1,cols:n.endColIndex-n.startColIndex+1}}function T(e,t){var n=t.getSelectionRanges();if(n.length<=0)return!1;var r=n[0],i=e.activeSheet.getRowCount(),o=e.activeSheet.getColCount();return 0===r.startColIndex&&r.endColIndex===o-1&&0===r.startRowIndex&&r.endRowIndex===i-1}function p(e,t){for(var n=t.startRowIndex;n<=t.endRowIndex;n++)for(var r=t.startColIndex;r<=t.endColIndex;r++)if(!v(e,n,r))return!1;return!0}function v(e,t,n){var i=(0,r.$e)(e.workbookReference,t,n);return!i||""===i.toString().replace(/[\u200B-\u200D\uFEFF]/g,"")}function m(e,t,n){var r,i,o;return(r=e.getCellDataAtPosition(t,n),r?.getMergeReference()||0)?(i=e.getCellDataAtPosition(t,n),!!(o=i?.getMergeReference())&&v(e,o.startRowIndex,o.startColIndex)):v(e,t,n)}function S(e,t){for(var{startRowIndex:n,endRowIndex:r,startColIndex:i,endColIndex:o}=t,a=n;a<=r;a++)for(var s=i;s<=o;s++)if(!m(e,a,s))return!1;return!0}function w(e,t,n,r){void 0===n&&(n=1e4),void 0===r&&(r=1e4);var{activeSheet:a}=e,l=a.getSheetId(),{rowCoverAccessor:u}=t.canvas,h=a.getRowCount(),_=a.getColCount(),A=Math.max(0,function(e,t){for(var{activeSheet:n}=e,{rowCoverAccessor:r}=t.canvas,i=n.getRowCount(),o=n.getColCount(),a=0;a<i;a++)for(var s=0;s<o;s++){var c=n.getCellDataAtPosition(a,s);if(I(a,s,r,c,e))return a}return -1}(e,t)),d=Math.max(0,function(e,t){for(var{activeSheet:n}=e,{rowCoverAccessor:r}=t.canvas,i=n.getRowCount(),o=n.getColCount(),a=0;a<o;a++)for(var s=0;s<i;s++){var c=n.getCellDataAtPosition(s,a);if(I(s,a,r,c,e))return a}return -1}(e,t));e.drawingManager.getDrawingsBySheetIdAndTypes(l,[i.X.Pic,i.X.Chart,i.X.Shape]).forEach(e=>{var{rowIndex:t,colIndex:n}=(0,s.C)(e.drawing);A=Math.min(t,A),d=Math.min(n,d)});for(var{areaData:f}=t.canvas,E=n+f.getGlobalLeftByCol(d),g=r+f.getGlobalTopByRow(A),R=A,C=d;R<h&&!(f.getGlobalBottomByRow(R)>g);R++);for(;C<_&&!(f.getGlobalRightByCol(C)>E);C++);R=Math.max(A,R-1),C=Math.max(d,C-1);for(var T=A,p=d,v=R;v>=A;v--)for(var m=C;m>=d;m--){var S=a.getCellDataAtPosition(v,m),w=S?.getMergeReference();w&&(S=a.getCellDataAtPosition(w.startRowIndex,w.startColIndex)),I(v,m,u,S,e)&&(T=Math.max(T,v),p=Math.max(p,m))}return e.drawingManager.getDrawingsBySheetIdAndTypes(l,[i.X.Pic,i.X.Chart,i.X.Shape]).forEach(e=>{var{rowIndex:t,colIndex:n,offsetX:r,offsetY:i,width:o,height:a,endAnchor:s}=(0,c.s)(e.drawing);if(!(t>R)&&!(n>C)){var l=n,u=t;if(s)l=s.colIndex,u=s.rowIndex;else{var h=f.getGlobalLeftByCol(n)+r+o,_=f.getGlobalTopByRow(t)+i+a;l=f.getColByGlobalLeft(h),u=f.getRowByGlobalTop(_)}p=Math.min(Math.max(l,p),C),T=Math.min(Math.max(u,T),R)}}),e.activeSheet.sparklineManager.getSparklineGroups().forEach(e=>{e.getSparklines().forEach(e=>{var{startRowIndex:t,startColIndex:n}=e.location;d=Math.min(n,d),A=Math.min(t,A),p=Math.min(Math.max(n,p),C),T=Math.min(Math.max(t,T),R)})}),{gridRange:new o.GridRange({sheetId:l,startRowIndex:A,endRowIndex:T,startColIndex:d,endColIndex:p}),isCutoff:T===R&&R!==h-1||p===C&&C!==_-1}}function I(e,t,n,r,i){return!!(r?.getFormattedValue()?.value||r?.getStyle(i)?.getCellPreviewBackgroundColorByFill()||n.isHiddenCell(e,t))}function O(e,t){var{normalSelectData:n}=t.canvas,r=n.selectQueue.filter(e=>e.selectRow||e.selectCell),i=[];return r.forEach((t,n)=>{for(var{yRange:r}=t,o=e.getRowCount(),a=r[1]===o-1?r[0]-1:r[1]+1;e.isRowHidden(a);)a=r[1]===o-1?a-1:a+1;a=Math.max(a,0),i.push({index:n,updateParams:{yRange:[a,a],xRange:t.xRange||void 0,activation:t.activation?{row:a,col:t.activation.col}:null}})}),i}function b(e,t){var{normalSelectData:n}=t.canvas,r=n.selectQueue.filter(e=>e.selectCol||e.selectCell),i=[];return r.forEach((t,n)=>{for(var{xRange:r}=t,o=e.getColCount(),a=r[1]===o-1?r[0]-1:r[1]+1;e.isColHidden(a);)a=r[1]===o-1?a-1:a+1;a=Math.max(a,0),i.push({index:n,updateParams:{xRange:[a,a],yRange:t.yRange||void 0,activation:t.activation?{row:t.activation.row,col:a}:null}})}),i}function y(e){if(!e.canvas.normalSelectData)return[];for(var t=[],{selectQueue:n}=e.canvas.normalSelectData,r=0;r<n.length;r++){var i=n[r];i.selectCol&&t.push({start:i.xRange[0],end:i.xRange[1]})}return t}},311759:function(e,t,n){n.d(t,{$8:function(){return a},G:function(){return o}});var r=n(27638),i=[r.Z.Smartsheet,r.Z.Smartcanvas,r.Z.Dashboard];function o(e){return i.includes(e)}function a(e){return e.startsWith("sc_")}r.Z.Grid,r.Z.Object},495033:function(e,t,n){n.d(t,{K:function(){return i}});var r=n(735926);function i(e,t,n){var i=/^[^\u4e00-\u9fa5a-zA-Z\d]+/,o=/[^\u4e00-\u9fa5a-zA-Z\d]+$/,a=e=>{var t="";if(e){var r=(t=n?e.replace(n,"").trim():e.replace(i,"").replace(o,"").trim()).split(/\s{10}/),a=r[r.length-1];a&&r.length>1&&(a=a.replace(/^\s*/,""),t=`${r[0]}${a}`)}return t},s=e=>!!e&&e.replace(i,"").length>0,c=(e=>{if(e){var t="";for(var[n]of e.cellDataGrid.createIterable()){var i=n.getFormattedValue();if(n.getType()!==r.d.Formula&&s(i?.value)){t=a(i?.value);break}if("string"==typeof t&&t)break}return t}})(e.activeSheet);return"function"==typeof t&&t(c),c}},914382:function(e,t,n){n.d(t,{M:function(){return o},n:function(){return a}});var r=n(684372),i={},o=(e,t)=>{if(i[e])return i[e];var n=(getComputedStyle(document.body).getPropertyValue(e)||"").trim().toLocaleLowerCase();return n&&(i[e]=n),n||t||""},a=e=>r.Color.createColor(e)},671638:function(e,t,n){n.d(t,{Yo:function(){return u},_b:function(){return _},cW:function(){return l},z_:function(){return h}});var r=n(313624),i=n(797218),o=n(556930),a=n(115089),s=n(384341),c=n(45865);function l(e){var t,n,r=e;return/^(mailto:(\/\/)?)?([a-z\u00a1-\uffff0-9_\-.])+@([a-z\u00a1-\uffff0-9_\-.])+\.([a-z]{2,})$/i.test(e)?r=e.replace(/^(mailto:(\/\/)?)?/i,"mailto:"):/^(https?|ftp|file):\/\//i.test(e)||(RegExp(`^${(0,o.Fb)()}`,"i").test(e),r=`//${e}`),(t=e,/\.qq\.com/.test(t)&&!/docs\.qq\.com/.test(t)&&!/doc\.weixin\.qq\.com/.test(t)&&s.default.isMiniProgram&&1)?`//${c.Z.getConfig("runtime.domainName")}/scenario/link.html?url=${encodeURIComponent(r)}&pid=${a.q.getConfig("globalPadId")}&cid=${a.q.getConfig("creatorId")}`:r}function u(e,t){void 0===t&&(t=!1);var n=l(e);(0,i.tencentDocOpenUrlForAll)({url:n,replace:t})}var h=()=>"1"===(0,r.IZ)("selection_cancel");function _(e,t){return t&&(e.indexOf("?")>=0?e+=`&${t}`:e+=`?${t}`),e}},560554:function(e,t,n){n.d(t,{T:function(){return i}});var r=n(732432);function i(e,t,n){if(null===e)return!1;var i=e.getCellDataAtPosition(t,n);if(!i)return!1;var o=i.getMergeReference();o&&(t=o.startRowIndex,n=o.startColIndex);var a=i.getDataValidation();return!!a&&a.type===r.e.List&&!!a.formulaModel1}},861602:function(e,t,n){n.d(t,{Z:function(){return eH}});var r=n(921734),i=n(209787),o=n(696272),a=n(142947),s=n(518215),c=n(962168),l=n(115089),u=n(107439),h=n(927053),_=n(194305),A=n(438810),d=n(899842),f=n(599099),E=n(203712),g=n(749089),R=n(791721),C=n(636869),T=n(447055),p=n(233455),v=n(735683),m=n(163861),S=n(952869),w=n(645592),I=n(484670);n(934143),n(575739);var O=n(121210),b=n(887106),y=n(722166),D=n(437121),N=n(928056),M=n(933329),L=function(e){function t(t){(n=e.call(this,t)||this)._bgt=[],n._bgT=[],n._cal=e=>{var t=n._BrQ(e),r=[];t.forEach(t=>{var i=Math.max(t.startColIndex,e.fromCol),o=Math.max(t.startRowIndex,e.fromRow),a=Math.min(t.endColIndex,e.toCol),s=Math.min(t.endRowIndex,e.toRow);if(!(i>a||o>s)){var c=n._tJ.getViewLeftByCol(i)+n._ua.rowHeadWidth,l=n._tJ.getViewTopByRow(o)+n._ua.colHeadHeight,u=i===a,h=o===s,_=u?c:n._tJ.getViewLeftByCol(a-1)+n._ua.rowHeadWidth,A=h?l:n._tJ.getViewTopByRow(s-1)+n._ua.colHeadHeight,d=a-1,f=n._Rj.activeSheet.isColHidden(d)?0:n._XY.getColSetWidth(d),E=n._Rj.activeSheet.isColHidden(a)?0:n._XY.getColSetWidth(a),g=u?E:E+f,R=s-1,C=n._Rj.activeSheet.isRowHidden(R)?0:n._XY.getRowDisplayHeight(R),T=n._Rj.activeSheet.isRowHidden(s)?0:n._XY.getRowDisplayHeight(s),p=h?T:T+C;c=Math.max(c,0),l=Math.max(l,0);var v=_<0?g+_:_+g-c,m=A<0?p+A:A+p-l;v=Math.max(v,0),m=Math.max(m,0),r.push([c,l,v,m])}}),r.length&&n.alloyExcel.collectEngine.collectGlobal(b.g4.line,{lines:n._bgU(e),lineProp:{style:y.j.Thin,color:D.Z.newInstanceByRGB(13,13,13,.06)},globalPos:{x:n._ua.rowHeadWidth,y:n._ua.colHeadHeight},clipInfos:r},b.Nm.RangeAuthBackground,e.areaSection,b.hP.RANGE_AUTH_BACKGROUND)},n.renderAfterCell=e=>{var{row:t,col:r}=e,i=[];n._bgT.forEach(t=>{var r=t(e);if(r){var{width:o,height:a,x:s,y:c}=r;i=i.concat(n._bgV(s,c,o,a))}}),i.length&&n.alloyExcel.collectEngine.collectCell(b.g4.line,{lines:i,lineProp:{style:y.j.Thin,color:D.Z.newInstanceByRGB(13,13,13,.06)},pos:{row:t,col:r}},b.Nm.SheetProtection)};var n,{rowColAccessor:r,renderApi:i,areaData:o,headSize:a,workbook:s}=t;return n._XY=r,n._ll=i,n._tJ=o,n._ua=a,n._Rj=s,n}(0,r._)(t,e);var n=t.prototype;return n._cam=function(e,t){t===M.l.RANGE?(this._bgt.length||this.alloyExcel.onAfterAreaRender(this._cal),this._bgt.push(e)):t===M.l.CELL&&(this._bgT.length||this.alloyExcel.onAfterCellRender(this.renderAfterCell),this._bgT.push(e)),this._cOJ()},n._cOJ=function(){this._ll.renderNextTick()},n._BrQ=function(e){var t=[];return this._bgt.forEach(n=>{var r=n(e);t=t.concat(r)}),t},n._bgU=function(e){var{areaSection:t}=e,{left:n,top:r,width:i,height:o,x:a,y:s}=(0,N.ub)(this._tJ,t),c=8*Math.ceil((n+r)/8)-(n+r);return this._bgV(a,s,i,o,c)},n._bgV=function(e,t,n,r,i){void 0===i&&(i=0);for(var o=e+n,a=t+r,s=[],c=new Set,l=0,u=e+i,h=u;h<=o;h+=8)c.add(h+t),l=o-h;for(var _=t+(8-l);_<=a;_+=8)c.add(o+_);return c.forEach(n=>{var r=[],i=n-t;i>=e&&i<=o&&r.push([i,t]),(i=n-a)>=e&&i<=o&&r.push([i,a]);var c=n-e;c>t&&c<a&&r.push([e,c]),(c=n-o)>t&&c<a&&r.push([o,c]),r.length>=2&&s.push([r[0][0],r[0][1],r[1][0],r[1][1]])}),s},t}(O.Z),k=n(540),F=n(402545),P=function(){function e(e,t,n,r,i,o,a,s){this._BXM=!1,this.operateEventsRemoved=!1,this.instantiationService=e,this.workbook=t,this._BRt=n,this.spreadsheetView=r,this.mutexManagement=i,this.dataCallView=o,this.sheetStatus=a,this.sdkSheetsBarService=s,Object.assign(this,r),this.alloyExcel=r.renderManager.alloyExcel,this.renderApi=r.renderManager.renderApi,this.groupStage=r.renderManager.groupStage,this.calculateSplitter=r.renderManager.getRender().calculateSplitter,this.spreadConfig=l.q,this.initCellRenderPlugins(),this.autoScroll=new h.ZP(this.spreadsheetView),this.defaultScale=new R.Z(this.spreadsheetView),this.operateData=this.spreadsheetView.operateContext.operateData,this.operateBoard=this.spreadsheetView.operateContext.operateBoard,this.mouseOperate=this.spreadsheetView.operateContext.mouseOperate,this.touchOperate=this.spreadsheetView.operateContext.touchOperate,this._BXL=new C.Z(this.container),this.normalSelectData=new S.Z(this.dataCallView,this.spreadsheetView,this.workbook),this.formulaSelectData=new T.Z(this.dataCallView,this.spreadsheetView,this.workbook),this.scrollApi=new v.Z(this.spreadsheetView),this.selectApi=new m.Z(this.spreadsheetView),this._cbY=new p.Z(this.spreadsheetView,this.scrollApi),this.initAreaTexturePlugin(),this.operateEventsRemoved=!1}var t=e.prototype;return t._BXn=function(){if(this._BXM)return void n.g.log?.info("view.level0\u5DF2\u7ECF\u521D\u59CB\u5316");n.g.log?.info("view.level0\u521D\u59CB\u5316"),this._BXM=!0},t.init=function(e){this.clientRect.refresh(),this.accessorManager.init(e),this.calculateSplitter.refresh(),this.areaData.refresh(),this.mainBoard.refresh(),this.resize.resize()},t.clear=function(e){this.clientRect.refresh(),this.accessorManager.clear(e),this.areaData.refresh(),this.alloyExcel.resize(),this.renderApi.resume(),this.mainBoard.refresh()},t.refresh=function(e){this.clientRect.refresh(),this.borderAccessor.refresh(e),this.calculateSplitter.refresh(),this.areaData.refresh(),this.mainBoard.refresh(),this.groupStage?.refresh(),this.resize.resize()},t.hideView=function(){this.alloyExcel.canvas.style.visibility="hidden",this.mainBoard.element.style.visibility="hidden",this.operateEventsRemoved||(this.mouseOperate.removeEvent(),this.touchOperate.removeEvent(),this.operateEventsRemoved=!0),this.contextMenuHandler&&this.container.removeEventListener("contextmenu",this.contextMenuHandler),this.contextMenuHandler=e=>{e.stopPropagation()},this.container.addEventListener("contextmenu",this.contextMenuHandler)},t.showView=function(){this.alloyExcel.canvas.style.visibility="visible",this.mainBoard.element.style.visibility="visible",this.operateEventsRemoved&&(this.mouseOperate.addEvent(),this.touchOperate.addEvent(),this.operateEventsRemoved=!1),this.contextMenuHandler&&(this.container.removeEventListener("contextmenu",this.contextMenuHandler),this.contextMenuHandler=void 0)},t.initCellRenderPlugins=function(){new A.Z({alloyExcel:this.alloyExcel,workbook:this.workbook,rowColAccessor:this.rowColAccessor,cellStyleAccessor:this.cellStyleAccessor}),new g.Z({alloyExcel:this.alloyExcel,workbook:this.workbook,rowColAccessor:this.rowColAccessor,cellStyleAccessor:this.cellStyleAccessor}),new f.Z({alloyExcel:this.alloyExcel,workbook:this.workbook,rowColAccessor:this.rowColAccessor,cellStyleAccessor:this.cellStyleAccessor}),new E.Z({alloyExcel:this.alloyExcel,workbook:this.workbook,rowColAccessor:this.rowColAccessor,paragraphAccessor:this.paragraphAccessor,cellStyleAccessor:this.cellStyleAccessor,alignCrossCenterAccessor:this.alignCrossCenterAccessor}),new d.Z({alloyExcel:this.alloyExcel,renderApi:this.renderApi,cellStyleAccessor:this.cellStyleAccessor}),new _.Z({alloyExcel:this.alloyExcel,workbook:this.workbook,renderApi:this.renderApi,rowColAccessor:this.rowColAccessor})},t.initAreaTexturePlugin=function(){this._cbz=new L({alloyExcel:this.alloyExcel,workbook:this.workbook,rowColAccessor:this.rowColAccessor,renderApi:this.renderApi,areaData:this.areaData,headSize:this.headSize})},e}(),x=P=(0,i.__decorate)([(0,i.__param)(0,o.T),(0,i.__param)(1,s.lc),(0,i.__param)(2,F.w),(0,i.__param)(3,I.Z),(0,i.__param)(4,w.Z),(0,i.__param)(5,u.Z),(0,i.__param)(6,a.T),(0,i.__param)(7,c.Z),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[void 0===o.T?Object:o.T,void 0===s.lc?Object:s.lc,void 0===k.IBaseView?Object:k.IBaseView,void 0===I.Z?Object:I.Z,void 0===w.Z?Object:w.Z,void 0===u.Z?Object:u.Z,void 0===a.T?Object:a.T,void 0===c.Z?Object:c.Z])],P),Z=n(56332),B=n(388261),H=n(375218),U=n(644080),V=n(24191),G=n(159409),K=n(758699),W=n(563411);n(738355);var Q=n(146849),Y=n(131524),q=n(241749),J=n(72941),j=n(164013),X={X:0,Y:1};function z(e){var{activeRow:t}=e,{activeCol:n}=e;if(t<0||n<0)throw Error("\u79FB\u52A8\u6FC0\u6D3B\u533A\u57DF\u5F02\u5E38")}function ee(e,t,n,r,i){var o=e.getCellDataAtPosition(n,r);if(!o)return null;var a=null,s=i>0?J.BS:J.lP,c=i>0?(0,q.HN)(t):(0,q.kq)(t);if(null===c)return null;if(o.isEmpty)a=s({transformTable:e,accessor:t},n+i,r,c,ec);else{var l=s(t,n+i,r,c,Y.hZ);if(null===l)return null;var u=e.getCellDataAtPosition(l,r);if(!u)return null;u.isEmpty?a=s({transformTable:e,accessor:t},l+i,r,c,ec):null!==(a=s({transformTable:e,accessor:t},n,r,c,el))&&(a=(i>0?J.lP:J.BS)({transformTable:e,accessor:t},a-i,r,n,ec))}return null==a&&(a=c),a}function et(e,t,n,r,i){var o=e.getCellDataAtPosition(n,r);if(!o)return null;var a=null,s=i>0?J.Q8:J.Xe,c=i>0?(0,q.qA)(t):(0,q.Ho)(t);if(null===c)return null;if(o.isEmpty)a=s({transformTable:e,accessor:t},n,r+i,c,ea);else{var l=s(t,n,r+i,c,Y.hZ);if(null===l)return null;var u=e.getCellDataAtPosition(n,l);if(!u)return null;u.isEmpty?a=s({transformTable:e,accessor:t},n,l+i,c,ea):null!==(a=s({transformTable:e,accessor:t},n,r,c,es))&&(a=(i>0?J.Xe:J.Q8)({transformTable:e,accessor:t},n,a-i,r,ea))}return null==a&&(a=c),a}function en(e,t,n){var{transformTable:r,accessor:i}=e,o=r.getMergeParent(n,t);return(!o||0===o.x)&&(0,Y.hZ)(i,t,n)}function er(e,t,n){var{transformTable:r,accessor:i}=e,o=r.getMergeParent(n,t),a=r.getMergeData(n,t);return(!o||r.getMergeData(n+o.y,t+o.x).colCount===-o.x+1)&&(!a||!(a.colCount>1))&&(0,Y.hZ)(i,t,n)}function ei(e,t,n){var{transformTable:r,accessor:i}=e,o=r.getMergeParent(n,t);return(!o||0===o.y)&&(0,Y.hZ)(i,t,n)}function eo(e,t,n){var{transformTable:r,accessor:i}=e,o=r.getMergeParent(n,t),a=r.getMergeData(n,t);return(!o||r.getMergeData(n+o.y,t+o.x).rowCount===-o.y+1)&&(!a||!(a.rowCount>1))&&(0,Y.hZ)(i,t,n)}function ea(e,t,n){var{transformTable:r,accessor:i}=e;return(0,Y.eN)(r,t,n)&&(0,Y.hZ)(i,t,n)&&(0,Y.PA)(r,t,n)}function es(e,t,n){var{transformTable:r,accessor:i}=e;return(0,Y.eN)(r,t,n)&&(0,Y.hZ)(i,t,n)&&(0,Y.AS)(r,t,n)}function ec(e,t,n){var{transformTable:r,accessor:i}=e;return(0,Y.eN)(r,t,n)&&(0,Y.hZ)(i,t,n)&&(0,Y.PA)(r,t,n)}function el(e,t,n){var{transformTable:r,accessor:i}=e;return(0,Y.eN)(r,t,n)&&(0,Y.hZ)(i,t,n)&&(0,Y.AS)(r,t,n)}function eu(e,t){var n,r,i,o;e.getIsInsertion()?(n=e,z(r=t),n.addSelection({xRange:[r.activeCol,r.activeCol],yRange:[r.activeRow,r.activeRow]}),n.setIsInsertion(!1)):e.select instanceof j.Z&&(i=e,z(o=t),i.updateSelection(i.currentSelectIndex,{xRange:[o.activeCol,o.activeCol],yRange:[o.activeRow,o.activeRow],activation:{row:o.activeRow,col:o.activeCol}}))}function eh(e,t,n,r,i){z(n);var{activation:o}=n;if(!o)throw Error("\u79FB\u52A8\u9009\u533A\u5F02\u5E38");var a=o.col,s=o.row,c={row:s,col:a};if(r===X.X)if(i>0){var l=(0,J.Q8)({transformTable:e,accessor:t},s,a+1,t.getColCount()-1,en);null!==l&&(c.col=l)}else{var u=(0,J.Xe)({transformTable:e,accessor:t},s,a-1,0,er);null!==u&&(c.col=u)}else if(i>0){var h=(0,J.BS)({transformTable:e,accessor:t},s+1,a,t.getRowCount()-1,ei);null!==h&&(c.row=h)}else{var _=(0,J.lP)({transformTable:e,accessor:t},s-1,a,0,eo);null!==_&&(c.row=_)}return{xRange:[c.col,c.col],yRange:[c.row,c.row],activation:c}}var e_=n(202630),eA=n(671888),ed=n(795849),ef=n(532565);function eE(e,t,n,r,i){return(z(n),r===X.X)?function(e,t,n,r){var i,o,a,s,c=n.selectQueue[n.currentSelectIndex],{activeRow:l}=n,{activeCol:u}=n;if(c instanceof e_.Z||c instanceof ed.Z)return null;if(c instanceof eA.Z||c instanceof ef.Z)i=c.xRange[0],o=c.xRange[1],c instanceof eA.Z?(a=0,s=t.getRowCount()-1):(a=c.yRange[0],s=c.yRange[1]);else throw Error("\u4E0D\u53EF\u7528\u7684\u9009\u533A\u7C7B\u578B");if(c instanceof eA.Z){var h=function(e,t,n,r,i){var o;if(t>0){var a=function(e,t,n,r){var i,o,a=[t,n];if(r>t){if(i=t,null===(o=(0,J.Q8)(e,0,i+1,n,Y.Sl)))return null;a[0]=o}else{if(i=n,null===(o=(0,J.Q8)(e,0,i+1,e.getColCount()-1,Y.Sl)))return null;a[1]=o}return a}(e,n,r,i);if(!a)return;o=a}else{var s=function(e,t,n,r){var i,o,a=[t,n];if(r<n){if(i=n,null===(o=(0,J.Xe)(e,0,i-1,t,Y.Sl)))return null;a[1]=o}else{if(i=t,null===(o=(0,J.Xe)(e,0,i-1,0,Y.Sl)))return null;a[0]=o}return a}(e,n,r,i);if(!s)return;o=s}return o}(t,r,i,o,u);return h?{xRange:h,activation:{row:l,col:u}}:null}var{xRange:_,yRange:A}=function(e,t,n,r,i,o,a,s){var c=n>0?function(e,t,n,r,i,o,a){for(var s,c,l=[o,a],u=[r,i];;){var h=void 0;if(n>o){if(c=o,null===(h=(0,J.Q8)(t,0,c+1,a,Y.Sl)))break;l[0]=h,s=J.mk.DISCARD}else{if(c=a,null===(h=(0,J.Q8)(t,0,c+1,t.getColCount()-1,Y.Sl)))break;l[1]=h,s=J.mk.EXTEND}if(eg(e,n,u,l,o,a,s))break;o=n,a=l[1]}return{xRange:l,yRange:u}}(e,t,s,r,i,o,a):function(e,t,n,r,i,o,a){for(var s,c,l=[o,a],u=[r,i];;){var h=void 0;if(n<a){if(c=a,null===(h=(0,J.Xe)(t,0,c-1,o,Y.Sl)))break;l[1]=h,s=J.mk.DISCARD}else{if(c=o,null===(h=(0,J.Xe)(t,0,c-1,0,Y.Sl)))break;l[0]=h,s=J.mk.EXTEND}if(eg(e,n,u,l,o,a,s))break;o=l[0],a=n}return{xRange:l,yRange:u}}(e,t,s,r,i,o,a),{xRange:l}=c,{yRange:u}=c;return{xRange:l,yRange:u}}(e,t,r,a,s,i,o,u);return{xRange:_,yRange:A,activation:{row:l,col:u}}}(e,t,n,i):function(e,t,n,r){var i,o,a,s,c=n.selectQueue[n.currentSelectIndex],{activeRow:l}=n,{activeCol:u}=n;if(c instanceof e_.Z||c instanceof eA.Z)return null;if(c instanceof ed.Z||c instanceof ef.Z)a=c.yRange[0],s=c.yRange[1],c instanceof ed.Z?(i=0,o=t.getColCount()-1):(i=c.xRange[0],o=c.xRange[1]);else throw Error("\u4E0D\u53EF\u7528\u7684\u9009\u533A\u7C7B\u578B");if(c instanceof ed.Z){var h=function(e,t,n,r,i){var o;if(t>0){var a=function(e,t,n,r){var i,o,a=[t,n];if(r>t){if(i=t,null===(o=(0,J.BS)(e,i+1,0,n,Y.So)))return null;a[0]=o}else{if(i=n,null===(o=(0,J.BS)(e,i+1,0,e.getRowCount()-1,Y.So)))return null;a[1]=o}return a}(e,n,r,i);if(!a)return;o=a}else{var s=function(e,t,n,r){var i,o,a=[t,n];if(r<n){if(i=n,null===(o=(0,J.lP)(e,i-1,0,t,Y.So)))return null;a[1]=o}else{if(i=t,null===(o=(0,J.lP)(e,i-1,0,0,Y.So)))return null;a[0]=o}return a}(e,n,r,i);if(!s)return;o=s}return o}(t,r,a,s,l);return h?{yRange:h,activation:{row:l,col:u}}:null}var{xRange:_,yRange:A}=function(e,t,n,r,i,o,a,s){var c=n>0?function(e,t,n,r,i,o,a){for(var s,c,l=[o,a],u=[r,i];;){var h=void 0;if(n>r){if(c=r,null===(h=(0,J.BS)(t,c+1,0,i,Y.So)))break;u[0]=h,s=J.mk.DISCARD}else{if(c=i,null===(h=(0,J.BS)(t,c+1,0,t.getRowCount()-1,Y.So)))break;u[1]=h,s=J.mk.EXTEND}if(eR(e,n,u,l,r,i,s))break;r=n,i=u[1]}return{xRange:l,yRange:u}}(e,t,s,r,i,o,a):function(e,t,n,r,i,o,a){for(var s,c,l=[o,a],u=[r,i];;){var h=void 0;if(n<i){if(c=i,null===(h=(0,J.lP)(t,c-1,0,r,Y.So)))break;u[1]=h,s=J.mk.DISCARD}else{if(c=r,null===(h=(0,J.lP)(t,c-1,0,0,Y.So)))break;u[0]=h,s=J.mk.EXTEND}if(eR(e,n,u,l,r,i,s))break;r=u[0],i=n}return{xRange:l,yRange:u}}(e,t,s,r,i,o,a),{xRange:l}=c,{yRange:u}=c;return{xRange:l,yRange:u}}(e,t,r,a,s,i,o,l);return{xRange:_,yRange:A,activation:{row:l,col:u}}}(e,t,n,i)}function eg(e,t,n,r,i,o,a){if((0,J.nM)(e,n,r,a)){if(t<r[0])r[0]=t;else if(t>r[1])r[1]=t;else if(r[0]!==i||r[1]!==o)return!0}return!1}function eR(e,t,n,r,i,o,a){if((0,J.nM)(e,n,r,a)){if(t<n[0])n[0]=t;else if(t>n[1])n[1]=t;else if(n[0]!==i||n[1]!==o)return!0}return!1}function eC(e,t,n,r,i){z(n);var o,a,s,c=n.selectQueue[n.currentSelectIndex],{activeRow:l}=n,{activeCol:u}=n;if(c instanceof e_.Z)o=eT(e,t,r,i,0,t.getRowCount()-1,0,t.getColCount()-1,l,u);else if(c instanceof ed.Z)o=eT(e,t,r,i,c.yRange[0],c.yRange[1],0,t.getColCount()-1,l,u),s=[c.yRange[0],c.yRange[1]];else if(c instanceof eA.Z)o=eT(e,t,r,i,0,t.getRowCount()-1,c.xRange[0],c.xRange[1],l,u),a=[c.xRange[0],c.xRange[1]];else if(c instanceof ef.Z)o=eT(e,t,r,i,c.yRange[0],c.yRange[1],c.xRange[0],c.xRange[1],l,u),s=[c.yRange[0],c.yRange[1]],a=[c.xRange[0],c.xRange[1]];else throw Error("\u4E0D\u53EF\u7528\u7684\u9009\u533A\u7C7B\u578B");return{activation:o,xRange:a,yRange:s}}function eT(e,t,n,r,i,o,a,s,c,l){return n===X.X?function(e,t,n,r,i,o,a,s,c){var l=function(e,n,r){return(0,Y.eN)(e,n,r)&&(0,Y.hZ)(t,n,r)},u=s,h=c;if(n>0)for(h+=1;;){var _=(0,J.Q8)(e,u,h,a,l);if(null!==_){h=_;break}h=o,(u+=1)>i&&(u=r)}else for(h-=1;;){var A=(0,J.Xe)(e,u,h,o,l);if(null!==A){h=A;break}h=a,(u-=1)<r&&(u=i)}return{row:u,col:h}}(e,t,r,i,o,a,s,c,l):function(e,t,n,r,i,o,a,s,c){var l=function(e,n,r){return(0,Y.eN)(e,n,r)&&(0,Y.hZ)(t,n,r)},u=s,h=c;if(n>0)for(u+=1;;){var _=(0,J.BS)(e,u,h,i,l);if(null!==_){u=_;break}u=r,(h+=1)>a&&(h=o)}else for(u-=1;;){var A=(0,J.lP)(e,u,h,r,l);if(null!==A){u=A;break}u=i,(h-=1)<o&&(h=a)}return{row:u,col:h}}(e,t,r,i,o,a,s,c,l)}function ep(e,t,n,r,i){return(z(n),r===X.X)?function(e,t,n,r){var i,o,a,s,c,l=n.selectQueue[n.currentSelectIndex],{activeRow:u}=n,{activeCol:h}=n;if(l instanceof e_.Z||l instanceof ed.Z)return null;if(l instanceof eA.Z||l instanceof ef.Z)i=l.xRange[0],o=l.xRange[1],l instanceof eA.Z?(a=0,s=t.getRowCount()-1):(a=l.yRange[0],s=l.yRange[1]);else throw Error("\u4E0D\u53EF\u7528\u7684\u9009\u533A\u7C7B\u578B");c=o>h?o:i;var _=et(e,t,n.activeRow,c,r);if(null===_)return null;var A=[Math.min(h,_),Math.max(h,_)];return l instanceof eA.Z?{xRange:A,activation:{row:u,col:h}}:{xRange:A,yRange:[a,s],activation:{row:u,col:h}}}(e,t,n,i):function(e,t,n,r){var i,o,a,s,c,l=n.selectQueue[n.currentSelectIndex],{activeRow:u}=n,{activeCol:h}=n;if(l instanceof e_.Z||l instanceof eA.Z)return null;if(l instanceof ed.Z||l instanceof ef.Z)a=l.yRange[0],s=l.yRange[1],l instanceof ed.Z?(i=0,o=t.getColCount()-1):(i=l.xRange[0],o=l.xRange[1]);else throw Error("\u4E0D\u53EF\u7528\u7684\u9009\u533A\u7C7B\u578B");var _=ee(e,t,s>u?s:a,n.activeCol,r);if(null===_)return null;var A=[Math.min(u,_),Math.max(u,_)];return l instanceof ed.Z?{yRange:A,activation:{row:u,col:h}}:{xRange:[i,o],yRange:A,activation:{row:u,col:h}}}(e,t,n,i)}var ev=n(450586),em=n(384341);function eS(e,t,n,r,i){return(z(n),r===X.X)?function(e,t,n,r){var i=et(e,t,n.activeRow,n.activeCol,r);if(null===i)return null;var{activeRow:o}=n;return{yRange:[o,o],xRange:[i,i],activation:{col:i,row:o}}}(e,t,n,i):function(e,t,n,r){var i=ee(e,t,n.activeRow,n.activeCol,r);if(null===i)return null;var{activeCol:o}=n;return{xRange:[o,o],yRange:[i,i],activation:{row:i,col:o}}}(e,t,n,i)}var ew=n(460725),eI=n(311759),eO=n(293962),eb=e=>e>=0?e:void 0,ey=function(){function e(e){this._tb=()=>{if(this._TA instanceof T.Z&&eu(this._TA,this._AOG),this._TA.select){var e=eh(this._TK,this._AsF,this._TA,X.X,1);if(this._Tb(this._TA,e),this._TA.activeRow<0||this._TA.activeCol<0)throw Error("\u79FB\u52A8\u9009\u533A\u5F02\u5E38");return this._bmT.scrollToVisible({row:this._TA.activeRow,col:this._TA.activeCol}),!1}},this._sE=()=>{if(this._TA instanceof T.Z&&eu(this._TA,this._AOG),this._TA.select){var e=eh(this._TK,this._AsF,this._TA,X.X,-1);if(this._Tb(this._TA,e),this._TA.activeRow<0||this._TA.activeCol<0)throw Error("\u79FB\u52A8\u9009\u533A\u5F02\u5E38");return this._bmT.scrollToVisible({row:this._TA.activeRow,col:this._TA.activeCol}),!1}},this._bmv=()=>{if(this._TA instanceof T.Z&&eu(this._TA,this._AOG),this._TA.select){var e=eh(this._TK,this._AsF,this._TA,X.Y,1);if(this._Tb(this._TA,e),this._TA.activeRow<0||this._TA.activeCol<0)throw Error("\u79FB\u52A8\u9009\u533A\u5F02\u5E38");return this._bmT.scrollToVisible({row:this._TA.activeRow,col:this._TA.activeCol}),!1}},this._bmV=()=>{if(this._TA instanceof T.Z&&eu(this._TA,this._AOG),this._TA.select){var e=eh(this._TK,this._AsF,this._TA,X.Y,-1);if(this._Tb(this._TA,e),this._TA.activeRow<0||this._TA.activeCol<0)throw Error("\u79FB\u52A8\u9009\u533A\u5F02\u5E38");return this._bmT.scrollToVisible({row:this._TA.activeRow,col:this._TA.activeCol}),!1}},this._bmw=()=>{if(this._TA instanceof T.Z&&eu(this._TA,this._AOG),this._TA.select){var e=eE(this._TK,this._AsF,this._TA,X.X,1);if(e){if(this._bLh(this._TA,e),!this._TA.select.xRange)throw Error("\u79FB\u52A8\u9009\u533A\u5F02\u5E38");this._bmT.scrollToVisible({col:this._TA.select.xRange[1]})}}},this._bmW=()=>{if(this._TA instanceof T.Z&&eu(this._TA,this._AOG),this._TA.select){var e=eE(this._TK,this._AsF,this._TA,X.X,-1);if(e){if(this._bLh(this._TA,e),!this._TA.select.xRange)throw Error("\u79FB\u52A8\u9009\u533A\u5F02\u5E38");this._bmT.scrollToVisible({col:this._TA.select.xRange[0]})}}},this._bmx=()=>{if(this._TA instanceof T.Z&&eu(this._TA,this._AOG),this._TA.select){var e=eE(this._TK,this._AsF,this._TA,X.Y,1);if(e){if(this._bLh(this._TA,e),!this._TA.select.yRange)throw Error("\u79FB\u52A8\u9009\u533A\u5F02\u5E38");this._bmT.scrollToVisible({row:this._TA.select.yRange[1]})}}},this._bmX=()=>{if(this._TA instanceof T.Z&&eu(this._TA,this._AOG),this._TA.select){var e=eE(this._TK,this._AsF,this._TA,X.Y,-1);if(e){if(this._bLh(this._TA,e),!this._TA.select.yRange)throw Error("\u79FB\u52A8\u9009\u533A\u5F02\u5E38");this._bmT.scrollToVisible({row:this._TA.select.yRange[0]})}}},this._HN=()=>{if(this._AOG.select){if((0,J.CK)(this._TK,this._AOG)){var e=eh(this._TK,this._AsF,this._AOG,X.Y,1);this._Tb(this._AOG,e)}else{var t=this._AsF.isRowHidden(this._AOG.activeRow),n=this._AsF.isColHidden(this._AOG.activeCol);if(t||n)return;var r=eC(this._TK,this._AsF,this._AOG,X.Y,1);this._bLh(this._AOG,r)}if(this._AOG.activeRow<0||this._AOG.activeCol<0)throw Error("\u79FB\u52A8\u9009\u533A\u5F02\u5E38");return this._bmT.scrollToVisible({row:this._AOG.activeRow,col:this._AOG.activeCol}),!1}},this._bmy=()=>{if(this._AOG.select){if((0,J.CK)(this._TK,this._AOG)){var e=eh(this._TK,this._AsF,this._AOG,X.Y,-1);this._Tb(this._AOG,e)}else{var t=eC(this._TK,this._AsF,this._AOG,X.Y,-1);this._bLh(this._AOG,t)}if(this._AOG.activeRow<0||this._AOG.activeCol<0)throw Error("\u79FB\u52A8\u9009\u533A\u5F02\u5E38");return this._bmT.scrollToVisible({row:this._AOG.activeRow,col:this._AOG.activeCol}),!1}},this._bmY=()=>{if(this._TA.select&&this._TA.select){if((0,J.CK)(this._TK,this._TA)){var e=eh(this._TK,this._AsF,this._TA,X.X,1);this._Tb(this._TA,e)}else{var t=eC(this._TK,this._AsF,this._TA,X.X,1);this._bLh(this._TA,t)}if(this._TA.activeRow<0||this._TA.activeCol<0)throw Error("\u79FB\u52A8\u9009\u533A\u5F02\u5E38");return this._bmT.scrollToVisible({row:this._TA.activeRow,col:this._TA.activeCol}),!1}},this._bmz=()=>{if(this._TA.select&&this._TA.select){if((0,J.CK)(this._TK,this._TA)){var e=eh(this._TK,this._AsF,this._TA,X.X,-1);this._Tb(this._TA,e)}else{var t=eC(this._TK,this._AsF,this._TA,X.X,-1);this._bLh(this._TA,t)}if(this._TA.activeRow<0||this._TA.activeCol<0)throw Error("\u79FB\u52A8\u9009\u533A\u5F02\u5E38");return this._bmT.scrollToVisible({row:this._TA.activeRow,col:this._TA.activeCol}),!1}},this._bmZ=()=>{if(this._TA instanceof T.Z&&eu(this._TA,this._AOG),this._TA.select){var e=eS(this._TK,this._AsF,this._TA,X.X,1);if(e){if(this._Tb(this._TA,e),this._TA.activeRow<0||this._TA.activeCol<0)throw Error("\u79FB\u52A8\u9009\u533A\u5F02\u5E38");this._bmT.scrollToVisible({row:this._TA.activeRow,col:this._TA.activeCol})}}},this._bMa=()=>{if(this._TA instanceof T.Z&&eu(this._TA,this._AOG),this._TA.select){var e=eS(this._TK,this._AsF,this._TA,X.X,-1);if(e){if(this._Tb(this._TA,e),this._TA.activeRow<0||this._TA.activeCol<0)throw Error("\u79FB\u52A8\u9009\u533A\u5F02\u5E38");this._bmT.scrollToVisible({row:this._TA.activeRow,col:this._TA.activeCol})}}},this._bMA=()=>{if(this._TA instanceof T.Z&&eu(this._TA,this._AOG),this._TA.select){var e=eS(this._TK,this._AsF,this._TA,X.Y,1);if(e){if(this._Tb(this._TA,e),this._TA.activeRow<0||this._TA.activeCol<0)throw Error("\u79FB\u52A8\u9009\u533A\u5F02\u5E38");this._bmT.scrollToVisible({row:this._TA.activeRow,col:this._TA.activeCol})}}},this._bMb=()=>{if(this._TA instanceof T.Z&&eu(this._TA,this._AOG),this._TA.select){var e=eS(this._TK,this._AsF,this._TA,X.Y,-1);if(e){if(this._Tb(this._TA,e),this._TA.activeRow<0||this._TA.activeCol<0)throw Error("\u79FB\u52A8\u9009\u533A\u5F02\u5E38");this._bmT.scrollToVisible({row:this._TA.activeRow,col:this._TA.activeCol})}}},this._bMB=()=>{if(this._TA instanceof T.Z&&eu(this._TA,this._AOG),this._TA.select){var e=ep(this._TK,this._AsF,this._TA,X.X,1);if(e){if(this._bLh(this._TA,e),!this._TA.select.xRange)throw Error("\u79FB\u52A8\u9009\u533A\u5F02\u5E38");this._bmT.scrollToVisible({col:this._TA.select.xRange[1]})}}},this._bMc=()=>{if(this._TA instanceof T.Z&&eu(this._TA,this._AOG),this._TA.select){var e=ep(this._TK,this._AsF,this._TA,X.X,-1);if(e){if(this._bLh(this._TA,e),!this._TA.select.xRange)throw Error("\u79FB\u52A8\u9009\u533A\u5F02\u5E38");this._bmT.scrollToVisible({col:this._TA.select.xRange[0]})}}},this._bMC=()=>{if(this._TA instanceof T.Z&&eu(this._TA,this._AOG),this._TA.select){var e=ep(this._TK,this._AsF,this._TA,X.Y,1);if(e){if(this._bLh(this._TA,e),!this._TA.select.yRange)throw Error("\u79FB\u52A8\u9009\u533A\u5F02\u5E38");this._bmT.scrollToVisible({row:this._TA.select.yRange[1]})}}},this._bMd=()=>{if(this._TA instanceof T.Z&&eu(this._TA,this._AOG),this._TA.select){var e=ep(this._TK,this._AsF,this._TA,X.Y,-1);if(e){if(this._bLh(this._TA,e),!this._TA.select.yRange)throw Error("\u79FB\u52A8\u9009\u533A\u5F02\u5E38");this._bmT.scrollToVisible({row:this._TA.select.yRange[0]})}}},this._bMD=()=>!this._TA.select||this._TA.select?.selectAll,this._bMe=(e,t,n)=>{var r=this._TA.select,i={activation:{row:this._TA.activeRow,col:this._TA.activeCol}};if(e.length>1||r.selectAll||r.selectRow||r.selectCol)return i;var o=(0,eO.Z)(this._Rj.activeSheet,n,!1);return n.contains(o)?i:{xRange:[o.startColIndex,o.endColIndex],yRange:[o.startRowIndex,o.endRowIndex],activation:t}},this._bME=()=>{if(this._bMD())return!1;var{activation:e,selectQueue:t=[]}=this._TA,n=t[0]?.yRange?.[0],r=t[0]?.yRange?.[1],i=t[0]?.xRange?.[0],o=t[0]?.xRange?.[1],{activeSheetId:a}=this._Rj,s=new ew.GridRange(a,eb(n),eb(r),eb(i),eb(o)),c=this._bMe(t,e,s);return this._bLh(this._TA,c),!1},this._bMf=()=>{if(this._TA.select){var e=(0,J.BS)(this._AsF,0,0,this._AsF.getRowCount()-1,(0,Y.Ln)([Y.So,Y.Qv])),t=(0,J.Q8)(this._AsF,0,0,this._AsF.getColCount()-1,(0,Y.Ln)([Y.Sl,Y.sb]));if(null!==e&&null!==t)return this._bLh(this._TA,{xRange:[t,t],yRange:[e,e],activation:{row:e,col:t}}),this._bmT.scrollToVisible({row:e,col:t}),ev.ZP.tdwReport({module:"excel_shortcuts",opername:"doc_excel_editor",action:em.default.isMac||em.default.isIPad?"select_shortcuts_Control+Fn+Left":"select_shortcuts_Ctrl+Home"}),!1}},this._bMF=()=>{if(this._TA.select){var e=(0,J.lP)(this._AsF,this._AsF.getRowCount()-1,this._AsF.getColCount()-1,0,Y.So),t=(0,J.Xe)(this._AsF,this._AsF.getRowCount()-1,this._AsF.getColCount()-1,0,Y.Sl);if(null!==e&&null!==t)return this._bLh(this._TA,{xRange:[t,t],yRange:[e,e],activation:{row:e,col:t}}),this._bmT.scrollToVisible({row:e,col:t}),ev.ZP.tdwReport({module:"excel_shortcuts",opername:"doc_excel_editor",action:em.default.isMac||em.default.isIPad?"select_shortcuts_Control+;":"select_shortcuts_Ctrl+;"}),!1}},this._tY=()=>{if(this._TA.select){var e=this._TA.activeRow,t=this._AsF.getColCount()-1,n=(0,J.Xe)(this._AsF,e,t,0,Y.hZ);if(null!==e&&null!==n)return this._Tb(this._TA,{xRange:[n,n],yRange:[e,e],activation:{row:e,col:n}}),this._bmT.scrollToVisible({row:e,col:n}),!1}},this._bMg=()=>{if(this._TA.select){var e=this._TA.activeRow,t=(0,J.Q8)(this._AsF,e,0,this._AsF.getColCount()-1,Y.hZ);if(null!==e&&null!==t)return this._Tb(this._TA,{xRange:[t,t],yRange:[e,e],activation:{row:e,col:t}}),this._bmT.scrollToVisible({row:e,col:t}),!1}},this._bMG=()=>{if(this._TA.select&&!this._TA.select?.selectAll){var{activation:e,selectQueue:t=[]}=this._TA,{yRange:n}=t[t.length-1],r={yRange:n?[n[0],n[1]]:void 0,activation:e};return this._bLh(this._TA,r),!1}},this._bMh=()=>{if(this._TA.select&&!this._TA.select?.selectAll){var{activation:e,selectQueue:t=[]}=this._TA,{xRange:n}=t[t.length-1],r={xRange:n?[n[0],n[1]]:void 0,activation:e};return this._bLh(this._TA,r),!1}},this._AsF=e.rowColAccessor,this._TA=e.selectData,this._AOG=e.normalSelectData,this._bmT=e.scrollApi,this._bmu=e.keyboardMount,this._Tb=e.startSelect,this._bLh=e.updateSelect,this._Rj=e.workbook,this._TK=e.transformTable,this._bmU=[{key:Q.ZP.KEYS.RIGHT,handler:this._tb},{key:Q.ZP.KEYS.LEFT,handler:this._sE},{key:Q.ZP.KEYS.DOWN,handler:this._bmv},{key:Q.ZP.KEYS.UP,handler:this._bmV},{key:Q.ZP.KEYS.RIGHT,shiftKey:!0,handler:this._bmw},{key:Q.ZP.KEYS.LEFT,shiftKey:!0,handler:this._bmW},{key:Q.ZP.KEYS.UP,shiftKey:!0,handler:this._bmX},{key:Q.ZP.KEYS.DOWN,shiftKey:!0,handler:this._bmx},{key:Q.ZP.KEYS.RIGHT,shortKey:!0,handler:this._bmZ},{key:Q.ZP.KEYS.LEFT,shortKey:!0,handler:this._bMa},{key:Q.ZP.KEYS.DOWN,shortKey:!0,handler:this._bMA},{key:Q.ZP.KEYS.UP,shortKey:!0,handler:this._bMb},{key:Q.ZP.KEYS.ENTER,handler:this._HN},{key:Q.ZP.KEYS.ENTER,shiftKey:!0,handler:this._bmy},{key:Q.ZP.KEYS.TAB,handler:this._bmY},{key:Q.ZP.KEYS.TAB,shiftKey:!0,handler:this._bmz},{key:Q.ZP.KEYS.RIGHT,shortKey:!0,shiftKey:!0,handler:this._bMB},{key:Q.ZP.KEYS.LEFT,shortKey:!0,shiftKey:!0,handler:this._bMc},{key:Q.ZP.KEYS.DOWN,shortKey:!0,shiftKey:!0,handler:this._bMC},{key:Q.ZP.KEYS.UP,shortKey:!0,shiftKey:!0,handler:this._bMd},{key:"a",shortKey:!0,handler:this._bME},{key:Q.ZP.KEYS.HOME,shortKey:!0,handler:this._bMf},{key:Q.ZP.KEYS.END,shortKey:!0,handler:this._bMF},{key:Q.ZP.KEYS.HOME,handler:this._bMg},{key:Q.ZP.KEYS.END,handler:this._tY},{key:Q.ZP.KEYS.SPACE,shiftKey:!0,ctrlKey:!em.default.isMac,handler:this._bMG},{key:Q.ZP.KEYS.SPACE,altKey:!0,ctrlKey:!em.default.isMac,handler:this._bMh},{key:Q.ZP.KEYS.SPACE_SAFARI,altKey:!0,handler:this._bMh}],this._bmt=new Q.ZP({root:this._bmu,bindings:this._bmU,shouldDisable:()=>(0,eI.G)(this._Rj.activeSheet.getSheetType())})}var t=e.prototype;return t._BpR=function(e){this._bmU.forEach(t=>{e.key===t.key&&e.shortKey===t.shortKey&&e.shiftKey===t.shiftKey&&e.altKey===t.altKey&&t.handler()})},t._BpL=function(e){this._TA=e},e}(),eD=function(){function e(e){this._bLu=null,this._bLU=null,this._bLJ=null,this._bLk=null,this._Aev=[],this._ATa=e=>{if(this._TB()&&!e.stopPropagation){if(e.e.shiftKey)return void this._bLw(e);var t,n=e.currRow,r=e.currCol;e.e.which&&1===e.e.which&&(this._Aev.push(this._Xw.onMousemove(this._Yn)),this._Aev.push(this._Xw.onMouseup(this._bLl)),this._AtV&&this._Aev.push(this._AtV.operateContext.mouseAndWheelPrepare.onWheelPrepare(this._Yn))),this._bLu=n,this._bLU=r,-1===n&&-1===r?(this._bLv={row:0,col:0},t={activation:this._bLv}):-1===r?(this._bLv={row:n,col:0},t={yRange:[n,n],activation:this._bLv}):-1===n?(this._bLv={row:0,col:r},t={xRange:[r,r],activation:this._bLv}):(r===Number.MAX_SAFE_INTEGER&&(r=this._KQ.getLastColInView()),n===Number.MAX_SAFE_INTEGER&&(n=this._KQ.getLastRowInView()),this._bLv={row:n,col:r},t={yRange:[n,n],xRange:[r,r],activation:this._bLv}),this._Tb(this._TA,t,e.e[Q.jQ]),this._bLG(this._TA)}},this._Yn=()=>{if(null===this._TA)throw Error("must bind selectData in SelectCells module");if(!this._Ta.stopPropagation){var e=this._Ta.currRow,t=this._Ta.currCol;if(-1!==this._bLu||-1!==this._bLU){var n=void 0,r=void 0;-1!==this._bLU&&(n=this._bLW(t)),-1!==this._bLu&&(r=this._bLx(e));var i={xRange:n,yRange:r,activation:this._bLv};this._bLh(this._TA,i)}}},this._bLl=()=>{this._bLu=null,this._bLU=null,this._bLJ=null,this._bLk=null,this._bLH(this._TA),this._Aev.forEach(e=>e.dispose()),this._Aev.length=0},this._Xw=e.mouseOperate,this._AtV=e.spreadsheetView,this._Ta=e.operateData,this._TA=e.selectData,this._KQ=e.areaData,this._AsF=e.rowColAccessor,this._bLG=e.readySelect,this._Tb=e.startSelect,this._bLh=e.updateSelect,this._bLH=e.endSelect,this.addMouseDownEvent()}var t=e.prototype;return t.addMouseDownEvent=function(){this._cAr=this._Xw.onMousedown(this._ATa)},t.removeMouseDownEvent=function(){this._cAr?.dispose()},t._BpL=function(e){this._TA=e},t._TB=function(){if(null===this._TA)throw Error("must bind selectData in SelectCells module");return!(this._Ta.stopPropagation||this._Ta.isOverTable())&&(2!==this._Ta.e.button||!(0,J.Kt)(this._Ta.currRow,this._Ta.currCol,this._TA))},t._bLw=function(e){if(this._TA){var t,n,{activeRow:r}=this._TA,{activeCol:i}=this._TA,o=e.currRow,a=e.currCol;-1===r&&(r=o),-1===i&&(i=a),-1!==a&&(t=a>i?[i,a]:[a,i]),-1!==o&&(n=o>r?[r,o]:[o,r]);var s={xRange:t,yRange:n};0===this._TA.selectQueue.length?this._Tb(this._TA,s,!1):this._bLh(this._TA,s)}},t._bLW=function(e){var t=[0,0];return e===Number.MAX_SAFE_INTEGER?e=this._KQ.getLastColInView():(e===Number.MIN_SAFE_INTEGER||-1===e)&&(e=this._KQ.getFirstColInView()),this._bLk,this._bLU>e?(t[0]=e,t[1]=Math.min(this._AsF.getColCount()-1,this._bLU)):(t[0]=this._bLU,t[1]=Math.min(this._AsF.getColCount()-1,e)),this._bLk=e,t},t._bLx=function(e){var t=[0,0];return e===Number.MAX_SAFE_INTEGER?e=this._KQ.getLastRowInView():(e===Number.MIN_SAFE_INTEGER||-1===e)&&(e=this._KQ.getFirstRowInView()),this._bLJ,this._bLu>=e?(t[0]=e,t[1]=Math.min(this._AsF.getRowCount()-1,this._bLu)):(t[0]=this._bLu,t[1]=Math.min(this._AsF.getRowCount()-1,e)),this._bLJ=e,t},e}(),eN=function(){function e(e){this._handleTap=e=>{if(this._TB()){var t=this._Ta.currRow,n=this._Ta.currCol;e.e.preventDefault(),this._Tb(this._TA,-1===t&&-1===n?{activation:{row:0,col:0}}:-1===n?{yRange:[t,t],activation:{row:t,col:0}}:-1===t?{xRange:[n,n],activation:{row:0,col:n}}:{yRange:[t,t],xRange:[n,n],activation:{row:t,col:n}})}},this._tZ=e.touchOperate,this._Ta=e.operateData,this._TA=e.selectData,this._Tb=e.startSelect,this._tZ.onTap(this._handleTap)}var t=e.prototype;return t._BpL=function(e){this._TA=e},t._TB=function(){if(null===this._TA)throw Error("must bind selectData in SelectCells module");return!(this._Ta.stopPropagation||this._Ta.isOverTable())},e}(),eM=function(e){function t(t){var n;return(n=e.call(this,t)||this)._bLG=e=>{n.onReadySelectEmitter.fire(e)},n._Tb=(e,t,r)=>{void 0===r&&(r=!1),n.onStartSelectEmitter.fire({selectData:e,options:t,multipleMode:r})},n._bLh=(e,t)=>{n.onUpdateSelectEmitter.fire({selectData:e,options:t})},n._bLH=e=>{n.onEndSelectEmitter.fire(e)},n._AsF=t.rowColAccessor,n._KQ=t.areaData,n._tZ=t.touchOperate,n._Xw=t.mouseOperate,n._AtV=t.spreadsheetView,n._Ta=t.operateData,n._bmT=t.scrollApi,n._bmu=t.keyboardMount,n._bMj=new eN({touchOperate:n._tZ,operateData:n._Ta,selectData:n._selectData,startSelect:n._Tb}),n._bMJ=new eD({mouseOperate:n._Xw,spreadsheetView:n._AtV,operateData:n._Ta,selectData:n._selectData,areaData:n._KQ,rowColAccessor:n._AsF,readySelect:n._bLG,startSelect:n._Tb,updateSelect:n._bLh,endSelect:n._bLH}),n._bMl=new ey({rowColAccessor:n._AsF,selectData:n._selectData,normalSelectData:n._normalSelectData,startSelect:n._Tb,updateSelect:n._bLh,scrollApi:n._bmT,keyboardMount:window.document.querySelector("#mainContainer"),workbook:n.workbook,transformTable:n._AtV.transformTable}),n}return(0,r._)(t,e),t.prototype.bindSelectData=function(e){this._selectData=e,this._bMj._BpL(this._selectData),this._bMJ._BpL(this._selectData),this._bMl._BpL(this._selectData)},(0,K._)(t,[{key:"_cAS",get:function(){return this._bMJ}},{key:"selectData",get:function(){return this._selectData}}]),t}(function(e){this.onReadySelectEmitter=new W.Q,this.onStartSelectEmitter=new W.Q,this.onUpdateSelectEmitter=new W.Q,this.onEndSelectEmitter=new W.Q,this._selectData=e.selectData,this._normalSelectData=e.normalSelectData,this._formulaSelectData=e.formulaSelectData,this.workbook=e.workbook,this.onReadySelect=this.onReadySelectEmitter.event,this.onStartSelect=this.onStartSelectEmitter.event,this.onUpdateSelect=this.onUpdateSelectEmitter.event,this.onEndSelect=this.onEndSelectEmitter.event}),eL=n(926584),ek=n(157054),eF=function(){function e(e){this._bLY=(e,t,n,r,i,o)=>({startCol:e,endCol:t,startRow:n,endRow:r,activation:i,selectData:o}),this._Rj=e}var t=e.prototype;return t._Bkv=function(e){if(this._bma(e)){var t=e.selectQueue[e.currentSelectIndex],n={startRow:-1,endRow:-1,startCol:-1,endCol:-1},r=null;if(t instanceof ed.Z&&([n.startRow,n.endRow]=t.yRange,n.startCol=0,n.endCol=Number.MAX_SAFE_INTEGER,r=ed.Z.newInstance(n.startRow,n.endRow)),t instanceof eA.Z&&([n.startCol,n.endCol]=t.xRange,n.startRow=0,n.endRow=Number.MAX_SAFE_INTEGER,r=eA.Z.newInstance(n.startCol,n.endCol)),t instanceof ef.Z&&([n.startRow,n.endRow]=t.yRange,[n.startCol,n.endCol]=t.xRange,r=ef.Z.newInstance(n.startRow,n.endRow,n.startCol,n.endCol)),e.removeSelection(e.currentSelectIndex),this._bmc(e,n,r),0===e.selectQueue.length){var i=this._bLY(n.startCol,n.startCol,n.startRow,n.startRow,null,e);e.resetSelection(),this._bmF(i)}this._bLs(e,e.selectQueue),this._bLZ(r)}},t._bLs=function(e,t){if(!t.some(e=>!!e.activation)){var n=t[t.length-1],r=this._bLz(n);e.updateSelection(t.length-1,r)}},t._bLz=function(e){var t={activation:new ek.Z(0,0),xRange:[0,0],yRange:[0,0]};return e instanceof ed.Z?{activation:new ek.Z(e.yRange[0],0),yRange:e.yRange}:e instanceof eA.Z?{activation:new ek.Z(0,e.xRange[0]),xRange:e.xRange}:e instanceof ef.Z?{activation:new ek.Z(e.yRange[0],e.xRange[0]),yRange:e.yRange,xRange:e.xRange}:t},t._bLZ=function(e){e instanceof ed.Z?ed.Z.destroy(e):e instanceof ef.Z?ef.Z.destroy(e):e instanceof eA.Z&&eA.Z.destroy(e)},t._bma=function(e){for(var t=!1,n=0;n<e.selectQueue.length-1&&!t;n++)if(e.selectQueue[n]instanceof e_.Z)return!0;var r=e.selectQueue[e.currentSelectIndex];return r instanceof ed.Z?t=this._bmA(r,e):r instanceof eA.Z?t=this._bmb(r,e):r instanceof ef.Z&&(t=this._bmB(r,e)),t},t._bmA=function(e,t){for(var n=!1,r=0;r<t.selectQueue.length-1&&!n;r++){var i=t.selectQueue[r],o=e.yRange[0];if(i instanceof ed.Z){var[a,s]=i.yRange;n=!!(a<=o&&o<=s)}}return n},t._bmb=function(e,t){for(var n=!1,r=0;r<t.selectQueue.length-1&&!n;r++){var i=t.selectQueue[r],o=e.xRange[0];if(i instanceof eA.Z){var[a,s]=i.xRange;n=!!(a<=o&&o<=s)}}return n},t._bmB=function(e,t){var n=!1;if(!e.activation)return n;for(var{row:r,col:i}=e.activation,o=0;o<t.selectQueue.length-1&&!n;o++){var a=t.selectQueue[o];if(a instanceof ef.Z){var[s,c]=a.xRange,[l,u]=a.yRange;l<=r&&r<=u&&s<=i&&i<=c&&(n=!0)}else if(a instanceof eA.Z){var[h,_]=a.xRange;h<=i&&i<=_&&(n=!0)}else if(a instanceof ed.Z){var[A,d]=a.yRange;A<=r&&r<=d&&(n=!0)}}return n},t._bmc=function(e,t,n){for(var{length:r}=e.selectQueue,i=r;i>=0;i--){var o=(0,eL.Z)(e.selectQueue[i]);o instanceof ef.Z&&this._bme(n,o,t,e,i),o instanceof ed.Z&&this._bmD(n,o,t,e,i),o instanceof eA.Z&&this._bmd(n,o,t,e,i),o instanceof e_.Z&&this._bmC(n,t,e,i)}},t._bmC=function(e,t,n,r){n.removeSelection(r);var i=this._Rj.activeSheet.getColCount(),o=this._Rj.activeSheet.getRowCount(),a=this._bmf(t,{startRow:0,startCol:0,endCol:i,endRow:o});if(a){var{startCol:s,endCol:c,startRow:l,endRow:u}=a;if(e instanceof ed.Z){var h=this._bLY(-1,-1,u+1,o-1,null,n),_=this._bLY(-1,-1,0,l-1,null,n);this._bmE([h,_])}else if(e instanceof eA.Z){var A=this._bLY(c+1,i-1,-1,-1,null,n),d=this._bLY(0,s-1,-1,-1,null,n);this._bmE([A,d])}else if(e instanceof ef.Z){var f=this._bLY(-1,-1,u+1,o-1,null,n),E=this._bLY(c+1,i-1,l,u,null,n),g=this._bLY(0,s-1,l,u,null,n),R=this._bLY(-1,-1,0,l-1,null,n);this._bmE([f,E,g,R])}}},t._bmd=function(e,t,n,r,i){var[o,a]=t.xRange,s=this._Rj.activeSheet.getRowCount(),c=this._bmf(n,{startRow:0,startCol:o,endCol:a,endRow:Number.MAX_SAFE_INTEGER});if(c){var{startCol:l,endCol:u,startRow:h,endRow:_}=c;if(e instanceof ed.Z){var[A,d]=e.yRange;r.removeSelection(i);var f=this._bLY(o,a,d+1,s-1,null,r),E=this._bLY(o,a,0,A-1,null,r);this._bmE([f,E])}else if(e instanceof eA.Z&&o<=l&&u<=a){r.removeSelection(i);var g=this._bLY(u+1,a,-1,-1,null,r),R=this._bLY(o,l-1,-1,-1,null,r);this._bmE([g,R])}else if(e instanceof ef.Z){r.removeSelection(i);var C=this._bLY(o,a,_+1,s-1,null,r),T=this._bLY(u+1,a,h,_,null,r),p=this._bLY(o,l-1,h,_,null,r),v=this._bLY(o,a,0,h-1,null,r);this._bmE([C,T,p,v])}}},t._bmD=function(e,t,n,r,i){var[o,a]=t.yRange,s=this._Rj.activeSheet.getColCount(),c=this._bmf(n,{startRow:o,startCol:0,endCol:Number.MAX_SAFE_INTEGER,endRow:a});if(c){var{startCol:l,endCol:u,startRow:h,endRow:_}=c;if(e instanceof ed.Z&&o<=h&&_<=a){r.removeSelection(i);var A=this._bLY(-1,-1,_+1,a,null,r),d=this._bLY(-1,-1,o,h-1,null,r);this._bmE([A,d])}else if(e instanceof eA.Z){var[f,E]=e.xRange;r.removeSelection(i);var g=this._bLY(E+1,s-1,o,a,null,r),R=this._bLY(0,f-1,o,a,null,r);this._bmE([g,R])}else if(e instanceof ef.Z){r.removeSelection(i);var C=this._bLY(-1,-1,_+1,a,null,r),T=this._bLY(0,l-1,h,_,null,r),p=this._bLY(u+1,s-1,h,_,null,r),v=this._bLY(-1,-1,o,h-1,null,r);this._bmE([C,T,p,v])}}},t._bme=function(e,t,n,r,i){var[o,a]=t.xRange,[s,c]=t.yRange,l=this._bmf(n,{startRow:s,startCol:o,endCol:a,endRow:c});if(l){var{startRow:u,startCol:h,endRow:_,endCol:A}=l;if(e instanceof eA.Z&&o<=h&&A<=a){r.removeSelection(i);var d=this._bLY(A+1,a,s,c,null,r),f=this._bLY(o,h-1,s,c,null,r);this._bmE([d,f])}if(e instanceof ed.Z&&s<=u&&_<=c){r.removeSelection(i);var E=this._bLY(o,a,_+1,c,null,r),g=this._bLY(o,a,s,u-1,null,r);this._bmE([E,g])}if(e instanceof ef.Z&&o<=h&&h<=a&&s<=u&&u<=c){r.removeSelection(i);var R=this._bLY(o,a,s,u-1,null,r),C=this._bLY(o,h-1,u,_,null,r),T=this._bLY(A+1,a,u,_,null,r),p=this._bLY(o,a,_+1,c,null,r);this._bmE([p,T,C,R])}}},t._bmE=function(e){e.forEach(e=>{this._bmF(e)})},t._bmf=function(e,t){var n=Math.max(e.startCol,t.startCol),r=Math.max(e.startRow,t.startRow),i=Math.min(e.endCol,t.endCol),o=Math.min(e.endRow,t.endRow);return i>=n&&o>=r?{startCol:n,startRow:r,endCol:i,endRow:o}:null},t._bmF=function(e){var{startRow:t,endRow:n,startCol:r,endCol:i,activation:o,selectData:a}=e;if(!(t>n)&&!(r>i)){var s=this._bmg({startRow:t,endRow:n,startCol:r,endCol:i,activation:o,selectData:a});a.addSelection(s)}},t._bmg=function(e){var{startRow:t,endRow:n,startCol:r,endCol:i,activation:o}=e,a={yRange:[t,n],xRange:[r,i],activation:o};return -1===t&&-1===n&&(a.yRange=null),-1===r&&-1===i&&(a.xRange=null),a},e}(),eP=function(){function e(e,t){this._bMs=e=>{e instanceof T.Z||e.selectQueue.length<1||this._bMR._Bkv(e)},this._bMS=e=>{var{selectData:t,options:n,multipleMode:r}=e;!r&&this._bMT&&t===this._AOG&&t.resetSelection();var i=t.currentSelectIndex;r||t.getIsInsertion()||0===t.selectQueue.length?t.addSelection(n,null):t.updateSelection(i,n,null),t===this._AOG?this._bMH.show():t===this._bLF&&(this._Ta.preventAutoTapFocus=!0,this._bMi.show())},this._bMt=e=>{var{selectData:t,options:n}=e,r=t.currentSelectIndex;t.updateSelection(r,n,null)},this._bFv=e,this._AOG=t.normalSelectData,this._bLF=t.formulaSelectData,this._bMH=t.normalSelectionStage,this._bMi=t.formulaSelectionStage,this._bMr=t.autoScroll,this._Ta=t.operateData,this._bFv.onStartSelect(this._bMS),this._bFv.onUpdateSelect(this._bMt),this._Rj=t.workbook,this._bMR=new eF(this._Rj),this._bFv.onReadySelect(e=>{var t=e.select;null!==t&&(t.selectCol?this._bMr.ready(h.OD.X):t.selectRow?this._bMr.ready(h.OD.Y):t.selectCell&&this._bMr.ready(h.OD.ALL))}),this._bFv.onEndSelect(this._bMs)}return(0,K._)(e,[{key:"_bMT",get:function(){return this._AOG.selectQueue.length>1}}]),e}(),ex=function(){function e(e){this._AOg=new eM(e),this._ArS=new eP(this._AOg,e)}return(0,K._)(e,[{key:"_Bwb",get:function(){return this._AOg}}]),e}(),eZ=n(426948),eB=n(622850),eH=function(e){function t(){var t;return t=e.apply(this,arguments)||this,t._cBE=!1,t}(0,r._)(t,e);var i=t.prototype;return i.initLevel1=function(){if(this._BXM||this._BXn(),this._cBE)return void n.g.log?.info("view.level1\u5DF2\u7ECF\u521D\u59CB\u5316");this.initLevel1Readonly(),n.g.log?.info("view.level1\u521D\u59CB\u5316"),this._cBE=!0},i.init=function(t){e.prototype.init.call(this,t)},i.refresh=function(t){e.prototype.refresh.call(this,t)},i.initLevel1Readonly=function(){this._initNormalSelectionStage(),this._initFormulaSelectionStage(),this._initWheelOperate(),this._initSlideOperate(),this._initSelectCells(),this.initScrollBar(),this.initDimensionColor()},i._initSelectCells=function(){this._Byf=new ex({workbook:this.workbook,rowColAccessor:this.rowColAccessor,areaData:this.areaData,touchOperate:this.touchOperate,mouseOperate:this.mouseOperate,spreadsheetView:this.spreadsheetView,selectData:this.normalSelectData,operateData:this.operateData,container:this.container,scrollApi:this.scrollApi,keyboardMount:this.container,normalSelectData:this.normalSelectData,formulaSelectData:this.formulaSelectData,normalSelectionStage:this.normalSelectionStage,formulaSelectionStage:this.formulaSelectionStage,autoScroll:this.autoScroll,clientRect:this.clientRect,mutexManagement:this.mutexManagement})},i._initWheelOperate=function(){this._BDe=new Z.Z(this.spreadsheetView,[this.mainBoard.element,this.operateBoard.board]),new H.Z(this._BDe,this.spreadsheetView)},i._initSlideOperate=function(){this.slideOperate=new B.Z(this.spreadsheetView,this.sdkSheetsBarService),new U.Z(this.slideOperate,this.spreadsheetView)},i._initNormalSelectionStage=function(){this.normalSelectionStage=new G.Z(this._BRt,this.normalSelectData,this.spreadsheetView,this.sheetStatus,this.mutexManagement)},i._initFormulaSelectionStage=function(){this.formulaSelectionStage=new V.Z(this.formulaSelectData,this.spreadsheetView,this.mutexManagement)},i.initScrollBar=function(){this.scrollBar=new eZ.Z({mainBoard:this.spreadsheetView.mainBoard,areaData:this.spreadsheetView.areaData,scale:this.spreadsheetView.scale})},i.initDimensionColor=function(){new eB.Z(this.workbook,this.spreadsheetView,this.normalSelectData)},t}(x)},496430:function(e,t,n){n.d(t,{Co:function(){return K},GB:function(){return W},GD:function(){return X},I1:function(){return Y},J9:function(){return B},Lc:function(){return j},OB:function(){return eo},QX:function(){return T},S8:function(){return m},SH:function(){return I},Tx:function(){return k},U2:function(){return p},V:function(){return ea},XL:function(){return D},Xl:function(){return M},Xs:function(){return L},YH:function(){return x},ai:function(){return v},bU:function(){return ee},d4:function(){return S},d8:function(){return C},dT:function(){return z},e6:function(){return er},eP:function(){return V},et:function(){return Q},ey:function(){return en},gU:function(){return R},kD:function(){return U},kW:function(){return H},kp:function(){return q},lD:function(){return w},li:function(){return G},lu:function(){return es},mK:function(){return Z},oH:function(){return F},t1:function(){return et},vf:function(){return E},vz:function(){return ei},xc:function(){return J},xw:function(){return N}});var r=n(445506),i=n(388896),o=n(469514),a=n(869855),s=n(36205),c=n(245484),l=n(437121),u=n(365392),h=n(541612),_=n(841491),A=n(540217);n(715399),n(556930),n(671638);var d=n(45865),f=n(524112),E=()=>(0,f.TN)()?1:50,g=(0,o.zL)(a.b0),R=()=>(0,f.TN)()?1:g,C=9,T=1,p=1,v=1,m=.25,S=4,w=.25,I=2,O=A.v.THIN,b=l.Z.newInstanceByHex(a.BM.borderColor),y=l.Z.newInstanceByHex(a.BM.borderColorDark),D=a.BM.borderStyle,N=l.Z.newInstanceByHex(a.BM.color),M=10,L="var(--bg-lv1-medium)",k={width:O,style:D,color:b},F={width:O,style:D,color:y},P=h.ZP.newInstance(a.BM.verticalAlign),x=u.ZP.newInstance(a.BM.horizontalAlign),Z=_.Z.newInstance(_.J.NOWRAP);l.Z.newInstanceByHex("#d6d6d6");var B=c.Z.newInstance(c.i.EMPTY,c.i.TEXT,c.i.EMPTY,c.i.TEXT),H=4,U=2,V="#ffb300",G={Height:22,Radius:11,OuterPadding:1,InnerLeftRightPadding:8,InnerLeftRightPaddingEnt:2,TriangleWidth:8,TriangleHeight:5,LabelAndTrianglePadding:4},K=[0,0,G.TriangleWidth,0,G.TriangleWidth/2,G.TriangleHeight],W={TextColor:"#0188fb",BorderWidth:1,StrokeColor:"#e0e0e0",NormalFillColor:"#ffffff",HoverFillColor:"#f4f4f4",HighlightFillColor:"#fff4c4",ShadowInfo:{shadowColor:"#B9B9B9",shadowOffsetX:0,shadowOffsetY:2,shadowBlur:10},TriangleColor:"#0188fb"},Q={borderWidth:W.BorderWidth,fillColor:W.NormalFillColor,strokeColor:W.StrokeColor,shadowInfo:W.ShadowInfo},Y={borderWidth:W.BorderWidth,fillColor:W.HoverFillColor,strokeColor:W.StrokeColor,shadowInfo:W.ShadowInfo},q={borderWidth:W.BorderWidth,fillColor:W.HighlightFillColor,strokeColor:W.StrokeColor,shadowInfo:W.ShadowInfo},J=r.Z.newInstance({background:s.C,horizontalAlign:x,verticalAlign:P,wrapStrategy:Z,indent:0,shrinkToFit:!1,justifyLastLine:!1,textRotation:void 0}),j="doc"===d.Z.getConfig("client"),X=500,z=50,ee=250,et={style:D,color:b},en={style:D,color:l.Z.newInstanceByHex("#02bd88")},er={style:D,color:l.Z.newInstanceByHex("#1e6fff")},ei={width:O,style:D,color:b};i.ZP.t("\u5AE9\u9EC4"),i.ZP.t("\u5AE9\u7EFF"),i.ZP.t("\u5AE9\u9752"),i.ZP.t("\u5AE9\u84DD\u7D2B"),i.ZP.t("\u5AE9\u7C89"),i.ZP.t("\u5AE9\u7EA2"),i.ZP.t("\u5AE9\u7070"),i.ZP.t("\u4EAE\u9EC4"),i.ZP.t("\u4EAE\u7EFF"),i.ZP.t("\u4EAE\u9752"),i.ZP.t("\u4EAE\u84DD\u7D2B"),i.ZP.t("\u4EAE\u7C89"),i.ZP.t("\u4EAE\u7EA2"),i.ZP.t("\u4EAE\u7070");var eo=[{color:"#FFE270",realColor:"#FFF5CC",text:i.ZP.t("\u6D45\u70701")},{color:"#FFD1A8",realColor:"#FFECDB",text:i.ZP.t("\u6D45\u84DD1")},{color:"#FAB0AE",realColor:"#FFDCDB",text:i.ZP.t("\u6D45\u5929\u84DD1")},{color:"#FAADD7",realColor:"#FFDBEA",text:i.ZP.t("\u6D45\u7EFF1")},{color:"#F5A8FF",realColor:"#FBDBFF",text:i.ZP.t("\u6D45\u7EA21")},{color:"#DAE0E7",realColor:"#F3F5F7",text:i.ZP.t("\u6D45\u6A59\u82721")},{color:"#8FE0B5",realColor:"#D3F3E2",text:i.ZP.t("\u6D45\u9EC41")},{color:"#8FDAFF",realColor:"#D6F1FF",text:i.ZP.t("\u6D45\u7D2B1")},{color:"#8FB8FF",realColor:"#D6E5FF",text:i.ZP.t("\u6D45\u7C89\u7EA21")},{color:"#FFCE0A",realColor:"#FFEA99",text:i.ZP.t("\u6D45\u70702")},{color:"#FF871F",realColor:"#FFCEA3",text:i.ZP.t("\u6D45\u84DD2")},{color:"#FF453D",realColor:"#FFB5B2",text:i.ZP.t("\u6D45\u5929\u84DD2")},{color:"#FF3DA7",realColor:"#FFB2DC",text:i.ZP.t("\u6D45\u7EFF2")},{color:"#C13DFF",realColor:"#E7B4FF",text:i.ZP.t("\u6D45\u7EA22")},{color:"#6E7B91",realColor:"#C5CAD3",text:i.ZP.t("\u6D45\u6A59\u82722")},{color:"#3FB576",realColor:"#ACE2C5",text:i.ZP.t("\u6D45\u9EC42")},{color:"#33BBFF",realColor:"#ADE4FF",text:i.ZP.t("\u6D45\u7D2B2")},{color:"#337EFF",realColor:"#ADCBFF",text:i.ZP.t("\u6D45\u7C89\u7EA22")}];l.Z.newInstanceByHex("#CBCDD1");var ea=20,es=104},107439:function(e,t,n){t.Z=(0,n(730635).y)("IDataCallView")},136811:function(e,t,n){var r=n(921734),i=n(209787);n(575739);var o=n(340576),a=n(696030),s=n(450586),c=n(777601),l=n(518215),u=n(262573),h=n(100837),_=n(460725),A=n(954057),d=n(892125),f=n(115089),E=function(e){function t(t){var n;return(n=e.call(this)||this).formulaDisplay=!1,n._ALw=!1,n.workbook=t,n._ALQ=new o.Q5,n._ALr=new o.Q5,n._ALR=new o.Q5,n._ALs=new o.Q5,n._ALS=new o.Q5,n._ALt=new o.Q5,n._ALT=new o.Q5,n._ALu=new o.Q5,n._ALU=new o.Q5,n._ALv=new o.Q5,n._ALV=new o.Q5,n.handleChangeDiff=e=>{s.ZP.jankMonitor.handleJankPathStack({moduleValue:"dataCallView",actionValue:"handleChangeDiff"});try{if(n._ALw)return;if(n._ALQ.fire(),n._ALW=(0,A.p3)(n.workbook.activeSheetId),f.q.getConfig("isHistory"))return void n._ALy(e.ranges);n._ALx(e),n._ALy(e.ranges),n._ALY(e),n._ALX(e),n._AmA(e),n._AmC(e)}catch(e){(0,c.b)(c.r.MUTATION_APPLY_TO_VIEW_ERROR,"DataCallView",e)}},n.beforeHandleDiff=n._ALQ.event,n.onRender=n._ALr.event,n.onInsertDeleteRow=n._ALR.event,n.onInsertDeleteCol=n._ALs.event,n.onSetRowHeight=n._ALS.event,n.onSetColWidth=n._ALt.event,n.onSetRowVisible=n._ALT.event,n.onSetColVisible=n._ALu.event,n.onSetDimensionStyle=n._ALU.event,n.onUpdateCells=n._ALv.event,n.onSetDimensionCount=n._ALV.event,n._register(n.workbook.event.onChangeDiff(n.handleChangeDiff)),n}(0,r._)(t,e);var n=t.prototype;return n.stop=function(){this._ALw=!0},n.start=function(){this._ALw=!1},n.forceUpdateCells=function(e){this._ALv.fire(e)},n.openFormulaDisplay=function(){this.formulaDisplay=!0},n.closeFormulaDisplay=function(){this.formulaDisplay=!1},n.setRowHeight=function(e){var{rowHeights:t,rowRanges:n}=e,r=t.map(e=>{var{row:t,size:n,sheetId:r}=e;return{dimensionRange:{sheetId:r,startIndex:t,endIndex:t,dimensionType:h.O.Row},size:n}});this._ALS.fire({dimensionSizes:r,rowRanges:n})},n._ALx=function(e){var t=e.insertedDimensions.filter(e=>{var{dimensionType:t}=e;return t===h.O.Row}),n=e.insertedDimensions.filter(e=>{var{dimensionType:t}=e;return t===h.O.Col}),r=e.deletedDimensions.filter(e=>{var{dimensionType:t}=e;return t===h.O.Row}),i=e.deletedDimensions.filter(e=>{var{dimensionType:t}=e;return t===h.O.Col});t.length&&this._Amc(t.map(e=>(0,A.eI)(e.sheetId,Math.max(e.index-1,0),_.INFINITE_INDEX))),n.length&&this._Amc(n.map(e=>(0,A.Sh)(e.sheetId))),r.length&&this._Amc(r.map(e=>(0,A.eI)(e.sheetId,e.index,_.INFINITE_INDEX))),i.length&&this._Amc(i.map(e=>(0,A.Sh)(e.sheetId))),(t.length||r.length)&&this._ALR.fire({insert:t,remove:r}),(n.length||i.length)&&this._ALs.fire({insert:n,remove:i});var o=e.hideShowDimensions.filter(e=>{var{type:t}=e;return t===h.O.Row}).map(e=>{var{sheetId:t,type:n,dimensionRange:r}=e;return{dimensionRange:{sheetId:t,startIndex:r.startIndex,endIndex:r.endIndex,dimensionType:n}}}),a=e.hideShowDimensions.filter(e=>{var{type:t}=e;return t===h.O.Col}).map(e=>{var{sheetId:t,type:n,dimensionRange:r}=e;return{dimensionRange:{sheetId:t,startIndex:r.startIndex,endIndex:r.endIndex,dimensionType:n}}});o.length&&(this._Amc(o.map(e=>{var{dimensionRange:t}=e;return(0,A.eI)(t.sheetId,t.startIndex,t.endIndex)})),this._ALT.fire(o)),a.length&&(this._Amc(a.map(e=>{var{dimensionRange:t}=e;return(0,A.Sh)(t.sheetId)})),this._ALu.fire(a));var s=e.resizedDimensions.filter(e=>{var{type:t}=e;return t===h.O.Row}).map(e=>{var{sheetId:t,type:n,dimensionRange:r,value:i}=e;return{dimensionRange:{sheetId:t,startIndex:r.startIndex,endIndex:r.endIndex,dimensionType:n},size:i}}),c=e.resizedDimensions.filter(e=>{var{type:t}=e;return t===h.O.Col}).map(e=>{var{sheetId:t,type:n,dimensionRange:r,value:i}=e;return{dimensionRange:{sheetId:t,startIndex:r.startIndex,endIndex:r.endIndex,dimensionType:n},size:i}});if(s.length){var l=s[0].dimensionRange.startIndex,u=s[0].dimensionRange.endIndex;this._Amc(s.map(e=>{var{dimensionRange:t}=e;return l=Math.min(l,t.startIndex),u=Math.max(u,t.endIndex),(0,A.eI)(t.sheetId,t.startIndex,t.endIndex)})),this._ALS.fire({dimensionSizes:s,rowRanges:{startRowIndex:l,endRowIndex:u}})}c.length&&(this._Amc(c.map(e=>{var{dimensionRange:t}=e;return(0,A.Sh)(t.sheetId)})),this._ALt.fire(c));var d=e.dimensionStyles.filter(e=>{var{type:t}=e;return t===h.O.Row}).map(e=>{var{sheetId:t,type:n,dimensionRange:r,defaultStyle:i}=e;return{dimensionRange:{sheetId:t,startIndex:r.startIndex,endIndex:r.endIndex,dimensionType:n},defaultStyle:i}}),f=e.dimensionStyles.filter(e=>{var{type:t}=e;return t===h.O.Col}).map(e=>{var{sheetId:t,type:n,dimensionRange:r,defaultStyle:i}=e;return{dimensionRange:{sheetId:t,startIndex:r.startIndex,endIndex:r.endIndex,dimensionType:n},defaultStyle:i}});d.length&&(this._Amc(d.map(e=>{var{dimensionRange:t}=e;return(0,A.eI)(t.sheetId,t.startIndex,t.endIndex)})),this._ALU.fire(d)),f.length&&(this._Amc(f.map(e=>{var{dimensionRange:t}=e;return(0,A.Sh)(t.sheetId)})),this._ALU.fire(f))},n._ALX=function(e){e.dimensionCountChangedSheetId&&(this._Amc([(0,A.Sh)(e.dimensionCountChangedSheetId)]),this._ALV.fire({sheetId:e.dimensionCountChangedSheetId,colCount:this.workbook.activeSheet.getColCount()}))},n._ALy=function(e){if(0!==e.length){var t=this.workbook.activeSheet.customSheetViewManager.getActiveSortRange(),n=[];e.forEach(e=>{var r=t?.intersect(e)?(0,d.q)([e],this.workbook.activeSheet):[e];n.push.apply(n,[].concat(r)),this._Amc(r)}),n.length>0&&this._ALv.fire({gridRanges:n})}},n._ALY=function(e){e.filterRanges.length&&e.filterRanges.forEach(e=>{var{type:t}=e;switch(t){case u.Y4.Add:this._ALz(e);break;case u.Y4.Update:this._ALZ(e);break;case u.Y4.Remove:this._Ama(e)}})},n._ALz=function(e){var{newWorkbookRange:t}=e,n=t.getRange();this._Amc([n]);var{sheetId:r,startRowIndex:i,endRowIndex:o,startColIndex:a,endColIndex:s}=n;this._ALv.fire({gridRanges:[new _.GridRange({sheetId:r,startRowIndex:i,endRowIndex:i,startColIndex:a,endColIndex:s})]});var c=t.filterProperty||t.localFilterProperty;(c?.hiddenRows?.length||0)>0&&this._ALT.fire([{dimensionRange:{sheetId:r,startIndex:i,endIndex:o,dimensionType:h.O.Row}}])},n._ALZ=function(e){if(e.newWorkbookRange?.getRange().sheetId===this.workbook.activeSheetId){var{newWorkbookRange:t,oldWorkbookRange:n}=e,r=t.getRange(),i=n.getRange();if(this._Amc([(0,A.eI)(r.sheetId,r.startRowIndex,Math.max(i.endRowIndex,r.endRowIndex))]),this.workbook.activeSheet.customSheetViewManager.getActiveGuid()){var o=[];o.push(i),r.subtract(i).forEach(e=>{o.push(e)}),this._ALv.fire({gridRanges:o})}this._ALT.fire([{dimensionRange:{sheetId:r.sheetId,startIndex:r.startRowIndex,endIndex:Math.max(i.endRowIndex,r.endRowIndex),dimensionType:h.O.Row}}])}},n._Ama=function(e){var{oldWorkbookRange:t}=e,n=t.getRange();this._Amc([n]);var{sheetId:r,startRowIndex:i,endRowIndex:o,startColIndex:a,endColIndex:s}=n;this._ALv.fire({gridRanges:[new _.GridRange({sheetId:r,startRowIndex:i,endRowIndex:i,startColIndex:a,endColIndex:s})]}),this._ALT.fire([{dimensionRange:{sheetId:r,startIndex:i,endIndex:o,dimensionType:h.O.Row}}])},n._AmA=function(e){var{customSheetViews:t}=e;if(t){var n=this._Amb(t);if(n){var{activeSheet:r,activeSheetId:i}=this.workbook,o=new _.GridRange({sheetId:i,startRowIndex:0,endRowIndex:r.getRowCount(),startColIndex:0,endColIndex:r.getColCount()});this._Amc([o]),this._ALv.fire({gridRanges:[o]});var{oldCustomSheetView:a,newCustomSheetView:s}=n,c=a?a.rowProperties:r.rowProperties,l=a?a.colProperties:r.colProperties,u=s?s.rowProperties:r.rowProperties,h=s?s.colProperties:r.colProperties,A=this._AmB(c,u,i,!0),d=this._AmB(l,h,i,!1);A.length&&this._ALT.fire(A),d.length&&this._ALu.fire(d)}}},n._Amb=function(e){var{activeSheet:t,activeSheetId:n}=this.workbook;for(var r of e){if(r.type===u.Dt.SetActive&&r.sheetId===n){var{originGuid:i}=r;return{oldCustomSheetView:i?t.customSheetViewManager.getCustomSheetViewByGuid(i):null,newCustomSheetView:t.customSheetViewManager.getActiveCustomSheetView()}}if(r.type===u.Dt.Update&&r.guid===t.customSheetViewManager.getActiveGuid())return r}return null},n._AmB=function(e,t,n,r){var i=[];return[e,t].forEach(e=>e?.forEach((e,t)=>{e?.hiddenByUser&&i.push({dimensionRange:{sheetId:n,startIndex:t,endIndex:t,dimensionType:r?h.O.Row:h.O.Col}})})),i},n._Amc=function(e){e.forEach(e=>{this._ALW.combineRange(e)})},n._AmC=function(e){this._ALr.fire({diffData:e,updatedRowRange:this._ALW.isInvalid()?void 0:this._ALW})},t}(a.Disposable);t.Z=(0,i.__decorate)([(0,i.__param)(0,l.lc),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[void 0===l.lc?Object:l.lc])],E)},305304:function(e,t,n){var r=n(434902),i=n(921734),o=n(345448),a=n(311759);t.Z=function(e){function t(t){var n;return(n=e.call(this,t)||this).workbook=t,n}(0,i._)(t,e);var n=t.prototype;return n._CGm=function(){var e=this;return(0,r._)(function*(){yield e.canvas.initLevel1(),e.canvas.renderApi.renderTable();var t=e.workbook.activeSheet.getSheetType();(0,a.G)(t)||e._cCX.fire(t)})()},n.initLevel2=function(){var e=this;return(0,r._)(function*(){yield e.canvas.initLevel2(),e._cCx.fire()})()},n._cwX=function(){},n.onRefresh=function(){},t}(o.Z)},540:function(e,t,n){n.d(t,{R:function(){return r}});var r={NORMAL:1,PIC:2,CHART:3,SHAPE:4,GROUP:5,SLICER:6,SMART_ART:7,FLOAT_OBJECTS:8}},402545:function(e,t,n){n.d(t,{w:function(){return r}});var r=(0,n(730635).y)("IView")},932724:function(e,t,n){n.d(t,{w:function(){return S},Z:function(){return I}});var r=n(434902),i=n(921734),o=n(209787);n(738355);var a=n(730635),s=n(696272),c=n(758699),l=n(693225),u=n(45865),h=n(712096),_=n(861602),A=n(622850),d=n(511680),f=n(234599),E=function(e){function t(){var t;return t=e.apply(this,arguments)||this,t.level2Inited=!1,t}(0,i._)(t,e);var o=t.prototype;return o.initLevel2=function(){var t=this,n=()=>e.prototype.initLevel1;return(0,r._)(function*(){if(t._cBE||(yield n().call(t)),t.level2Inited)return void console.info("view.preview \u5DF2\u7ECF\u521D\u59CB\u5316");console.info("view.preview \u521D\u59CB\u5316"),yield t._bKY(),yield t._blh(),yield t._blA(),yield t._bla(),yield t._bsA(),yield t._bsB(),t.level2Inited=!0})()},o.init=function(t){var n=this,i=()=>e.prototype.init;return(0,r._)(function*(){i().call(n,t)})()},o.refresh=function(t){e.prototype.refresh.call(this,t)},o.getCanvasProvider=function(){return this.canvasProvider},o._bKY=function(){var e=this;return(0,r._)(function*(){e.contextMenuCenter=yield(0,d.mD)(l.N)})()},o._blA=function(){var e=this;return(0,r._)(function*(){e.filterCenter=yield(0,d.mD)(f.tm)})()},o._bla=function(){var e=this;return(0,r._)(function*(){e.copyFrame=new(yield n.e("28730").then(n.bind(n,74380))).default({alloyExcel:e.alloyExcel,workbook:e.workbook,view:e._BRt})})()},o._bsA=function(){new A.Z(this.workbook,this.spreadsheetView,this.normalSelectData)},o._bsB=function(){var e=this;return(0,r._)(function*(){e.canvasProvider=new(yield h.U[h.k.CANVAS_PROVIDER]()).default({alloyExcel:e.alloyExcel,workbook:e.workbook,areaData:e.areaData,headSize:e.headSize,calculateSplitter:e.calculateSplitter,borderAccessor:e.borderAccessor,transformTable:e.transformTable})})()},o._blh=function(){var e=this;return(0,r._)(function*(){!1!==u.Z.getConfig("toolbar.insertGroup.location")&&(e.locationRenderPlugin=new(yield Promise.resolve().then(n.bind(n,779689))).default({alloyExcel:e.alloyExcel,workbook:e.workbook,view:e._BRt,sheetStatus:e.sheetStatus}))})()},(0,c._)(t,[{key:"contextMenu",get:function(){if(this.contextMenuCenter)return this.contextMenuCenter.contextMenu}},{key:"selectCells",get:function(){return this._Byf._Bwb}}]),t}(_.Z),g=n(107439),R=n(645592),C=n(484670),T=n(305304),p=n(962168),v=n(518215),m=n(142947),S=(0,a.y)("IView"),w=function(e){function t(t,n,r,i,o,a,s){var c;return(c=e.call(this,n)||this).instantiationService=t,c.workbook=n,c.sheetStatus=r,c.dataCallView=i,c.mutexManagement=o,c.spreadsheetView=a,c.sdkSheetsBarService=s,c}return(0,i._)(t,e),t.prototype.initCanvas=function(){var e=this;return(0,r._)(function*(){if(e._cCW.fire(),e.canvas)throw Error("\u89C6\u56FE\u5DF2\u7ECF\u521D\u59CB\u5316");e.canvas=new E(e.instantiationService,e.workbook,e,e.spreadsheetView,e.mutexManagement,e.dataCallView,e.sheetStatus,e.sdkSheetsBarService),yield e._CGm()})()},t}(T.Z),I=w=(0,o.__decorate)([(0,o.__param)(0,s.T),(0,o.__param)(1,v.lc),(0,o.__param)(2,m.T),(0,o.__param)(3,g.Z),(0,o.__param)(4,R.Z),(0,o.__param)(5,C.Z),(0,o.__param)(6,p.Z),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.T?Object:s.T,void 0===v.lc?Object:v.lc,void 0===m.T?Object:m.T,void 0===g.Z?Object:g.Z,void 0===R.Z?Object:R.Z,void 0===C.Z?Object:C.Z,void 0===p.Z?Object:p.Z])],w)},920333:function(e,t,n){n.d(t,{Z:function(){return v}});var r=n(434902),i=n(921734),o=n(209787);n(738355);var a=n(696272),s=n(345448),c=n(962168),l=n(758699),u=n(696030),h=n(200271),_=n(712096),A=n(861602),d=n(563411),f=function(e){function t(){for(var t,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call.apply(e,[].concat([this],r))||this).onFocusViewEmitter=new d.Q,t._level2Inited=!1,t.onFocusView=t.onFocusViewEmitter.event,t}(0,i._)(t,e);var o=t.prototype;return o.initLevel2=function(){var e=this;return(0,r._)(function*(){if(e._cBE||(yield e.initLevel1()),e._level2Inited)return void n.g.log?.info("view.level2 \u5DF2\u7ECF\u521D\u59CB\u5316");n.g.log?.info("view.level2 \u521D\u59CB\u5316"),yield e._bXg().catch(h.Qj),yield e._bXh().catch(h.Qj),e._level2Inited=!0})()},o.init=function(t){var n=this,i=()=>e.prototype.init;return(0,r._)(function*(){i().call(n,t),yield n._bsa(t)})()},o.refresh=function(t){e.prototype.refresh.call(this,t),this._bsa(t)},o.getRangeMove=function(){return this.rangeMove},o.getCanvasProvider=function(){return this.canvasProvider},o._bsa=function(e){var t=this;return(0,r._)(function*(){t.scrollBar?.refresh(),t.cardCenter?.refresh(e),t.smartDrag?.refresh(),t.onFocusViewEmitter.fire()})()},o._bXg=function(){var e=this;return(0,r._)(function*(){e.canvasProvider=new(yield _.U[_.k.CANVAS_PROVIDER]()).default({alloyExcel:e.alloyExcel,workbook:e.workbook,areaData:e.areaData,headSize:e.headSize,calculateSplitter:e.calculateSplitter,borderAccessor:e.borderAccessor,transformTable:e.transformTable})})()},o._bXh=function(){var e=this;return(0,r._)(function*(){new(yield _.U[_.k.CORNER_TRIANGLE_RENDER_PLUGIN]()).default({alloyExcel:e.alloyExcel,normalSelectData:e.normalSelectData,transformTable:e.transformTable,workbook:e.workbook})})()},(0,l._)(t,[{key:"contextMenu",get:function(){return this.contextMenuCenter?.contextMenu}}]),t}((0,u.mixinDisposable)(A.Z)),E=n(107439),g=n(645592),R=n(484670),C=n(518215),T=n(142947),p=function(e){function t(t,n,r,i,o,a,s){var c;return(c=e.call(this,n)||this).instantiationService=t,c.workbook=n,c.sheetStatus=r,c.dataCallView=i,c.mutexManagement=o,c.spreadsheetView=a,c.sdkSheetsBarService=s,c}(0,i._)(t,e);var n=t.prototype;return n.initCanvas=function(){if(this._cCW.fire(),this.canvas)throw Error("\u89C6\u56FE\u5DF2\u7ECF\u521D\u59CB\u5316");this.canvas=this._register(new f(this.instantiationService,this.workbook,this,this.spreadsheetView,this.mutexManagement,this.dataCallView,this.sheetStatus,this.sdkSheetsBarService)),this.canvas.initLevel1(),this._cwv();var e=this.workbook.activeSheet.getSheetType();this._cCX.fire(e),this._cCx.fire()},n.initLevel2=function(){var e=this;return(0,r._)(function*(){yield e.canvas.initLevel2()})()},t}(s.Z),v=p=(0,o.__decorate)([(0,o.__param)(0,a.T),(0,o.__param)(1,C.lc),(0,o.__param)(2,T.T),(0,o.__param)(3,E.Z),(0,o.__param)(4,g.Z),(0,o.__param)(5,R.Z),(0,o.__param)(6,c.Z),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===a.T?Object:a.T,void 0===C.lc?Object:C.lc,void 0===T.T?Object:T.T,void 0===E.Z?Object:E.Z,void 0===g.Z?Object:g.Z,void 0===R.Z?Object:R.Z,void 0===c.Z?Object:c.Z])],p)},345448:function(e,t,n){n.d(t,{Z:function(){return O}});var r=n(434902),i=n(921734);n(575739),n(738355);var o=n(156084),a=n(696030),s=n(384341),c=n(524112),l=n(340576),u=n(450586),h=function(){function e(){this._Ja=new l.Q5,this._JA=new l.Q5,this._Jb=new l.Q5,this.onClick=this._Ja.event,this.onMouseIn=this._JA.event,this.onMouseOut=this._Jb.event}var t=e.prototype;return t.fireClick=function(e){this._Ja.fire(e)},t.fireMouseIn=function(e){this._JA.fire(e)},t.fireMouseOut=function(e){this._Jb.fire(e)},t.dispose=function(){this._Ja.dispose(),this._JA.dispose(),this._Jb.dispose()},e}(),_=n(540),A=n(951924),d=n(387795),f=n(27638),E=n(460725),g=n(393743),R=n(260261),C=n(868611),T=n(311759),p=n(671638),v=n(496430),m=n(71557),S=n(63298),w=n(72941),I=n(924412),O=function(e){function t(t){var n;return(n=e.call(this)||this)._BpP=null,n.workbook=t,n._bCW=new l.Q5({name:"selectionChange"}),n._cCW=new l.Q5,n._cCx=new l.Q5,n._cCX=new l.Q5,n._cCy=new l.Q5,n.onFocusViewEmitter=new l.Q5,n._bbu=_.R.NORMAL,n._Bpq=e=>{n._bXi=(0,S.Rv)()},n.onSelectionChange=n._bCW.event,n.onBeforeInitCanvas=n._cCW.event,n.onAfterInitCanvas=n._cCx.event,n.onAfterFirstRender=n._cCX.event,n.onAfterSwitchSheetFirstRender=n._cCy.event,n.onFocusView=n.onFocusViewEmitter.event,n._bXH=[],n._bXH.push(t.activeSheetId),n._cwW(),n.viewEvent=new h,n._Bpq(),n}(0,i._)(t,e);var a=t.prototype;return a.clear=function(){this._bXi=S.FF,this._BpP=null,this._bXH=[],this.workbook.worksheetManager.getSheetIdList().forEach(e=>{this.canvas.clear(e)})},a.initLazy=function(){var e=this;return(0,r._)(function*(){yield e.initLevel2(),e._BVX()})()},a.renderAfterSwitchingDoc=function(e){this.clear(),this._bXi=(0,S.Rv)(),this.render(e)},a.getVisibleRowArea=function(){if(this.canvas){var e=(0,m.nG)(this.canvas.areaData,this.canvas.transformTable);return{sheetId:this.workbook.activeSheetId,rowRanges:e}}},a.getVisibleRowColArea=function(){if(this.canvas){var e=(0,m.a7)(this.canvas.areaData,this.canvas.transformTable);return{sheetId:this.workbook.activeSheetId,rowColRanges:e}}},a.getVisibleColArea=function(){if(this.canvas){var e=(0,m.rN)(this.canvas.areaData,this.canvas.transformTable,this.canvas.rowCoverAccessor);return{sheetId:this.workbook.activeSheetId,colRanges:e}}},a.getVisibleArea=function(e){var{shouldExcludeHiddenRowOrCol:t,sheetId:n}=e,r=this.getVisibleRowArea(),i=this.getVisibleColArea(),o=this.workbook.worksheetManager.getSheetBySheetId(n);if(!o||!r||!i)return[];if(!t)return(0,m.V9)(r,i);var a=(0,m.VW)(r,o),s=(0,m.fu)(i,o);return(0,m.V9)(a,s)},a.getMaxContentVisibleWidth=function(){for(var{activeSheet:e}=this.workbook,{rowCoverAccessor:t}=this.canvas,n=this.getVisibleArea({sheetId:this.workbook.activeSheetId,shouldExcludeHiddenRowOrCol:!0}),r=n[n.length-1],i=r.endRowIndex-1,o=r.endColIndex-1,a=0,s=i;s>=0;s--)for(var c=o;c>=0;c--){var l=e.getCellDataAtPosition(s,c),u=l?.getMergeReference();u&&(l=e.getCellDataAtPosition(u.startRowIndex,u.startColIndex)),(0,C.vz)(s,c,t,l,this.workbook)&&(a=Math.max(a,c))}for(var h=0,_=0;_<=a;_++){var A=e.getColWidth(_);void 0!==A?h+=A:h+=e.getColWidthWithDefault(_)}return h},a.getSelection=function(){return{rangeSelections:this.getSelectionRanges(),activeCell:this.getActiveCell()}},a.getSelectionRanges=function(){var e=this.canvas?.normalSelectData;if(!e)return n.g.log.error(g.w.View,"\u8C03\u7528 getSelectRanges \u7684\u65F6\u673A\u592A\u65E9, \u6A21\u5757\u672A\u52A0\u8F7D"),[];var t=this.workbook.activeSheetId,r=this.workbook.activeSheet;if(!r)return[new E.GridRange({sheetId:t,startRowIndex:0,endRowIndex:0,startColIndex:0,endColIndex:0})];var i=r.getRowCount(),o=r.getColCount(),a=(0,I.f)(e,t),s=a.filter(e=>(e.endRowIndex===E.INFINITE_INDEX||e.endRowIndex<i)&&(e.endColIndex===E.INFINITE_INDEX||e.endColIndex<o)&&e.startRowIndex<i&&e.startColIndex<o);return 0===s.length&&(s=[r.getCellDataAtPosition(0,0)?.getMergeReference()||new E.GridRange({sheetId:t,startRowIndex:0,endRowIndex:0,startColIndex:0,endColIndex:0})],n.g.log.error(g.w.View,"\u6CA1\u6709\u6709\u6548\u7684\u9009\u533A",a)),s},a.getActiveCell=function(){var{activeCol:e,activeRow:t}=this.canvas.normalSelectData,r=this.workbook.activeSheetId,i=this.workbook.activeSheet,o=i.getRowCount(),a=i.getColCount();return t>=o&&e>=a&&(t=0,e=0,n.g.log.error(g.w.View,"\u6CA1\u6709\u6709\u6548\u7684\u9009\u533A activeCell",r,t,o,e,a)),{sheetId:this.workbook.activeSheetId,rowIndex:t,colIndex:e}},a.getSelectionType=function(){return this._bbu},a.setSelectionType=function(e){this._bbu=e,this._bCW.fire()},a.setSavedLocation=function(){var{activeSheet:e}=this.workbook;if(e&&!(0,T.G)(e?.getSheetType())){var t=this._cwx();t&&(this._bXi.sheets[e.getSheetId()]=t)}},a.deleteLocation=function(e){delete this._bXi.sheets[e]},a.getSavedLocation=function(e){return this._bXi.sheets[e]},a.getSavedLocationData=function(){return this._bXi},a.setSelection=function(e){if(!(0,p.z_)()){var t=this.getSavedLocation(e);if(t){var{rowStart:n,rowEnd:r,colStart:i,colEnd:o}=t.selection;this.setCurrentSelection({yRange:[n,r],xRange:[i,o]})}else this.setFirstCellFocus()}},a.setCurrentSelection=function(e){this.canvas.selectApi.select(this.canvas.normalSelectData,e,null)},a.getSheetLocation=function(){var e={xRange:[],yRange:[],row:{frozen:0,flow:0},col:{frozen:0,flow:0}};if(this.canvas.normalSelectData?.selectQueue[0]){var t=(0,w.TS)(this.canvas.rowColAccessor,[this.canvas.normalSelectData.selectQueue[0]]),n=(0,w.rz)(this.canvas.rowColAccessor,[this.canvas.normalSelectData.selectQueue[0]]);e={xRange:[n[0][0],n[0][1]],yRange:[t[0][0],t[0][1]]}}return e.row={frozen:this.canvas.areaData.row.frozen.offsetSize,flow:this.canvas.areaData.row.flow.offsetSize},e.col={frozen:this.canvas.areaData.col.frozen.offsetSize,flow:this.canvas.areaData.col.flow.offsetSize},e},a.setFirstCellFocus=function(){if(!(0,p.z_)()){var e=(0,R.jO)(this.workbook.activeSheet,-1,1),t=(0,R.dM)(this.workbook.activeSheet,-1,1);this.canvas.selectApi.selectCells(this.canvas.normalSelectData,{xRange:[e,e],yRange:[t,t]},null)}},a.setTopScroll=function(){this.canvas.scrollApi.scrollByPixel({areaX:"flow",diffX:0,areaY:"flow",diffY:0})},a.setSheetScroll=function(e){var t=this.getSavedLocation(e);if(n.g.log?.info("[locate] setSheetScroll",{sheetId:e,curSelection:t}),void 0!==t){var{calculateSplitter:r}=this.canvas;return r.stopAsyncCalculate(),this.canvas.scrollApi.scrollToRenderFrom({row:t.flow.row,col:t.flow.col}),this.canvas.scrollApi.scrollFrozenToRenderFrom({row:t.frozen.row,col:t.frozen.col}),r.startAsyncCalculate(),!0}return this.setTopScroll(),!0},a.render=function(e,t,r){if(void 0===t&&(t=A.o.SLIENT),void 0===r&&(r=!1),!this.canvas)throw Error("\u89C6\u56FE\u5C1A\u672A\u521D\u59CB\u5316");u.ZP.jankMonitor.handleJankPathStack({moduleValue:"SHEETS_BAR_JANK",actionValue:"SWITCH_SHEET"}),n.g.log?.info("sheets_bar::switch_sheet_full_refresh_canvas"),this._bXj(e),this._cwX(e,t),this.canvas.calculateSplitter.refresh(),this.onRefresh(),this.canvas.renderApi.resume(),r?this.canvas.renderApi.renderNextTick():this.canvas.renderApi.renderTable(),this.workbook.activeSheet.getSheetType()===f.Z.Chartsheet?this.hideWorkspace():this.showWorkspace(),this._cCy.fire(this.workbook.activeSheet.getSheetType())},a.hideWorkspace=function(){this.canvas.hideView()},a.showWorkspace=function(){this.canvas.showView()},a._BVX=function(){window.performanceData&&(window.performanceData.initAfterCanvasLoaded=+new Date),this.canvas.renderApi.renderNextTick()},a._cww=function(){if(d.VQ){var e=document.createElement("style");e.setAttribute("type","text/css"),e.innerText=".snack-loading-container { display: none !important }",document.head.appendChild(e),s.default.isTencentDocsApp&&n.g.mqq?.ui?.setWebViewBehavior({titleBarHide:!0})}},a._cwW=function(){this.onSelectionChange((0,o.default)(()=>{this.canvas.renderApi.renderColHead(),this.canvas.renderApi.renderRowHead()},v.dT)),this.onAfterFirstRender(e=>{if(this.canvas.normalSelectData.onModifySelectData(()=>{this.setSelectionType(_.R.NORMAL)}),this.canvas.normalSelectionStage._cTG(()=>this._bCW.fire()),document.dispatchEvent(new CustomEvent("first_render_clearwhitescreen")),(0,T.G)(e))return})},a._cwv=function(){var e=this.workbook.activeSheet.getSheetId(),t=(0,S.HM)(),r=(0,c.IZ)("tab",n.g.__originUrl),i=this._bXi?.sheets?.[e],o=!1;(0,c.$0)()?(this.canvas.renderApi.pause(),this.setSheetScroll(e),o=!0,this.canvas.renderApi.resume()):t?(t.scale&&this.canvas.scale.scaleTo(t.scale),r&&t.active_sheet!==r||t.active_sheet!==e||(this.canvas.scrollApi.scrollToRenderFrom({row:t.flow?.row,col:t.flow?.col}),this.canvas.scrollApi.scrollFrozenToRenderFrom({row:t.frozen?.row,col:t.frozen?.col}),o=!0),this.canvas.renderApi.resume()):i?(this.canvas.renderApi.pause(),"number"==typeof i.scale&&this.canvas.scale.scaleTo(i.scale),this.canvas.scrollApi.scrollToRenderFrom({row:i.flow?.row,col:i.flow?.col}),this.canvas.scrollApi.scrollFrozenToRenderFrom({row:i.frozen?.row,col:i.frozen?.col}),o=!0,this.canvas.renderApi.resume()):this._BpP&&this._BpP.then(t=>{var n=t.sheets[e];n&&(this.canvas.scrollApi.scrollToRenderFrom({row:n.flow?.row,col:n.flow?.col}),this.canvas.scrollApi.scrollFrozenToRenderFrom({row:n.frozen?.row,col:n.frozen?.col}))});var a=+new Date;this.canvas.renderApi.resume(),this.canvas.renderApi.renderTable();var s=+new Date;n.g.performanceData&&(n.g.performanceData.firstRenderDuration=s-a),o?this.setSelection(e):this.setFirstCellFocus()},a.onRefresh=function(){this.canvas.copyFrame?.closeCopy()},a._cwX=function(e,t){t!==A.o.API&&(this.setSheetScroll(e),this.setSelection(e))},a._bXj=function(e){if(e!==this.workbook.activeSheet.getSheetId())return void n.g?.log?.error(g.w.View,"\u66F4\u65B0 sheet \u5F02\u5E38");this.canvas.refresh(e)},a._cwx=function(){if(this.canvas&&this.canvas.normalSelectData?.selectQueue[0]){var{areaData:e,normalSelectData:t}=this.canvas,n=(0,I.f)(t,this.workbook.activeSheetId)[0];return{frozen:{row:-1===e.row.frozen.to?-1:e.row.frozen.renderFrom,col:-1===e.col.frozen.to?-1:e.col.frozen.renderFrom},flow:{row:e.row.flow.renderFrom,col:e.col.flow.renderFrom},scale:this.canvas.scale.displayScale,selection:{rowStart:n.startRowIndex,rowEnd:n.endRowIndex,colStart:n.startColIndex,colEnd:n.endColIndex}}}},t}(a.Disposable)},712096:function(e,t,n){n.d(t,{U:function(){return i},k:function(){return r}});var r={AREA_OVERLAY:"AREA_OVERLAY",CANVAS_PROVIDER:"CANVAS_PROVIDER",CORNER_TRIANGLE_RENDER_PLUGIN:"CORNER_TRIANGLE_RENDER_PLUGIN"},i={[r.CANVAS_PROVIDER]:()=>Promise.all([n.e("96660"),n.e("14650")]).then(n.bind(n,715076)),[r.CORNER_TRIANGLE_RENDER_PLUGIN]:()=>Promise.all([n.e("96660"),n.e("14650")]).then(n.bind(n,423241))}},121210:function(e,t){t.Z=function(e){this.alloyExcel=e.alloyExcel}},933329:function(e,t,n){n.d(t,{l:function(){return r}});var r={RANGE:0,CELL:1}},716262:function(e,t,n){n.d(t,{VD:function(){return s},Xf:function(){return o},jG:function(){return c},qp:function(){return l},t9:function(){return a}});var r=n(496430),i=n(680465),o=2;function a(e,t,n){var r=0;switch(e.verticalAlign.value){case i.M.SmlCenter:r=(t-n)/2;break;case i.M.SmlTop:r=o;break;case i.M.SmlBottom:r=t-o-n}return r}function s(e,t){return!!(t[0]<=e[0])&&!!(e[0]<=t[0]+t[2])&&!!(t[1]<=e[1])&&!!(e[1]<=t[1]+t[3])}function c(e,t){return void 0===t&&(t=.8),t*((e||r.Xl)/r.Xl)}function l(e,t,n,r,o,a){var{width:s,height:c}=a,l=(t.left-s)/2,u=0;switch(e.verticalAlign.value){case i.M.SmlCenter:u=(n-c)/2;break;case i.M.SmlTop:u+c>n&&(u=1);break;case i.M.SmlBottom:u=n-c-1;break;default:console.error("Error")}return[r+l,o+u]}},221917:function(e,t,n){var r=n(758699);t.Z=function(){function e(e){this._bA=1,this._bb=0,this._bB=0,this._bc=1,this._bC=0,this._bd=0,e&&(this._bA=e.a,this._bb=e.b,this._bB=e.c,this._bc=e.d,this._bC=e.e,this._bd=e.f)}var t=e.prototype;return t.transform=function(e,t,n,r,i,o){var a=this._bA,s=this._bb,c=this._bB,l=this._bc,u=this._bC,h=this._bd;return this._bA=a*e+c*t,this._bb=s*e+l*t,this._bB=a*n+c*r,this._bc=s*n+l*r,this._bC=a*i+c*o+u,this._bd=s*i+l*o+h,this},t.scale=function(e,t){return this.transform(e,0,0,t,0,0),this},t.translate=function(e,t){return this.transform(1,0,0,1,e,t),this},t.rotate=function(e){var t=Math.cos(e),n=Math.sin(e);return this.transform(t,n,-n,t,0,0),this},t.applyToPoint=function(e,t){return{x:e*this._bA+t*this._bB+this._bC,y:e*this._bb+t*this._bc+this._bd}},t.reset=function(){return this._bA=this._bc=1,this._bb=this._bB=this._bC=this._bd=0,this},(0,r._)(e,[{key:"a",get:function(){return this._bA}},{key:"b",get:function(){return this._bb}},{key:"c",get:function(){return this._bB}},{key:"d",get:function(){return this._bc}},{key:"e",get:function(){return this._bC}},{key:"f",get:function(){return this._bd}}]),e}()},645592:function(e,t,n){t.Z=(0,n(730635).y)("IMutexManagement")},155094:function(e,t,n){n.d(t,{d:function(){return i}}),n(575739);var r=n(384341),i={SELECTION:"selection",FORMULA_SELECTION:"formulaSelection",FLOAT_IMAGE:"floatImage",SHAPE:"shape",CHART:"chart",CARD_CENTER:"cardCenter",CONTEXT_MENU:"contextMenu",INPUT:"input",VALIDATION_LIST:"validationList",ERROR_TIP_PANEL:"errorTipPanel",CELL_EDITOR_DROPDOWN:"cellEditorDropdown",CUSTOM_CELL_EDITOR:"customCellEditor",VALIDATION_LIST_HEADER:"validationListHeader",ADDON:"addon"},o={[i.SHAPE]:[i.SELECTION,i.INPUT,i.FLOAT_IMAGE,i.CUSTOM_CELL_EDITOR,i.ADDON,i.CHART],[i.CHART]:[i.SELECTION,i.INPUT,i.FLOAT_IMAGE,i.CUSTOM_CELL_EDITOR,i.ADDON,i.SHAPE],[i.SELECTION]:[i.FLOAT_IMAGE,i.CHART,i.ADDON,i.SHAPE],[i.FORMULA_SELECTION]:[i.FLOAT_IMAGE,i.CHART,i.ADDON,i.SHAPE],[i.INPUT]:[i.CARD_CENTER],[i.CELL_EDITOR_DROPDOWN]:[i.CARD_CENTER,i.CONTEXT_MENU,i.VALIDATION_LIST],[i.CONTEXT_MENU]:r.default.isPC?[i.CARD_CENTER,i.CELL_EDITOR_DROPDOWN,i.VALIDATION_LIST]:[i.CARD_CENTER],[i.VALIDATION_LIST]:[i.CARD_CENTER],[i.FLOAT_IMAGE]:r.default.isPC?[i.SELECTION,i.CHART,i.INPUT,i.CUSTOM_CELL_EDITOR,i.ADDON,i.SHAPE]:[i.SELECTION,i.CHART,i.CUSTOM_CELL_EDITOR,i.ADDON,i.SHAPE],[i.ERROR_TIP_PANEL]:[i.CARD_CENTER,i.CONTEXT_MENU,i.VALIDATION_LIST],[i.CUSTOM_CELL_EDITOR]:[i.VALIDATION_LIST_HEADER],[i.ADDON]:[i.SELECTION,i.FLOAT_IMAGE,i.CUSTOM_CELL_EDITOR,i.CHART,i.SHAPE]};t.Z=function(){function e(){this._sX=o,this._sy={}}var t=e.prototype;return t.addMutexComponent=function(e,t){void 0===this._sy[e]&&(this._sy[e]=[]),this._sy[e].push(t)},t.removeMutexComponent=function(e,t){var n=this._sy[e];if(n){var r=n.findIndex(e=>e===t);r<0||n.splice(r,1)}},t.mutexShow=function(e){this._sX[e]?.forEach(t=>{this._sy[t]?.forEach(t=>{t.mutexHide(e)})})},e}()},130550:function(e,t,n){n.d(t,{C:function(){return r}});function r(e){e._isTapAdded||(e.addEventListener("touchstart",function(t){if(1!==t.touches.length){this.touchT=void 0,window.clearTimeout(this.longTapTick);return}var n=t.touches[0];this.touchX=n.clientX,this.touchY=n.clientY,this.touchT=Date.now(),this.longTapTick=window.setTimeout(()=>{if(e.onLongTap)e.onLongTap();else{var t=document.createEvent("HTMLEvents");t.initEvent("longTap",!1,!0),e.dispatchEvent(t)}},500)}),e.addEventListener("touchmove",function(e){if(e.preventDefault(),this.longTapTick){var t=e.touches[0],n=t.clientX;(Math.abs(t.clientY-this.touchY)>5||Math.abs(n-this.touchX)>5)&&window.clearTimeout(this.longTapTick)}}),e.addEventListener("touchend",function(t){var n=t.changedTouches[0],r=n.clientX,i=n.clientY;if((window.clearTimeout(this.longTapTick),!(t.touches.length>0)&&void 0!==this.touchT)&&!(Math.abs(i-this.touchY)>30||Math.abs(r-this.touchX)>30)&&Date.now()<=this.touchT+250)if(e.ontap)e.ontap();else{var o=document.createEvent("HTMLEvents");o.initEvent("tap",!1,!0),o.x=r,o.y=i,o.originEvent=t,e.dispatchEvent(o)}}),e._isTapAdded=!0)}},200271:function(e,t,n){if(n.d(t,{Ic:function(){return h},PF:function(){return s},Qj:function(){return i},UW:function(){return a},ad:function(){return l},j9:function(){return c},kf:function(){return u},p7:function(){return o}}),7719==n.j)var r=n(393743);function i(e){return n.g.log.error(r.w.Common,e),Promise.resolve()}function o(e){e.stopPropagation?.(),e.preventDefault?.()}function a(e){e.stopPropagation?.()}function s(e){e.preventDefault?.()}function c(e,t,n,r){return[e,t,e+n,t,e+n,t+r,e,t+r,e,t]}function l(e){var t=this,n=null;return function(){for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];n||(n=Promise.resolve().then(()=>{n=null,e.apply(t,i)}))}}function u(e,t){void 0===t&&(t=0);var n=this,r=null;return function(){for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];r||(r=setTimeout(()=>{r=null,e.apply(n,o)},t))}}function h(e,t){void 0===t&&(t=0);var n=this,r=0,i=0;return function(){for(var o=arguments.length,a=Array(o),s=0;s<o;s++)a[s]=arguments[s];i=Date.now();var c=()=>{Date.now()-i>t||(e.apply(n,a),l())},l=()=>{r=requestAnimationFrame(c)};r&&(cancelAnimationFrame(r),r=0),l()}}},131524:function(e,t,n){function r(e){return function(t,n,r){return e.every(e=>e(t,n,r))}}function i(e,t,n){return!e.getMergeParent(n,t)}function o(e,t,n){var r=e.getMergeParent(n,t),i=e.getMergeData(n,t);if(r){var o=e.getMergeData(n+r.y,t+r.x);if(o&&o.colCount>1)return!1}return!i||!(i.colCount>1)}function a(e,t,n){var r=e.getMergeParent(n,t),i=e.getMergeData(n,t);if(r){var o=e.getMergeData(n+r.y,t+r.x);if(o&&o.rowCount>1)return!1}return!i||!(i.rowCount>1)}function s(e,t,n){return!(e.isColHidden(t)||e.isRowHidden(n))}function c(e,t,n){return!e.isRowHidden(n)}function l(e,t){return!e.isColHidden(t)}function u(e,t,n){return!!e.getCellContent(n,t)}function h(e,t,n){return!e.getCellContent(n,t)}function _(e,t,n){return!(e.getFrozenRowCount()>n)}function A(e,t){return!(e.getFrozenColCount()>t)}n.d(t,{AS:function(){return h},D0:function(){return a},Ln:function(){return r},PA:function(){return u},Qv:function(){return _},Sl:function(){return l},So:function(){return c},dK:function(){return o},eN:function(){return i},hZ:function(){return s},sb:function(){return A}})},777601:function(e,t,n){n.d(t,{b:function(){return s},r:function(){return o}});var r=n(450586),i=n(127982),o={MUTATION_APPLY_TO_VIEW_ERROR:"MUTATION_APPLY_TO_VIEW_ERROR"},a=new Set;function s(e,t,s){a.has(e)||(a.add(e),n.g.log.error(t,s?.message,s?.stack),i.$.report(e),r.ZP.galileo.reportEvent({name:o.MUTATION_APPLY_TO_VIEW_ERROR,custom_error:s?.name}))}},737814:function(e,t,n){function r(e){return 2*e.headSize.rowHeadWidth}function i(e){return 2*e.headSize.colHeadHeight}function o(e,t){var r=e*n.g.devicePixelRatio;return Math.ceil(t*r)/r}function a(e){return 1/(e*n.g.devicePixelRatio)}n.d(t,{hD:function(){return o},n_:function(){return i},pJ:function(){return r},sJ:function(){return a}})},930944:function(e,t,n){n.d(t,{Z:function(){return _}});var r=n(758699),i=n(209787),o=n(109646),a=n(873565),s=n(976037),c=n(291698);n(259058);var l=n(27638),u=n(463313),h=n.n(u),_=function(){function e(e){this._beS=e,this.drawerMode=o.$t.FLOAT,this.drawerStyle={},this._BPc=()=>{this._ur.removeRightSubDrawer()},this.closeDrawer=()=>{this._ByT&&this._BPC()&&this._ur.closeRightDrawer()},this.toggleDrawer=e=>this._ByT?this.closeDrawer():this.openDrawer(e),this.showDrawer=()=>{this._ur.showRightDrawer({name:this._beS})},this.hideDrawer=()=>{this._ur.hideRightDrawer(this._beS)},this.getContent=()=>null,this._BlE=()=>null,this.beforeOpenDrawer=e=>!0,this._BPC=()=>!0,this.afterOpenDrawer=()=>{},this.afterCloseDrawer=()=>{},this._BxV=()=>{},this._uR=()=>{a.Am.get(c.P).containerModel.activeSheet.sheetType,l.Z.Smartcanvas;var e={paddingTop:0,border:"1px solid var(--border-medium)",backgroundColor:"var(--bg-lv3-default)",width:"280px",height:"calc(100% - 6px)",...this.drawerStyle};return"discussion-seize-drawer"===this._beS&&(delete e.backgroundColor,e.border="none",e.width="312px"),e}}var t=e.prototype;return t.openDrawer=function(e){this.beforeOpenDrawer(e)&&(e&&(this.config=e),this._ur.showRightDrawer({name:this._beS,type:"transparent",animation:"fadeIn",title:this.title,titleStyle:this.titleStyle,closeButtonStyle:this.closeButtonStyle,content:h().createElement("div",{id:this._beS,className:"wb-right-side-panel","data-testid":this._beS},this.getContent()),style:this._uR(),onOpen:()=>{this.afterOpenDrawer(),this._ur.setRightDrawerMode(this.drawerMode)},onAfterOpenAnimation:()=>{this._BxV()},onClose:()=>{this.afterCloseDrawer()}}),this._ur.updateRightDrawerStyle({zIndex:1501}),s.ZP.default.trigger("afterShowWorkbenchSidePanel"))},t._BPd=function(e){var{name:t,childOf:n,title:r}=e;n&&(this._ur.isRightOpening(t)||(this._ur.removeRightSubDrawer(),this._ur.showRightDrawer({name:t,childOf:n,title:r,titleStyle:this._BmM,content:h().createElement(h().Fragment,null,this._BlE())})))},(0,r._)(e,[{key:"_ByT",get:function(){return this._ur.isRightOpening(this._beS)}}]),e}();(0,i.__decorate)([(0,a.tB)(),(0,i.__metadata)("design:type",void 0===o.zv?Object:o.zv)],_.prototype,"_ur",void 0)},775660:function(e,t,n){n.d(t,{Z:function(){return A}});var r=n(209787),i=n(533618),o=n(75192),a=n(796639),s=n(402545),c=n(622228),l=n(825111),u=n(524112),h=n(941465),_=n(450586),A=function(){function e(e,t,n){this._yj=!1,this._ix=e,this._Hx=t,this._Wh=n,this._Ajm={},this._AjM=(0,u.P2)(()=>{var{inputManager:e}=this._ix.canvas,t=e.getFormat();this._AjO(),this._Ajo(c.HM.BOLD,!!t[c.HM.BOLD]),this._Ajo(c.HM.ITALIC,!!t[c.HM.ITALIC]),this._Ajo(c.HM.UNDERLINE,!!t[c.HM.UNDERLINE]),this._Ajo(c.HM.STRIKETHROUGH,!!t[c.HM.STRIKETHROUGH]),this._Ajo(c.HM.FONT_FAMILY,(t.fontFamily||"").replace(/"|'/g,"")),this._Ajo(c.HM.FONT_SIZE,t.fontSize);var n=Array.isArray(t.color)?t.color[0]:t.color,r=(0,h.Ik)(n);r&&r.length>=3&&this._Ajo(c.HM.FONT_COLOR,(0,h.jg)(r[0],r[1],r[2])),this._Hx.update()},100),this._Ajn=()=>{var{inputManager:e}=this._ix.canvas;e.emitter.on(e.EVENT.SELECTION_CHANGE,this._AjM),e.emitter.on(e.EVENT.UNDO_REDO_CHANGE,this._AjM),this._yj=!0,this._AjM()},this._AjN=()=>{var{inputManager:e}=this._ix.canvas;e.emitter.off(e.EVENT.SELECTION_CHANGE,this._AjM),e.emitter.off(e.EVENT.UNDO_REDO_CHANGE,this._AjM),this._yj=!1,this._AjO(),this._Hx.update()},this._dc()}var t=e.prototype;return t.isInputtingState=function(){var{inputManager:e}=this._ix.canvas;return this._yj||e.isInputtingState()},t.getInputStateValue=function(e){return this._Ajm[e]},t.checkInputAndFormat=function(e,t,r){n.g.performanceData&&(n.g.performanceData.setInputStyleTimeStamp=+new Date);var{inputManager:i}=this._ix.canvas;return!!i.isInputtingState()&&(i.getSelection()?i.format(e,t):r&&i.format(e,t,r),_.ZP.tdwReport({opername:"tech_doc",module:"input_manager",action:"set_input_style_duration",ver5:new Date-n.g?.performanceData?.setInputStyleTimeStamp||0}),!0)},t.getSavedSelection=function(){var{inputManager:e}=this._ix.canvas;return e.getSavedSelection()},t.checkAndUndo=function(){var{inputManager:e}=this._ix.canvas;return!!e.isInputtingState()&&(e.undo(),!0)},t.checkAndRedo=function(){var{inputManager:e}=this._ix.canvas;return!!e.isInputtingState()&&(e.redo(),!0)},t.getCanUndo=function(){return this._ix.canvas.inputManager.canUndo()},t.getCanRedo=function(){return this._ix.canvas.inputManager.canRedo()},t._dc=function(){var{inputManager:e}=this._ix.canvas;e.emitter.on(e.EVENT.ENTER_INPUT,this._Ajn),e.emitter.on(e.EVENT.EXIT_INPUT,this._AjN)},t._Ajo=function(e,t){this._Ajm[e]=t},t._AjO=function(){this._Ajm={}},e}();A=(0,r.__decorate)([(0,i.L)({adapters:[l.L]}),(0,r.__param)(0,s.w),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[void 0===s.w?Object:s.w,void 0===o.O?Object:o.O,void 0===a.n?Object:a.n])],A)},970073:function(e,t){var n={fullscreenEnabled:0,fullscreenElement:1,requestFullscreen:2,exitFullscreen:3,fullscreenchange:4,fullscreenerror:5},r=["webkitFullscreenEnabled","webkitFullscreenElement","webkitRequestFullscreen","webkitExitFullscreen","webkitfullscreenchange","webkitfullscreenerror"],i=["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror"],o=["msFullscreenEnabled","msFullscreenElement","msRequestFullscreen","msExitFullscreen","MSFullscreenChange","MSFullscreenError"],a="undefined"!=typeof window&&void 0!==window.document?window.document:{},s="fullscreenEnabled"in a&&Object.keys(n)||r[0]in a&&r||i[0]in a&&i||o[0]in a&&o||[];t.Z={requestFullscreen:e=>e[s[n.requestFullscreen]](),requestFullscreenFunction:e=>e[s[n.requestFullscreen]],get exitFullscreen(){return a[s[n.exitFullscreen]].bind(a)},addEventListener:(e,t,r)=>a.addEventListener(s[n[e]],t,r),removeEventListener:(e,t,r)=>a.removeEventListener(s[n[e]],t,r),get fullscreenEnabled(){return!!a[s[n.fullscreenEnabled]]},set fullscreenEnabled(val){},get fullscreenElement(){return a[s[n.fullscreenElement]]},set fullscreenElement(val){},get onfullscreenchange(){return a[`on${s[n.fullscreenchange]}`.toLowerCase()]},set onfullscreenchange(handler){return a[`on${s[n.fullscreenchange]}`.toLowerCase()]=handler},get onfullscreenerror(){return a[`on${s[n.fullscreenerror]}`.toLowerCase()]},set onfullscreenerror(handler){return a[`on${s[n.fullscreenerror]}`.toLowerCase()]=handler}}}}]);
//# sourceMappingURL=initial_core_4.d21fc3e52296e5e0.js.map