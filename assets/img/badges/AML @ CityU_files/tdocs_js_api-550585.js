((e,n)=>{"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).tdocs=n()})(this,(function(){var e=function(){return(e=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};function n(e,n){var t={};for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&n.indexOf(i)<0&&(t[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,i=Object.getOwnPropertySymbols(e);o<i.length;o++)n.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(t[i[o]]=e[i[o]]);return t}function t(e,n,t,o){return new(t=t||Promise)((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var n;e.done?i(e.value):((n=e.value)instanceof t?n:new t((function(e){e(n)}))).then(c,s)}a((o=o.apply(e,n||[])).next())}))}function o(e,n){var t,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},c={next:s(0),throw:s(1),return:s(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function s(c){return function(s){var a=[c,s];if(t)throw new TypeError("Generator is already executing.");for(;r;)try{if(t=1,o&&(i=2&a[0]?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,(a=i?[2&a[0],i.value]:a)[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!((i=0<(i=r.trys).length&&i[i.length-1])||6!==a[0]&&2!==a[0])){r=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3]))r.label=a[1];else if(6===a[0]&&r.label<i[1])r.label=i[1],i=a;else{if(!(i&&r.label<i[2])){i[2]&&r.ops.pop(),r.trys.pop();continue}r.label=i[2],r.ops.push(a)}}a=n.call(e,r)}catch(s){a=[6,s],o=0}finally{t=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}}}function i(e,n,t){if(t||2===arguments.length)for(var o,i=0,r=n.length;i<r;i++)!o&&i in n||((o=o||Array.prototype.slice.call(n,0,i))[i]=n[i]);return e.concat(o||Array.prototype.slice.call(n))}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var c,s,a,u,l,d,f,p,w,v,h,g,m,b,k,C,y,W,S,_,A,T,x,I,P,D,O,M,E,j,L,N,B,F,U,R,V,q,Q,J,G,X,$,H,z,K,Y,Z,ee,ne,te,oe,ie,re,ce,se,ae,ue,le,de,fe,pe,we,ve,he,ge,me,be,ke,Ce,ye,We,Se,_e,Ae,Te,xe="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Ie={exports:{}},Pe={exports:{}};function De(e,n){return e.set(n[0],n[1]),e}function Oe(e,n){return e.add(n),e}function Me(e,n,t,o){var i=-1,r=e?e.length:0;for(o&&r&&(t=e[++i]);++i<r;)t=n(t,e[i],i,e);return t}function Ee(e){var n=!1;if(null!=e&&"function"!=typeof e.toString)try{n=!!(e+"")}catch(e){}return n}function je(e){var n=-1,t=Array(e.size);return e.forEach((function(e,o){t[++n]=[o,e]})),t}function Le(e,n){return function(t){return e(n(t))}}function Ne(e){var n=-1,t=Array(e.size);return e.forEach((function(e){t[++n]=e})),t}function Be(e){var n=-1,t=e?e.length:0;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function Fe(e){var n=-1,t=e?e.length:0;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function Ue(e){var n=-1,t=e?e.length:0;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function Re(e){this.__data__=new Fe(e)}function Ve(e,n){var t,o,i,r,c,s=Ae(e)||(o=t=e)&&"object"==typeof o&&Ze(o)&&Y.call(t,"callee")&&(!ce.call(t,"callee")||Z.call(t)==l)?((e,n)=>{for(var t=-1,o=Array(e);++t<e;)o[t]=n(t);return o})(e.length,String):[],a=s.length,d=!!a;for(i in e)!n&&!Y.call(e,i)||d&&("length"==i||(r=i,(c=null==(c=a)?u:c)&&("number"==typeof r||N.test(r))&&-1<r&&r%1==0&&r<c))||s.push(i);return s}function qe(e,n,t){var o=e[n];Y.call(e,n)&&Ye(o,t)&&(void 0!==t||n in e)||(e[n]=t)}function Qe(e,n){for(var t=e.length;t--;)if(Ye(e[t][0],n))return t;return-1}function Je(e,n,t,o,i,r,c){var s;if(void 0===(s=o?r?o(e,i,r,c):o(e):s)){if(!nn(e))return e;var a,u,m,W,L,N,F,U,R,V,q=Ae(e);if(q){if(R=(U=e).length,V=U.constructor(R),R&&"string"==typeof U[0]&&Y.call(U,"index")&&(V.index=U.index,V.input=U.input),s=V,!n){var Q=e,J=s,G=-1,X=Q.length;for(J=J||Array(X);++G<X;)J[G]=Q[G];return J}}else{var $=_e(e),H=$==p||$==w;if(Te(e))return N=e,n?N.slice():(F=new N.constructor(N.length),N.copy(F),F);if($==g||$==l||H&&!r){if(Ee(e))return r?e:{};if(s="function"==typeof(W=H?{}:e).constructor&&!ze(W)&&nn(L=ie(W))?re(L):{},!n)return a=e,u=(m=s)&&Xe(e,tn(e),m),Xe(a,Se(a),u)}else{if(!B[$])return r?e:{};s=((e,n,t)=>{var o,i,r,c,s,a,u,l,p=e.constructor;switch($){case S:return Ge(e);case d:case f:return new p(+e);case _:return u=e,l=t?Ge(u.buffer):u.buffer,new u.constructor(l,u.byteOffset,u.byteLength);case A:case T:case x:case I:case P:case D:case O:case M:case E:return s=e,a=t?Ge(s.buffer):s.buffer,new s.constructor(a,s.byteOffset,s.length);case v:return c=e,Me(t?n(je(c),!0):je(c),De,new c.constructor);case h:case C:return new p(e);case b:return(r=new(i=e).constructor(i.source,j.exec(i))).lastIndex=i.lastIndex,r;case k:return o=e,Me(t?n(Ne(o),!0):Ne(o),Oe,new o.constructor);case y:return We?Object(We.call(e)):{}}})(e,Je,n)}}var z,K=(c=c||new Re).get(e);if(K)return K;c.set(e,s);for(var Z,ee,ne=(z=q?z:t?(()=>{var n=e,t=Se,o=tn(n);if(Ae(n))return o;for(var i=o,r=t(n),c=-1,s=r.length,a=i.length;++c<s;)i[a+c]=r[c];return i})():tn(e))||e,te=-1,oe=ne?ne.length:0;++te<oe&&!1!==(Z=ne[te],ee=te,z&&(Z=e[ee=Z]),void qe(s,ee,Je(Z,n,t,o,ee,e,c))););}return s}function Ge(e){var n=new e.constructor(e.byteLength);return new oe(n).set(new oe(e)),n}function Xe(e,n,t,o){t=t||{};for(var i=-1,r=n.length;++i<r;){var c=n[i],s=o?o(t[c],e[c],c,t,e):void 0;qe(t,c,void 0===s?e[c]:s)}return t}function $e(e,n){var t,o=e.__data__;return("string"==(t=typeof n)||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==n:null===n)?o["string"==typeof n?"string":"hash"]:o.map}function He(e,n){var t,o=null==e?void 0:e[n];return!nn(t=o)||z&&z in t||!(en(t)||Ee(t)?ee:L).test(Ke(t))?void 0:o}function ze(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||$)}function Ke(e){if(null!=e){try{return K.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Ye(e,n){return e===n||e!=e&&n!=n}function Ze(e){return null!=e&&"number"==typeof(n=e.length)&&-1<n&&n%1==0&&n<=u&&!en(e);var n}function en(e){var n=nn(e)?Z.call(e):"";return n==p||n==w}function nn(e){var n=typeof e;return e&&("object"==n||"function"==n)}function tn(e){return(Ze(e)?Ve:e=>{if(!ze(e))return le(e);var n,t=[];for(n in Object(e))Y.call(e,n)&&"constructor"!=n&&t.push(n);return t})(e)}s=(c=Pe).exports,a="__lodash_hash_undefined__",u=9007199254740991,p="[object Function]",w="[object GeneratorFunction]",m="[object Promise]",W="[object WeakMap]",j=/\w*$/,L=/^\[object .+?Constructor\]$/,N=/^(?:0|[1-9]\d*)$/,(B={})[l="[object Arguments]"]=B["[object Array]"]=B[S="[object ArrayBuffer]"]=B[_="[object DataView]"]=B[d="[object Boolean]"]=B[f="[object Date]"]=B[A="[object Float32Array]"]=B[T="[object Float64Array]"]=B[x="[object Int8Array]"]=B[I="[object Int16Array]"]=B[P="[object Int32Array]"]=B[v="[object Map]"]=B[h="[object Number]"]=B[g="[object Object]"]=B[b="[object RegExp]"]=B[k="[object Set]"]=B[C="[object String]"]=B[y="[object Symbol]"]=B[D="[object Uint8Array]"]=B[O="[object Uint8ClampedArray]"]=B[M="[object Uint16Array]"]=B[E="[object Uint32Array]"]=!0,B["[object Error]"]=B[p]=B[W]=!1,F="object"==typeof xe&&xe&&xe.Object===Object&&xe,U="object"==typeof self&&self&&self.Object===Object&&self,R=F||U||Function("return this")(),Q=(q=(V=s&&!s.nodeType&&s)&&c&&!c.nodeType&&c)&&q.exports===V,G=Array.prototype,X=Function.prototype,$=Object.prototype,H=R["__core-js_shared__"],z=(J=/[^.]+$/.exec(H&&H.keys&&H.keys.IE_PROTO||""))?"Symbol(src)_1."+J:"",K=X.toString,Y=$.hasOwnProperty,Z=$.toString,ee=RegExp("^"+K.call(Y).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ne=Q?R.Buffer:void 0,te=R.Symbol,oe=R.Uint8Array,ie=Le(Object.getPrototypeOf,Object),re=Object.create,ce=$.propertyIsEnumerable,se=G.splice,ae=Object.getOwnPropertySymbols,ue=ne?ne.isBuffer:void 0,le=Le(Object.keys,Object),de=He(R,"DataView"),fe=He(R,"Map"),pe=He(R,"Promise"),we=He(R,"Set"),ve=He(R,"WeakMap"),he=He(Object,"create"),ge=Ke(de),me=Ke(fe),be=Ke(pe),ke=Ke(we),Ce=Ke(ve),ye=te?te.prototype:void 0,We=ye?ye.valueOf:void 0,Be.prototype.clear=function(){this.__data__=he?he(null):{}},Be.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Be.prototype.get=function(e){var n,t=this.__data__;return he?(n=t[e])===a?void 0:n:Y.call(t,e)?t[e]:void 0},Be.prototype.has=function(e){var n=this.__data__;return he?void 0!==n[e]:Y.call(n,e)},Be.prototype.set=function(e,n){return this.__data__[e]=he&&void 0===n?a:n,this},Fe.prototype.clear=function(){this.__data__=[]},Fe.prototype.delete=function(e){var n=this.__data__,t=Qe(n,e);return!(t<0||(t==n.length-1?n.pop():se.call(n,t,1),0))},Fe.prototype.get=function(e){var n=this.__data__,t=Qe(n,e);return t<0?void 0:n[t][1]},Fe.prototype.has=function(e){return-1<Qe(this.__data__,e)},Fe.prototype.set=function(e,n){var t=this.__data__,o=Qe(t,e);return o<0?t.push([e,n]):t[o][1]=n,this},Ue.prototype.clear=function(){this.__data__={hash:new Be,map:new(fe||Fe),string:new Be}},Ue.prototype.delete=function(e){return $e(this,e).delete(e)},Ue.prototype.get=function(e){return $e(this,e).get(e)},Ue.prototype.has=function(e){return $e(this,e).has(e)},Ue.prototype.set=function(e,n){return $e(this,e).set(e,n),this},Re.prototype.clear=function(){this.__data__=new Fe},Re.prototype.delete=function(e){return this.__data__.delete(e)},Re.prototype.get=function(e){return this.__data__.get(e)},Re.prototype.has=function(e){return this.__data__.has(e)},Re.prototype.set=function(e,n){var t=this.__data__;if(t instanceof Fe){var o=t.__data__;if(!fe||o.length<199)return o.push([e,n]),this;t=this.__data__=new Ue(o)}return t.set(e,n),this},Se=ae?Le(ae,Object):function(){return[]},_e=function(e){return Z.call(e)},(de&&_e(new de(new ArrayBuffer(1)))!=_||fe&&_e(new fe)!=v||pe&&_e(pe.resolve())!=m||we&&_e(new we)!=k||ve&&_e(new ve)!=W)&&(_e=function(e){var n=Z.call(e),t=n==g?e.constructor:void 0,o=t?Ke(t):void 0;if(o)switch(o){case ge:return _;case me:return v;case be:return m;case ke:return k;case Ce:return W}return n}),Ae=Array.isArray,Te=ue||function(){return!1},c.exports=function(e){return Je(e,!0,!0)},Pe.exports.default;var on,rn,cn,sn,an,un,ln,dn,fn,pn,wn,vn,hn,gn,mn,bn,kn,Cn,yn,Wn,Sn,_n,An,Tn,xn,In,Pn,Dn,On,Mn,En,jn={exports:{}};function Ln(e){var n=-1,t=e?e.length:0;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function Nn(e){var n=-1,t=e?e.length:0;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function Bn(e){var n=-1,t=e?e.length:0;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function Fn(e,n){for(var t,o=e.length;o--;)if((t=e[o][0])===n||t!=t&&n!=n)return o;return-1}function Un(e,n){var t,o=e.__data__;return("string"==(t=typeof n)||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==n:null===n)?o["string"==typeof n?"string":"hash"]:o.map}function Rn(e,n){var t=null==e?void 0:e[n];return function(e){return qn(e)&&!(yn&&yn in e)&&((n=qn(e)?_n.call(e):"")==sn||n==an||(e=>{var n=!1;if(null!=e&&"function"!=typeof e.toString)try{n=!!(e+"")}catch(e){}return n})(e)?An:wn).test((e=>{if(null!=e){try{return Wn.call(e)}catch(e){}try{return e+""}catch(e){}}return""})(e));var n}(t)?t:void 0}function Vn(e,n){if("function"!=typeof e||n&&"function"!=typeof n)throw new TypeError("Expected a function");function t(){var o,i=arguments,r=n?n.apply(this,i):i[0],c=t.cache;return c.has(r)?c.get(r):(o=e.apply(this,i),t.cache=c.set(r,o),o)}return t.cache=new(Vn.Cache||Bn),t}function qn(e){var n=typeof e;return e&&("object"==n||"function"==n)}function Qn(e){return"symbol"==typeof e||e&&"object"==typeof e&&"[object Symbol]"==_n.call(e)}on=jn,cn="__lodash_hash_undefined__",sn="[object Function]",an="[object GeneratorFunction]",un=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ln=/^\w*$/,dn=/^\./,fn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,pn=/\\(\\)?/g,wn=/^\[object .+?Constructor\]$/,vn="object"==typeof xe&&xe&&xe.Object===Object&&xe,hn="object"==typeof self&&self&&self.Object===Object&&self,gn=vn||hn||Function("return this")(),mn=Array.prototype,bn=Function.prototype,kn=Object.prototype,Cn=gn["__core-js_shared__"],yn=(rn=/[^.]+$/.exec(Cn&&Cn.keys&&Cn.keys.IE_PROTO||""))?"Symbol(src)_1."+rn:"",Wn=bn.toString,Sn=kn.hasOwnProperty,_n=kn.toString,An=RegExp("^"+Wn.call(Sn).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Tn=gn.Symbol,xn=mn.splice,In=Rn(gn,"Map"),Pn=Rn(Object,"create"),Dn=Tn?Tn.prototype:void 0,On=Dn?Dn.toString:void 0,Ln.prototype.clear=function(){this.__data__=Pn?Pn(null):{}},Ln.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Ln.prototype.get=function(e){var n,t=this.__data__;return Pn?(n=t[e])===cn?void 0:n:Sn.call(t,e)?t[e]:void 0},Ln.prototype.has=function(e){var n=this.__data__;return Pn?void 0!==n[e]:Sn.call(n,e)},Ln.prototype.set=function(e,n){return this.__data__[e]=Pn&&void 0===n?cn:n,this},Nn.prototype.clear=function(){this.__data__=[]},Nn.prototype.delete=function(e){var n=this.__data__,t=Fn(n,e);return!(t<0||(t==n.length-1?n.pop():xn.call(n,t,1),0))},Nn.prototype.get=function(e){var n=this.__data__,t=Fn(n,e);return t<0?void 0:n[t][1]},Nn.prototype.has=function(e){return-1<Fn(this.__data__,e)},Nn.prototype.set=function(e,n){var t=this.__data__,o=Fn(t,e);return o<0?t.push([e,n]):t[o][1]=n,this},Bn.prototype.clear=function(){this.__data__={hash:new Ln,map:new(In||Nn),string:new Ln}},Bn.prototype.delete=function(e){return Un(this,e).delete(e)},Bn.prototype.get=function(e){return Un(this,e).get(e)},Bn.prototype.has=function(e){return Un(this,e).has(e)},Bn.prototype.set=function(e,n){return Un(this,e).set(e,n),this},Mn=Vn((function(e){e=null==e?"":"string"==typeof(n=e)?n:Qn(n)?On?On.call(n):"":"0"==(t=n+"")&&1/n==-1/0?"-0":t;var n,t,o=[];return dn.test(e)&&o.push(""),e.replace(fn,(function(e,n,t,i){o.push(t?i.replace(pn,"$1"):n||e)})),o})),Vn.Cache=Bn,En=Array.isArray,on.exports=function(e,n,t){var o=null==e?void 0:function(e,n){for(var t,o,i,r=0,c=((n=((e,n)=>{var t;if(!En(e))return"number"==(t=typeof e)||"symbol"==t||"boolean"==t||null==e||Qn(e)||ln.test(e)||!un.test(e)||null!=n&&e in Object(n)})(n,e)?[n]:En(t=n)?t:Mn(t)).length);null!=e&&r<c;)e=e[(o=n[r++],i=void 0,"string"==typeof o||Qn(o)?o:"0"==(i=o+"")&&1/o==-1/0?"-0":i)];return r&&r==c?e:void 0}(e,n);return void 0===o?t:o},jn.exports.default;var Jn,Gn,Xn,$n,Hn,zn,Kn,Yn,Zn,et,nt,tt,ot,it,rt,ct,st,at,ut,lt,dt,ft,pt,wt,vt,ht,gt,mt,bt,kt,Ct,yt,Wt,St,_t,At,Tt,xt,It,Pt,Dt,Ot,Mt={exports:{}};function Et(e,n){var t=null==e?void 0:e[n];return function(e){return Bt(e)&&!(dt&&dt in e)&&(Nt(e)||(e=>{var n=!1;if(null!=e&&"function"!=typeof e.toString)try{n=!!(e+"")}catch(e){}return n})(e)?vt:nt).test(jt(e))}(t)?t:void 0}function jt(e){if(null!=e){try{return ft.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Lt(e){return null!=e&&"number"==typeof(n=e.length)&&-1<n&&n%1==0&&n<=9007199254740991&&!Nt(e);var n}function Nt(e){var n=Bt(e)?wt.call(e):"";return"[object Function]"==n||"[object GeneratorFunction]"==n}function Bt(e){var n=typeof e;return e&&("object"==n||"function"==n)}Gn=(Jn=Mt).exports,zn="[object Map]",Kn="[object Promise]",Yn="[object Set]",Zn="[object WeakMap]",et="[object DataView]",nt=/^\[object .+?Constructor\]$/,tt="object"==typeof xe&&xe&&xe.Object===Object&&xe,ot="object"==typeof self&&self&&self.Object===Object&&self,it=tt||ot||Function("return this")(),st=(ct=(rt=Gn&&!Gn.nodeType&&Gn)&&Jn&&!Jn.nodeType&&Jn)&&ct.exports===rt,at=Function.prototype,ut=Object.prototype,lt=it["__core-js_shared__"],dt=(Xn=/[^.]+$/.exec(lt&&lt.keys&&lt.keys.IE_PROTO||""))?"Symbol(src)_1."+Xn:"",ft=at.toString,pt=ut.hasOwnProperty,wt=ut.toString,vt=RegExp("^"+ft.call(pt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ht=st?it.Buffer:void 0,gt=ut.propertyIsEnumerable,mt=ht?ht.isBuffer:void 0,$n=Object.keys,Hn=Object,bt=Et(it,"DataView"),kt=Et(it,"Map"),Ct=Et(it,"Promise"),yt=Et(it,"Set"),Wt=Et(it,"WeakMap"),St=!gt.call({valueOf:1},"valueOf"),_t=jt(bt),At=jt(kt),Tt=jt(Ct),xt=jt(yt),It=jt(Wt),Pt=function(e){return wt.call(e)},(bt&&Pt(new bt(new ArrayBuffer(1)))!=et||kt&&Pt(new kt)!=zn||Ct&&Pt(Ct.resolve())!=Kn||yt&&Pt(new yt)!=Yn||Wt&&Pt(new Wt)!=Zn)&&(Pt=function(e){var n=wt.call(e),t="[object Object]"==n?e.constructor:void 0,o=t?jt(t):void 0;if(o)switch(o){case _t:return et;case At:return zn;case Tt:return Kn;case xt:return Yn;case It:return Zn}return n}),Dt=Array.isArray,Ot=mt||function(){return!1},Jn.exports=function(e){if(Lt(e)&&(Dt(e)||"string"==typeof e||"function"==typeof e.splice||Ot(e)||(t=n=e)&&"object"==typeof t&&Lt(t)&&pt.call(n,"callee")&&(!gt.call(n,"callee")||"[object Arguments]"==wt.call(n))))return!e.length;var n,t,o,i,r=Pt(e);if(r==zn||r==Yn)return!e.size;if(St||e===("function"==typeof(o=e&&e.constructor)&&o.prototype||ut))return!$n(Hn(e)).length;for(i in e)if(pt.call(e,i))return!1;return!0},Mt.exports.default;var Ft,Ut,Rt,Vt,qt,Qt,Jt,Gt,Xt,$t,Ht,zt,Kt,Yt,Zt,eo,no,to,oo,io,ro,co,so,ao,uo,lo,fo,po,wo,vo,ho,go,mo,bo,ko,Co,yo,Wo,So,_o,Ao,To,xo,Io,Po,Do,Oo,Mo,Eo,jo,Lo,No,Bo,Fo,Uo,Ro,Vo,qo,Qo,Jo,Go,Xo,$o,Ho,zo,Ko={exports:{}};function Yo(e){var n;return(Ut[e]||(n=Ut[e]={i:e,l:!1,exports:{}},Ft[e].call(n.exports,n,n.exports,Yo),n.l=!0,n)).exports}function Zo(){}function ei(e){var n=-1,t=null==e?0:e.length;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function ni(e){var n=-1,t=null==e?0:e.length;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function ti(e){var n=-1,t=null==e?0:e.length;for(this.clear();++n<t;){var o=e[n];this.set(o[0],o[1])}}function oi(e){var n=this.__data__=new ni(e);this.size=n.size}function ii(e,n,t){(void 0===t||vi(e[n],t))&&(void 0!==t||n in e)||ci(e,n,t)}function ri(e,n){for(var t=e.length;t--;)if(vi(e[t][0],n))return t;return-1}function ci(e,n,t){"__proto__"==n&&xo?xo(e,n,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[n]=t}function si(e){if(null==e)return void 0===e?"[object Undefined]":"[object Null]";if(To&&To in Object(e)){var n=e,t=vo.call(n,To),o=n[To];try{var i=!(n[To]=void 0)}catch(n){}var r=go.call(n);return i&&(t?n[To]=o:delete n[To]),r}return go.call(e)}function ai(e){return ki(e)&&si(e)==Jt}function ui(e,n,t,o,i){e!==n&&jo(n,(function(r,c){var s,a,u,l,d,f,p,w,v,h,g,m,b,k,C,y,W,S,_,A;i=i||new oi,bi(r)?(u=n,d=t,f=ui,p=o,w=i,S=wi(a=e,l=c),_=wi(u,l),(A=w.get(_))?ii(a,l,A):((v=void 0===(b=p?p(S,_,l+"",a,u,w):void 0))&&(g=!(h=Ro(_))&&Vo(_),m=!h&&!g&&Qo(_),b=_,h||g||m?b=Ro(S)?S:ki(W=S)&&hi(W)?((e,n)=>{var t=-1,o=e.length;for(n=n||Array(o);++t<o;)n[t]=e[t];return n})(S):g?(v=!1,_.slice()):m?(v=!1,y=new(C=(k=_).buffer).constructor(C.byteLength),new yo(y).set(new yo(C)),new k.constructor(y,k.byteOffset,k.length)):[]:(e=>{var n,t;if(ki(e)&&si(e)==Xt)return null===(n=Wo(e))||"function"==typeof(t=vo.call(n,"constructor")&&n.constructor)&&t instanceof t&&wo.call(t)==mo})(_)||Uo(_)?Uo(b=S)?b=(()=>{for(var e,n,t,o,i=S,r=Ci(S),c=void 0,s=!c,a=(c=c||{},-1),u=r.length;++a<u;){var l=r[a],d=void 0;void 0===d&&(d=i[l]),s?ci(c,l,d):(t=d,o=(e=c)[n=l],vo.call(e,n)&&vi(o,t)&&(void 0!==t||n in e)||ci(e,n,t))}return c})():bi(S)&&!gi(S)||(b="function"!=typeof _.constructor||pi(_)?{}:Eo(Wo(_))):v=!1),v&&(w.set(_,b),f(b,_,d,p,w),w.delete(_)),ii(a,l,b))):(s=o?o(wi(e,c),r,c+"",e,n,i):void 0,ii(e,c,s=void 0===s?r:s))}),Ci)}function li(e,n){var t,o=e.__data__;return("string"==(t=typeof n)||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==n:null===n)?o["string"==typeof n?"string":"hash"]:o.map}function di(e,n){var t=null==e?void 0:e[n];return function(e){return bi(e)&&!(ho&&ho in e)&&(gi(e)?bo:$t).test((e=>{if(null!=e){try{return wo.call(e)}catch(e){}try{return e+""}catch(e){}}return""})(e))}(t)?t:void 0}function fi(e,n){var t=typeof e;return(n=null==n?Qt:n)&&("number"==t||"symbol"!=t&&Ht.test(e))&&-1<e&&e%1==0&&e<n}function pi(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||fo)}function wi(e,n){if(("constructor"!==n||"function"!=typeof e[n])&&"__proto__"!=n)return e[n]}function vi(e,n){return e===n||e!=e&&n!=n}function hi(e){return null!=e&&mi(e.length)&&!gi(e)}function gi(e){var n;if(bi(e))return(n=si(e))==Gt||"[object GeneratorFunction]"==n||"[object AsyncFunction]"==n||"[object Proxy]"==n}function mi(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=Qt}function bi(e){var n=typeof e;return null!=e&&("object"==n||"function"==n)}function ki(e){return null!=e&&"object"==typeof e}function Ci(e){if(hi(e))return function(e){var n,t=Ro(e),o=!t&&Uo(e),i=!t&&!o&&Vo(e),r=!t&&!o&&!i&&Qo(e),c=t||o||i||r,s=c?((e,n)=>{for(var t=-1,o=Array(e);++t<e;)o[t]=n(t);return o})(e.length,String):[],a=s.length;for(n in e)c&&("length"==n||i&&("offset"==n||"parent"==n)||r&&("buffer"==n||"byteLength"==n||"byteOffset"==n)||fi(n,a))||s.push(n);return s}(e);var n=e;if(bi(n)){var t,o=pi(n),i=[];for(t in n)("constructor"!=t||!o&&vo.call(n,t))&&i.push(t);return i}var r=[];if(null!=n)for(var c in Object(n))r.push(c);return r}function yi(e){return e}Vt=(Rt=Ko).exports,qt="__lodash_hash_undefined__",Qt=9007199254740991,Jt="[object Arguments]",Gt="[object Function]",Xt="[object Object]",$t=/^\[object .+?Constructor\]$/,Ht=/^(?:0|[1-9]\d*)$/,(zt={})["[object Float32Array]"]=zt["[object Float64Array]"]=zt["[object Int8Array]"]=zt["[object Int16Array]"]=zt["[object Int32Array]"]=zt["[object Uint8Array]"]=zt["[object Uint8ClampedArray]"]=zt["[object Uint16Array]"]=zt["[object Uint32Array]"]=!0,zt[Jt]=zt["[object Array]"]=zt["[object ArrayBuffer]"]=zt["[object Boolean]"]=zt["[object DataView]"]=zt["[object Date]"]=zt["[object Error]"]=zt[Gt]=zt["[object Map]"]=zt["[object Number]"]=zt[Xt]=zt["[object RegExp]"]=zt["[object Set]"]=zt["[object String]"]=zt["[object WeakMap]"]=!1,Kt="object"==typeof xe&&xe&&xe.Object===Object&&xe,Yt="object"==typeof self&&self&&self.Object===Object&&self,Zt=Kt||Yt||Function("return this")(),eo=Vt&&!Vt.nodeType&&Vt,to=(no=eo&&Rt&&!Rt.nodeType&&Rt)&&no.exports===eo,oo=to&&Kt.process,ro=(io=(()=>{try{return no&&no.require&&no.require("util").types||oo&&oo.binding&&oo.binding("util")}catch(e){}})())&&io.isTypedArray,uo=Array.prototype,lo=Function.prototype,fo=Object.prototype,po=Zt["__core-js_shared__"],wo=lo.toString,vo=fo.hasOwnProperty,ho=(co=/[^.]+$/.exec(po&&po.keys&&po.keys.IE_PROTO||""))?"Symbol(src)_1."+co:"",go=fo.toString,mo=wo.call(Object),bo=RegExp("^"+wo.call(vo).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ko=to?Zt.Buffer:void 0,Co=Zt.Symbol,yo=Zt.Uint8Array,ko&&ko.allocUnsafe,so=Object.getPrototypeOf,Wo=function(e){return so(ao(e))},So=(ao=Object).create,_o=fo.propertyIsEnumerable,Ao=uo.splice,To=Co?Co.toStringTag:void 0,xo=(()=>{try{var e=di(Object,"defineProperty");return e({},"",{}),e}catch(e){}})(),Io=ko?ko.isBuffer:void 0,Po=Math.max,Do=Date.now,Oo=di(Zt,"Map"),Mo=di(Object,"create"),Eo=function(e){if(!bi(e))return{};if(So)return So(e);Zo.prototype=e;var n=new Zo;return Zo.prototype=void 0,n},ei.prototype.clear=function(){this.__data__=Mo?Mo(null):{},this.size=0},ei.prototype.delete=function(e){var n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n},ei.prototype.get=function(e){var n,t=this.__data__;return Mo?(n=t[e])===qt?void 0:n:vo.call(t,e)?t[e]:void 0},ei.prototype.has=function(e){var n=this.__data__;return Mo?void 0!==n[e]:vo.call(n,e)},ei.prototype.set=function(e,n){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=Mo&&void 0===n?qt:n,this},ni.prototype.clear=function(){this.__data__=[],this.size=0},ni.prototype.delete=function(e){var n=this.__data__,t=ri(n,e);return!(t<0||(t==n.length-1?n.pop():Ao.call(n,t,1),--this.size,0))},ni.prototype.get=function(e){var n=this.__data__,t=ri(n,e);return t<0?void 0:n[t][1]},ni.prototype.has=function(e){return-1<ri(this.__data__,e)},ni.prototype.set=function(e,n){var t=this.__data__,o=ri(t,e);return o<0?(++this.size,t.push([e,n])):t[o][1]=n,this},ti.prototype.clear=function(){this.size=0,this.__data__={hash:new ei,map:new(Oo||ni),string:new ei}},ti.prototype.delete=function(e){var n=li(this,e).delete(e);return this.size-=n?1:0,n},ti.prototype.get=function(e){return li(this,e).get(e)},ti.prototype.has=function(e){return li(this,e).has(e)},ti.prototype.set=function(e,n){var t=li(this,e),o=t.size;return t.set(e,n),this.size+=t.size==o?0:1,this},oi.prototype.clear=function(){this.__data__=new ni,this.size=0},oi.prototype.delete=function(e){var n=this.__data__,t=n.delete(e);return this.size=n.size,t},oi.prototype.get=function(e){return this.__data__.get(e)},oi.prototype.has=function(e){return this.__data__.has(e)},oi.prototype.set=function(e,n){var t=this.__data__;if(t instanceof ni){var o=t.__data__;if(!Oo||o.length<199)return o.push([e,n]),this.size=++t.size,this;t=this.__data__=new ti(o)}return t.set(e,n),this.size=t.size,this},jo=function(e,n,t){for(var o=-1,i=Object(e),r=t(e),c=r.length;c--;){var s=r[++o];if(!1===n(i[s],s,i))break}return e},Lo=xo?function(e,n){return xo(e,"toString",{configurable:!0,enumerable:!1,value:(t=n,function(){return t}),writable:!0});var t}:yi,Bo=No=0,Fo=function(){var e=Do(),n=16-(e-Bo);if(Bo=e,0<n){if(800<=++No)return arguments[0]}else No=0;return Lo.apply(void 0,arguments)},Uo=ai(function(){return arguments}())?ai:function(e){return ki(e)&&vo.call(e,"callee")&&!_o.call(e,"callee")},Ro=Array.isArray,Vo=Io||function(){return!1},Qo=ro?(qo=ro,function(e){return qo(e)}):function(e){return ki(e)&&mi(e.length)&&!!zt[si(e)]},Jo=function(e,n,t){ui(e,n,t)},zo=Fo((Xo=Go=function(e,n){var t=-1,o=n.length,i=1<o?n[o-1]:void 0,r=2<o?n[2]:void 0;for((i=3<Jo.length&&"function"==typeof i?(o--,i):void 0,r&&((e,n,t)=>{var o;if(bi(t))return("number"==(o=typeof n)?hi(t)&&fi(n,t.length):"string"==o&&n in t)&&vi(t[n],e)})(n[0],n[1],r)&&(i=o<3?void 0:i,o=1),e=Object(e));++t<o;){var c=n[t];c&&Jo(e,c,t)}return e},Ho=yi,$o=Po(Xo.length-1,0),function(){for(var e=arguments,n=-1,t=Po(e.length-$o,0),o=Array(t);++n<t;)o[n]=e[$o+n];n=-1;for(var i=Array($o+1);++n<$o;)i[n]=e[n];i[$o]=Ho(o);var r=Xo,c=this,s=i;switch(s.length){case 0:return r.call(c);case 1:return r.call(c,s[0]);case 2:return r.call(c,s[0],s[1]);case 3:return r.call(c,s[0],s[1],s[2])}return r.apply(c,s)}),Go+""),Rt.exports=zo,Ko.exports.default,Ie.exports=(Ft={"../node_modules/webpack/buildin/global.js":function(e,n){var t=function(){return this}();try{t=t||new Function("return this")()}catch(e){"object"==typeof window&&(t=window)}e.exports=t},"./config-constants.ts":function(e,n,t){function o(){}Object.defineProperty(n,"__esModule",{value:!0}),n.ConfigItem=void 0,o.getKey=function(e){if(""===this.configName)throw new Error("子类未重命名configName!");return this.configName+"."+e},o.configName="",n.ConfigItem=o},"./config-manager.ts":function(e,n,t){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=(Object.defineProperty(n,"__esModule",{value:!0}),n.DocsConfig=void 0,o(t("lodash.merge"))),r=o(t("lodash.get")),c=o(t("lodash.isempty")),s=o(t("lodash.clonedeep")),a=t("./utils.ts"),u=(l.prototype.bind=function(e){i.default(this.cache,e)},l.prototype.get=function(e){return r.default(this.cache,e)},l.prototype.clear=function(){this.cache={}},l.prototype.getAll=function(){return this.cache},l);function l(){this.cache={}}function d(){this.cache=new u,this.init()}d.getInstance=function(){return this.instance||(this.instance=new d),this.instance},d.prototype.bind=function(e){c.default(e)||this.cache.bind(e)},d.prototype.clear=function(){this.cache.clear()},d.prototype.getConfig=function(e){return"object"==typeof(e=this.cache.get(e))?s.default(e):e},d.prototype.getAllConfig=function(){var e=null!=(e=this.cache.getAll())?e:{};return s.default(e)},d.prototype.saveToSessionStorage=function(e){var n,t;try{if(window&&window.sessionStorage)return t=null!=(n=null!=e?e:this.cache.getAll())?n:{},window.sessionStorage.setItem("configCache",JSON.stringify(t)),!0}catch(e){console.error(e)}return!1},d.prototype.loadFromSessionStorage=function(){try{if(!window||!window.sessionStorage)throw new Error("browser is not support sessionStorage");var e=window.sessionStorage.getItem("configCache");if(e)return this.bind(JSON.parse(e)),!0}catch(e){console.error(e)}return!1},d.prototype.init=function(){var e;"undefined"!=typeof window&&("object"==typeof(e=window.AppConfig)?(e=e[a.getURLQuery("mode")]||e.normal,e=i.default(e,null==e?void 0:e.custom),this.bind(e),this.saveToSessionStorage()):console.error("加载 AppConfig 配置出错"))},n.DocsConfig=t=d},"./index.ts":function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.ConfigItem=void 0;var o=t("./config-manager.ts"),i=t("./config-constants.ts");Object.defineProperty(n,"ConfigItem",{enumerable:!0,get:function(){return i.ConfigItem}}),n.default=o.DocsConfig},"./utils.ts":function(e,n,t){(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.getURLQuery=void 0,n.getURLQuery=function(n,t){var o,i=(t?"?"+(t.split("?")[1]||""):null==(i=e.location)?void 0:i.search)||"";return(o=i?i.match(new RegExp("(\\?|&)"+n+"=([^&]*)(&|$)")):null)?decodeURIComponent(o[2]):""}}).call(this,t("../node_modules/webpack/buildin/global.js"))},"lodash.clonedeep":function(e,n){e.exports=Pe.exports},"lodash.get":function(e,n){e.exports=jn.exports},"lodash.isempty":function(e,n){e.exports=Mt.exports},"lodash.merge":function(e,n){e.exports=Ko.exports}},Ut={},Yo.m=Ft,Yo.c=Ut,Yo.d=function(e,n,t){Yo.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},Yo.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},Yo.t=function(e,n){if(1&n&&(e=Yo(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(Yo.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)Yo.d(t,o,function(n){return e[n]}.bind(null,o));return t},Yo.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return Yo.d(n,"a",n),n},Yo.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},Yo.p="",Yo(Yo.s="./index.ts"));var Wi,Si,_i=Ie.exports.default.getInstance().getConfig('npm["@tencent/tdocs-jsapi"]'),Ai=function(){return window.location.host},Ti=(null==_i?void 0:_i.TOC_HOST)||"docs.qq.com",xi=(null==_i?void 0:_i.TOB_HOST)||"doc.weixin.qq.com",Ii=(null==_i?void 0:_i.TOB_COOKIE_DOMAIN)||".doc.weixin.qq.com",Pi=Object.values((null==_i?void 0:_i.COOKIE_DOMAINS)||[".weixin.qq.com","weixin.qq.com",".doc.weixin.qq.com","doc.weixin.qq.com"]),Di=(null==_i?void 0:_i.QQJSSDK)||"https://docs.idqqimg.com/tim/docs/sheets/static/js/lib/docs.qqapi.v1.js",Oi=(null==_i?void 0:_i.WXJSSDK)||"https://res.wx.qq.com/open/js/jweixin-1.6.0.js",Mi=(null==_i?void 0:_i.WW_MOBILE_JSSDK)||"https://res.wx.qq.com/d/tdocs-bridge/v0.0.34/TenOfficeJSBridge.js",Ei=(null==_i?void 0:_i.WW_PC_JSSDK)||"https://res.wx.qq.com/d/tdocs-bridge/v0.0.35/wwapp.js",ji=(null==_i?void 0:_i.WW_MOBILE_JSSDK_OLD)||"https://res.wx.qq.com/d/tdocs-bridge/v0.0.30/QMailBridge.js",Li=(null==_i?void 0:_i.WW_PC_JSSDK_OLD)||"https://res.wx.qq.com/d/tdocs-bridge/v0.0.30/WxDriveAdapter.js",Ni=(null==_i?void 0:_i.WW_WEMEET_JS_SDK)||"https://res.wx.qq.com/d/tdocs-bridge/v0.0.29/wemeet-js-sdk-1.0.40.js",Bi=new RegExp((null==_i?void 0:_i.WEDRIVE_LINK_REGEXP)||"^http(s):\\/\\/drive\\.weixin\\.qq\\.com"),Fi=new RegExp((null==_i?void 0:_i.PRIVATE_WEDRIVE_LINK_REGEXP)||"^http(s):\\/\\/drive\\.weixin\\.qq\\.com\\/s\\?"),Ui=new RegExp((null==_i?void 0:_i.WEDOC_FORM_LINK_REGEXP)||"^http(s):\\/\\/doc\\.weixin\\.qq\\.com\\/form"),Ri=new RegExp((null==_i?void 0:_i.TOC_ORIGIN_REGEXP)||"^https?:\\/\\/docs\\.qq\\.com(\\/|$)"),Vi=new RegExp((null==_i?void 0:_i.TOB_ORIGIN_REGEXP)||"^https?:\\/\\/doc\\.weixin\\.qq\\.com(\\/|$)"),qi=new RegExp((null==_i?void 0:_i.APP_WORK_WEIXIN_ADMIN_URL_REGEXP)||"^https?:\\/\\/app\\.work\\.weixin\\.qq\\.com\\/wework_admin"),Qi=(null==_i?void 0:_i.TOC_SUPPORT_URL)||"https://support.qq.com/products/28096/",Ji=(null==_i?void 0:_i.TOB_SUPPORT_URL)||"https://support.qq.com/products/111603/",Gi=(Xi.isServerSide=function(){return"undefined"==typeof window},Xi.getUserAgent=function(){return this.isServerSide()?"":navigator.userAgent},Xi.getLowerCaseUserAgent=function(){return this.getUserAgent().toLowerCase()},Xi.isMobile=function(){return/(mobile)/i.test(this.getUserAgent())||/(android)/i.test(this.getUserAgent())},Xi.isEnterpriseEnv=function(){return Ai()===xi},Xi.isAndroid=function(){return/(android)/i.test(this.getUserAgent())},Xi.isIOS=function(){return/(iphone|ipad|ipod)/i.test(this.getUserAgent())},Xi.isIPad=function(){return/(ipad)/i.test(this.getUserAgent())},Xi.isAPad=function(){return!/(mobile)/i.test(this.getUserAgent())&&/android/i.test(this.getUserAgent())&&/TencentDocs/i.test(this.getUserAgent())},Xi.isMac=function(){return!this.isMobile()&&/Mac OS X/i.test(this.getUserAgent())},Xi.isWindows=function(){return!this.isServerSide()&&/win/i.test(navigator.platform.toLowerCase())},Xi.isLinux=function(){return!this.isServerSide()&&navigator.platform.includes("Linux")},Xi.isIE=function(){return/msie/i.test(this.getUserAgent())&&!this.isOpera()||/trident/i.test(this.getUserAgent())},Xi.isIE9=function(){return!!this.isIE()&&"MSIE9.0"===navigator.appVersion.split(";")[1].replace(/[ ]/g,"")},Xi.isIE10=function(){return!!this.isIE()&&"MSIE10.0"===navigator.appVersion.split(";")[1].replace(/[ ]/g,"")},Xi.isIE11=function(){return!window.ActiveXObject&&"ActiveXObject"in window},Xi.isEdge=function(){return/edge/i.test(this.getUserAgent())},Xi.isChrome=function(){return/chrome/i.test(this.getUserAgent())},Xi.isIOSChrome=function(){return/CriOS/i.test(this.getUserAgent())},Xi.getChromeVersion=function(){var e=this.getUserAgent().match(/Chrom(e|ium)\/([0-9]+)\./);return e?parseInt(e[2],10):0},Xi.isFireFox=function(){return/firefox/i.test(this.getUserAgent())},Xi.isOpera=function(){return/opera/i.test(this.getUserAgent())},Xi.isSafari=function(){return/safari/i.test(this.getUserAgent())},Xi.isQBFamily=function(){return/QQBrowser/i.test(this.getUserAgent())},Xi.isMQB=function(){return/MQB/i.test(this.getUserAgent())},Xi.isMQBFamily=function(){return/MQQBrowser/i.test(this.getUserAgent())},Xi.isPCQQBrowser=function(){return this.isQBFamily()&&!this.isMobile()&&!/QBCore/i.test(this.getUserAgent())},Xi.isMobileQQBrowser=function(){return this.isMobile()&&this.isMQBFamily()&&!/TBS/i.test(this.getUserAgent())},Xi.isQQBrowser=function(){return this.isMobile()?this.isMobileQQBrowser():this.isPCQQBrowser()},Xi.isWindowStore=function(){return/MSAppHost/i.test(this.getUserAgent())},Xi.isTimQQ=function(){return/(QQ)/i.test(this.getUserAgent())&&!this.isTencentDocsApp()&&!this.isWeWork()&&!this.isWXh5()&&!this.isQQBrowser()},Xi.isTim=function(){return/TIM/.test(this.getUserAgent())},Xi.isQQ=function(){return this.isTimQQ()&&!this.isTim()},Xi.isWeMeetApp=function(){return/(tencent_wemeet)/i.test(this.getUserAgent())&&(this.isIOS()||this.isAndroid())},Xi.isTencentDocsApp=function(){return/TencentDocs/i.test(this.getUserAgent())},Xi.isTencentDocsIPadApp=function(){return this.isIPad()&&this.isTencentDocsApp()},Xi.isTencentDocsPhoneApp=function(){return!this.isIPad()&&!this.isAPad()&&this.isTencentDocsApp()},Xi.getTencentDocsAppVersion=function(){var e;return this.isTencentDocsApp()&&(e=null,this.isAndroid()?e=this.getUserAgent().match(/TencentDocs\/(\S*).tencentdocs/):this.isIOS()&&(e=this.getUserAgent().match(/TencentDocs\/(\S*)/)),e)?e[1]:""},Xi.getQQBrowserVersion=function(){var e=this.getUserAgent().match(/MQQBrowser\/(\S*)/);return e?e[1]:""},Xi.checkTencentDocAppVersionSupportFunction=function(e){var n=this.getTencentDocsAppVersion();return 0<=this.compareVersion(n,e)},Xi.checkTencentDocAppVersionLowerSupportFunction=function(e){var n=this.getTencentDocsAppVersion();return this.compareVersion(n,e)<0},Xi.isTencentDocsPC=function(){return/TxDocsPC/i.test(this.getUserAgent())},Xi.isTencentDocsDesktopApp=function(){return/TDAppDesktop/i.test(this.getUserAgent())},Xi.checkAppVersionSupportFunction=function(e){var n=this.getUserAgent().match(/MQQBrowser\/(\S*)/);return!!n&&n[1]>=e},Xi.getTencentDocsDesktopAppVersion=function(){var e;return this.isTencentDocsDesktopApp()&&(e=this.getUserAgent().match(/TDAppDesktop\/(\S*)/))?e[1]:""},Xi.supportNativeToolbar=function(){var e;if(this.isTencentDocsApp()&&!location.href.includes("/aio/")){var n=null==(e=this.getUserAgent().match(/TencentDocs\/(\S*).tencentdocs/))?void 0:e[1];if(this.isAndroid()&&"string"==typeof n&&"2.1.5"<=n||(this.isIOS()||this.isIPad())&&this.checkTencentDocAppVersionSupportFunction("2.1.5"))return!0}return!1},Xi.isPortrait=function(){var e=window.orientation;return 0===e||180===e},Xi.measureSafeMargin=function(){var e,n,t=this.isPortrait().toString();return this._margins[t]||(this._innerSpan||(this._innerSpan=document.createElement("span")),this._innerSpan.id="safeAreaMarginSpan",e=["top","bottom"].map((function(e){return"padding-"+e+": constant(safe-area-inset-"+e+"); padding-"+e+": env(safe-area-inset-"+e+");"})).join(""),this._innerSpan.style.cssText="position: absolute; top: -50000px; white-space:nowrap; overflow: hidden; "+e,document.body.appendChild(this._innerSpan),n=window.getComputedStyle(this._innerSpan),this._margins[t]={top:parseInt(n.paddingTop||"0",10)||0,bottom:parseInt(n.paddingBottom||"0",10)||0}),this._margins[t]},Xi.isIphoneX=function(){var e=/iphone/gi.test(this.getUserAgent())&&window.devicePixelRatio&&3===window.devicePixelRatio&&(812===window.screen.width&&375===window.screen.height||375===window.screen.width&&812===window.screen.height),n=/iphone/gi.test(this.getUserAgent())&&window.devicePixelRatio&&3===window.devicePixelRatio&&(414===window.screen.width&&896===window.screen.height||896===window.screen.width&&414===window.screen.height),t=/iphone/gi.test(this.getUserAgent())&&window.devicePixelRatio&&2===window.devicePixelRatio&&(414===window.screen.width&&896===window.screen.height||896===window.screen.width&&414===window.screen.height);return e||n||t},Xi.clearSafeMargin=function(){var e=document.getElementById("safeAreaMarginSpan");e?e.remove():this._innerSpan&&this._innerSpan.remove()},Xi.getStylePanelHeight=function(){var e,n=258;return this.isIOS()?this.isPortrait()?(e=this.measureSafeMargin().bottom,n+=!this.isIphoneX()||0!==e||this.isWXh5()||this.isQQMiniProgram()?e:32):n=window.innerHeight/2:this.isPortrait()||(n=window.innerHeight/2),n},Xi.getDocUniqueUrl=function(){var e=window.location.pathname.split("/");return e[e.length-1]||"doc"},Xi.setStylePanelClick=function(e){this.stylePanelButtonClicked=e},Xi.isStylePanelClick=function(){return this.stylePanelButtonClicked},Xi.isQQHD=function(){return/IPadQQ/i.test(this.getUserAgent())},Xi.isWXFamily=function(){return/MicroMessenger/i.test(this.getUserAgent())},Xi.isWXorQQMiniProgram=function(){return this.isWXMiniProgram()||this.isQQMiniProgram()},Xi.isWXMiniProgram=function(){return this.isWXFamily()&&this.isMiniProgram()},Xi.isQQMiniProgram=function(){return/QQ\/|TIM/i.test(this.getUserAgent())&&this.isMiniProgram()},Xi.isWeWork=function(){return/(wxwork)/i.test(this.getUserAgent())},Xi.isWeWorkMacOrWin=function(){return!this.isMobile()&&this.isWeWork()&&/(Windows)|(Macintosh)/i.test(this.getUserAgent())},Xi.isWeWorkWin=function(){return!this.isMobile()&&this.isWeWork()&&/(Windows)/i.test(this.getUserAgent())},Xi.isWeWorkLinux=function(){return!this.isMobile()&&this.isWeWork()&&/(Linux)/i.test(this.getUserAgent())},Xi.isWXh5=function(){return this.isWXFamily()&&!this.isWeWork()&&!this.isWXMiniProgram()},Xi.isAndroidPad=function(){return!/(mobile)/i.test(this.getUserAgent())&&/(android)/i.test(this.getUserAgent())},Xi.getBrowser=function(){var e,n,t,o="other",i="0",r="other",c=navigator.userAgent.toLowerCase(),s=navigator.vendor;try{var a=null!==(n=/(msie\s|trident.*rv:)([\w.]+)/.exec(e=c))?{browser:"ie",version:n[2]||"0"}:null!==(n=/(edge)\/([\w.]+)/.exec(e))?{browser:"edge",version:n[2]||"0"}:null!==(n=/(chrome)\/([\w.]+)/.exec(e))&&/Google/.test(s)?{browser:n[1]||"",version:n[2]||"0"}:null!==(n=/version\/([\w.]+).*(safari)/.exec(e))&&/Apple Computer/.test(s)?{browser:n[2]||"",version:n[1]||"0"}:null!==(n=/(firefox)\/([\w.]+)/.exec(e))||null!==(n=/(opera).+version\/([\w.]+)/.exec(e))?{browser:n[1]||"",version:n[2]||"0"}:{browser:"other",version:"0"};a.browser&&(o=a.browser,i=a.version,r=/qqbrowser/.test(c)?"qq":/se/.test(c)&&/metasr/.test(c)?"sougou":/360se/.test(c)?"360":/ucweb/.test(c)?"uc":/2345explorer/.test(c)?"2345":/lbbrowser/.test(c)?"liebao":/maxthon/.test(c)?"maxthon":o)}catch(t){console.error(" getBrowser error: "+t)}return r+"_"+o+"_"+i},Xi.compareVersion=function(e,n){var t=e.split("."),o=n.split("."),i=parseInt(t[0],10)-parseInt(o[0],10);return 0==i&&e!==n?this.compareVersion(t.splice(1).join("."),o.splice(1).join(".")):i},Xi.isMiniProgram=function(){var e=window;return/miniprogram|miniapp(?!enable)/i.test(this.getUserAgent())||void 0!==e.__wxjs_environment&&"miniprogram"===e.__wxjs_environment},Xi._margins={},Xi.stylePanelButtonClicked=!1,Xi);function Xi(){}function $i(e){var n;return(Si[e]||(n=Si[e]={i:e,l:!1,exports:{}},Wi[e].call(n.exports,n,n.exports,$i),n.l=!0,n)).exports}Wi=[function(e,n){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)},function(e,n,t){e.exports=!t(3)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,n,t){var o=t(5);e.exports=function(e){if(o(e))return e;throw TypeError(e+" is not an object!")}},function(e,n){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,n,t){var o=t(18)("wks"),i=t(17),r=t(0).Symbol,c="function"==typeof r;(e.exports=function(e){return o[e]||(o[e]=c&&r[e]||(c?r:i)("Symbol."+e))}).store=o},function(e,n){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,n,t){function o(e,n,t){var u,l,d,f,p=e&o.F,w=e&o.G,v=e&o.P,h=e&o.B,g=w?i:e&o.S?i[n]||(i[n]={}):(i[n]||{}).prototype,m=w?r:r[n]||(r[n]={}),b=m.prototype||(m.prototype={});for(u in t=w?n:t)d=((l=!p&&g&&void 0!==g[u])?g:t)[u],f=h&&l?a(d,i):v&&"function"==typeof d?a(Function.call,d):d,g&&s(g,u,d,e&o.U),m[u]!=d&&c(m,u,f),v&&b[u]!=d&&(b[u]=d)}var i=t(0),r=t(15),c=t(11),s=t(12),a=t(19);i.core=r,o.F=1,o.G=2,o.S=4,o.P=8,o.B=16,o.W=32,o.U=64,o.R=128,e.exports=o},function(e,n,t){var o=t(2),i=t(24),r=t(16),c=Object.defineProperty;n.f=t(1)?Object.defineProperty:function(e,n,t){if(o(e),n=r(n,!0),o(t),i)try{return c(e,n,t)}catch(e){}if("get"in t||"set"in t)throw TypeError("Accessors not supported!");return"value"in t&&(e[n]=t.value),e}},function(e,n){var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},function(e,n){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,n,t){var o=t(14),i=Math.min;e.exports=function(e){return 0<e?i(o(e),9007199254740991):0}},function(e,n,t){var o=t(7),i=t(26);e.exports=t(1)?function(e,n,t){return o.f(e,n,i(1,t))}:function(e,n,t){return e[n]=t,e}},function(e,n,t){var o=t(0),i=t(11),r=t(13),c=t(17)("src"),s=t(45),a=(""+s).split("toString");t(15).inspectSource=function(e){return s.call(e)},(e.exports=function(e,n,t,s){var u="function"==typeof t;u&&!r(t,"name")&&i(t,"name",n),e[n]!==t&&(u&&!r(t,c)&&i(t,c,e[n]?""+e[n]:a.join(String(n))),e===o?e[n]=t:s?e[n]?e[n]=t:i(e,n,t):(delete e[n],i(e,n,t)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[c]||s.call(this)}))},function(e,n){var t={}.hasOwnProperty;e.exports=function(e,n){return t.call(e,n)}},function(e,n){var t=Math.ceil,o=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(0<e?o:t)(e)}},function(e,n){var t=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=t)},function(e,n,t){var o=t(5);e.exports=function(e,n){if(!o(e))return e;var t,i;if(n&&"function"==typeof(t=e.toString)&&!o(i=t.call(e))||"function"==typeof(t=e.valueOf)&&!o(i=t.call(e))||!n&&"function"==typeof(t=e.toString)&&!o(i=t.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,n){var t=0,o=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++t+o).toString(36))}},function(e,n,t){var o=t(15),i=t(0),r=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,n){return r[e]||(r[e]=void 0!==n?n:{})})("versions",[]).push({version:o.version,mode:t(46)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,n,t){var o=t(27);e.exports=function(e,n,t){if(o(e),void 0===n)return e;switch(t){case 1:return function(t){return e.call(n,t)};case 2:return function(t,o){return e.call(n,t,o)};case 3:return function(t,o,i){return e.call(n,t,o,i)}}return function(){return e.apply(n,arguments)}}},function(e,n,t){var o=t(30),i=t(9);e.exports=function(e){return o(i(e))}},function(e,n){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,n,t){var o=t(9);e.exports=function(e){return Object(o(e))}},function(e,n,t){var o,i,r=t(36),c=RegExp.prototype.exec,s=String.prototype.replace,a=c,u=(i=/b*/g,c.call(o=/a/,"a"),c.call(i,"a"),0!==o.lastIndex||0!==i.lastIndex),l=void 0!==/()??/.exec("")[1];e.exports=a=u||l?function(e){var n,t,o,i,a=this;return l&&(t=new RegExp("^"+a.source+"$(?!\\s)",r.call(a))),u&&(n=a.lastIndex),o=c.call(a,e),u&&o&&(a.lastIndex=a.global?o.index+o[0].length:n),l&&o&&1<o.length&&s.call(o[0],t,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(o[i]=void 0)})),o}:a},function(e,n,t){e.exports=!t(1)&&!t(3)((function(){return 7!=Object.defineProperty(t(25)("div"),"a",{get:function(){return 7}}).a}))},function(e,n,t){var o=t(5),i=t(0).document,r=o(i)&&o(i.createElement);e.exports=function(e){return r?i.createElement(e):{}}},function(e,n){e.exports=function(e,n){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:n}}},function(e,n){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,n,t){var o=t(5),i=t(48).set;e.exports=function(e,n,t){var r,c=n.constructor;return c!==t&&"function"==typeof c&&(r=c.prototype)!==t.prototype&&o(r)&&i&&i(e,r),e}},function(e,n,t){var o=t(49),i=t(26),r=t(20),c=t(16),s=t(13),a=t(24),u=Object.getOwnPropertyDescriptor;n.f=t(1)?u:function(e,n){if(e=r(e),n=c(n,!0),a)try{return u(e,n)}catch(e){}if(s(e,n))return i(!o.f.call(e,n),e[n])}},function(e,n,t){var o=t(8);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==o(e)?e.split(""):Object(e)}},function(e,n,t){var o=t(32),i=t(21).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(e){return o(e,i)}},function(e,n,t){var o=t(13),i=t(20),r=t(50)(!1),c=t(34)("IE_PROTO");e.exports=function(e,n){var t,s=i(e),a=0,u=[];for(t in s)t!=c&&o(s,t)&&u.push(t);for(;n.length>a;)!o(s,t=n[a++])||~r(u,t)||u.push(t);return u}},function(e,n,t){var o=t(14),i=Math.max,r=Math.min;e.exports=function(e,n){return(e=o(e))<0?i(e+n,0):r(e,n)}},function(e,n,t){var o=t(18)("keys"),i=t(17);e.exports=function(e){return o[e]||(o[e]=i(e))}},function(e,n,t){var o=t(5),i=t(8),r=t(4)("match");e.exports=function(e){var n;return o(e)&&(void 0!==(n=e[r])?!!n:"RegExp"==i(e))}},function(e,n,t){var o=t(2);e.exports=function(){var e=o(this),n="";return e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.unicode&&(n+="u"),e.sticky&&(n+="y"),n}},function(e,n,t){var o=t(53)(!0);e.exports=function(e,n,t){return n+(t?o(e,n).length:1)}},function(e,n,t){var o=t(54),i=RegExp.prototype.exec;e.exports=function(e,n){var t=e.exec;if("function"==typeof t){var r=t.call(e,n);if("object"!=typeof r)throw new TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==o(e))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(e,n)}},function(e,n,t){t(55);var o,i,r,c=t(12),s=t(11),a=t(3),u=t(9),l=t(4),d=t(23),f=l("species"),p=!a((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),w=(i=(o=/(?:)/).exec,o.exec=function(){return i.apply(this,arguments)},2===(r="ab".split(o)).length&&"a"===r[0]&&"b"===r[1]);e.exports=function(e,n,t){var o,i,r,v,h=l(e),g=!a((function(){var n={};return n[h]=function(){return 7},7!=""[e](n)})),m=g?!a((function(){var n=!1,t=/a/;return t.exec=function(){return n=!0,null},"split"===e&&(t.constructor={},t.constructor[f]=function(){return t}),t[h](""),!n})):void 0;g&&m&&("replace"!==e||p)&&("split"!==e||w)||(o=/./[h],r=(i=t(u,h,""[e],(function(e,n,t,i,r){return n.exec===d?g&&!r?{done:!0,value:o.call(n,t,i)}:{done:!0,value:e.call(t,n,i)}:{done:!1}})))[0],v=i[1],c(String.prototype,e,r),s(RegExp.prototype,h,2==n?function(e,n){return v.call(e,this,n)}:function(e){return v.call(e,this)}))}},function(e,n,t){var o=t(19),i=t(30),r=t(22),c=t(10),s=t(57);e.exports=function(e,n){var t=1==e,a=2==e,u=3==e,l=4==e,d=6==e,f=5==e||d,p=n||s;return function(n,s,w){for(var v,h,g=r(n),m=i(g),b=o(s,w,3),k=c(m.length),C=0,y=t?p(n,k):a?p(n,0):void 0;C<k;C++)if((f||C in m)&&(h=b(v=m[C],C,g),e))if(t)y[C]=h;else if(h)switch(e){case 3:return!0;case 5:return v;case 6:return C;case 2:y.push(v)}else if(l)return!1;return d?-1:u||l?l:y}}},function(e,n,t){var o=t(4)("unscopables"),i=Array.prototype;null==i[o]&&t(11)(i,o,{}),e.exports=function(e){i[o][e]=!0}},function(e,n){e.exports=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,n){function t(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}e.exports=function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,n,t){var o=t(6);o(o.S+o.F*!t(1),"Object",{defineProperty:t(7).f})},function(e,n,t){e.exports=t(18)("native-function-to-string",Function.toString)},function(e,n){e.exports=!1},function(e,n,t){var o=t(0),i=t(28),r=t(7).f,c=t(31).f,s=t(35),a=t(36),u=w=o.RegExp,l=w.prototype,d=/a/g,f=/a/g,p=new w(d)!==d;if(t(1)&&(!p||t(3)((function(){return f[t(4)("match")]=!1,w(d)!=d||w(f)==f||"/a/i"!=w(d,"i")})))){for(var w=function(e,n){var t=this instanceof w,o=s(e),r=void 0===n;return!t&&o&&e.constructor===w&&r?e:i(p?new u(o&&!r?e.source:e,n):u((o=e instanceof w)?e.source:e,o&&r?a.call(e):n),t?this:l,w)},v=c(u),h=0;v.length>h;)(e=>{e in w||r(w,e,{configurable:!0,get:function(){return u[e]},set:function(n){u[e]=n}})})(v[h++]);(l.constructor=w).prototype=l,t(12)(o,"RegExp",w)}t(51)("RegExp")},function(e,n,t){function o(e,n){if(r(e),!i(n)&&null!==n)throw TypeError(n+": can't set as prototype!")}var i=t(5),r=t(2);e.exports={set:Object.setPrototypeOf||("__proto__"in{}?((e,n,i)=>{try{(i=t(19)(Function.call,t(29).f(Object.prototype,"__proto__").set,2))(e,[]),n=!(e instanceof Array)}catch(e){n=!0}return function(e,t){return o(e,t),n?e.__proto__=t:i(e,t),e}})({},!1):void 0),check:o}},function(e,n){n.f={}.propertyIsEnumerable},function(e,n,t){var o=t(20),i=t(10),r=t(33);e.exports=function(e){return function(n,t,c){var s,a=o(n),u=i(a.length),l=r(c,u);if(e&&t!=t){for(;l<u;)if((s=a[l++])!=s)return!0}else for(;l<u;l++)if((e||l in a)&&a[l]===t)return e||l||0;return!e&&-1}}},function(e,n,t){var o=t(0),i=t(7),r=t(1),c=t(4)("species");e.exports=function(e){var n=o[e];r&&n&&!n[c]&&i.f(n,c,{configurable:!0,get:function(){return this}})}},function(e,n,t){var o=t(2),i=t(22),r=t(10),c=t(14),s=t(37),a=t(38),u=Math.max,l=Math.min,d=Math.floor,f=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g;t(39)("replace",2,(function(e,n,t,w){return[function(o,i){var r=e(this),c=null==o?void 0:o[n];return void 0!==c?c.call(o,r,i):t.call(String(r),o,i)},function(e,n){var v=w(t,e,this,n);if(v.done)return v.value;var h,g=o(e),m=String(this),b="function"==typeof n,k=(b||(n=String(n)),g.global);k&&(h=g.unicode,g.lastIndex=0);for(var C=[];null!==(A=a(g,m))&&(C.push(A),k);)""===String(A[0])&&(g.lastIndex=s(m,r(g.lastIndex),h));for(var y,W="",S=0,_=0;_<C.length;_++){for(var A=C[_],T=String(A[0]),x=u(l(c(A.index),m.length),0),I=[],P=1;P<A.length;P++)I.push(void 0===(y=A[P])?y:String(y));var D,O=A.groups,M=b?(D=[T].concat(I,x,m),void 0!==O&&D.push(O),String(n.apply(void 0,D))):((e,n,o,r,c,s)=>{var a=o+e.length,u=r.length,l=p;return void 0!==c&&(c=i(c),l=f),t.call(s,l,(function(t,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return e;case"`":return n.slice(0,o);case"'":return n.slice(a);case"<":s=c[i.slice(1,-1)];break;default:var l,f=+i;if(0==f)return t;if(u<f)return 0!==(l=d(f/10))&&l<=u?void 0===r[l-1]?i.charAt(1):r[l-1]+i.charAt(1):t;s=r[f-1]}return void 0===s?"":s}))})(T,m,x,I,O,n);S<=x&&(W+=m.slice(S,x)+M,S=x+T.length)}return W+m.slice(S)}]}))},function(e,n,t){var o=t(14),i=t(9);e.exports=function(e){return function(n,t){var r,c,s=String(i(n)),a=o(t),u=s.length;return a<0||u<=a?e?"":void 0:(r=s.charCodeAt(a))<55296||56319<r||a+1===u||(c=s.charCodeAt(a+1))<56320||57343<c?e?s.charAt(a):r:e?s.slice(a,a+2):c-56320+(r-55296<<10)+65536}}},function(e,n,t){var o=t(8),i=t(4)("toStringTag"),r="Arguments"==o(function(){return arguments}());e.exports=function(e){var n,t,c;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(t=((e,n)=>{try{return e[n]}catch(e){}})(n=Object(e),i))?t:r?o(n):"Object"==(c=o(n))&&"function"==typeof n.callee?"Arguments":c}},function(e,n,t){var o=t(23);t(6)({target:"RegExp",proto:!0,forced:o!==/./.exec},{exec:o})},function(e,n,t){var o=t(6),i=t(40)(1);o(o.P+o.F*!t(60)([].map,!0),"Array",{map:function(e){return i(this,e,arguments[1])}})},function(e,n,t){var o=t(58);e.exports=function(e,n){return new(o(e))(n)}},function(e,n,t){var o=t(5),i=t(59),r=t(4)("species");e.exports=function(e){var n;return void 0===(n=i(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!i(n.prototype)||(n=void 0),o(n))&&null===(n=n[r])?void 0:n)?Array:n}},function(e,n,t){var o=t(8);e.exports=Array.isArray||function(e){return"Array"==o(e)}},function(e,n,t){var o=t(3);e.exports=function(e,n){return!!e&&o((function(){n?e.call(null,(function(){}),1):e.call(null)}))}},function(e,n,t){var o=t(35),i=t(2),r=t(62),c=t(37),s=t(10),a=t(38),u=t(23),l=t(3),d=Math.min,f=[].push,p="length",w=!l((function(){}));t(39)("split",2,(function(e,n,t,l){var v="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[p]||2!="ab".split(/(?:ab)*/)[p]||4!=".".split(/(.?)(.?)/)[p]||1<".".split(/()()/)[p]||"".split(/.?/)[p]?function(e,n){var i=String(this);if(void 0===e&&0===n)return[];if(!o(e))return t.call(i,e,n);for(var r,c,s,a=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,w=void 0===n?4294967295:n>>>0,v=new RegExp(e.source,l+"g");(r=u.call(v,i))&&!((c=v.lastIndex)>d&&(a.push(i.slice(d,r.index)),1<r[p]&&r.index<i[p]&&f.apply(a,r.slice(1)),s=r[0][p],d=c,w<=a[p]));)v.lastIndex===r.index&&v.lastIndex++;return d===i[p]?!s&&v.test("")||a.push(""):a.push(i.slice(d)),w<a[p]?a.slice(0,w):a}:"0".split(void 0,0)[p]?function(e,n){return void 0===e&&0===n?[]:t.call(this,e,n)}:t;return[function(t,o){var i=e(this),r=null==t?void 0:t[n];return void 0!==r?r.call(t,i,o):v.call(String(i),t,o)},function(e,n){var o=l(v,e,this,n,v!==t);if(o.done)return o.value;var u=i(e),f=String(this),p=r(u,RegExp),h=u.unicode,g=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(w?"y":"g"),m=new p(w?u:"^(?:"+u.source+")",g),b=void 0===n?4294967295:n>>>0;if(0==b)return[];if(0===f.length)return null===a(m,f)?[f]:[];for(var k=0,C=0,y=[];C<f.length;){m.lastIndex=w?C:0;var W,S=a(m,w?f:f.slice(C));if(null===S||(W=d(s(m.lastIndex+(w?0:C)),f.length))===k)C=c(f,C,h);else{if(y.push(f.slice(k,C)),y.length===b)return y;for(var _=1;_<=S.length-1;_++)if(y.push(S[_]),y.length===b)return y;C=k=W}}return y.push(f.slice(k)),y}]}))},function(e,n,t){var o=t(2),i=t(27),r=t(4)("species");e.exports=function(e,n){var t,c=o(e).constructor;return void 0===c||null==(t=o(c)[r])?n:i(t)}},function(e,n,t){function o(e){var n=a(e,!1);if("string"==typeof n&&2<n.length){var t,o,i,r=(n=g?n.trim():p(n,3)).charCodeAt(0);if(43===r||45===r){if(88===(t=n.charCodeAt(2))||120===t)return NaN}else if(48===r){switch(n.charCodeAt(1)){case 66:case 98:o=2,i=49;break;case 79:case 111:o=8,i=55;break;default:return+n}for(var c,s=n.slice(2),u=0,l=s.length;u<l;u++)if((c=s.charCodeAt(u))<48||i<c)return NaN;return parseInt(s,o)}}return+n}var i=t(0),r=t(13),c=t(8),s=t(28),a=t(16),u=t(3),l=t(31).f,d=t(29).f,f=t(7).f,p=t(64).trim,w=b=i.Number,v=b.prototype,h="Number"==c(t(66)(v)),g="trim"in String.prototype;if(!b(" 0o1")||!b("0b1")||b("+0x1")){for(var m,b=function(e){var n=arguments.length<1?0:e,t=this;return t instanceof b&&(h?u((function(){v.valueOf.call(t)})):"Number"!=c(t))?s(new w(o(n)),t,b):o(n)},k=t(1)?l(w):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),C=0;k.length>C;C++)r(w,m=k[C])&&!r(b,m)&&f(b,m,d(w,m));(b.prototype=v).constructor=b,t(12)(i,"Number",b)}},function(e,n,t){function o(e,n,t){var o={},r=c((function(){return!!s[e]()||"​"!="​"[e]()})),a=o[e]=r?n(d):s[e];t&&(o[t]=a),i(i.P+i.F*r,"String",o)}var i=t(6),r=t(9),c=t(3),s=t(65),a="["+s+"]",u=RegExp("^"+a+a+"*"),l=RegExp(a+a+"*$"),d=o.trim=function(e,n){return e=String(r(e)),1&n&&(e=e.replace(u,"")),2&n?e.replace(l,""):e};e.exports=o},function(e,n){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,n,t){function o(){}var i=t(2),r=t(67),c=t(21),s=t(34)("IE_PROTO"),a=function(){var e,n=t(25)("iframe"),o=c.length;for(n.style.display="none",t(69).appendChild(n),n.src="javascript:",(e=n.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),a=e.F;o--;)delete a.prototype[c[o]];return a()};e.exports=Object.create||function(e,n){var t;return null!==e?(o.prototype=i(e),t=new o,o.prototype=null,t[s]=e):t=a(),void 0===n?t:r(t,n)}},function(e,n,t){var o=t(7),i=t(2),r=t(68);e.exports=t(1)?Object.defineProperties:function(e,n){i(e);for(var t,c=r(n),s=c.length,a=0;a<s;)o.f(e,t=c[a++],n[t]);return e}},function(e,n,t){var o=t(32),i=t(21);e.exports=Object.keys||function(e){return o(e,i)}},function(e,n,t){var o=t(0).document;e.exports=o&&o.documentElement},function(e,n,t){var o=t(6),i=t(40)(5),r=!0;"find"in[]&&Array(1).find((function(){r=!1})),o(o.P+o.F*r,"Array",{find:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0)}}),t(41)("find")},function(e,n,t){var o=t(6);o(o.P,"Array",{fill:t(72)}),t(41)("fill")},function(e,n,t){var o=t(22),i=t(33),r=t(10);e.exports=function(e){for(var n=o(this),t=r(n.length),c=arguments.length,s=i(1<c?arguments[1]:void 0,t),a=2<c?arguments[2]:void 0,u=void 0===a?t:i(a,t);s<u;)n[s++]=e;return n}},function(e,n,t){t.r(n),t.d(n,"getVersionFromUA",(function(){return d})),t.d(n,"compareVersion",(function(){return l})),t.d(n,"UserAgent",(function(){return qe}));var o=t(42),i=t.n(o),r=t(43),c=t.n(r),s=(t(44),t(47),t(52),t(56),t(61),t(63),t(70),t(71),/\d+([._]\d+)*/);function a(e){var n,t=s.exec(e);return null!=(n=null==t?void 0:t[0].replace(/_/g,"."))?n:null}function u(e){var n=a(e);return(null==n?void 0:n.split(".").map(Number))||[]}function l(e,n){return t=u(e),o=u(n),(i=Array(Math.max(t.length,o.length)).fill(0).map((function(e,n){return(t[n]||0)-(o[n]||0)})).find((function(e){return 0!==e}))||0)<0?-1:0<i?1:0;var t,o,i}function d(e,n){var t;try{t=new RegExp("\\b".concat(e,"\\W+\\d+([\\._]\\d+)*"),"i")}catch(e){return null}var o=t.exec(n);return o?a(o[0].substring(e.length)):null}var f,p=function(){return f=void 0===f?"undefined"!=typeof navigator?navigator.userAgent:"":f};function w(e){return function(n){return e(n||p())}}function v(e){return function(n,t){return e(t||p(),n)}}var h=w((function(e){return/(mobile)/i.test(e)||C(e)})),g=w((function(e){return/(mobile)/i.test(e)&&!b(e)})),m=w((function(e){return/(iphone)/i.test(e)})),b=w((function(e){return/(ipad)/i.test(e)})),k=w((function(e){return/(mobile)/i.test(e)&&_(e)})),C=w((function(e){return!/(mobile)/i.test(e)&&_(e)})),y=w((function(e){return!h(e)})),W=w((function(e){return!h(e)&&/Mac OS X/i.test(e)})),S=w((function(e){return W(e)&&1<navigator.maxTouchPoints})),_=w((function(e){return/android|adr/i.test(e)})),A=w((function(e){return _(e)?d("Android",e):null})),T=v((function(e,n){return 0<=l(A(e)||"",n)})),x=w((function(e){return/(iphone|ipad|ipod)/i.test(e)})),I=w((function(e){return x(e)?d("OS",e):null})),P=v((function(e,n){return 0<=l(I(e)||"",n)})),D=w((function(e){return/(win64|wow64|win32|wow32|windows nt)/i.test(e)})),O=w((function(e){return/MSAppHost/i.test(e)})),M=w((function(e){return/linux/i.test(e)&&!_(e)})),E=w((function(e){return/linux-kylin/i.test(e)})),j=w((function(e){return/linux-uos/i.test(e)})),L=w((function(e){return!h(e)&&/QQBrowser/i.test(e)&&!/QBCore/i.test(e)})),N=w((function(e){return L(e)?d("QQBrowser",e):null})),B=v((function(e,n){return 0<=l(N(e)||"",n)})),F=w((function(e){return h(e)&&/MQQBrowser/i.test(e)&&!be(e)&&!K(e)&&!ee(e)&&!Se(e)&&!Ee(e)&&!Ce(e)&&!Le(e)})),U=w((function(e){return F(e)?d("MQQBrowser",e):null})),R=v((function(e,n){return 0<=l(U(e)||"",n)})),V=w((function(e){return(h(e)?F:L)(e)})),q=w((function(e){return/(Chrome|CriOS)\/\S+( Mobile\S*)? Safari\/\S+$/i.test(e)})),Q=w((function(e){return d("Chrome",e)})),J=v((function(e,n){return 0<=l(Q(e)||"",n)})),G=w((function(e){return/Version\/\S+( Mobile\S*)? Safari\/\S+$/i.test(e)})),X=w((function(e){return/MSIE/i.test(e)&&!/opera/i.test(e)||/Trident/i.test(e)})),$=w((function(e){return/Edge/i.test(e)})),H=w((function(e){return/Edg\//i.test(e)})),z=w((function(e){return/(Firefox|Focus|FxiOS)\//i.test(e)})),K=w((function(e){return/MicroMessenger/i.test(e)&&!ee(e)&&!ye(e)})),Y=w((function(e){return K(e)||ye(e)?d("MicroMessenger",e):null})),Z=v((function(e,n){return 0<=l(Y(e)||"",n)})),ee=w((function(e){return/(wxwork)/i.test(e)})),ne=w((function(e){return/(wxworkQt)/i.test(e)})),te=w((function(e){return/WeComCEF/i.test(e)&&ee(e)})),oe=w((function(e){return/(wxworklocal)/i.test(e)})),ie=w((function(e){return/WXDrive/i.test(e)})),re=w((function(e){return ie(e)?d("WXDrive",e):null})),ce=v((function(e,n){return 0<=l(re(e)||"",n)})),se=w((function(e){return ee(e)?d("wxwork",e):null})),ae=v((function(e,n){return 0<=l(se(e)||"",n)})),ue=w((function(e){return oe(e)?d("wxworklocal",e):null})),le=v((function(e,n){return 0<=l(ue(e)||"",n)})),de=w((function(e){return/QQ\//i.test(e)&&!Se(e)&&!We(e)&&!ve(e)})),fe=w((function(e){return/QQ\//i.test(e)&&/_GM/i.test(e)})),pe=w((function(e){return de(e)||We(e)?d("QQ",e):null})),we=v((function(e,n){return 0<=l(pe(e)||"",n)})),ve=w((function(e){return/TIM/i.test(e)})),he=w((function(e){return/QBCore/i.test(e)&&/TIM2.0/i.test(e)})),ge=w((function(e){return ve(e)?d("TIM",e):null})),me=v((function(e,n){return 0<=l(ge(e)||"",n)})),be=w((function(e){return ve(e)&&!We(e)||de(e)})),ke=w((function(e){return ve(e)||/QQ/i.test(e)})),Ce=w((function(e){return/miniprogram|miniapp(?!enable)/i.test(e)||"undefined"!=typeof __wxjs_environment&&"miniprogram"===__wxjs_environment})),ye=w((function(e){return/MicroMessenger/i.test(e)&&Ce(e)})),We=w((function(e){return/QQ\/|TIM/i.test(e)&&Ce(e)})),Se=w((function(e){return/TencentDocs/i.test(e)})),_e=w((function(e){return d("TencentDocs",e)})),Ae=v((function(e,n){return 0<=l(_e(e)||"",n)})),Te=w((function(e){return/TxDocsPC/i.test(e)})),xe=w((function(e){return Te(e)})),Ie=w((function(e){return d("TxDocsPC",e)})),Pe=v((function(e,n){return 0<=l(Ie(e)||"",n)})),De=w((function(e){return/TDAppDesktop/i.test(e)})),Oe=w((function(e){return d("TDAppDesktop",e)})),Me=v((function(e,n){return 0<=l(Oe(e)||"",n)})),Ee=w((function(e){return/weiyun/i.test(e)})),je=w((function(e){return/SE 2\.X MetaSr 1\.0/i.test(e)})),Le=w((function(e){return/tencent_wemeet/i.test(e)})),Ne=w((function(e){return Le(e)&&/meeting_wework/i.test(e)})),Be=w((function(e){return/TencentMeetingRooms/i.test(e)})),Fe=w((function(e){return G(e)?d("Version",e):null})),Ue=v((function(e,n){return 0<=l(Fe(e)||"",n)})),Re=w((function(e){return z(e)?d("(Firefox|Focus|FxiOS)",e):null})),Ve=v((function(e,n){return 0<=l(Re(e)||"",n)})),qe=(c()(Qe,[{key:"isMobile",get:function(){return h(this.userAgent)}},{key:"isMobilePhone",get:function(){return g(this.userAgent)}},{key:"isIPhone",get:function(){return m(this.userAgent)}},{key:"isIPad",get:function(){return b(this.userAgent)}},{key:"isAndroidPhone",get:function(){return k(this.userAgent)}},{key:"isAndroidPad",get:function(){return C(this.userAgent)}},{key:"isPC",get:function(){return y(this.userAgent)}},{key:"isMac",get:function(){return W(this.userAgent)}},{key:"isIPadEmulatedMac",get:function(){return S(this.userAgent)}},{key:"isAndroid",get:function(){return _(this.userAgent)}},{key:"isIOS",get:function(){return x(this.userAgent)}},{key:"isWindows",get:function(){return D(this.userAgent)}},{key:"isWindowsUWP",get:function(){return O(this.userAgent)}},{key:"isLinux",get:function(){return M(this.userAgent)}},{key:"isLinuxKylin",get:function(){return E(this.userAgent)}},{key:"isLinuxUOS",get:function(){return j(this.userAgent)}},{key:"isPCQQBrowser",get:function(){return L(this.userAgent)}},{key:"isMobileQQBrowser",get:function(){return F(this.userAgent)}},{key:"isQQBrowser",get:function(){return V(this.userAgent)}},{key:"isChrome",get:function(){return q(this.userAgent)}},{key:"isSafari",get:function(){return G(this.userAgent)}},{key:"isIE",get:function(){return X(this.userAgent)}},{key:"isOldEdge",get:function(){return $(this.userAgent)}},{key:"isChromiumEdge",get:function(){return H(this.userAgent)}},{key:"isFirefox",get:function(){return z(this.userAgent)}},{key:"isWeChat",get:function(){return K(this.userAgent)}},{key:"isWxWork",get:function(){return ee(this.userAgent)}},{key:"isWxWorkQt",get:function(){return ne(this.userAgent)}},{key:"isWxWorkCustom",get:function(){return te(this.userAgent)}},{key:"isWxWorkPrivate",get:function(){return oe(this.userAgent)}},{key:"isWxDrive",get:function(){return ie(this.userAgent)}},{key:"isQQ",get:function(){return de(this.userAgent)}},{key:"isQQForGooglePlay",get:function(){return fe(this.userAgent)}},{key:"isTim",get:function(){return ve(this.userAgent)}},{key:"isPCTim",get:function(){return he(this.userAgent)}},{key:"isTimOrQQ",get:function(){return be(this.userAgent)}},{key:"isTimOrQQFamily",get:function(){return ke(this.userAgent)}},{key:"isMiniProgram",get:function(){return Ce(this.userAgent)}},{key:"isWxMiniProgram",get:function(){return ye(this.userAgent)}},{key:"isQQMiniProgram",get:function(){return We(this.userAgent)}},{key:"isTencentDocsApp",get:function(){return Se(this.userAgent)}},{key:"isPCTencentDocsClient",get:function(){return Te(this.userAgent)}},{key:"isPCTencentDocsApp",get:function(){return xe(this.userAgent)}},{key:"isElectronTencentDocsClient",get:function(){return De(this.userAgent)}},{key:"isWeiYunApp",get:function(){return Ee(this.userAgent)}},{key:"isSouGou",get:function(){return je(this.userAgent)}},{key:"isTencentMeeting",get:function(){return Le(this.userAgent)}},{key:"isWxWorkTencentMeeting",get:function(){return Ne(this.userAgent)}},{key:"isTencentMeetingRooms",get:function(){return Be(this.userAgent)}}]),Qe);function Qe(){var e=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:p();i()(this,Qe),this.getAndroidVersion=function(){return A(e.userAgent)},this.isAndroidVersionAboveOrEqual=function(n){return T(n,e.userAgent)},this.getIOSVersion=function(){return I(e.userAgent)},this.isIOSVersionAboveOrEqual=function(n){return P(n,e.userAgent)},this.getPCQQBrowserVersion=function(){return N(e.userAgent)},this.isPCQQBrowserVersionAboveOrEqual=function(n){return B(n,e.userAgent)},this.getMobileQQBrowserVersion=function(){return U(e.userAgent)},this.isMobileQQBrowserVersionAboveOrEqual=function(n){return R(n,e.userAgent)},this.getChromeVersion=function(){return Q(e.userAgent)},this.isChromeVersionAboveOrEqual=function(n){return J(n,e.userAgent)},this.getWeChatVersion=function(){return Y(e.userAgent)},this.isWeChatVersionAboveOrEqual=function(n){return Z(n,e.userAgent)},this.getWxDriveVersion=function(){return re(e.userAgent)},this.isWxDriveVersionAboveOrEqual=function(n){return ce(n,e.userAgent)},this.getWxWorkVersion=function(){return se(e.userAgent)},this.isWxWorkVersionAboveOrEqual=function(n){return ae(n,e.userAgent)},this.getWxWorkPrivateVersion=function(){return ue(e.userAgent)},this.isWxWorkPrivateVersionAboveOrEqual=function(n){return le(n,e.userAgent)},this.getQQVersion=function(){return pe(e.userAgent)},this.isQQVersionAboveOrEqual=function(n){return we(n,e.userAgent)},this.getTimVersion=function(){return ge(e.userAgent)},this.isTimVersionAboveOrEqual=function(n){return me(n,e.userAgent)},this.getTencentDocsAppVersion=function(){return _e(e.userAgent)},this.isTencentDocsAppVersionAboveOrEqual=function(n){return Ae(n,e.userAgent)},this.getPCTencentDocsClientVersion=function(){return Ie(e.userAgent)},this.isPCTencentDocsClientVersionAboveOrEqual=function(n){return Pe(n,e.userAgent)},this.getElectronTencentDocsClientVersion=function(){return Oe(e.userAgent)},this.isElectronTencentDocsClientVersionAboveOrEqual=function(n){return Me(n,e.userAgent)},this.getSafariVersion=function(){return Fe(e.userAgent)},this.isSafariVersionAboveOrEqual=function(n){return Ue(n,e.userAgent)},this.getFirefoxVersion=function(){return Re(e.userAgent)},this.isFirefoxVersionAboveOrEqual=function(n){return Ve(n,e.userAgent)},Object.defineProperty(this,"userAgent",{value:n,writable:!1})}n.default=new qe}],Si={},$i.m=Wi,$i.c=Si,$i.d=function(e,n,t){$i.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},$i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},$i.t=function(e,n){if(1&n&&(e=$i(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if($i.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)$i.d(t,o,function(n){return e[n]}.bind(null,o));return t},$i.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return $i.d(n,"a",n),n},$i.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},$i.p="";var Hi,zi,Ki,Yi,Zi,er,nr,tr,or,ir,rr,cr,sr,ar,ur,lr,dr=$i($i.s=73).default;(lr=Hi=Hi||{}).IsQQ="IsQQ",lr.isQQMiniProgram="isQQMiniProgram",lr.isTencentDocsApp="isTencentDocsApp",lr.isElectronTencentDocsClient="isElectronTencentDocsClient",lr.isWXh5="isWXh5",lr.isWeWork="isWeWork",lr.isWeWorkApp="isWeWorkApp",lr.isTencentMeeting="isTencentMeeting",lr.UNKNOW="UNKNOW",(ur=zi=zi||{}).Android="android",ur.IOS="ios",ur.Windows="windows",ur.Mac="mac",ur.Linux="linux",(ar=Ki=Ki||{})[ar.Direct=0]="Direct",ar[ar.Detail=1]="Detail",ar[ar.Browser=2]="Browser",ar[ar.NativeControl=3]="NativeControl",(sr=Yi=Yi||{})[sr.show=0]="show",sr[sr.hide=1]="hide",sr[sr.disable=2]="disable",(cr=Zi=Zi||{}).image="image",cr.text="text",cr.collaborator="collaborator",cr.offline="offline",cr.separator="separator",cr.iconWithText="iconWithText",(rr=er=er||{})[rr.left=0]="left",rr[rr.right=1]="right",rr[rr.middle=2]="middle",(ir=nr=nr||{}).share="0",ir.more="1",ir.starOff="2",ir.starOn="3",ir.back="4",ir.undo="5",ir.redo="6",ir.expand="7",ir.edit="8",ir.play="9",ir.toolbarTick="10",ir.eye="11",ir.addCollaborator="12",ir.collaborator="13",ir.notification="14",ir.discussion="16",ir.filter="18",ir.wikicatalog="17",ir.myCollectedForms="19",ir.Unchecked="20",ir.Checked="21",ir.Smartsheet="22",ir.ArrowDown="23",ir.NormalSheet="24",ir.DashBoard="25",ir.SmartsheetDatasource="26",ir.External="27",(or=tr=tr||{})[or.Back=0]="Back",or[or.Eye=1]="Eye",or[or.Share=2]="Share",or[or.More=3]="More",or[or.Undo=4]="Undo",or[or.Redo=5]="Redo",or[or.AddCollaborator=6]="AddCollaborator",or[or.Collaborator=7]="Collaborator",or[or.Notification=8]="Notification",or[or.MyCollectedForms=9]="MyCollectedForms",or[or.Filter=10]="Filter",or[or.Discussion=11]="Discussion",or[or.WikiCatalog=12]="WikiCatalog",or[or.Unchecked=13]="Unchecked",or[or.Checked=14]="Checked",or[or.SmartSheet=16]="SmartSheet",or[or.ArrowDown=17]="ArrowDown",or[or.NormalSheet=18]="NormalSheet",or[or.DashBoard=19]="DashBoard",or[or.SmartsheetDatasource=20]="SmartsheetDatasource",or[or.External=21]="External",vr.getInstance=function(){return this.instance||(this.instance=new this)},vr.prototype.invokeNative=function(e,n){switch(void 0===n&&(n=vr.defaultInvokeParams),this.platform){case zi.Android:this.invokeAndroid(e,n);break;case zi.Mac:case zi.IOS:this.invokeMacOrIOS(e,n);break;case zi.Windows:this.invokeWindows(e,n);break;case zi.Linux:this.invokeLinux(e,n);break;default:console.error("未知的平台")}},vr.prototype.invokeAndroid=function(e,n){var t,o,i=JSON.stringify(n);mr?"function"==typeof(null==(t=window.JSCallJavaMgr)?void 0:t.postMessage)?window.JSCallJavaMgr.postMessage(i):console.warn("Not In WeMeet Controller App"):null!=(o=window.JSCallJavaMgr)&&o[e]?window.JSCallJavaMgr[e](i):console.warn("Not In ANDROID WeMeet App")},vr.prototype.invokeMacOrIOS=function(e,n){var t,o=null==(t=window.webkit)?void 0:t.messageHandlers,i=o&&o[e];null!=i&&i.postMessage?i.postMessage(JSON.stringify(n)):console.warn("Not In WeMeet App")},vr.prototype.invokeWindows=function(e,n){var t,o=null==(t=window.external)?void 0:t.nativeCall,i=n.module;o?o(e,[i,n.method,n.param,n.callback,n.callId],(function(){})):console.warn("Not In WeMeet App")},vr.prototype.invokeLinux=function(e,n){var t,o=null==(t=window.QtWeb)?void 0:t.JsCall,i=n.module;o?o(e,[i,n.method,n.param,n.callback,n.callId],(function(){})):console.warn("Not In WeMeet App")},vr.defaultInvokeParams={module:"",method:"",param:{},callback:"",callId:""};var fr,pr=vr,wr="undefined"==typeof window;function vr(){this.platform=Cr()}function hr(e){return t(this,void 0,void 0,(function(){var n;return o(this,(function(t){switch(t.label){case 0:if(fr)return[4,fr];throw new Error("请先加载sdk");case 1:return t.sent(),(n={})[Hi.isWeWork]=_r()?window.qmailBridge:Wr()?window.wwapp:{},n[Hi.IsQQ]=window.mqq,n[Hi.isQQMiniProgram]=window.mqq,n[Hi.isTencentDocsApp]=window.mqq,n[Hi.isElectronTencentDocsClient]=window.mqq,n[Hi.isWXh5]={},n[Hi.isWeWorkApp]=Ar()?window.TenOfficeJSBridge:Tr()?window.qmailBridge:window.WeixinJSBridge,n[Hi.isTencentMeeting]=pr.getInstance(),n[Hi.UNKNOW]={},[2,n[e]]}}))}))}var gr=Gi.getUserAgent().includes("app/tencent_wemeet"),mr=Gi.getUserAgent().includes("app/tencent_wemeet_controller"),br=["log","iosLog","clientDatabaseRequest"];function kr(){var e=Hi.UNKNOW;return gr?e=Hi.isTencentMeeting:Gi.isQQ()||Gi.isQQMiniProgram()||Gi.isTencentDocsApp()?e=Hi.isTencentDocsApp:dr.isElectronTencentDocsClient?e=Hi.isElectronTencentDocsClient:Gi.isWXh5()?e=Hi.isWXh5:Gi.isWeWork()&&(e=Gi.isWeWorkMacOrWin()||Ir()&&Gi.isWeWorkLinux()?Hi.isWeWork:Hi.isWeWorkApp),e}function Cr(){return Gi.isAndroid()?zi.Android:Gi.isIOS()?zi.IOS:Gi.isWindows()?zi.Windows:Gi.isMac()?zi.Mac:Gi.isLinux()?zi.Linux:void 0}function yr(){var e=Gi.getLowerCaseUserAgent().match(/wxwork\/([0-9.]*)/);return e?e[1]:""}function Wr(){var e;return Ir()?0<=Gi.compareVersion(Pr(),"2.6.15"):Gi.isMobile()?Ar():!(_r()||(e=0<=Gi.compareVersion(yr(),"3.1.18"))&&Ai()===Ti&&Gi.isMac()&&!/WeComCEF/i.test(Gi.getUserAgent()))&&e}function Sr(){return/embeddisk/.test(Gi.getLowerCaseUserAgent())||Gi.isMac()&&0<=Gi.compareVersion(yr(),"4.1.0")}function _r(){return!Ir()&&/WXDrive/i.test(Gi.getLowerCaseUserAgent())}function Ar(){var e,n;return/wdocs/i.test(Gi.getLowerCaseUserAgent())||Gi.isIOS()&&!(null==(n=null==(e=window.webkit)?void 0:e.messageHandlers)||!n.TenOfficeJSBridge)||Gi.isAndroid()&&!!window.TenOfficeJSBridgeAndroid}function Tr(){return!Gi.isServerSide()&&!window.WeixinJSBridge}function xr(){return!(Ar()||Gi.isServerSide()||0!==location.pathname.indexOf("/forms/")&&0!==location.pathname.indexOf("/journal/"))}function Ir(){return/wxworklocal/i.test(Gi.getLowerCaseUserAgent())}function Pr(){var e=Gi.getLowerCaseUserAgent().match(/wxworklocal\/([0-9.]*)/);return e?e[1]:""}function Dr(e,n){var i={};return Object.keys(e).forEach((function(c){var s=e[c];i[c]=function(e,n,i,c){var s=this;return function(a){return void 0===a&&(a={}),t(s,void 0,Promise,(function(){var s,u=this;return o(this,(function(l){switch(l.label){case 0:return[4,hr(e)];case 1:if(s=l.sent())return[2,new Promise((function(e,l){return t(u,void 0,void 0,(function(){var t,u,d,f,p,w;return o(this,(function(o){a=a||{},t=Gr(i),u=t.reportSuccess,d=t.reportFail,f=null==a?void 0:a.success,a.success=function(n){null!=f&&f(n),e(n),u(),console.warn("tdocs call "+i+" success!, res => ",n)},p=null==a?void 0:a.fail,a.fail=function(e){var n;null!=p&&p(e),l(e),br.includes(i)||null==(n=null==c?void 0:c.log)||n.call(c,{level:"error",message:"tdocs call "+i+" failed! res => "+JSON.stringify(e)}),d({req:a,res:e}),console.error("tdocs call "+i+" fail!, res => "+JSON.stringify(e))};try{!(v=w=n(s,a))||"object"!==r(v)&&"function"!=typeof v||"function"!=typeof v.then||w.then(a.success).catch(a.fail)}catch(o){a.fail(o)}var v;return[2]}))}))}))];throw new Error("当前环境无jssdk，"+e)}}))}))}}(n,s,c,i)})),i}function Or(n){var t,o=n.buttons,i=((t={})[nr.back]=tr.Back,t[nr.eye]=tr.Eye,t[nr.addCollaborator]=tr.AddCollaborator,t[nr.collaborator]=tr.Collaborator,t[nr.share]=tr.Share,t[nr.more]=tr.More,t[nr.undo]=tr.Undo,t[nr.redo]=tr.Redo,t),r=(0<=Gi.compareVersion(yr(),"4.0.6")&&(i[nr.notification]=tr.Notification),0<=Gi.compareVersion(yr(),"4.0.20")&&(i[nr.discussion]=tr.Discussion),0<=Gi.compareVersion(yr(),"4.1.8")&&(i[nr.myCollectedForms]=tr.MyCollectedForms,i[nr.filter]=tr.Filter,i[nr.wikicatalog]=tr.WikiCatalog),0<=Gi.compareVersion(yr(),"4.1.20")&&(i[nr.Unchecked]=tr.Unchecked,i[nr.Checked]=tr.Checked),0<=Gi.compareVersion(yr(),"4.1.26")&&(i[nr.Smartsheet]=tr.SmartSheet,i[nr.ArrowDown]=tr.ArrowDown,i[nr.NormalSheet]=tr.NormalSheet,i[nr.DashBoard]=tr.DashBoard),0<=Gi.compareVersion(yr(),"4.1.28")&&(i[nr.SmartsheetDatasource]=tr.SmartsheetDatasource,i[nr.External]=tr.External),{0:er.left,1:er.middle,2:er.right}),c=[];return o.forEach((function(e){var n,t,o,s,a;e.type===Zi.collaborator?(s={id:e.id,type:Zi.image,icon:nr.collaborator===e.url?i[nr.collaborator]:tr.Eye,position:r[e.position],state:e.state,onclick:e.onclick,canClickWhenDisabled:!!e.canClickWhenDisabled,useAnimation:e.useAnimation,rightIcon:e.rightIcon?i[e.rightIcon]:void 0,badge:""},null!=(n=e.collaborators)&&n.length&&1<(null==(t=e.collaborators)?void 0:t.length)&&(s.badge=String(e.collaborators.length)),e.badge&&(s.badge=e.badge),c.push(s)):e.type===Zi.image||e.type===Zi.iconWithText?void 0!==(a=i[e.url])&&c.push({id:e.id,type:e.type,icon:a,position:r[e.position],state:e.state,onclick:e.onclick,canClickWhenDisabled:!!e.canClickWhenDisabled,badge:e.badge,badgeStyle:e.badgeStyle,text:e.text,useAnimation:e.useAnimation,rightIcon:e.rightIcon?i[e.rightIcon]:void 0}):c.push({id:e.id,type:e.type,text:null==(o=e)?void 0:o.text,position:r[e.position],state:e.state,onclick:e.onclick,canClickWhenDisabled:!!e.canClickWhenDisabled,badge:e.badge,badgeStyle:e.badgeStyle,useAnimation:e.useAnimation})})),e(e({},n),{buttons:c})}function Mr(e,n){var t=Gr("consume_cst"),o=t.reportSuccess,i=t.reportFail,r=Object.keys(e).map((function(n){return"wwapp_"+n+"="+encodeURIComponent(e[n])})).join("&");fetch("/cgi/gateway/consume_cst?from_tdocs_jsapi=1&"+r).then((function(e){return e.json()})).then((function(e){var t,i;0===(null==e?void 0:e.retcode)?null!=(t=null==n?void 0:n.success)&&t.call(n,e):null!=(i=null==n?void 0:n.fail)&&i.call(n,e),o()})).catch((function(e){var t;null!=(t=null==n?void 0:n.fail)&&t.call(n,e),i(null==e?void 0:e.message)}))}function Er(e){void 0===e&&(e=location.href);var n,t,o,i,r,c,s=new URL(e);return s.searchParams.get("docid")||s.searchParams.get("form_id")||s.searchParams.get("formId")||(s.pathname.startsWith("/smartsheet/form/")&&null!=(t=null==(n=window)?void 0:n.clientVars)&&t.globalPadId?null==(i=null==(o=window)?void 0:o.clientVars)?void 0:i.globalPadId:"0"===(c=(null==(r=/^\/(doc|sheet|forms|slide|flowchart|mind|blankpage|smartsheet|form\/page)\/(j\/)?(.+)\/?/.exec(s.pathname))?void 0:r[3])||"")?"":c)}function jr(){return/^\/(doc|sheet|forms|slide|flowchart|mind|mall|blankpage|smartsheet|scenario|form\/page|journal|home)\/(.+)\/?/.exec(location.pathname)}function Lr(e){console.warn("------设置新的cookie-------",e),document.cookie=encodeURIComponent(e.key)+"="+encodeURIComponent(e.value)+(e.expires?"; expires="+e.expires:"")+(e.domain?"; domain="+e.domain:"")+"; path="+(e.path||"/")+(e.secure?"; secure":"")}function Nr(n){Lr(e(e({},n),{value:"",expires:"Thu, 01 Jan 1970 00:00:00 GMT"}))}function Br(e){var n=new RegExp("(?:^|;+|\\s+)"+e+"=([^;]*)"),t=null;return(t=window.document?window.document.cookie.match(n):t)?decodeURIComponent(t[1]):""}function Fr(e){return e=""+e,"[TDOCS]["+(new Date).toLocaleString()+"]["+(Er()||location.pathname)+"]["+(window.__globalReleaseVersion||"")+"] "+e.replace(/(http:\/\/|https:\/\/)?(doc.weixin.qq.com|docs.qq.com)/gi,"TDOC_HOSTNAME")}function Ur(){return window.WeixinJSBridge?Promise.resolve(window.WeixinJSBridge):new Promise((function(e){document.addEventListener("WeixinJSBridgeReady",(function(){e(window.WeixinJSBridge)}))}))}function Rr(e){var n,t,o,i;try{e.category="tdocsJSAPI",null!=(i=null==(t=null==(n=window.TencentDocReport)?void 0:n.tencentDocReportSDK)?void 0:(o=t.cube).tdw)&&i.call(o,e)}catch(e){}}function Vr(e,n){void 0===n&&(n=location.href);try{return new URL(n).searchParams.get(e)}catch(e){return null}}function qr(e){var n,t;try{null!=(t=null==(n=window.tencentDocReport)?void 0:n.retcodeEnt)&&t.call(n,e)}catch(e){}}function Qr(e){var n=null;return function(t){return n=n||e(t).then((function(e){return n=null,e})).catch((function(e){throw n=null,e}))}}function Jr(){var e,n;return!(null==(n=null==(e=null==navigator?void 0:navigator.userAgent)?void 0:e.includes)||!n.call(e,"wxworkQt"))}function Gr(e,n){function t(n,t){var o=void 0;try{o=t&&JSON.stringify(t)}catch(n){console.error(n)}Gi.isEnterpriseEnv()&&Rr({module:"tdocs_jsapi",opername:"tdocs_jsapi_sdk",action:n?"invoke_func_success":"invoke_func_fail",ver7:yr(),ver8:e,ver9:Er()||location.pathname,ver10:kr(),ver11:Date.now()-i,ver12:xr()?1:2,obj3:o})}function o(){r&&clearTimeout(r)}void 0===n&&(n=3e3);var i=Date.now(),r=setTimeout((function(){Gi.isEnterpriseEnv()&&(Rr({module:"tdocs_jsapi",opername:"tdocs_jsapi_sdk",action:"invoke_func_timeout",ver7:yr(),ver8:e,ver9:Er()||location.pathname,ver10:kr(),ver11:n}),r=0)}),n);return{reportSuccess:function(){t(!0),o()},reportFail:function(e){t(!1,e),o()}}}var Xr="undefined"==typeof window?{log:null}:window,$r=(Hr.debug=function(){for(var e,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];try{Xr.log?(e=Xr.log).debug.apply(e,n):console.debug.apply(console,n)}catch(e){Hr.error("日志发生错误","debug",n)}},Hr.log=function(){for(var e,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];try{Xr.log?(e=Xr.log).info.apply(e,n):console.log.apply(console,n)}catch(e){Hr.error("日志发生错误","log",n)}},Hr.warn=function(){for(var e,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];try{Xr.log?(e=Xr.log).warn.apply(e,n):console.warn.apply(console,n)}catch(e){Hr.error("日志发生错误","warn",n)}},Hr.error=function(){for(var e,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];try{Xr.log?(e=Xr.log).error.apply(e,n):console.error.apply(console,n)}catch(e){console.error("日志发生错误","error",n)}},Hr.time=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];var o={time:Date.now(),options:n};this.sTimeLableMap.set(e,o)},Hr.timeEnd=function(e){var n,t,o=Date.now(),r=Hr.sTimeLableMap.get(e);void 0!==r&&(n=o-r.time,t="",r.options&&3===r.options.length&&"clientDatabaseRequest"===r.options[1]&&(t=r.options[2]),Hr.log.apply(Hr,i(["label: "+e+": "+n+"ms."],r.options||[])),Hr.speedReport(n,t),this.sTimeLableMap.delete(e))},Hr.speedReport=function(e,n){n&&Xr.dbjsApiSpeedReport&&Xr.dbjsApiSpeedReport(e,n)},Hr.sTimeLableMap=new Map,Hr);function Hr(){}function zr(e,t,o,i){var r=o.success,c=o.fail,s=n(o,["success","fail"]);console.log(e,"params",s),t.invoke({func:e,params:s,namespace:i}).then((function(n){console.log(e,"原始res",n),0===(n=n||{code:-1,data:null,msg:"res is empty"}).code?null!=r&&r(n.data):2===n.code?null!=r&&r(null):(console.log(e,"返回code不为0",n.msg,n.code),null!=c&&c(n.msg,n.code))})).catch((function(e){console.log("调用失败"),null!=c&&c(e)}))}function Kr(e,n,t,o){var i=Zr(t);return console.log(e,"params",i),new Promise((function(t,r){n.invoke({func:e,params:i,namespace:o}).then((function(n){0===(n=void 0===n?{code:-1,data:null,msg:"res is empty"}:n).code?t(n.data):($r.log(e,"返回code不为0",n.msg),r(n))})).catch((function(e){$r.log("调用失败",e),r(e)}))}))}function Yr(e,n){return new Promise((function(t){var o;null!=(o=window.WeixinJSBridge)&&o.invoke(e,Zr(n),t)}))}function Zr(e){var t=e||{};return t.success,n(t,["success","fail"])}function ec(e,t,o){void 0===o&&(o=!1),Ur().then((function(i){var r=t.success,c=t.fail,s=n(t,["success","fail"]);console.log("[tdocs] invokeWeixinJSBridge func:"+e+" params:",s),null!=i&&i.invoke(e,s,(function(n){console.log("[tdocs] invokeWeixinJSBridge func:"+e+" resp:",n);try{if(o&&"{}"===JSON.stringify(n))return void(null!=r&&r(n))}catch(n){}n.err_msg.includes("cancel")?null!=r&&r(null):n.err_msg.includes("ok")?null!=r&&r(n):null!=c&&c(n)}))}))}function nc(n){return e(e({},n),{success:function(e){var t,o,i;"params"in e?null!=(t=n.success)&&t.call(n,(null==(o=e.params)?void 0:o.data)||{}):null!=(i=n.success)&&i.call(n,e)}})}function tc(n){return e(e({},n),{success:function(e){var t,o;"data"in e?null!=(t=n.success)&&t.call(n,(null==e?void 0:e.data)||{}):null!=(o=n.success)&&o.call(n,e)}})}function oc(t,o){var i=o.success,r=o.fail,c=n(o,["success","fail"]);return xr()?new Promise((function(n,t){ec("wwapp.doc.collectionTable.readSystemClipboard",e(e({},o),{success:function(e){var t,o,i,r;n({html:(null==(o=null==(t=null==e?void 0:e.params)?void 0:t.data)?void 0:o.html)||"",plain:(null==(r=null==(i=null==e?void 0:e.params)?void 0:i.data)?void 0:r.plain)||""})},fail:function(e){t(e)}}))})):Ar()?t.invoke({func:"readSystemClipboard",params:c}).then((function(e){0===e.code?(i||Promise.resolve)(e.data):(r||Promise.reject)(e.msg)})):void t.readFromPasteBoard().then((function(e){var n;null!=(n=o.success)&&n.call(o,{html:(null==e?void 0:e.html)||"",plain:(null==e?void 0:e.value)||""})})).catch(o.fail)}function ic(e,t){var o,i,r;if(Ar())return o=t.success,i=t.fail,r=n(t,["success","fail"]),e.invoke({func:"writeSystemClipboard",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}));e.writeToPasteBoard({html:t.html||"",value:t.plain||""}).then(t.success).catch(t.fail)}function rc(e,n){zr("isWeDriveEnabled",e,n)}function cc(e,n){zr("chooseWeDriveFile",e,n)}function sc(e,n){xr()?ec("wwapp.doc.collectionTable.chooseWeDriveFile",nc(n)):zr("multiChooseWeDriveFile",e,n)}function ac(e,n){xr()?ec("wwapp.doc.collectionTable.chooseTencentOfficeFile",nc(n)):zr("chooseTencentOfficeFile",e,n)}function uc(e,t){var o,i,r;return console.log(e,t),Ar()?(o=t.success,i=t.fail,r=n(t,["success","fail"]),e.invoke({func:"discuss",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))):e.discuss(Zr(t))}function lc(e,n){if(!Ar())return e.forwardToConversion(Zr(n));zr("shareDoc",e,n)}function dc(e,n){return Kr("fileDownload",e,n)}function fc(e,n){console.log("开始调用企业微信接口111"),void 0===n.docid&&(n.docid=Er()||void 0),zr("openCamera",e,n)}function pc(e,n){var t;null!=(t=null==n?void 0:n.success)&&t.call(n,yr())}function wc(e,n){var t;null!=(t=null==n?void 0:n.success)&&t.call(n,Gi.compareVersion(yr(),(null==n?void 0:n.version)||""))}function vc(e,n){var t;null!=(t=null==n?void 0:n.success)&&t.call(n,Wr())}function hc(e,i){return t(void 0,void 0,Promise,(function(){var t,r,c;return o(this,(function(o){return console.log(e,i),Ar()?(t=i.success,r=i.fail,c=n(i,["success","fail"]),[2,e.invoke({func:"onUnload",params:c}).then((function(e){0===e.code?(t||Promise.resolve)(e.data):(r||Promise.reject)(e.msg)}))]):[2,e.onUnload(Zr(i))]}))}))}function gc(e,n){return t(void 0,void 0,Promise,(function(){return o(this,(function(t){switch(t.label){case 0:return console.log("addEventListener 开始监听"),[4,hr(Hi.isWeWorkApp)];case 1:return t.sent().addEventListener(e,n),[2]}}))}))}function mc(e,n){return t(void 0,void 0,Promise,(function(){var t;return o(this,(function(o){switch(o.label){case 0:return[4,hr(Hi.isWeWorkApp)];case 1:return t=o.sent(),console.log("removeEventListener",e),t.removeEventListener(e,n),[2]}}))}))}function bc(e,n){return void 0!==e?e:n&&Br("wedoc_openid")&&jr()&&(Gi.isMobile()||Gi.isMac()?0<=Gi.compareVersion(yr(),"4.0.10"):0<=Gi.compareVersion(yr(),"4.0.6"))?1:void 0}function kc(e,n){var t=Gr(e.openid?"disklogin_openid":"disklogin"),o=t.reportSuccess,i=t.reportFail,r="/disklogin/login?from_tdocs_jsapi=1&product=2&from=2&f=json&"+Object.keys(e).map((function(n){return"wwapp_"+n+"="+encodeURIComponent(e[n])})).join("&");fetch(r).then((function(e){return e.json()})).then((function(e){var t,c,s,a;0===(null==(t=null==e?void 0:e.head)?void 0:t.ret)?(null!=(c=null==n?void 0:n.success)&&c.call(n,e),o()):(null!=(s=null==n?void 0:n.fail)&&s.call(n,e),i(e),qr({url:r,code:(null==(a=null==e?void 0:e.head)?void 0:a.ret)||-1,scene:"backendError"}))})).catch((function(e){var t;null!=(t=null==n?void 0:n.fail)&&t.call(n,e),i(null==e?void 0:e.message)}))}function Cc(e){return!!e&&!!(""+e).match(/^\d+$/)}function yc(e){return!!e&&!(""+e).match(/^\d+$/)&&!(""+e).match(/@/)}function Wc(e){return""+e=="4294967304"}function Sc(n,i){return t(void 0,void 0,void 0,(function(){var t,r,c,s,a,u,l,d;return o(this,(function(o){switch(o.label){case 0:return t=bc(i.useOpenid,i.canUseOpenid||!(null==(u=i.selectedUserOpenIds)||!u.length)||!(null==(l=i.selectedOpenIds)||!l.length)),Ar()?[3,2]:Tr()?[2,n.selectPerson(Zr(i))]:(r=i.selectedVid||i.selectedUserIds,c=i.selectedOpenIds||i.selectedUserOpenIds,[4,Yr("wwapp.selectContacts",e(e({docid:Er(),docId:Er()},i),{useOpenid:t,selectedVid:t?void 0:r&&r.filter(Cc),selectedOpenIds:t?c||r&&r.filter(yc):void 0}))]);case 1:return s=o.sent(),null!=(d=null==s?void 0:s.selectedContacts)&&d.length?t?[2,e(e({},s),{successOrNot:!0,notifySelected:s.checkNotice,persons:s.selectedContacts.map((function(n){return e(e({},n),{vid:n.openid,name:n.at_name||n.name})}))})]:[2,e(e({},s),{successOrNot:!0,notifySelected:s.checkNotice,persons:s.selectedContacts.map((function(n){return e(e({},n),{name:n.at_name||n.name})}))})]:[2,Promise.reject(s)];case 2:return t?[4,Kr("selectPerson",n,e(e({docid:Er()},i),{useOpenid:t,selectedUserOpenIds:i.selectedUserOpenIds||i.selectedUserIds&&i.selectedUserIds.filter(yc),selectedUserIds:void 0}))]:[2,Kr("selectPerson",n,e(e({},i),{selectedUserIds:i.selectedUserIds&&i.selectedUserIds.filter(Cc)}))];case 3:return a=o.sent(),[2,e(e({},a),{persons:a.persons&&a.persons.map((function(n){return e(e({},n),{vid:n.openid})}))})]}}))}))}function _c(n,i){return t(void 0,void 0,void 0,(function(){var t;return o(this,(function(o){return t=i.openid||i.useOpenid||!Cc(i.vid)?1:void 0,void 0===i.docid&&(i.docid=Er()),/_st$/.test(i.docid)||Wc(i.openid||i.vid)||t&&Gi.compareVersion(yr(),"4.0.10")<0?[2,Promise.resolve({})]:t&&!yc(i.openid||i.vid)?[2,Promise.reject({err_msg:(i.openid||i.vid)+" is not openid"})]:Ar()?t?[2,Kr("viewProfile",n,e(e({},i),{useOpenid:t,openid:i.openid||i.vid,vid:void 0}))]:[2,Kr("viewProfile",n,i)]:Tr()?[2,n.viewProfile(Zr(i))]:t?[2,Yr("wwapp.openContactProfile",e(e({},i),{useOpenid:t,openid:i.openid||i.vid,vid:void 0}))]:[2,Yr("wwapp.openContactProfile",e(e({},i),{vid:Gi.isIOS()?Number(i.vid):i.vid}))]}))}))}function Ac(e,t){var o,i,r;return Ar()?(o=t.success,i=t.fail,r=n(t,["success","fail"]),e.invoke({func:"updateAuthority",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))):e.updateAuthority(Zr(t))}function Tc(n,t){var o,i,r=bc(t.useOpenid,!(null==(o=t.online_users_detail)||!o.find((function(e){return yc(e.openid)}))));zr("showCollaboratorPanel",n,e(e({docid:Er()},t),{useOpenid:r,online_users_detail:null==(i=t.online_users_detail)?void 0:i.filter((function(e){return r?yc(e.openid):Cc(e.uin)}))}))}function xc(n,t){var o,i,r=bc(t.useOpenid,!(null==(o=t.online_users_detail)||!o.find((function(e){return yc(e.openid)}))));zr("updateOnlineUserList",n,e(e({docid:Er()},t),{useOpenid:r,online_users_detail:null==(i=t.online_users_detail)?void 0:i.filter((function(e){return r?yc(e.openid):Cc(e.uin)}))}))}function Ic(e,n){zr("updateAuth",e,n)}function Pc(e,n){console.log("开始调用 initToolbarConfig"),zr("initToolbarConfig",e,n)}function Dc(e,n){console.log("开始调用 setToolbarConfig"),zr("updateToolbarConfig",e,n)}function Oc(e,n){console.log("开始调用 showNativeToolbar"),zr("setNativeToolbarShow",e,n)}function Mc(e,n){console.log("开始调用 updatePanelConfig"),zr("updateStylePanelConfig",e,n)}function Ec(e,n){console.log("开始调用 showNativePanel"),zr("setNativePanelShow",e,n)}function jc(e){var n,t,o=e.buttons,i=e.ext;Gi.compareVersion(yr(),"4.0.8")<0&&o?(n=o,t=i,console.log("[timeline]: handlePolyfillTitleBar",n,t),n.forEach((function(e){var n,o,i;2!==e.icon?3===e.icon&&(n=(t||{}).moreMenuClick,o={enable:0===e.state},n&&(o.onClick=n),ec("wwapp.doc.collectionTable.enableMenu",o)):(i=null==t?void 0:t.forwardData)&&ec("wwapp.doc.collectionTable.enableTopBarShareIcon",{enable:0===e.state,form_card_msg:i})}))):ec("wwapp.doc.collectionTable.updateTitlebarIcons",e)}function Lc(e,n){var t,o,i,r;console.info("----setActionButtons1-------"),Jc?Jc.then((function(){Lc(e,n)})).catch((function(){Lc(e,n)})):is||null!=(t=window.magicBox)&&t.start?(o=Or(n),o=ss(e,o,!1),console.info("----setActionButtons2-------"),console.info(o),console.info(JSON.stringify(o)),xr()?ec("wwapp.doc.collectionTable.setTitlebarIcons",o):(ts(),es(e,o),zr("setTitlebarIcons",e,o))):(i=e,r=n,xr()?(is={custom:!1,text:""},Lc(i,r)):os(i,{success:function(e){is=e||(console.error("getCustomTopbarButtonConfigAndSetButtons",e),{custom:!1,text:""}),Lc(i,r)},fail:function(e){console.error("getCustomTopbarButtonConfigAndSetButtons",e),is={custom:!1,text:""},Lc(i,r)}}))}function Nc(e,n){xr()?ec("wwapp.doc.collectionTable.setTitlebarIcons",n):(ts(),es(e,n),zr("setTitlebarIcons",e,n))}function Bc(n,t){var o;xr()?(o=t,ec(Gi.isAndroid()?"wwapp.doc.collectionTable.updateNavigationBarShadow":"wwapp.updateNavigationBarShadow",{action:o.showMask?"showShadow":"hideShadow",success:function(e){console.log("[tdocsJsapi]formsShowTitlebarMask res:",e),o.onClickMask&&"function"==typeof o.onClickMask&&o.onClickMask()}},!0)):(n.removeEventListener("onUserClickedTitlebarMask"),t.onClickMask&&n.addEventListener("onUserClickedTitlebarMask",t.onClickMask),zr("showTitlebarMask",n,e(e({},t),{onClickMask:void 0})))}function Fc(e,n){console.info("-----showMenuActions------"),console.info(n),ns(e,n),zr("showMenuActions",e,n)}function Uc(e,n){var t,o;console.info("-----showBottomActionSheet------"),console.info(n),t=e,o=n,console.error(JSON.stringify(o.actions)),o.actions&&0!==o.actions.length&&(0===Object.keys(Hc).length&&t.addEventListener("onBottomActionSheetClick",(function(e){var n;console.error("点击回调",e),console.error(Hc),null!=(n=Hc[e.id])&&n.call(Hc,e)})),o.actions.forEach((function(e){e.onclick&&(Hc[e.id]=e.onclick)}))),zr("showBottomActionSheet",e,n)}function Rc(e,n){var t;Jc?Jc.then((function(){Rc(e,n)})).catch((function(){Rc(e,n)})):(t=Or(n),t=ss(e,t,!0),console.info("-----updateActionButtons log------"),console.info(t),console.info(JSON.stringify(t)),xr()?jc(t):(es(e,t),zr("updateTitlebarIcons",e,t)))}function Vc(e,n){xr()?jc(n):(es(e,n),zr("updateTitlebarIcons",e,n))}function qc(e,n){if(!Ar())return e.setTitle(Zr(n));zr("setWebviewNaviTitle",e,n)}function Qc(e,n){console.error("showOnlineUserList, options-------------",n),zr("showOnlineUserList",e,n)}var Jc=null,Gc={},Xc=null,$c={},Hc={},zc=null,Kc=!1,Yc={},Zc=!1;function es(e,n){var t;console.error("--addEventListenerByActionButtonConfig---"),n.buttons.forEach((function(e){e.onclick&&(Gc[e.id]=e.onclick)})),t=e,Xc||(Xc=function(e){var n;console.error("点击回调",e),null!=(n=Gc[e.id])&&n.call(Gc,e)},console.error(Xc),console.error("init titlebarIconClick"),t.addEventListener("titlebarIconClick",Xc))}function ns(e,n){var t;console.error(JSON.stringify(n.actions)),0===Object.keys($c).length&&(t=e,Zc||(t.addEventListener("onMenuActionClick",(function(e){var n;console.error("点击回调",e),console.error($c),null!=(n=$c[e.name])&&n.call($c,e)})),t.addEventListener("menuSwitchResult",(function(e){var n;console.error("点击回调",e),console.error($c),null!=(n=$c[e.name])&&n.call($c,e)})),Zc=!0)),n.actions.forEach((function(e){e.forEach((function(e){(e.onclick||e.onswitch)&&(e.onclick&&($c[e.name]=e.onclick),e.onswitch)&&($c[e.name]=e.onswitch)}))}))}function ts(){Gc={}}function os(n,t){console.info("--------------getCustomTopbarButton");var o=!1,i=new Promise((function(i,r){zr("getCustomTopbarButton",n,e(e({},t),{success:function(e){var n;o||(is=e,o=!(Jc=null),null!=(n=null==t?void 0:t.success)&&n.call(t,e),i(),console.log("getCustomTopbarButtonConfig",e))},fail:function(e){var n;o||(is={custom:!1,text:""},o=!(Jc=null),null!=(n=null==t?void 0:t.fail)&&n.call(t,e),r(),console.error("getCustomTopbarButtonConfig fail"))}})),setTimeout((function(){var e;o||(is={custom:!1,text:""},o=!(Jc=null),null!=(e=null==t?void 0:t.fail)&&e.call(t,{}),r(),console.error("getCustomTopbarButtonConfig timeout"))}),3e3)}));is||(Jc=i)}var is=null,rs=function(e,n){zr("onCustomTopbarButtonClick",e,n)},cs=[];function ss(n,t,o){if(null==is||!is.custom)return t;o?t.buttons.forEach((function(n){var t=cs.findIndex((function(e){return e.id===n.id}));-1!==t?cs[t]=e(e({},cs[t]),n):cs.push(n)})):cs=i([],t.buttons);var r=i([],cs),c=cs.find((function(e){return e.icon===tr.More&&2===e.position&&e.state===Yi.show}));return(r=c?r.map((function(n){return 2===n.position?e(e({},n),{state:Yi.hide}):n})):r).push({id:"__send__",type:Zi.text,text:is.text||"发送",position:2,state:c?Yi.show:Yi.hide,onclick:function(){return rs(n,{})}}),e(e({},t),{buttons:r})}function as(){var e;Gc={},$c={},Hc={},Yc={},(Xc=null)!=(e=null==window?void 0:window.TenOfficeJSBridge)&&e.__callbackMap.clear(),zc=null}function us(e){var n=e.url,t=e.target;ec("wwapp.doc.collectionTable.openUrl",{url:n,target:void 0===t?Ki.NativeControl:t})}function ls(e,n){var t,o,i,r;xr()?(((e,n)=>{var t=n.url,o=n.target;if(Gi.compareVersion(yr(),"4.1.0")<0)try{return o!==Ki.Direct?ls(e,n):o===Ki.Direct||Gi.isIOS()?window.location.href=t:window.open(t)}catch(e){return console.log("formsWebviewOpenUrl error",e),window.location.href=t}Bi.test(n.url)?us({url:t,target:Ki.NativeControl}):us(n)})(e,n),null!=(t=null==n?void 0:n.success)&&t.call(n)):(i=(Ir()?Fi:Bi).test(n.url),r=Ui.test(n.url),null!=n&&n.url&&(i||r)&&(n.target=3),Ar()?zr("openDocLink",e,n):Tr()?e.openDocLink(Zr(n)).then(n.success).catch(n.fail):null!=(o=window.WeixinJSBridge)&&o.invoke("wwapp.openUrl",Zr(n),n.success))}function ds(e,n){xr()?ec("wwapp.closeCurrentWebview",n):zr("popBack",e,n)}function fs(e,n){xr()?ec("wwapp.doc.collectionTable.closeWebView",n):zr("closeFormAndTemplate",e,n)}function ps(e,n){var t;console.log(e),Ar()?zr("previewImage",e,n):Tr()?e.previewImage(Zr(n)).then(n.success).catch(n.fail):null!=(t=window.WeixinJSBridge)&&t.invoke("wwapp.previewImages",{imageUrls:n.images,curIndex:n.currentIndex,editable:!1},n.success)}function ws(e,n){console.log("开始调用callWxWorkAppApi"),zr("savePublicImg",e,n)}function vs(e,n){if(console.log("开始调用chooseimage"),!Ar())return e.chooseImage(Zr(n));void 0===n.docid&&(n.docid=Er()||void 0),zr("multipleImagePicker",e,n)}function hs(e,n){var t;Ar()?zr("previewFiles",e,n):null!=(t=window.WeixinJSBridge)&&t.invoke("wwapp.doc.previewFiles",Zr(n),n.success)}function gs(e,n){var t;Ar()?zr("preloadData",e,n):null!=(t=window.WeixinJSBridge)&&t.invoke("wwapp.doc.preloadData",Zr(n),n.success)}function ms(e,t){var o,i,r;return Ar()?(o=t.success,i=t.fail,r=n(t,["success","fail"]),e.invoke({func:"showNativeToast",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))):e.showNativeToast(Zr(t))}function bs(e,t){var o,i,r;return Ar()?(o=t.success,i=t.fail,r=n(t,["success","fail"]),e.invoke({func:"notifyCommentActionToNative",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))):e.notifyCommentActionToNative(Zr(t))}function ks(e,n){Ar()?zr("notifyEmojiCommentToNative",e,n):e.notifyEmojiCommentToNative(Zr(n)).then(n.success).catch(n.fail)}function Cs(e,t){var o,i,r;return Ar()?(o=t.success,i=t.fail,r=n(t,["success","fail"]),e.invoke({func:"allCommentPanelCountUpdated",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))):e.allCommentPanelCountUpdated(Zr(t))}function ys(e,t){var o,i,r;return Ar()?(o=t.success,i=t.fail,r=n(t,["success","fail"]),e.invoke({func:"showNativeAllCommentPanel",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))):e.showNativeAllCommentPanel(Zr(t))}function Ws(e,t){var o,i,r;return Ar()?(o=t.success,i=t.fail,r=n(t,["success","fail"]),e.invoke({func:"launchCommentInput",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))):e.launchCommentInput(Zr(t))}function Ss(e,t){var o,i,r;return Ar()?(o=t.success,i=t.fail,r=n(t,["success","fail"]),e.invoke({func:"showEmojiActionPanel",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))):e.showEmojiActionPanel(Zr(t))}function _s(e,n){zr("showNativeSingleCommentPanel",e,n)}function As(e,n){zr("hideNativeSingleCommentPanel",e,n)}function Ts(e,n){zr("notifyDocChange",e,n)}function xs(e,n){zr("updateMessageQuoteStatus",e,n)}function Is(n,t){xr()?ec("wwapp.doc.collectionTable.clearUnread",e(e({},t),{docId:t.docid})):zr("clearDocUnread",n,t)}function Ps(n,t){var o,i,r;xr()?ec("wwapp.doc.collectionTable.showDiscussion",e(e({},t),{docId:t.docid})):(r=bc(t.useOpenid,!(null==(o=t.online_users_detail)||!o.find((function(e){return yc(e.openid)})))),zr("showDiscussion",n,e(e({docid:Er()},t),{useOpenid:r,online_users_detail:null==(i=t.online_users_detail)?void 0:i.filter((function(e){return r?yc(e.openid):Cc(e.uin)}))})))}function Ds(n,t){xr()?ec("wwapp.doc.collectionTable.hideDiscussion",e(e({},t),{docId:t.docid})):zr("hideDiscussion",n,t)}function Os(n,t){xr()?ec("wwapp.doc.collectionTable.updateDiscussion",e(e({},t),{docId:t.docid})):zr("updateDiscussion",n,t)}function Ms(e,n){zr("queryLatestUnreadMsg",e,n)}function Es(e,n){zr("queryConversationUnread",e,n)}function js(n,t){xr()?ec("wwapp.doc.collectionTable.getRedPointMsgList",nc(e(e({},t),{docId:t.docid}))):zr("getRedPointMsgList",n,t)}function Ls(e,n){Ar()?zr("getConversationMsgList",e,n):Ur().then((function(){var e;null!=(e=window.WeixinJSBridge)&&e.invoke("wwapp.doc.collectionTable.getConversationMsgList",Zr(n),(function(e){var t,o,i,r;null!=(o=null==(t=null==e?void 0:e.params)?void 0:t.data)&&o.json_strings?null!=(i=n.success)&&i.call(n,e.params.data):null!=(r=n.fail)&&r.call(n,e)}))}))}function Ns(e,n){zr("insertWxworkGroupChat",e,n)}function Bs(e,n){zr("isInWxworkGroupChat",e,n)}function Fs(e,n){zr("joinWxworkGroupChat",e,n)}function Us(e,n){zr("enterWxworkGroupChat",e,n)}function Rs(e,n){zr("createWxworkNameCardSelf",e,n)}function Vs(e,n){zr("enterWxworkNameCard",e,n)}function qs(e,n){zr("canChatWithWxworkNameCard",e,n)}function Qs(e,n){zr("createWxworkCalender",e,n)}function Js(e,n){zr("selectWxworkCalenderList",e,n)}function Gs(e,n){zr("viewDetailWxworkCalender",e,n)}function Xs(e,n){zr("queryWxworkCalenderInfo",e,n)}function $s(e,n){zr("joinWxworkCalender",e,n)}function Hs(e,n){zr("createTransferedChatMessageInfo",e,n)}function zs(e,n){zr("openChatMessageDetail",e,n)}function Ks(e,n){zr("insertApp",e,n)}function Ys(e,n){zr("openMiniProgram",e,n)}function Zs(e,n){xr()?ec("startGroupChat",n):zr("startGroupChat",e,n)}function ea(e,t){var o,i,r;return Ar()?(o=t.success,i=t.fail,r=n(t,["success","fail"]),e.invoke({func:"vibration",params:r}).then((function(e){0===e.code?(o||Promise.resolve)(e.data):(i||Promise.reject)(e.msg)}))):e.vibration(Zr(t))}function na(e,n){zr("vibrateDevice",e,n)}function ta(n,t){var o=bc(t.useOpenid,t.canUseOpenid);Ar()?zr("getAppCookies",n,e(e({docid:Er(),useOpenid:o},t),{success:function(e){var n;e&&o&&e.wedoc_openid&&!e.openid&&(e.openid=e.wedoc_openid),null!=(n=t.success)&&n.call(t,e)}})):Ur().then((function(n){return null==n?void 0:n.invoke("wwapp.exchangeST",e(e({docid:Er()},t),{useOpenid:o}),(function(e){var n,o,i,r;null!=(o=null==(n=null==e?void 0:e.err_msg)?void 0:n.includes)&&o.call(n,"ok")?null!=(i=null==t?void 0:t.success)&&i.call(t,e):null!=(r=null==t?void 0:t.fail)&&r.call(t,e)}))}))}function oa(e,n,t){try{var o,i;Gi.isIOS()&&(o=Br("wedoc_skey"),i=(null==e?void 0:e.wedoc_skey)||"",-1<o.indexOf("%")||-1<i.indexOf("%"))&&Rr({module:"tdocs_jsapi",opername:"tdocs_jsapi_sdk",action:"ios_skey_encode_error_"+t,ver7:yr(),ver8:o,obj3:i,ver9:Er()||location.pathname,ver10:kr(),ver11:n?1:0,ver12:ia()})}catch(e){}}function ia(){var e=navigator.userAgent.match(/iPhone OS ([\d_]+)/);return e?e[1]:""}function ra(n,t){var o,i,r,c,s,a,u,l;console.warn("----------客户端开始续票--------"),i=["uid","uid_key","wedrive_sid","wedrive_skey","wedrive_ticket","wedrive_uin","tdoc_sid","tdoc_skey","tdoc_vid","wedoc_sid","wedoc_skey","wedoc_ticket","tdoc_uid"],Pi.forEach((function(e){i.forEach((function(n){Nr({key:n,domain:e===Ai()?"":e,path:"/"})}))})),!Ar()&&Tr()&&(n.docLogin().then((function(){return Mr({},t)})).catch(t.fail),null!=(o=n.hasReceivedMsgFromNative))&&o.call(n)||(console.warn("----------开始续票--------"),r=Ar()&&!1!==t.isAutoSetLoginState,c=bc(t.useOpenid,!0),s=Gr("getLoginCst"),a=s.reportSuccess,u=s.reportFail,l=!1,"D0000000000000000"===Er()&&setTimeout((function(){var e;l||null!=(e=t.fail)&&e.call(t,{msg:"timeout for D0000000000000000"})}),2e3),ta(n,e(e({docid:Er(),useOpenid:c,canUseOpenid:!0},t),{isAutoSetLoginState:r,success:function(n){console.warn("----------跟客户端交互成功--------",n),r?setTimeout((function(){var o,i=!Br("wedrive_ticket")&&!Br("wedoc_ticket");if(oa(n,i,"before"),i){console.warn("----------客户端种票失败--------");var r={cst:!0,deviceid:!0,vid:!0,openid:!0},s=Ii;if(console.warn("----------前端自己种票了--------"),Object.keys(n).forEach((function(e){r[e]||Lr({key:e,value:n[e],domain:s,path:"/"})})),Gi.isWeWork()&&Gi.isIOS()){var a=parseInt(ia().split("_")[0],10),u=!Number.isNaN(a)&&a<=12;if(console.warn("----------iOS系统版本--------",a,u),u)return console.warn("----------iOS12以下系统，前端自己种票失败，重新调用cgi--------"),void kc(e({cst:n.cst,deviceid:n.deviceid},c&&n.openid?{openid:n.openid}:{vid:n.vid}),t)}oa(n,i,"after")}null!=(o=t.success)&&o.call(t,n)}),150):kc(e({cst:n.cst,deviceid:n.deviceid},c&&n.openid?{openid:n.openid}:{vid:n.vid}),t),a(),l=!0},fail:function(e){var n;null!=(n=t.fail)&&n.call(t,e),u(e),l=!0}})))}function ca(n,t){var o,i=Fr(t.message||""),r=t.level||"info";return xr()?null==(o=null==t?void 0:t.success)?void 0:o.call(t):Ar()?void(Gi.isIOS()&&0<Gi.compareVersion(yr(),"4.0.20")?zr("iosLog",n,e(e({},t),{level:r,message:i})):zr("log",n,e(e({},t),{level:r,message:i}))):n.localLog(Zr(e(e({},t),{level:r,message:i})))}function sa(e,n){zr("emitEvent",e,n,"magicbox")}function aa(e,n){zr("clientMutexLock",e,n,"docx")}function ua(e,n){zr("mapDocumentVersion",e,n,"docx")}function la(e,n){zr("removeDocumentVersion",e,n,"docx")}function da(e,t){var o=t.success,i=t.fail,r=n(t,["success","fail"]);e.invoke({func:"getOfflineLocalConfig",params:r,namespace:"docx"}).then((function(e){null!=o&&o(e)})).catch((function(e){console.log("调用失败"),null!=i&&i(e)}))}function fa(e,n){zr("isOfflineBidAvailable",e,n,"docx")}function pa(e,n){zr("notifyNative",e,n,"docx")}function wa(e,n){zr("manualSaveDocData",e,n,"docx")}function va(e,n){zr("preloadJsReady",e,n,"docx")}function ha(e,n){var t=n.urls,o=n.success,i=n.fail,r="documentUrlReplace";e.invoke({func:r,params:t,namespace:"docx"}).then((function(e){0===(e=void 0===e?{code:-1,data:null,msg:"res is empty"}:e).code?null!=o&&o(e.data):(console.log(r,"返回code不为0",e.msg),null!=i&&i(e.msg))})).catch((function(e){console.log("调用失败"),null!=i&&i(e)}))}function ga(e,n){zr("firstLoadFinished",e,n,"docx")}function ma(e,n){xr()?ec("wwapp.doc.collectionTable.requestFocus",n):zr("requestFocus",e,n)}function ba(t,o){var i,r;xr()?(i=o.success,r=n(o,["success"]),ec("wwapp.selectGroupChat",e(e({},r),{success:function(n){return"string"==typeof n.selectedConversationIdList&&n.selectedConversationIdList?null==i?void 0:i(e(e({},n),{selectedConversationIdList:JSON.parse(n.selectedConversationIdList)})):null==i?void 0:i(n)}}))):zr("selectGroupChat",t,o)}function ka(e,n){xr()?ec("journalStatisticShowPersonPicker",tc(n)):zr("journalStatisticShowPersonPicker",e,n)}function Ca(e,n){xr()?ec("journalStatisticShowDatePicker",tc(n)):zr("journalStatisticShowDatePicker",e,n)}function ya(n,t){xr()?ec("wwapp.selectCorpGroupContact",e(e({},t),{seizeParams:!0})):zr("selectCorpGroupContact",n,t)}function Wa(n,t){xr()?ec("wwapp.doc.collectionTable.notifyJournalSubmitted",e(e({},t),{seizeParams:!0})):zr("notifyJournalSubmitted",n,t)}function Sa(n,t){var o,i;xr()?ec("previewFile",e(e({},t),{name:null==(o=t.name)?void 0:o.replace(/[/\\?%*|"<>:]/g,"-")})):zr("previewFile",n,e(e({},t),{name:null==(i=t.name)?void 0:i.replace(/[/\\?%*|"<>:]/g,"-")}))}function _a(e,n){var t;Ar()?zr("wwapp.tdoc.getTemplateSegmentName",e,n):null!=(t=window.WeixinJSBridge)&&t.invoke("wwapp.tdoc.getTemplateSegmentName",Zr(n),n.success)}function Aa(e,n){var t;Ar()?zr("wwapp.tdoc.getMobileTemplateFromPage",e,n):null!=(t=window.WeixinJSBridge)&&t.invoke("wwapp.tdoc.getMobileTemplateFromPage",Zr(n),n.success)}function Ta(e,n){Ar()?zr("chooseImage",e,n):ec("chooseImage",n)}function xa(n,t){Ar()?zr("updateTimelineConv",n,t):ec("wwapp.doc.collectionTable.updateTimelineConv",e(e({},t),{docId:t.docid}))}function Ia(e,n){Ar()?zr("showEmojiPanel",e,n):ec("wwapp.doc.collectionTable.showEmojiPanel",n)}function Pa(e,n){Ar()?zr("toggleEmojiPanel",e,n):ec("wwapp.doc.collectionTable.toggleEmojiPanel",n)}function Da(e,n){Ar()?zr("keepEmojiPanel",e,n):ec("wwapp.doc.collectionTable.keepEmojiPanel",n)}function Oa(e,n){Ar()?zr("showOrHideLoading",e,n):ec("wwapp.doc.collectionTable.showOrHideLoading",n)}function Ma(n,t){var o=e(e({},t),{form_card_msg:t.formCardMsg,is_form_url:!!t.formCardMsg}),i=o.forwardRoomIds?"shareAppMessageWithRoomId":"shareAppMessage";Array.isArray(o.forwardRoomIds)&&(dr.isAndroid?o.forwardRoomIds=o.forwardRoomIds.map((function(e){return""+e})):o.forwardRoomIds=o.forwardRoomIds.map((function(e){return+e}))),Ar()?zr(i,n,o):ec(i,o)}var Ea={didPublishWorkLog:function(e,n){zr("didPublishWorkLog",e,n)},openTencentOfficeFromTemplate:function(e,n){zr("wwapp.tdoc.openTencentOfficeFromTemplate",e,n)},openWorklogTemplate:function(e,t){var o,i,r,c,s;o="wwapp.doc.worklog.openWorklogTemplate",i=e,r=t.success,c=t.fail,s=n(t,["success","fail"]),console.log(o,"params",s),Gi.isIOS()?i.invoke(o,s,r):i.invoke({func:o,params:s,namespace:void 0}).then((function(e){0===e.code?null!=r&&r(e.data):(console.log(o,"返回code不为0",e.msg),null!=c&&c(e.msg,e.code))})).catch((function(e){console.log("调用失败"),null!=c&&c(e)}))},selectGroupChat:ba,shareCustomCard:function(e,n){zr("shareCustomCard",e,n)},journalStatisticsShowPersonPicker:ka,journalStatisticsShowDatePicker:Ca,journalJumpToStat:function(e,n){zr("jumpToStat",e,n)},journalJumpToManagement:function(e,n){zr("jumpToManagement",e,n)},journalSendToGroupChat:function(e,n){zr("journalSendToGroupChat",e,n)},openDocOrNormalOrJournal:function(e,n){zr("openDocOrNormalOrEditWorklog",e,n)},sendTemplateInviteCard:function(e,n){zr("sendTemplateInviteCard",e,n)},selectCorpGroupContact:ya,getWecomSetting:function(e,n){zr("getWecomSetting",e,n)},selectCorpGroupContactNative:function(e,n){zr("selectCorpGroupContactNative",e,n)},notifyJournalSubmitted:Wa},ja={previewFile:Sa},La={selectGroupChat:ba,notifyJournalSubmitted:Wa,journalStatisticsShowDatePicker:Ca,journalStatisticsShowPersonPicker:ka},Na={chooseWeDriveDir:function(e,n){Ar()?zr("chooseWeDriveDir",e,n):ec("wwapp.doc.collectionTable.chooseWeDriveDir",nc(n))},selectImgFromImagePickerOrFileFromFav:function(e,n){Ar()?zr("selectImgFromImagePickerOrFileFromFav",e,n):ec("wwapp.selectImgFromImagePickerOrFileFromFav",n)},saveFileToDrive:function(e,n){Ar()?zr("saveFileToDrive",e,n):ec("wwapp.doc.collectionTable.saveFileToDrive",nc(n))},getLocalImgData:function(e,n){Ar()?zr("getLocalImgData",e,n):ec("getLocalImgData",n)},openLocation:function(n,t){var o=t.longitude,i=t.latitude,r=e(e({},t),{longitude:""+o,latitude:""+i});Ar()?(Gi.isIOS()&&Gi.compareVersion(yr(),"4.1.9")<=0&&(r.longitude=+o,r.latitude=+i,r.longtitude=+o),zr("openLocation",n,r)):ec("openLocation",e(e({},r),{longitude:+o,latitude:+i}))},selectLocation:function(e,n){Ar()?zr("selectLocation",e,n):ec("wwapp.selectLocation",n)},shareWechatMessage:function(e,n){Ar()?zr("shareWechatMessage",e,n):ec("shareWechatMessage",n)},forwardBySchoolNotification:function(e,n){Ar()?zr("forwardBySchoolNotification",e,n):ec("wwapp.forwardBySchoolNotification",n)},selectEnterpriseContacts:function(e,n){Ar()?zr("selectEnterpriseContacts",e,n):ec("selectEnterpriseContact",n)},selectContacts:function(n,t){Ar()?zr("selectContacts",n,t):ec("wwapp.selectContacts",e(e({},t),{docId:t.docid}))},openEnterpriseContact:function(e,n){Ar()?zr("openEnterpriseContact",e,n):ec("wwapp.openEnterpriseContact",n)},openSchoolNodeProfile:function(e,n){Ar()?zr("openSchoolNodeProfile",e,n):ec("wwapp.openSchoolNodeProfile",n)},selectHomeSchoolNode:function(e,n){Ar()?zr("selectHomeSchoolNode",e,n):ec("wwapp.selectHomeSchoolNode",n)},genRoomChatTicket:function(e,n){Ar()?zr("genRoomChatTicket",e,n):ec("wwapp.doc.collectionTable.genRoomChatTicket",n)},getTimelineStatus:function(n,t){Ar()?zr("getTimelineStatus",n,t):ec("wwapp.doc.collectionTable.getTimelineStatus",nc(e(e({},t),{docId:t.docid})))},setTimelineStatus:function(n,t){Ar()?zr("setTimelineStatus",n,t):ec("wwapp.doc.collectionTable.setTimelineStatus",e(e({},t),{docId:t.docid}))},updateTimelineConv:xa,onReceiveEvent:function(e,n){Ar()?zr("onReceiveEvent",e,n):ec("wwapp.doc.collectionTable.onReceiveEvent",n)},geoLocation:function(e,n){Ar()?zr("geoLocation",e,n):ec("geoLocation",n)},checkForwardBySchoolNotification:function(n,t){Ar()?zr("checkForwardBySchoolNotification",n,e(e({},t),{success:function(e){var n,o;1===e.canUse?null!=(n=null==t?void 0:t.success)&&n.call(t,!0):null!=(o=null==t?void 0:t.success)&&o.call(t,!1)}})):ec("wwapp.checkJsApi",e(e({},t),{funcName:"wwapp.forwardBySchoolNotification",success:function(e){var n,o;1===e.canUse||0===e.canUse?null!=(n=null==t?void 0:t.success)&&n.call(t,!0):null!=(o=null==t?void 0:t.success)&&o.call(t,!1)}}))}},Ba={showEmojiPanel:Ia,toggleEmojiPanel:Pa,keepEmojiPanel:Da,forwardFormsToWXWork:Ma,updateTimelineConv:xa},Fa={},Ua=null,Ra=0<=Gi.compareVersion(yr(),"3.1.20"),Va=0<=Gi.compareVersion(yr(),"3.1.23"),qa=0<=Gi.compareVersion(yr(),"4.0.0"),Qa=0<=Gi.compareVersion(yr(),"4.0.2"),Ja=0<=Gi.compareVersion(yr(),"4.0.6"),Ga=0<=Gi.compareVersion(yr(),"4.0.8"),Xa=0<=Gi.compareVersion(yr(),"4.0.16"),$a=0<=Gi.compareVersion(yr(),"4.0.18"),Ha=0<=Gi.compareVersion(yr(),"4.0.20"),za=0<=Gi.compareVersion(yr(),"4.1.0"),Ka=0<=Gi.compareVersion(yr(),"4.1.2"),Ya=0<=Gi.compareVersion(yr(),"4.1.6"),Za=0<=Gi.compareVersion(yr(),"4.1.8"),eu=0<=Gi.compareVersion(yr(),"4.1.10"),nu=0<=Gi.compareVersion(yr(),"4.1.12"),tu=0<=Gi.compareVersion(yr(),"4.1.20"),ou=0<=Gi.compareVersion(yr(),"4.1.22"),iu=0<=Gi.compareVersion(yr(),"4.1.26"),ru=0<=Gi.compareVersion(yr(),"4.1.28"),cu=0<=Gi.compareVersion(yr(),"4.1.30"),su=0<=Gi.compareVersion(yr(),"4.1.32"),au=0<=Gi.compareVersion(yr(),"4.1.36"),uu=e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e({clean:as,isWeDriveEnabled:rc,chooseWeDriveFile:cc,multiChooseWeDriveFile:sc,chooseTencentOfficeFile:ac,getClipboardData:oc,setClipboardData:ic,fileDownload:dc,getAppVersion:pc,compare:wc,isNewWwapp:vc,openCamera:fc,quoteToDiscuss:uc,forwardToConversion:lc,showNativePanel:Ec,updatePanelConfig:Mc,initToolbarConfig:Pc,showNativeToolbar:Oc,updateToolbarConfig:Dc,setTitle:qc,showOnlineUserList:Qc,getCustomTopbarButtonConfig:os,onCustomTopbarButtonClick:rs,viewProfile:_c,onUnload:hc,selectPerson:Sc,openUrl:ls,popBack:ds,saveImage:ws,previewImage:ps,chooseImage:vs,chooseImagePicker:Ta,setActionButtons:Lc,showMenuActions:Fc,showBottomActionSheet:Uc,updateActionButtons:Rc,showNativeToast:ms,notifyCommentActionToNative:bs,notifyEmojiCommentToNative:ks,allCommentPanelCountUpdated:Cs,showNativeAllCommentPanel:ys,launchCommentInput:Ws,showEmojiActionPanel:Ss,vibration:ea,updateAuthority:Ac,wdocsUpdateAuthority:Ac,getLoginCst:ta,docLogin:ra,log:ca,sendMagicBoxMsg:sa,getClientMutexLock:aa,mapDocumentVersion:ua,removeDocumentVersion:la,getOfflineLocalConfig:da,isOfflineBidAvailable:fa,preloadJsReady:va,manualSaveDocData:wa,notifyNative:pa,firstLoadFinished:ga,documentUrlReplace:ha,requestFocus:ma},Ra?{insertWxworkGroupChat:Ns,isInWxworkGroupChat:Bs,joinWxworkGroupChat:Fs,enterWxworkGroupChat:Us,createWxworkNameCardSelf:Rs,enterWxworkNameCard:Vs,canChatWithWxworkNameCard:qs,joinWxworkCalender:$s,queryWxworkCalenderInfo:Xs,createWxworkCalender:Qs,selectWxworkCalenderList:Js,viewDetailWxworkCalender:Gs,openChatMessageDetail:zs,createTransferedChatMessageInfo:Hs,clearDocUnread:Is,showDiscussion:Ps,hideDiscussion:Ds,updateDiscussion:Os,showCollaboratorPanel:Tc}:{}),Va?{showNativeSingleCommentPanel:_s,hideNativeSingleCommentPanel:As,updateOnlineUserList:xc,notifyDocChange:Ts,updateMessageQuoteStatus:xs}:{}),qa?{insertApp:Ks,openMiniProgram:Ys}:{}),Qa?{updateAuth:Ic}:{}),Qa&&Gi.isIOS()?{vibrateDevice:na}:{}),Ja?{queryLatestUnreadMsg:Ms,queryConversationUnread:Es,getRedPointMsgList:js,clientDatabaseRequest:function(e,n){var t=n.success;n.success=function(e){null!=e&&e.result&&null!=t&&t(e),null!=t&&t({result:e})},zr("clientDatabaseRequest",e,n,"docx")}}:{}),Ga&&Gi.isIOS()?{setBounces:function(e,n){zr("setBounces",e,n)}}:{}),Ga?{waitForClientLoadingClosed:function(e,n){var t,o=new Promise((function(e){t=setTimeout((function(){e(void 0),console.log("waitForClientLoadingClosed 超时了")}),n.timeout)})),i=new Promise((function(n){e.addEventListener("loadingClosed",(function o(){n(void 0),clearTimeout(t),console.log("waitForClientLoadingClosed 客户端回调蒙层消失"),e.removeEventListener("loadingClosed",o)}))}));return Promise.race([o,i])},setTitlebarIcons:Nc,updateTitlebarIcons:Vc}:{}),Xa?e(e({},Ea),{startGroupChat:Zs}):{}),$a?e({showTitlebarMask:Bc,showDocSharePanel:function(e,n){zr("showDocSharePanel",e,n)},showAdvancedFunc:function(e,n){zr("wwapp.showAdvancedFunc",e,n)}},ja):{}),Ha?{previewFiles:hs,getTemplateSegmentName:_a}:{}),Ha&&Gi.isIOS()?{getMobileTemplateFromPage:Aa}:{}),za?{importFromTencentOffice:function(e,n){zr("importFromTencentOffice",e,n)},importFromWechatFile:function(e,n){zr("importFromWechatFile",e,n)},getConversationMsgList:Ls}:{}),Ka?{preloadData:gs,updateMenuActions:function(e,n){console.info("-----updateMenuActions------"),console.info(n),ns(e,n),zr("updateMenuActions",e,n)},onlyDownloadFile:function(e,n){return Kr("onlyDownloadFile",e,n)},saveToWedriveByLocalPath:function(e,n){return Kr("saveToWedriveByLocalPath",e,n)},openWithOtherAppByLocalPath:function(e,n){return Kr("openWithOtherAppByLocalPath",e,n)},importFromLocal:function(e,n){zr("importFromLocal",e,n)},selectWxworkMeetingList:function(e,n){zr("selectWxworkMeetingList",e,n)},viewDetailWxworkMeeting:function(e,n){zr("viewDetailWxworkMeeting",e,n)},enterWxworkMeeting:function(e,n){zr("enterWxworkMeeting",e,n)},joinWxworkMeeting:function(e,n){zr("joinWxworkMeeting",e,n)}}:{}),Ya?{notifyNativeRefetchDocInfo:function(e,n){zr("notifyNativeRefetchDocInfo",e,n)},closeCommentInput:function(e,n){zr("closeCommentInput",e,n)},getNativeWebViewSize:function(e,n){return Kr("getNativeWebViewSize",e,n)},disableOfflinePackage:function(e,n){zr("disableOfflinePackage",e,n,"docx")}}:{}),Za?e(e(e({},Ba),Na),{closeFormAndTemplate:fs,showNewWikiDocActionSheet:function(e,n){zr("showNewWikiDocActionSheet",e,n)},showWikiCatalogPanel:function(e,n){zr("showWikiCatalogPanel",e,n)},switchWikiDoc:function(e,n){zr("switchWikiDoc",e,n)},getWikiMemberCount:function(e,n){zr("getWikiMemberCount",e,n)},showWikiMemberPage:function(e,n){zr("showWikiMemberPage",e,n)},getDisplayFontSize:function(e,n){return Kr("getDisplayFontSize",e,n)},sendDocApplyToConversation:function(e,n){Kr("sendDocApplyToConversation",e,n)},showOrHideLoading:Oa}):{}),Za&&Gi.isAndroid()?{getAndroidNativeScreenSize:function(e,n){zr("getNativeScreenSize",e,n,"docx")},getAndroidDeviceInfo:function(e,n){zr("getDeviceInfo",e,n,"docx")}}:{}),eu?{selectLocation:function(e,n){zr("selectLocation",e,n)},openLocation:function(e,n){zr("openLocation",e,n)},showTelAlert:function(n,t){zr("showTelAlert",n,e({appid:200001},t))},showMailWritePage:function(e,n){zr("showMailWritePage",e,n)},getTransactionIds:function(n,t){zr("getTransactionIds",n,e({command:"beginTransaction"},t),"docx")}}:{}),eu&&Gi.isIOS()?{setDocumentSSR:function(e,n){zr("setDocumentSSR",e,n,"docx")},getDocumentSSR:function(e,n){zr("getDocumentSSR",e,n,"docx")},removeDocumentSSR:function(e,n){zr("removeDocumentSSR",e,n,"docx")}}:{}),nu?{createSheetRangeAuth:function(e,n){return Kr("createSheetRangeAuth",e,n)},showSheetRangeAuthList:function(e,n){return Kr("showSheetRangeAuthList",e,n)},getNavigationBarHeight:function(e,n){zr("getNativeNavigationBarHeight",e,n)}}:{}),tu?{openMyDocListPage:function(e,n){zr("openMyDocListPage",e,n)},getWeworkInfo:function(e,n){var t=n.success;n.success=function(e){var n;e.englishName=null!=(n=e.englishName)?n:e.english_name,null!=t&&t(e)},zr("getSelfUserInfo",e,n)},showTimelineDocMenu:function(e,n){return Kr("showTimelineDocMenu",e,n)},addExistingDocToWiki:function(e,n){zr("addExistingDocToWiki",e,n)},openSecurityApplication:function(e,n){return Kr("openSecurityApplication",e,n)},scanQRCode:function(e,n){console.log("开始调用 scanQRCode",n),Ar()?zr("scanQRCode",e,n):ec("scanQRCode",n)}}:{}),tu&&Gi.isIOS()?{shouldShowOrHideFormToolbar:function(e,n){console.log("开始调用 shouldShowOrHideFormToolbar",n),Ar()?zr("shouldShowOrHideFormToolbar",e,n):ec("shouldShowOrHideFormToolbar",n)},setFormToolbarIcons:function(e,n){console.log("开始调用 setFormToolbarIcons",n),Ar()?zr("setFormToolbarIcons",e,n):ec("setFormToolbarIcons",n)},updateFormToolbarIcons:function(e,n){console.log("开始调用 updateFormToolbarIcons",n),Ar()?zr("updateFormToolbarIcons",e,n):ec("updateFormToolbarIcons",n)}}:{}),ou?{getDocumentVersion:function(e,n){zr("getDocumentVersion",e,n,"docx")},getBidInfo:function(e,n){zr("getBidInfo",e,n,"docx")},getDocMemberInfo:function(e,n){zr("getDocMemberInfo",e,n)},foldToMinimize:function(e,n){zr("foldToMinimize",e,n)},isMinimizeEnabled:function(e,n){zr("isMinimizeEnabled",e,n)},modifyFormViewShareSetting:function(e,n){zr("modifyFormViewShareSetting",e,n)},prefetchFormViewShareSetting:function(e,n){zr("prefetchFormViewShareSetting",e,n)},showSmartsheetDotMenu:function(e,n){zr("showSmartsheetDotMenu",e,n)}}:{}),iu?{smartsheetWebDataReady:function(e,n){zr("smartsheetWebDataReady",e,n)},smartsheetConfigSubTableMsgPanel:function(e,n){zr("smartsheetConfigSubTableMsgPanel",e,n)},smartsheetShowViewSetting:function(e,n){zr("smartsheetShowViewSetting",e,n)},closeSmartsheetViewSettingPanel:function(e,n){zr("closeSmartsheetViewSettingPanel",e,n)},ssCustomerServiceReCallGuideCard:function(e,n){zr("ssCustomerServiceReCallGuideCard",e,n)},smartsheetUpdateViewSetting:function(e,n){zr("smartsheetUpdateViewSetting",e,n)},smartSheetShowNormalLayout:function(e,n){zr("smartSheetShowNormalLayout",e,n)},setSmartsheetFloatingButtonStyle:function(e,n){zr("setSmartsheetFloatingButtonStyle",e,n)},setSmartsheetFloatingButtonOffset:function(e,n){zr("setSmartsheetFloatingButtonOffset",e,n)},smartsheetWebSubTablesOperation:function(e,n){zr("smartsheetWebSubTablesOperation",e,n)},smartsheetGetMainPageStatus:function(e,n){zr("smartsheetGetMainPageStatus",e,n)},smartsheetEnableNativeGesture:function(e,n){zr("smartsheetEnableNativeGesture",e,n)},smartsheetShowSubTableList:function(e,n){zr("smartsheetShowSubTableList",e,n)},smartsheetHideSubTableList:function(e,n){zr("smartsheetHideSubTableList",e,n)},smartsheetSubViewsPanelOperation:function(e,n){zr("smartsheetSubViewsPanelOperation",e,n)},smartsheetUpdateWebScrollStatus:function(e,n){zr("smartsheetUpdateWebScrollStatus",e,n)},showInputAlert:function(e,n){zr("showInputAlert",e,n)},showAlertMobile:function(e,n){zr("showAlert",e,n)},showAlertMixButton:function(e,n){zr("showAlertMixButton",e,n)},docTemplateUse:function(e,n){zr("docTemplateUse",e,n)},showTemplateBottomBar:function(e,n){var t,o,i;t=e,(o=n).buttons.forEach((function(e){e.onClick&&(Fa[e.id]=e.onClick)})),o.content.learnMoreId&&o.content.onLearnMoreBtnClick&&(Fa[o.content.learnMoreId]=o.content.onLearnMoreBtnClick),o.onBottomBarVisibilityChange&&t.addEventListener("templateBottomBarVisibilityChange",o.onBottomBarVisibilityChange),console.log("showTemplateBottomBar --addEventListenerByActionButtonConfig---",Fa),i=t,Ua||(Ua=function(e){var n;console.log("showTemplateBottomBar 点击 showTemplateBottomBar 回调",e),null!=(n=Fa[e.id])&&n.call(Fa,e)},console.log("showTemplateBottomBar init templateBottomBarButtonClick",Fa),i.addEventListener("templateBottomBarButtonClick",Ua)),zr("showTemplateBottomBar",e,n)},selectConversations:function(n,t){zr("selectConversations",n,e({max_count:500},t))},fetchConversationInfos:function(e,n){zr("fetchConversationInfos",e,n)},pushNavigatorPage:function(e,n){zr("react.pushNavigatorPage",e,n)},showAnimatedPanel:function(e,n){zr("react.showReactAnimatedPanel",e,n)},showBottomSheet:function(e,n){zr("react.showBottomSheet",e,n)},showPopupWidget:function(e,n){zr("react.showPopupWidget",e,n)},createInstance:function(e,n){zr("react.createInstance",e,n)},appendChild:function(e,n){zr("react.appendChild",e,n)},appendChildToContainer:function(e,n){zr("react.appendChildToContainer",e,n)},removeChild:function(e,n){zr("react.removeChild",e,n)},insertChildBefore:function(e,n){zr("react.insertChildBefore",e,n)},commitUpdate:function(e,n){zr("react.commitUpdate",e,n)},batchCommit:function(e,n){zr("react.batchCommit",e,n)},sendControllerEvent:function(e,n){zr("react.sendControllerEvent",e,n)}}:{}),ru?{selectSmartSheetForImport:function(e,n){zr("selectSmartSheetForImport",e,n)}}:{}),cu?{selectFile:function(e,n){return Kr("selectFile",e,n)},getLocalFileInfo:function(e,n){return Kr("getLocalFileInfo",e,n)},getLocalThumbnail:function(e,n){return Kr("getLocalThumbnail",e,n)},uploadFileToC2C:function(e,n){return Kr("uploadFileToC2C",e,n)},operateC2CUploadFiles:function(e,n){return Kr("operateC2CUploadFiles",e,n)},queryC2CUploadStatus:function(e,n){return Kr("queryC2CUploadStatus",e,n)},showSimpleEditContentPanel:function(e,n){var t,o;console.info("-----showSimpleEditContentPanel------"),console.info(n),t=n,zc||e.addEventListener("onSimpleEditContentPanelAction",(function(e){console.error("点击回调",e),console.error(zc),null!=zc&&zc(e)})),zc=null!=(o=t.onClick)?o:null,zr("showSimpleEditContentPanel",e,n)},showTopTips:function(e,n){return console.info("-----showTopTips------"),console.info(n),t=e,o=n,console.error(JSON.stringify(o.actions)),o.actions&&0!==o.actions.length&&(Kc||(Kc=!0,t.addEventListener("onTopTipsClick",(function(e){var n;console.error("点击回调",e),console.error(Yc),null!=(n=Yc[e.id])&&n.call(Yc,e)}))),null!=o)&&o.actions.forEach((function(e){e.onclick&&(Yc[e.id]=e.onclick)})),Kr("showTopTips",e,n);var t,o},showDataPicker:function(e,n){return Kr("showDataPicker",e,n)},isDarkMode:function(e,n){return Kr("isDarkMode",e,n)},dismissTopTips:function(e,n){console.info("-----dismissTopTips------"),zr("dismissTopTips",e,n),Yc={}},unfocusPrimaryFocus:function(e,n){return console.info("-----unfocusPrimaryFocus------"),Kr("unfocusPrimaryFocus",e,n)},updateWatermarkInfo:function(e,n){zr("updateWatermarkInfo",e,n)},forcePopAllPage:function(e,n){zr("react.forcePopAllPage",e,n)},forcePopPage:function(e,n){zr("react.forcePopPage",e,n)},showLoading:function(e,n){zr("react.showLoading",e,n)},getRootPageId:function(e,n){return Kr("react.getRootPageId",e,n)}}:{}),su?{saveSnapshot:function(e,n){return Kr("react.saveSnapshot",e,n)},deleteSnapshot:function(e,n){return Kr("react.deleteSnapshot",e,n)},hideSnapshot:function(e,n){return Kr("react.hideSnapshot",e,n)},getSnapshotExtra:function(e,n){return Kr("react.getSnapshotExtra",e,n)},pushRootWidget:function(e,n){$r.log("pushRootWidget",n);var t=Kr("react.pushRootWidget",e,n);return $r.log("pushRootWidget res",t),t},canSmartSheetUseNativeView:function(e,n){return Kr("canSmartSheetUseNativeView",e,n)},showRootMask:function(n,t){n.removeEventListener("onUserClickedRootMask"),t.onClickMask&&n.addEventListener("onUserClickedRootMask",t.onClickMask),zr("react.showRootMask",n,e(e({},t),{onClickMask:void 0}))},showRFDialog:function(e,n){zr("react.showDialog",e,n)},popRootWidget:function(e,n){return Kr("react.popRootWidget",e,n)},smartsheetShowMenuPop:function(e,n){return Kr("react.smartsheetShowMenuPop",e,n)},smartsheetDismissMenuPop:function(e,n){return zr("react.smartsheetDismissMenuPop",e,n)},showBusinessAlert:function(e,n){zr("react.showBusinessAlert",e,n)},blockDarkMode:function(e,n){return Kr("react.blockDarkMode",e,n)},smartsheetGetRecordData:function(e,n){zr("smartsheetGetRecordData",e,n)},smartsheetUpdateRecordData:function(e,n){zr("smartsheetUpdateRecordData",e,n)},getSSDetailPageTitle:function(e,n){return console.info("-----getSSDetailPageTitle------"),Kr("getSSDetailPageTitle",e,n)},weblog:function(e,n){return zr("weblog",e,n)}}:{}),au?{notifyMobileUpdateTips:function(e,n){console.info("-----notifyMobileUpdateTips------"),zr("notifyMobileUpdateTips",e,n)}}:{}),lu={clean:as,getClipboardData:oc,setClipboardData:ic,getAppVersion:pc,compare:wc,isNewWwapp:vc,quoteToDiscuss:uc,forwardToConversion:lc,setTitle:qc,viewProfile:_c,onUnload:hc,selectPerson:Sc,openUrl:ls,previewImage:ps,showNativeToast:ms,notifyCommentActionToNative:bs,notifyEmojiCommentToNative:ks,allCommentPanelCountUpdated:Cs,showNativeAllCommentPanel:ys,launchCommentInput:Ws,showEmojiActionPanel:Ss,vibration:ea,updateAuthority:Ac,docLogin:ra,log:ca},du=e(e(e(e({getAppVersion:pc,compare:wc,isNewWwapp:vc,viewProfile:_c,selectPerson:Sc,openUrl:ls,previewImage:ps,getLoginCst:ta,docLogin:ra},Ha?{previewFiles:hs,getTemplateSegmentName:_a}:{}),Ha&&Gi.isIOS()?{getMobileTemplateFromPage:Aa}:{}),za?{getConversationMsgList:Ls}:{}),Ka?{preloadData:gs}:{}),fu=e(e(e(e(e(e(e(e(e(e(e(e({},du),Na),{log:ca,hideDiscussion:Ds,clearDocUnread:Is,getRedPointMsgList:js,previewFile:Sa,viewProfile:_c,getLoginCst:ta,chooseImagePicker:Ta,requestFocus:ma,setClipboardData:ic,keepEmojiPanel:Da,forwardFormsToWXWork:Ma,updateTimelineConv:xa}),Ra?{popBack:ds}:{}),Ga?{showDiscussion:Ps,setTitlebarIcons:Nc,updateTitlebarIcons:Vc,updateDiscussion:Os}:{}),Xa?{selectCorpGroupContact:ya}:{}),!$a&&Gi.isAndroid()?{}:{showTitlebarMask:Bc}),$a?{chooseWeDriveFile:cc,multiChooseWeDriveFile:sc}:{}),za?{chooseTencentOfficeFile:ac,showEmojiPanel:Ia,toggleEmojiPanel:Pa,getClipboardData:oc}:{}),!Ha||Gi.isAndroid()?{}:{showOrHideLoading:Oa}),La),{startGroupChat:Zs,setActionButtons:Lc,updateActionButtons:Rc,closeFormAndTemplate:fs}),pu=Dr(Ar()?uu:xr()?fu:Tr()?lu:du,Hi.isWeWorkApp),wu=(pu.docLogin&&(pu.docLogin=Qr(pu.docLogin)),e(e(e({},pu),{isWedocWebview:Ar}),Ar()?{addEventListener:gc,removeEventListener:mc,removeIconButtonClickEvent:ts,callbackMap:Gc,deleteCookie:Nr,onRemoteCall:function(e,n){return t(void 0,void 0,Promise,(function(){var t,i;return o(this,(function(o){switch(o.label){case 0:return console.log("onRemoteCall 开始监听"),[4,hr(Hi.isWeWorkApp)];case 1:return t=o.sent(),null!=(i=t.onRemoteCall)&&i.call(t,e,n),[2]}}))}))},offRemoteCall:function(e,n){return t(void 0,void 0,Promise,(function(){var t,i;return o(this,(function(o){switch(o.label){case 0:return[4,hr(Hi.isWeWorkApp)];case 1:return t=o.sent(),console.log("onRemoteCall",e),null!=(i=t.offRemoteCall)&&i.call(t,e,n),[2]}}))}))}}:{}));function vu(e){var t=e||{},o=t.success,i=t.fail,r=t.cancel;return{data:n(t,["success","fail","cancel"]),success:o,fail:i,cancel:r}}function hu(e){var t=e||{};return t.success,n(t,["success","fail"])}function gu(e,n,t){return n.invoke(e,{data:hu(t)})}function mu(e,n,t){n.invoke(e,vu(t))}function bu(){return/^\/(journal|forms|form\/page)\//.test(location.pathname)||!jr()&&!/^\/txdoc\//.test(location.pathname)?void 0:"doc"}function ku(){if(/^\/(journal|forms|form\/page)\//.test(location.pathname))return!0}function Cu(e){return!Jr()&&Fu?e.replace(/^wwqt\./,"wwapp2."):e}function yu(e){return Fu||e&&Jr()}function Wu(e,n){_r()?e.readFromPasteBoard((function(e){var t;null!=(t=n.success)&&t.call(n,{plain:e.value||"",html:e.html||""})}),n.fail):e.invoke("wwapp.wedoc.readFromPasteBoard",vu(n))}function Su(e,n){_r()?e.writeToPasteBoard({html:n.html||"",value:n.plain||""},n.success,n.fail):e.invoke("wwapp.wedoc.writeToPasteBoard",vu(n))}function _u(e,n){var t;_r()?null!=(t=n.success)&&t.call(n,e.readFileListFromClipBoard()):e.invoke("wwapp.wedoc.readFileListFromClipBoard",vu(n))}function Au(e,n){_r()?e.readAsDataURL(n.path).then((function(e){var t,o;e?null!=(t=n.success)&&t.call(n,{base64:e}):null!=(o=n.fail)&&o.call(n)})).catch((function(e){var t;null!=(t=n.fail)&&t.call(n,e)})):e.invoke("wwapp.wedoc.readAsDataURL",vu(n))}function Tu(e,n){_r()?e.copyNativeImageByPath(n.path).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.copyNativeImageByPath",vu(n))}function xu(e,n){e.invoke("wwapp.wedoc.requestFullscreen",vu(n))}function Iu(e,n){e.invoke("wwapp.wedoc.exitFullscreen",vu(n))}function Pu(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.wework_isFullscreen",e),[2]}}))}))}function Du(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.wework_isFullscreen",e),[2]}}))}))}function Ou(e,n){_r()?e.add2Drive().then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.add2Drive",vu(n))}function Mu(n,t){_r()?n.selectFromWxDrive(e(e({},hu(t)),{confirmHandler:function(e){var n,o,i=null!=e&&e.length?e[0]:null;i?null!=(o=t.success)&&o.call(t,{err_code:0,err_msg:"pickWeDriveWindow:ok",fileid:i.doc_id||i.id,filename:i.name,filetype:i.doc_id?1:0,spaceid:i.topId||i.rootId,url:i.doc_url}):null!=(n=t.fail)&&n.call(t)}})):n.invoke("wwapp.wedoc.selectFromWxDrive",vu(t))}function Eu(e,t){var o,i,r,c,s,a;_r()?(e.jumpToDrive({id:t.file_id,parentId:t.folder_id,topId:t.space_id}),null!=(o=t.success)&&o.call(t)):Sr()?(r=(i=t||{}).success,c=i.fail,s=n(i,["success","fail"]),a={data:{event:"jumpToDrive",param:JSON.stringify({file:s})},success:r,fail:c,cancel:c},e.invoke("wwapp.wedoc.wedriveUniversalEvent",a)):e.invoke("wwapp.wedoc.jumpToDrive",vu(t))}function ju(n,t){var o;Sr()&&(o=JSON.stringify(t.param),t=e(e({},t),{param:o}),n.invoke("wwapp.wedoc.wedriveUniversalEvent",vu(t)))}function Lu(e,n){_r()?e.request("mainService.appIpcRequest","wework/getPartyListOrUserListForWXDrive",hu(n),{timeout:2e3}).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.getPartyListOrUserList",vu(n))}function Nu(e,n){_r()?e.request("mainService.appIpcRequest","wework/getSubDepartmentsForWXDrive",hu(n)).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.getSubDepartments",vu(n))}function Bu(n,i){return t(void 0,void 0,void 0,(function(){return o(this,(function(t){if(void 0===(i=Uu(i)).docid&&(i.docid=Er()),/_st$/.test(i.docid))return[2,Promise.resolve({})];if(Wc(i.openid||i.vid))return[2,Promise.resolve({})];if(_r())return[2,n.viewProfile(null==i?void 0:i.vid)];if(i.openid||i.useOpenid||!Cc(i.vid)){if(Gi.isMac()&&Gi.compareVersion(yr(),"4.0.10")<0)return[2,Promise.resolve({})];if(!yc(i.openid||i.vid))return[2,Promise.reject({err_msg:(i.openid||i.vid)+" is not openid"})];i=e(e({},i),{openid:i.openid||i.vid,vid:void 0,useOpenid:1})}return 0<=Gi.compareVersion(yr(),"4.1.32")&&(i=e(e({},i),{scene:1})),[2,gu("wwapp.wedoc.viewProfile",n,i)]}))}))}var Fu=0<=Gi.compareVersion(yr(),"4.1.32");function Uu(n){if("number"!=typeof n.positionX||"number"!=typeof n.positionY)return n;if(!window.parent||window.parent===window)return n;try{var t=window.parent.document.querySelectorAll("iframe"),o=Array.from(t).find((function(e){return e.contentWindow===window})),i=null==o?void 0:o.getBoundingClientRect();return i?e(e({},n),{positionX:n.positionX+i.left,positionY:n.positionY+i.top}):n}catch(t){return console.error(t),n}}function Ru(n,i){return t(void 0,void 0,void 0,(function(){var t,r,c,s;return o(this,(function(o){switch(o.label){case 0:return _r()?[2,n.selectContacts(hu(i))]:(t=bc(i.useOpenid,i.canUseOpenid||!(null==(c=i.selectedContactOpenIds)||!c.length)||!(null==(s=i.disabledUserOpenIds)||!s.length)))?[4,gu("wwapp.wedoc.selectContacts",n,e(e({docid:Er(),docId:Er(),ignoreCmodes:ku(),whitelistType:bu()},i),{useOpenid:t,selectedContacts:void 0,disabledUserIds:void 0,selectedContactOpenIds:i.selectedContactOpenIds||i.selectedUserIds&&i.selectedUserIds.filter(yc),disabledUserOpenIds:i.disabledUserOpenIds||i.disabledUserIds&&i.disabledUserIds.filter(yc)}))]:[2,gu("wwapp.wedoc.selectContacts",n,e(e({docid:Er(),whitelistType:bu(),ignoreCmodes:ku()},i),{selectedContacts:i.selectedContacts&&i.selectedContacts.filter(Cc),disabledUserIds:i.disabledUserIds&&i.disabledUserIds.filter(Cc)}))];case 1:return r=o.sent(),[2,e(e({},r),{selectedContacts:r.selectedContacts&&r.selectedContacts.map((function(n){return e(e({},n),{vid:n.openid,id:n.openid})})),applyExternalVidList:r.applyExternalVidList&&r.applyExternalVidList.map((function(n){return e(e({},n),{vid:n.openid,id:n.openid})})),applyWxList:r.applyWxList&&r.applyWxList.map((function(n){return e(e({},n),{vid:n.openid,id:n.openid})})),selectedOtherContacts:r.selectedOtherContacts&&r.selectedOtherContacts.map((function(n){return e(e({},n),{vid:n.openid,id:n.openid})}))})]}}))}))}function Vu(n,i){var r;_r()?function e(n,t,o,i){var r;void 0===i&&(i=3),null!=(r=window.qmailBridge)&&r[n]?t(window.qmailBridge):0<i?setTimeout((function(){return e(n,t,o,i-1)}),1e3):o()}("getRecentContacts",(function(e){e.getRecentContacts().then(null==i?void 0:i.success).catch(null==i?void 0:i.fail)}),(function(){var e;null!=(e=i.fail)&&e.call(i)})):(r=bc(i.useOpenid,i.canUseOpenid))?gu("wwapp.wedoc.getRecentContacts",n,e(e({docid:Er()},i),{useOpenid:r})).then((function(n){return t(void 0,void 0,void 0,(function(){var t;return o(this,(function(o){return null!=(t=i.success)&&t.call(i,e(e({},n),{persons:n.persons&&n.persons.map((function(n){return e(e({},n),{vid:n.openid})}))})),[2]}))}))})).catch(i.fail):n.invoke("wwapp.wedoc.getRecentContacts",vu(i))}function qu(n,i){var r;_r()?n.searchContacts(hu(i)).then(null==i?void 0:i.success).catch(null==i?void 0:i.fail):(r=bc(i.useOpenid,i.canUseOpenid))?gu("wwapp.wedoc.searchContacts",n,e(e({docid:Er()},i),{useOpenid:r})).then((function(n){return t(void 0,void 0,void 0,(function(){var t;return o(this,(function(o){return null!=(t=i.success)&&t.call(i,e(e({},n),{persons:n.persons&&n.persons.map((function(n){return e(e({},n),{vid:n.openid})}))})),[2]}))}))})).catch(i.fail):n.invoke("wwapp.wedoc.searchContacts",vu(i))}var Qu={CN:{INVITE:"邀请成员加入",LINK:"复制链接",DISABLE:"企业外人员不可加入此文档",QRCODE:"生成二维码",SHARE_TPL:"分享模板"},EN:{INVITE:"Send Invitation",LINK:"Copy the link",DISABLE:"Externals cannot join this document",QRCODE:"Generate QR Code",SHARE_TPL:"Share Template"},HK:{INVITE:"邀請成員加入",LINK:"複製連結",DISABLE:"企業外人員不可加入此文檔",QRCODE:"生成二維碼",SHARE_TPL:"分享模板"},TH:{INVITE:"เชิญสมาชิกเข้าร่วม",LINK:"คัดลอกลิงก์",DISABLE:"ผู้ที่ไม่ใช่พนักงานภายในไม่สามารถเข้าร่วมเอกสารนี้ได้",QRCODE:"สร้างรหัส QR",SHARE_TPL:"แบ่งปันเทมเพลต"},VI:{INVITE:"Mời thành viên tham gia",LINK:"Sao chép liên kết",DISABLE:"Không cho phép người ngoài doanh nghiệp tham gia tài liệu này",QRCODE:"Tạo mã QR",SHARE_TPL:"Chia sẻ mẫu"},MS:{INVITE:"Jemput ahli untuk menyertai",LINK:"Salin pautan",DISABLE:"Ahli luar syarikat tidak dibenarkan menyertai dokumen ini",QRCODE:"Buat kod QR",SHARE_TPL:"Kongsi Templat"},FIL:{INVITE:"Mag-imbita ng mga kasapi na sumali",LINK:"Kopyahin ang link",DISABLE:"Ang mga tao na hindi kabilang sa kumpanya ay hindi maaaring sumali sa dokumentong ito",QRCODE:"Lumikha ng QR code",SHARE_TPL:"Ibahagi ang Template"},ID:{INVITE:"Undang anggota untuk bergabung",LINK:"Salin tautan",DISABLE:"Pegawai di luar perusahaan tidak dapat bergabung dengan dokumen ini",QRCODE:"Buat kode QR",SHARE_TPL:"Bagikan Templat"},ES:{INVITE:"Invitar a miembros a unirse",LINK:"Copiar enlace",DISABLE:"Los miembros externos a la empresa no pueden unirse a este documento",QRCODE:"Generar código QR",SHARE_TPL:"Compartir plantilla"},DE:{INVITE:"Mitglieder einladen beizutreten",LINK:"Link kopieren",DISABLE:"Externe Mitarbeiter können nicht an diesem Dokument teilnehmen",QRCODE:"QR-Code generieren",SHARE_TPL:"Vorlage teilen"},JA:{INVITE:"メンバーを招待して参加する",LINK:"リンクをコピーする",DISABLE:"企業外の人はこのドキュメントに参加できません",QRCODE:"QRコードを生成する",SHARE_TPL:"テンプレートを共有する"}},Ju=0<=Gi.compareVersion(yr(),"4.0.18"),Gu=0<=Gi.compareVersion(yr(),"4.1.8"),Xu=0<=Gi.compareVersion(yr(),"4.1.10"),$u=new Map,Hu=!1,zu=0,Ku=!1,Yu=function(){for(var e,n,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];try{"function"==typeof(null==(n=window.log)?void 0:n.info)?(e=window.log).info.apply(e,t):console.info.apply(console,t)}catch(e){}};function Zu(e){var n;Yu("----QuoteToDiscuss onclick----",e),"close"===(null==e?void 0:e.id)&&Xu?(zu=Date.now(),Ku=!1,Yu("----QuoteToDiscuss onclose----",zu),window.dispatchEvent(new CustomEvent("sharePanelClosed"))):null!=e&&e.id&&null!=(n=$u.get(e.id))&&n()}function el(){var e=Date.now()-zu;return!(e<=500&&Xu&&(Yu("----QuoteToDiscuss forbidden show---- diffTime="+e),1))}function nl(n,t){var o,i,r,c,s,a,u;_r()?n.discuss(hu(t)).then(t.success).catch(t.fail):el()?(c=window.isTimelineMode?{hideDiscussWindow:!0}:{},$u.clear(),Ju&&t.extraButtons&&(a=n,null!=(u=t.extraButtons)&&u.forEach((function(e){var n=e.id,t=e.onClick;n&&t&&$u.set(n,t)})),console.log("----QuoteToDiscuss Click Action Init----",null==u?void 0:u.length,Hu),Hu||(a.on("wwapp.wedoc.onClickSharePanel",Zu),Hu=!0)),(t=t.fixPosition?Uu(t):t).url&&(o=t.url,i=Vr("wikifileid"),r=Vr("wikifileid",o),i)&&i!==r&&Rr({module:"tdocs_jsapi",opername:"tdocs_jsapi_sdk",action:"wiki_file_id_not_match",ver7:yr(),ver8:i,ver9:Er()||location.pathname,ver10:kr(),source3:r}),Gu&&(void 0!==(null==t?void 0:t.positionX)&&Gi.isWindows()&&(t.positionX-=40,console.debug("4.1.8版本转发弹窗UI变化,tdoc自动向左偏移40px(win)",t.positionX)),s=Qu[(()=>{try{var e=window.__LANG__||localStorage.getItem("shared-language")||"zh-CN";return e?/^en/i.test(e)?"EN":/hk$/i.test(e)||/tw$/i.test(e)?"HK":/^zh/i.test(e)?"CN":/^ms/i.test(e)?"MS":/^es/i.test(e)?"ES":/^id/i.test(e)?"ID":/^ja/i.test(e)?"JA":/^th/i.test(e)?"TH":/^tl/i.test(e)||/^fil/i.test(e)?"FIL":/^vi/i.test(e)?"VI":/^de/i.test(e)?"DE":"EN":"CN"}catch(e){return"CN"}})()],t&&!/forms\//.test((null==t?void 0:t.url)||"")&&(t.shareTitle=/_st$/.test((null==t?void 0:t.docId)||"")?s.SHARE_TPL:s.INVITE,console.debug("4.1.8版本转发弹窗UI变化,shareTitle自动修改为",t.shareTitle)),((null==t?void 0:t.extraButtons)||[]).forEach((function(e){var n;e.skipFix||(!e.enable&&["qrcode","wechat-share"].includes(e.id)&&(e.hoverText=s.DISABLE),e.enable&&"qrcode"===e.id&&(e.hoverText=s.QRCODE),"link"===e.id&&(n=Gi.isMac()?"⌘ L":"Ctrl+L",e.hoverText=s.LINK+"  "+n),console.debug("4.1.8版本转发弹窗UI变化,"+e.id+"的hoverText自动修改为"+e.hoverText))}))),setTimeout((function(){var o=vu(e(e({whitelistType:bu()},c),t));n.invoke("wwapp.wedoc.discuss",o),Yu("wwapp.wedoc.discuss",o)}),25),Xu&&(Ku=!0,window.dispatchEvent(new CustomEvent("sharePanelShowed")))):zu=0}function tl(n,t){var o,i;if(_r())n.startConversation(hu(t)).then(t.success).catch(t.fail);else{if(void 0===t.docid&&(t.docid=Er()),t.openid||t.useOpenid||!Cc(t.vid)){if(Gi.isMac()&&Gi.compareVersion(yr(),"4.0.10")<0)return void(null!=(o=t.success)&&o.call(t,{}));if(!yc(t.openid||t.vid))return void(null!=(i=t.fail)&&i.call(t,{err_msg:(t.openid||t.vid)+" is not openid"}));t=e(e({},t),{openid:t.openid||t.vid,vid:void 0,useOpenid:1})}n.invoke("wwapp.wedoc.startConversation",vu(t))}}function ol(n,t){var o;_r()?n.forwardFormsToWXWork(t.forms||[]).then(t.success).catch(t.fail):(o=e({},t),Array.isArray(t.forwardRoomIds)&&(dr.isWindows||dr.isMac&&dr.isWxWorkVersionAboveOrEqual("4.0.19")?o.forwardRoomIds=t.forwardRoomIds.map((function(e){return""+e})):o.forwardRoomIds=t.forwardRoomIds.map((function(e){return+e}))),n.invoke("wwapp.wedoc.forwardFormsToWXWork",vu(e({whitelistType:bu()},o))))}function il(e,n){_r()?e.forwardToConversion(n.convId||"").then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.forwardToConversion",vu(n))}function rl(e,n){_r()?e.request("mainService.appIpcRequest","wework/notifyPush",hu(n),{needCallback:!1}).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.notifyPush",vu(n))}function cl(e,n){_r()?e.request("mainService.appIpcRequest","wework/showDiscussWindow",hu(n),{needCallback:!1}).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.showDiscussWindow",vu(n))}function sl(e,n){_r()?e.request("mainService.appIpcRequest","wework/hideOneDiscussWindow",hu(n),{needCallback:!1}).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.hideOneDiscussWindow",vu(n))}function al(e,n){_r()?e.request("mainService.appIpcRequest","wework/destroyDiscussWindow",hu(n),{needCallback:!1}).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.destroyDiscussWindow",vu(n))}function ul(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return _r()?(window.wedocs_preloadIPCRenderer.on("wework_completeComment",e),[2]):[4,hr(Hi.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.wework_completeComment",e),[2]}}))}))}function ll(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return _r()?(window.wedocs_preloadIPCRenderer.removeListener("wework_completeComment",e),[2]):[4,hr(Hi.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.wework_completeComment",e),[2]}}))}))}function dl(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return _r()?(window.wedocs_preloadIPCRenderer.on("wework_unreadCountChange",e),[2]):[4,hr(Hi.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.wework_unreadCountChange",e),[2]}}))}))}function fl(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return _r()?(window.wedocs_preloadIPCRenderer.removeListener("wework_unreadCountChange",e),[2]):[4,hr(Hi.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.wework_unreadCountChange",e),[2]}}))}))}function pl(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return _r()?(window.wedocs_preloadIPCRenderer.on("wework_closeDiscussWindow",e),[2]):[4,hr(Hi.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.wework_closeDiscussWindow",e),[2]}}))}))}function wl(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return _r()?(window.wedocs_preloadIPCRenderer.removeListener("wework_closeDiscussWindow",e),[2]):[4,hr(Hi.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.wework_closeDiscussWindow",e),[2]}}))}))}function vl(e,n){var t;null!=(t=null==n?void 0:n.success)&&t.call(n,yr())}function hl(e,n){var t;null!=(t=null==n?void 0:n.success)&&t.call(n,Gi.compareVersion(yr(),(null==n?void 0:n.version)||""))}function gl(e,n){var t;null!=(t=null==n?void 0:n.success)&&t.call(n,Wr())}function ml(e,n){n.target!==Ki.Browser&&(Ri.test(n.url)||Vi.test(n.url))?n.target===Ki.Direct?location.href=n.url:yl(e,n):_l(e,n)}function bl(n,t){var o,i;Gi.isMac()?null!=(i=null==(o=window.WeixinJSBridge)?void 0:o.invoke)&&i.call(o,"wwapp.openUrl",e(e({width:"960",height:"680"},hu(t)),{forceInnerBrowser:1,url:t.url}),t.success):n.invoke("wwapp.wedoc.openInWxworkBrowser",vu(t))}function kl(e,t){var o,i,r,c,s;_r()?e.openFileInWedrive(t.fileId,t.url).then(t.success).catch(t.fail):Sr()?(i=(o=t||{}).success,r=o.fail,c=n(o,["success","fail"]),s={data:{event:"openFileInWedrive",param:JSON.stringify(c)},success:i,fail:r,cancel:r},e.invoke("wwapp.wedoc.wedriveUniversalEvent",s)):e.invoke("wwapp.wedoc.openFileInWedrive",vu(t))}function Cl(e,n){var t;_r()?null!=(t=n.success)&&t.call(n,e.closeWindow()):(xr()&&document.body.clientWidth<610&&e.invoke("wwapp.closeCurrentWebview",vu(n)),e.invoke("wwapp.wedoc.closeWindow",vu(n)))}function yl(e,n){Ri.test(n.url)||Vi.test(n.url)||qi.test(n.url)?_r()?e.request("mainProcessModule.WeDocsSchemaProtocolController.openwedocs",{url:n.url,id:Er(n.url),is_silent:n.is_silent||!1},{needCallback:!1}).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.openInTab",vu(n)):_l(e,n)}function Wl(e,n){e.invoke("wwapp.wedoc.openWecomSearch",vu(n))}function Sl(e,n){_r()?e.openWedocsMainWindow(!1,!1,{}).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.openAndJumpToMainPage",vu(n))}Gi.isServerSide()||!Gi.isWeWorkMacOrWin()||/^\/home/.test(location.pathname)||document.addEventListener("tdocsReady",(function(){hr(Hi.isWeWork).then((function(e){var n=e.notify.bind(e);e.notify=function(){for(var e,t,o,i,r,c=[],s=0;s<arguments.length;s++)c[s]=arguments[s];n.apply(void 0,c);try{"wwapp.wedoc.onClickSharePanel"===c[0]&&(o=document.querySelector(".tmall-panel"))&&(i=o.querySelector("iframe"))&&null!=(t=null==(r=null==i?void 0:i.contentWindow)?void 0:r.wwapp)&&t.notify&&((e=r.wwapp).notify.apply(e,c),console.debug("forward success",c))}catch(e){console.error("forward error",e)}}}))}));var _l=function(e,n){_r()?e.openFileInBrowser(n.url).then(n.success).catch(n.fail):e.invoke("wwapp.wedoc.openFileInBrowser",vu(n))};function Al(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return _r()?(window.wedocs_preloadIPCRenderer.on("focusWedocsWindow",e),[2]):[4,hr(Hi.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.focusWedocsWindow",e),[2]}}))}))}function Tl(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return _r()?(window.wedocs_preloadIPCRenderer.removeListener("focusWedocsWindow",e),[2]):[4,hr(Hi.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.focusWedocsWindow",e),[2]}}))}))}function xl(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return _r()?(window.wedocs_preloadIPCRenderer.on("blurWedocsWindow",e),[2]):[4,hr(Hi.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.blurWedocsWindow",e),[2]}}))}))}function Il(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return _r()?(window.wedocs_preloadIPCRenderer.removeListener("blurWedocsWindow",e),[2]):[4,hr(Hi.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.blurWedocsWindow",e),[2]}}))}))}function Pl(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return _r()?(window.wedocs_preloadIPCRenderer.on("url_change",(function(n,t){return e(t)})),[2]):[4,hr(Hi.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.urlChange",e),[2]}}))}))}function Dl(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return _r()?(window.wedocs_preloadIPCRenderer.removeListener("url_change",(function(n,t){return e(t)})),[2]):[4,hr(Hi.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.urlChange",e),[2]}}))}))}function Ol(e,n){var t,o;_r()?(o=location.search.replace(/^\?/,"").split("&").reduce((function(e,n){var t=n.split("=");return t[0]&&(e[t[0]]=t[1]),e}),{}),null!=(t=n.success)&&t.call(n,o)):e.invoke("wwapp.wedoc.getWindowUrlParams",vu(n))}function Ml(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.clickDocTab",e),[2]}}))}))}function El(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.clickDocTab",e),[2]}}))}))}function jl(n,t){var o;if(_r())null!=(o=t.success)&&o.call(t,n.openSupportPage());else if(Ai()===Ti)_l(n,e(e({},t),{url:Qi}));else{var i,r=Ji,c=[];for(i in t.querys)c.push(i+"="+encodeURIComponent(t.querys[i]));var s=c.join("&");fetch("/diskmng/contactus?func=2").then((function(e){return e.json()})).then((function(o){var i,c=null==(i=null==o?void 0:o.body)?void 0:i.feedback_url;if(c){var a=new URL(c),u=a.searchParams.get("tucao_redirect_uri");if(u){var l,d=!1,f=(u.includes("http")||(u="http://"+u,d=!0),new URL(u));for(l in t.querys)f.searchParams.set(l,t.querys[l]);u=f.toString(),d&&(u=u.slice(7)),a.searchParams.set("tucao_redirect_uri",u),c=a.toString()}}else c=r+"?"+s;_l(n,e(e({},t),{url:c}))})).catch((function(o){console.error("fetch feedback url error",o),_l(n,e(e({},t),{url:r+"?"+s}))}))}}function Ll(n,t){var o=bc(t.useOpenid,t.canUseOpenid);n.invoke("wwapp.wedoc.getLoginCst",vu(e({docid:Er(),useOpenid:o},t)))}function Nl(n,t){var o,i,r,c;_r()?n.docLogin((function(){return Mr({},t)}),t.fail):(o=bc(t.useOpenid,!0),i=Gr("getLoginCst"),r=i.reportSuccess,c=i.reportFail,n.invoke("wwapp.wedoc.getLoginCst",vu(e(e({docid:Er(),useOpenid:o,canUseOpenid:!0},t),{success:function(n){kc(e({cst:n.cst,deviceid:n.deviceid},o&&n.openid?{openid:n.openid}:{vid:n.vid}),t),r()},fail:function(e){var n;null!=(n=t.fail)&&n.call(t,e),c(e)}}))))}function Bl(n,t){var o=Fr(t.msg||t.message||""),i=t.level||"info";_r()?n.localLog(o).then(t.success).catch(t.fail):n.invoke("wwapp.wedoc.localLog",vu(e(e({},t),{msg:o,level:i})))}function Fl(e,n){e.invoke("wwapp.wedoc.insertWxworkGroupChat",vu(n))}function Ul(e,n){e.invoke("wwapp.wedoc.isInWxworkGroupChat",vu(n))}function Rl(e,n){e.invoke("wwapp.wedoc.joinWxworkGroupChat",vu(n))}function Vl(e,n){e.invoke("wwapp.wedoc.enterWxworkGroupChat",vu(n))}function ql(e,n){e.invoke("wwapp.wedoc.createWxworkNameCardSelf",vu(n))}function Ql(n,t){0<=Gi.compareVersion(yr(),"4.1.32")&&(t=e(e({},t),{scene:1})),n.invoke("wwapp.wedoc.enterWxworkNameCard",vu(t))}function Jl(e,n){e.invoke("wwapp.wedoc.canChatWithWxworkNameCard",vu(n))}function Gl(e,n){e.invoke("wwapp.wedoc.createWxworkCalender",vu(n))}function Xl(e,n){e.invoke("wwapp.wedoc.selectWxworkCalenderList",vu(n))}function $l(e,n){e.invoke("wwapp.wedoc.viewDetailWxworkCalender",vu(n))}function Hl(e,n){e.invoke("wwapp.wedoc.queryWxworkCalenderInfo",vu(n))}function zl(e,n){e.invoke("wwapp.wedoc.joinWxworkCalender",vu(n))}function Kl(e,n){e.invoke("wwapp.wedoc.createTransferedChatMessageInfo",vu(n))}function Yl(e,n){e.invoke("wwapp.wedoc.openChatMessageDetail",vu(n))}function Zl(e,n){e.invoke("wwapp.wedoc.getConversationList",vu(n))}function ed(e,n){e.invoke("wwapp.wedoc.getConversationsDetail",vu(n))}function nd(e,n){e.invoke("wwapp.wedoc.getNoticeCount",vu(n))}function td(e,n){e.invoke("wwapp.wedoc.monitorDocConv",vu(n))}function od(e,n){e.invoke("wwapp.wedoc.markAsRead",vu(n))}function id(e,n){e.invoke("wwapp.wedoc.setConvTop",vu(n))}function rd(e,n){e.invoke("wwapp.wedoc.removeConv",vu(n))}function cd(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.conversationChange",e),[2]}}))}))}function sd(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.conversationChange",e),[2]}}))}))}function ad(e,n){e.invoke("wwapp.wedoc.setNoticeType",vu(n))}function ud(e,n){e.invoke("wwapp.wedoc.getTotalUnreadCount",vu(n))}function ld(e,n){e.invoke("wwapp.wedoc.timelineInited",vu(n))}function dd(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.openDocInTimeline",e),[2]}}))}))}function fd(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.openDocInTimeline",e),[2]}}))}))}function pd(e,n){e.invoke("wwapp.wedoc.shareToWeixin",vu(n))}function wd(e,n){e.invoke("wwapp.wedoc.isInstalledWeixinApp",vu(n))}function vd(e,n){e.invoke("wwapp.wedoc.queryDepartmentNames",vu(n))}function hd(e,n){e.invoke("isDarkMode",vu(n))}function gd(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.darkModeChange",e),[2]}}))}))}function md(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.darkModeChange",e),[2]}}))}))}function bd(e,n){e.invoke("wwapp.selectCorpGroupContact",vu(n))}var kd={selectEnterpriseContacts:function(e,n){ec("selectEnterpriseContact",n)},genRoomChatTicket:function(e,n){ec("wwapp.getTicketToSendGroupChat",n)}},Cd=0<=Gi.compareVersion(yr(),"3.1.20"),yd=0<=Gi.compareVersion(yr(),"3.1.23"),Wd=0<=Gi.compareVersion(yr(),"4.0.0"),Sd=0<=Gi.compareVersion(yr(),"4.0.2"),_d=0<=Gi.compareVersion(yr(),"4.0.6"),Ad=0<=Gi.compareVersion(yr(),"4.0.8"),Td=0<=Gi.compareVersion(yr(),"4.0.12"),xd=0<=Gi.compareVersion(yr(),"4.0.16"),Id=0<=Gi.compareVersion(yr(),"4.0.18"),Pd=0<=Gi.compareVersion(yr(),"4.0.20"),Dd=0<=Gi.compareVersion(yr(),"4.1.0"),Od=0<=Gi.compareVersion(yr(),"4.1.2"),Md=0<=Gi.compareVersion(yr(),"4.1.6"),Ed=0<=Gi.compareVersion(yr(),"4.1.8"),jd=0<=Gi.compareVersion(yr(),"4.1.10"),Ld=0<=Gi.compareVersion(yr(),"4.1.12"),Nd=0<=Gi.compareVersion(yr(),"4.1.15"),Bd=0<=Gi.compareVersion(yr(),"4.1.16"),Fd=0<=Gi.compareVersion(yr(),"4.1.20"),Ud=0<=Gi.compareVersion(yr(),"4.1.22"),Rd=0<=Gi.compareVersion(yr(),"4.1.26"),Vd=0<=Gi.compareVersion(yr(),"4.1.28"),qd=0<=Gi.compareVersion(yr(),"4.1.32"),Qd=0<=Gi.compareVersion(yr(),"4.1.36"),Jd=e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e(e({getClipboardData:Wu,setClipboardData:Su,readAsDataURL:Au,readFileListFromClipBoard:_u,copyNativeImage:Tu,getAppVersion:vl,compare:hl,isNewWwapp:gl,quoteToDiscuss:nl,startConversation:tl,forwardFormsToWXWork:ol,forwardToConversion:il,notifyPush:rl,showDiscussWindow:cl,hideOneDiscussWindow:sl,destroyDiscussWindow:al,requestFullscreen:xu,exitFullscreen:Iu,addToDrive:Ou,selectFromWxDrive:Mu,jumpToDrive:Eu,wedriveUniversalEvent:ju,getPartyListOrUserList:Lu,getSubDepartments:Nu,openSupportPage:jl,selectContacts:Ru,viewProfile:Bu,getRecentContacts:Vu,searchContacts:qu,openUrl:ml,openInBrowser:_l,openInTab:yl,openAndJumpToMainPage:Sl,openFileInWedrive:kl,closeWindow:Cl,getWindowUrlParams:Ol,docLogin:Nl,getLoginCst:Ll,log:Bl,boardSelectContacts:function(e,n){e.invoke("wwapp.blackboard.selectContacts",vu(n))},showRobotProfile:function(e,n){e.invoke("wwapp.blackboard.showRobotProfile",vu(n))},addRobot:function(e,n){e.invoke("wwapp.blackboard.addRobot",vu(n))},forwardBlackboard:function(e,n){e.invoke("wwapp.blackboard.forwardBlackboard",vu(n))},jumpToConversation:function(e,n){e.invoke("wwapp.blackboard.jumpToConversation",vu(n))},monitorBlackboard:function(e,n){e.invoke("wwapp.blackboard.monitorBlackboard",vu(n))},getWeWorkFontConfig:function(e,n){e.invoke("wwapp.blackboard.getWeWorkFontConfig",vu(n))},showForwardDialogForBlackboard:function(e,n){e.invoke("wwapp.blackboard.showForwardDialogForBlackboard",vu(n))},getUserCountForWXDrive:function(e,n){e.invoke("wwapp.blackboard.getUserCountForWXDrive",vu(n))},readFileCardFromClipboard:function(e,n){e.invoke("wwapp.blackboard.readFileCardFromClipboard",vu(n))},selectContactsForWXDrive:function(e,n){e.invoke("wwapp.blackboard.selectContactsForWXDrive",vu(n))}},kd),Cd?{insertWxworkGroupChat:Fl,isInWxworkGroupChat:Ul,joinWxworkGroupChat:Rl,enterWxworkGroupChat:Vl,createWxworkNameCardSelf:ql,enterWxworkNameCard:Ql,canChatWithWxworkNameCard:Jl,joinWxworkCalender:zl,queryWxworkCalenderInfo:Hl,createWxworkCalender:Gl,selectWxworkCalenderList:Xl,viewDetailWxworkCalender:$l,openChatMessageDetail:Yl,createTransferedChatMessageInfo:Kl,getConversationList:Zl,getConversationsDetail:ed,getNoticeCount:nd,monitorDocConv:td,markAsRead:od,setConvTop:id,removeConv:rd,setNoticeType:ad,getTotalUnreadCount:ud}:{}),Gi.isMac()?{}:{openWecomSearch:Wl}),yd&&Gi.isWindows()?{timelineInited:ld}:{}),Wd?{queryDepartmentNames:vd,insertApp:function(e,n){e.invoke("wwapp.wedoc.insertApp",vu(n))},openMiniProgram:function(e,n){e.invoke("wwapp.wedoc.openMiniProgram",vu(n))},shareToWeixin:pd,isInstalledWeixinApp:wd}:{}),Wd?{openInWxworkBrowser:bl}:{}),Sd&&Gi.isMac()?{isDarkMode:hd,toggleMainPage:function(e,n){e.invoke("wwapp.wedoc.toggleMainPage",vu(n))}}:{}),_d?{queryLatestUnreadMsg:function(e,n){e.invoke("wwapp.wedoc.queryLatestUnreadMsg",vu(n))}}:{}),_d&&Gi.isMac()?{getDisplayFontSize:function(e,n){e.invoke("wwapp.wedoc.getDisplayFontSize",vu(n))}}:{}),Ad?{getRedPointMsgList:function(e,n){e.invoke("wwapp.wedoc.getRedPointMsgList",vu(n))}}:{}),Td&&Gi.isWindows()?{checkIsCurrentUser:function(n,t){var o;n.invoke("wwapp.wedoc.checkIsCurrentUser",vu(e(e({},t),{useOpenid:null!=(o=t.useOpenid)?o:Cc(t.userId)?void 0:1})))},getLastClickDocTabTime:function(e,n){e.invoke("wwapp.wedoc.getLastClickDocTabTime",vu(n))},getCurrentProcessMemory:function(e,n){e.invoke("wwapp.wedoc.getCurrentProcessMemory",vu(n))}}:{}),Td?{startMeeting:function(e,n){e.invoke("wwapp.wedoc.startMeeting",vu(n))},startGroupChat:function(e,n){e.invoke("wwapp.wedoc.startGroupChat",vu(n))},finishLoad:function(e,n){e.invoke("wwapp.wedoc.finishLoad",vu(n))}}:{}),xd?e(e({openContactProfile:function(e,n){e.invoke("wwapp.openContactProfile",vu(n))},openDefaultBrowser:function(e,n){e.invoke("wwapp.openDefaultBrowser",vu(n))},openEnterpriseContact:function(e,n){e.invoke("wwapp.openEnterpriseContact",vu(n))},downloadFile:function(e,n){e.invoke("wwapp.downloadFile",vu(n))},uploadFile:function(e,n){e.invoke("wwapp.uploadFile",vu(n))},setBlackBoardNavigationItem:function(e,n){e.invoke("wwapp.setBlackBoardNavigationItem",vu(n))},getAppInfo:function(e,n){e.invoke("wwapp.getAppInfo",vu(n))},disableWebviewBounce:function(e,n){e.invoke("wwapp.disableWebviewBounce",vu(n))},openLocation:function(e,n){e.invoke("wwapp.openLocation",vu(n))},selectLocation:function(e,n){e.invoke("wwapp.selectLocation",vu(n))},showAlert:function(e,n){e.invoke("wwapp.showAlert",vu(n))},previewImages:function(e,n){e.invoke("wwapp.previewImages",vu(n))},previewFile:function(e,n){e.invoke("wwapp.previewFile",vu(n))},readLocalCache:function(e,n){e.invoke("wwapp.readLocalCache",vu(n))},selectHomeSchoolNode:function(e,n){e.invoke("wwapp.selectHomeSchoolNode",vu(n))},showListDialog:function(e,n){e.invoke("wwapp.showListDialog",vu(n))},selectGroupChat:function(e,n){e.invoke("wwapp.selectGroupChat",vu(n))},notifyWebViewFinish:function(e,n){e.invoke("wwapp.journal.notifyWebViewFinish",vu(n))},shareToConversation:function(e,n){e.invoke("wwapp.journal.shareToConversation",vu(n))},didSubmitedJournalTemplate:function(e,n){e.invoke("wwapp.journal.didSubmitedJournalTemplate",vu(n))},onPageStatusChanged:function(e,n){e.invoke("wwapp.journal.onPageStatusChanged",vu(n))},jumpToJournalSetting:function(e,n){e.invoke("wwapp.journal.jumpToJournalSetting",vu(n))},didPublishWorkLog:function(e,n){e.invoke("wwapp.journal.didPublishWorkLog",vu(n))},getWorknoteChatData:function(e,n){e.invoke("wwapp.journal.getWorknoteChatData",vu(n))},selectWorknoteTime:function(e,n){e.invoke("wwapp.journal.selectWorknoteTime",vu(n))}},Gi.isWindows()?{selectCorpGroupContact:bd}:{}),{sendTemplateInviteCard:function(e,n){e.invoke("wwapp.journal.sendTemplateInviteCard",vu(n))},sendTemplateInviteCard4WeworkJournal:function(e,n){e.invoke("sendTemplateInviteCard",vu(n))},getWecomSetting:function(e,n){e.invoke("wwapp.wedoc.getWecomSetting",vu(n))},openNativeJournal:function(e,n){e.invoke("wwapp.wedoc.openNativeJournal",vu(n))},getLanguageSettings:function(e,n){e.invoke("wwapp.wedoc.getLanguageSettings",vu(n))}}):{}),Id?{selectCorpGroupContact:bd,getUserInfo:function(e,n){e.invoke("wwapp.wedoc.getUserInfo",vu(n))},timelineInited:ld,getMessageList:function(e,n){e.invoke("wwapp.wedoc.getMessageList",vu(n))},getReadedAnchor:function(e,n){e.invoke("wwapp.wedoc.getReadedAnchor",vu(n))},markConvAsRead:function(e,n){e.invoke("wwapp.wedoc.markConvAsRead",vu(n))},removeMessage:function(e,n){e.invoke("wwapp.wedoc.removeMessage",vu(n))},removeAllMessage:function(e,n){e.invoke("wwapp.wedoc.removeAllMessage",vu(n))},openWorkUrl:function(e,n){e.invoke("wwapp.wedoc.openWorkUrl",vu(n))},showAdvancedFunc:function(e,n){e.invoke("wwapp.showAdvancedFunc",vu(n))}}:{}),Id&&Gi.isWindows()?{getVisibilityState:function(e,n){e.invoke("wwapp.wedoc.getVisibilityState",vu(n))}}:{}),Pd?{isMailInTab:function(e,n){e.invoke("wwapp.wedoc.isMailInTab",vu(n))},openMailWritePage:function(e,n){e.invoke("wwapp.wedoc.openMailWritePage",vu(n))}}:{}),Dd?{checkIsDocBrowser:function(e,n){Gi.isMac()?Promise.resolve().then((function(){var e;return null==(e=n.success)?void 0:e.call(n,{isDocBrowser:/WeComCEF/i.test(Gi.getUserAgent())})})):e.invoke("wwapp.wedoc.checkIsDocBrowser",vu(n))}}:{}),Od?{selectWxworkMeetingList:function(e,n){e.invoke("wwapp.wedoc.selectWxworkMeetingList",vu(n))},viewDetailWxworkMeeting:function(e,n){e.invoke("wwapp.wedoc.viewDetailWxworkMeeting",vu(n))},enterWxworkMeeting:function(e,n){e.invoke("wwapp.wedoc.enterWxworkMeeting",vu(n))},joinWxworkMeeting:function(e,n){e.invoke("wwapp.wedoc.joinWxworkMeeting",vu(n))},openMeetingRecord:function(e,n){e.invoke("wwapp.wedoc.openMeetingRecord",vu(n))},hasWorkbenchAppId:function(e,n){e.invoke("wwapp.wedoc.hasWorkbenchAppId",vu(n))}}:{}),Od&&Gi.isMac()?{getDropFiles:function(e,n){e.invoke("wwapp.wedoc.getDropFiles",vu(n))}}:{}),Md?{getApplyInfo:function(n,t){n.invoke("wwapp.getApplyInfo",vu(e(e({},t),{success:function(e){var n,o;null!=e&&e.result?null!=(n=t.success)&&n.call(t,e.result):null!=(o=t.fail)&&o.call(t,e)}})))}}:{}),Ed?{getUserCount:function(e,n){e.invoke("wwapp.wedoc.getUserCount",vu(n))},sendDocTipsMessage:function(e,n){e.invoke("wwapp.wedoc.sendDocTipsMessage",vu(n))},sendMagicBoxMsg:function(e,n){e.invoke(Cu("wwqt.wedoc.emitEvent"),vu(n))},journalLoaded:function(e,n){e.invoke(Cu("wwqt.wedoc.journalLoaded"),vu(n))},formLoaded:function(e,n){e.invoke(Cu("wwqt.wedoc.formLoaded"),vu(n))},wedriveMessage:function(e,n){e.invoke(Cu("wwqt.wedoc.wedriveMessage"),vu(n))},checkWxworkAppNetwork:function(e,n){e.invoke("wwapp.wedoc.checkWxworkAppNetwork",vu(n))}}:{}),Ed&&Gi.isMac()?{getMacDeviceInfo:function(e,n){e.invoke("macDeviceInfo",vu(n))}}:{}),jd?{showTelAlert:function(n,t){n.invoke("wwapp2.wedoc.showTelAlert",vu(e({appid:200001},t)))},showMailWritePage:function(e,n){e.invoke("wwapp2.wedoc.showMailWritePage",vu(n))}}:{}),yu(Ld)?{forwardToDesktop:function(e,n){e.invoke(Cu("wwqt.wedoc.forwardToDesktop"),vu(n))}}:{}),yu(Bd)?{getWeworkInfo:function(e,n){var t=n.success;n.success=function(e){e.corpId=""+(e.corpId||""),null!=t&&t(e)},e.invoke(Cu("wwqt.wedoc.getWeworkInfo"),vu(n))}}:{}),yu(Fd)?{openMyDocListPage:function(e,n){e.invoke(Cu("wwqt.wedoc.openMyDocListPage"),vu(n))},setTabIconByDocType:function(e,n){e.invoke(Cu("wwqt.wedoc.setTabIconByDocType"),vu(n))}}:{}),Fd?{openSecurityApplication:function(e,n){e.invoke("wwapp2.wedoc.openSecurityApplication",vu(n))},setZoomLevel:function(e,n){e.invoke("wwapp2.setZoomLevel",vu(n))}}:{}),yu(Ud)?{uploadFileInWedrive:function(e,n){e.invoke(Cu("wwqt.wedoc.consumeDropFileInWedrive"),vu(n))},getProcessUsage:function(e,n){e.invoke(Cu("wwqt.wedoc.getProcessUsage"),vu(n))}}:{}),Rd?{selectConversations:function(n,t){var o=Uu({positionX:t.x,positionY:t.y}),i=o.positionX,r=o.positionY;mu("wwapp2.wedoc.selectConversations",n,e(e({max_count:500},t),{x:i,y:r}))},fetchConversationInfos:function(e,n){mu("wwapp2.wedoc.fetchConversationInfos",e,n)}}:{}),Vd?{selectSmartSheetForImport:function(e,n){e.invoke("wwapp2.wedoc.selectSmartSheetForImport",vu(n))},getImageFromMobile:function(e,n){e.invoke("wwapp2.wedoc.getImageFromMobile",vu(n))},getImageFromMobileByPath:function(e,n){e.invoke(Cu("wwqt.wedoc.getImageFromMobileByPath"),vu(n))},closeSelectConversationsWindow:function(e,n){mu("wwapp2.wedoc.closeSelectConversationsWindow",e,n)}}:{}),qd?{addToConvToolBar:function(e,n){e.invoke("wwapp2.wedoc.addToConvToolBar",vu(n))},doAppAuth:function(e,n){e.invoke("wwapp2.wedoc.doAppAuth",vu(n))},customerInfo:function(e,n){e.invoke("wwapp2.wedoc.customerInfo",vu(n))},smartsheetGetContext:function(e,n){e.invoke("wwapp2.wedoc.getContext",vu(n))}}:{}),Qd?{fetchCurrentConversation:function(e,n){mu("wwapp2.wedoc.fetchCurrentConversation",e,n)},openConvToolByDocId:function(e,n){e.invoke("wwapp2.wedoc.openConvToolByDocId",vu(n))},openConvToolDocWebView:function(e,n){e.invoke("wwapp2.wedoc.openConvToolDocWebView",vu(n))},addToGroupPanel:function(e,n){e.invoke("wwapp2.wedoc.addToGroupPanel",vu(n))},isChatroomMode:function(e,n){e.invoke("wwapp2.wedoc.isChatroomMode",vu(n))}}:{}),qd&&Gi.isWindows()?{isDarkMode:hd}:{}),Gd={getClipboardData:Wu,setClipboardData:Su,readAsDataURL:Au,readFileListFromClipBoard:_u,copyNativeImage:Tu,getAppVersion:vl,compare:hl,isNewWwapp:gl,quoteToDiscuss:nl,startConversation:tl,forwardFormsToWXWork:ol,forwardToConversion:il,notifyPush:rl,showDiscussWindow:cl,hideOneDiscussWindow:sl,destroyDiscussWindow:al,addToDrive:Ou,selectFromWxDrive:Mu,jumpToDrive:Eu,getPartyListOrUserList:Lu,getSubDepartments:Nu,openSupportPage:jl,selectContacts:Ru,viewProfile:Bu,getRecentContacts:Vu,searchContacts:qu,openUrl:ml,openInBrowser:_l,openInTab:yl,openAndJumpToMainPage:Sl,openFileInWedrive:kl,closeWindow:Cl,getWindowUrlParams:Ol,docLogin:Nl,log:Bl},Xd={getAppVersion:vl,compare:hl,isNewWwapp:gl},$d=Dr(_r()?Gd:Wr()?Jd:Xd,Hi.isWeWork),Hd=($d.docLogin&&($d.docLogin=Qr($d.docLogin)),jd&&($d.canShowSharePanel=el,$d.isSharePanelShowed=function(){return Ku}),jd&&($d.canUseNativeIframe=function(){return dr.isWxWorkQt&&dr.isWxWorkVersionAboveOrEqual("4.1.10")},$d.useNativeIframe=function(e,t){if(!e)return null;var o=t.onMessage,i=t.onClean,c=t.query,s=t.inject,a=t.targetName,u=void 0===a?"general_container":a,l=n(t,["onMessage","onClean","query","inject","scope","targetName"]);if(c){var d,f=new URL(e),p=f.searchParams;for(d in c)"object"===r(c[d])&&(c[d]=JSON.stringify(c[d]));new URLSearchParams(c).forEach((function(e,n){return p.has(n)?p.set(n,e):p.append(n,e)})),f.search=p.toString(),e=f.toString()}var w,v,h,g="",m=("function"==typeof s?g=encodeURIComponent("("+s.toString()+")()"):s&&(g=encodeURIComponent(s)),Date.now().toString()),b=u+"?"+new URLSearchParams({scope:t.scope||"",identifier:m,options:JSON.stringify(l),inject:g}),k=window.open(e,b);return k?(w=function(){window.__QtNativeIframe=void 0,window.removeEventListener("message",v)},v=function(e){o&&o(e),"https://doc.weixin.qq.com"!==e.origin&&"https://docs.qq.com"!==e.origin||"_QtNativeDestroyed_"===e.data&&(console.warn("receive _QtNativeDestroyed_"),i(),w())},window.__QtNativeIframe&&(console.error("__QtNativeIframe already exists, safetyClean"),window.__QtNativeIframe.safetyClean()),window.addEventListener("message",v),h={ref:k,identifier:m,safetyClean:w},window.__QtNativeIframe=h):null}),yu(Nd)&&($d.onEnterBackground=function(e){function n(n){var t,o,i;"magicbox://tdocs/container/enterBackground"===(null==(t=null==n?void 0:n.detail)?void 0:t.schema)&&(i=(null==(o=null==n?void 0:n.detail)?void 0:o.option)||{},e(i),$r.log("enterBackground",i))}return window.addEventListener("magicBoxEvent",n),function(){return window.removeEventListener("magicBoxEvent",n)}},$d.onEnterForeground=function(e){function n(n){var t,o,i;"magicbox://tdocs/container/enterForeground"===(null==(t=null==n?void 0:n.detail)?void 0:t.schema)&&(i=(null==(o=null==n?void 0:n.detail)?void 0:o.option)||{},e(i),$r.log("enterForeground",i))}return window.addEventListener("magicBoxEvent",n),function(){return window.removeEventListener("magicBoxEvent",n)}}),e(e(e(e(e(e(e(e(e(e(e(e({},$d),_r()?{onCompleteComment:ul,onUnreadCountChange:dl,onCloseDiscussWindow:pl,onBlurWedocsWindow:xl,onFocusWedocsWindow:Al,onUrlChange:Pl,offCompleteComment:ll,offUnreadCountChange:fl,offCloseDiscussWindow:wl,offBlurWedocsWindow:Il,offFocusWedocsWindow:Tl,offUrlChange:Dl}:{}),Wr()?{onUpdateWeWorkFontConfig:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().on("wwapp.blackboard.updateWeWorkFontConfig",e),[2]}}))}))},onBoardOpenPage:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().on("wwapp.blackboard.boardOpenPage",e),[2]}}))}))},onFocusBoardWindow:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().on("wwapp.blackboard.focusBoardWindow",e),[2]}}))}))},onBlurBoardWindow:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().on("wwapp.blackboard.blurBoardWindow",e),[2]}}))}))},offBlurBoardWindow:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().off("wwapp.blackboard.blurBoardWindow",e),[2]}}))}))},offBoardOpenPage:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().off("wwapp.blackboard.boardOpenPage",e),[2]}}))}))},offFocusBoardWindow:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().off("wwapp.blackboard.focusBoardWindow",e),[2]}}))}))},offUpdateWeWorkFontConfig:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().off("wwapp.blackboard.updateWeWorkFontConfig",e),[2]}}))}))},onCompleteComment:ul,onFullscreenChange:Pu,onUnreadCountChange:dl,onCloseDiscussWindow:pl,onBlurWedocsWindow:xl,onFocusWedocsWindow:Al,onUrlChange:Pl,offCompleteComment:ll,offFullscreenChange:Du,offUnreadCountChange:fl,offCloseDiscussWindow:wl,offBlurWedocsWindow:Il,offFocusWedocsWindow:Tl,offUrlChange:Dl}:{}),Cd?{onConversationChange:cd,offConversationChange:sd}:{}),yd?{onClickDocTab:Ml,offClickDocTab:El,onOpenDocInTimeline:dd,offOpenDocInTimeline:fd}:{}),Sd&&Gi.isMac()?{onDarkModeChange:gd,offDarkModeChange:md}:{}),_d&&Gi.isMac()?{onFontSizeDidChange:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.fontSizeDidChange",e),[2]}}))}))},offFontSizeDidChange:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.fontSizeDidChange",e),[2]}}))}))}}:{}),Ad&&Gi.isMac()?{onMainPageFloatingChange:function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.mainPageFloatingChange",e),[2]}}))}))},offMainPageFloatingChange:function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.mainPageFloatingChange",e),[2]}}))}))}}:{}),Id?{onSearchDocInTimeline:function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.searchDocInTimeline",e),[2]}}))}))},offSearchDocInTimeline:function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.searchDocInTimeline",e),[2]}}))}))},onMessageChange:function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.messageChange",e),[2]}}))}))},offMessageChange:function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.messageChange",e),[2]}}))}))}}:{}),Id&&Gi.isWindows()||yu(Ld&&Gi.isMac())?{onVisibilityChange:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().on("wwapp.wedoc.visibilityChange",e),[2]}}))}))},offVisibilityChange:function(e){return t(this,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().off("wwapp.wedoc.visibilityChange",e),[2]}}))}))}}:{}),Ud?{onDragFileEvent:function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().on(Cu("wwqt.wedoc.dragFileEvent"),e),[2]}}))}))},offDragFileEvent:function(e){return t(void 0,void 0,Promise,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,hr(Hi.isWeWork)];case 1:return n.sent().off(Cu("wwqt.wedoc.dragFileEvent"),e),[2]}}))}))}}:{}),qd&&Gi.isWindows()?{onDarkModeChange:gd,offDarkModeChange:md}:{})),zd=0<=Gi.compareVersion(Pr(),"2.6.15"),Kd=e(e({getClipboardData:Wu,setClipboardData:Su,readAsDataURL:Au,readFileListFromClipBoard:_u,copyNativeImage:Tu,getAppVersion:vl,compare:hl,isNewWwapp:gl,quoteToDiscuss:nl,startConversation:tl,forwardFormsToWXWork:ol,forwardToConversion:il,notifyPush:rl,showDiscussWindow:cl,hideOneDiscussWindow:sl,destroyDiscussWindow:al,requestFullscreen:xu,exitFullscreen:Iu,addToDrive:Ou,selectFromWxDrive:Mu,jumpToDrive:Eu,wedriveUniversalEvent:ju,getPartyListOrUserList:Lu,getSubDepartments:Nu,selectContacts:Ru,viewProfile:Bu,getRecentContacts:Vu,searchContacts:qu,openUrl:ml,openInBrowser:_l,openInTab:yl,openAndJumpToMainPage:Sl,openFileInWedrive:kl,closeWindow:Cl,getWindowUrlParams:Ol,docLogin:Nl,getLoginCst:Ll,log:Bl,insertWxworkGroupChat:Fl,isInWxworkGroupChat:Ul,joinWxworkGroupChat:Rl,enterWxworkGroupChat:Vl,createWxworkNameCardSelf:ql,enterWxworkNameCard:Ql,canChatWithWxworkNameCard:Jl,joinWxworkCalender:zl,queryWxworkCalenderInfo:Hl,createWxworkCalender:Gl,selectWxworkCalenderList:Xl,viewDetailWxworkCalender:$l,openChatMessageDetail:Yl,createTransferedChatMessageInfo:Kl,getConversationList:Zl,getConversationsDetail:ed,getNoticeCount:nd,monitorDocConv:td,markAsRead:od,setConvTop:id,removeConv:rd,setNoticeType:ad,getTotalUnreadCount:ud},Gi.isMac()?{}:{openWecomSearch:Wl}),{timelineInited:ld,queryDepartmentNames:vd,shareToWeixin:pd,isInstalledWeixinApp:wd,openInWxworkBrowser:bl}),Yd=Dr(zd?Kd:{getAppVersion:vl,compare:hl,isNewWwapp:gl},Hi.isWeWork),Zd=e(e({},Yd),{onCompleteComment:ul,onFullscreenChange:Pu,onUnreadCountChange:dl,onCloseDiscussWindow:pl,onBlurWedocsWindow:xl,onFocusWedocsWindow:Al,onUrlChange:Pl,offCompleteComment:ll,offFullscreenChange:Du,offUnreadCountChange:fl,offCloseDiscussWindow:wl,offBlurWedocsWindow:Il,offFocusWedocsWindow:Tl,offUrlChange:Dl,onConversationChange:cd,offConversationChange:sd,onClickDocTab:Ml,offClickDocTab:El,onOpenDocInTimeline:dd,offOpenDocInTimeline:fd}),ef=(Gi.compareVersion(yr(),"3.1.20"),Gi.compareVersion(yr(),"3.1.23"),Gi.compareVersion(yr(),"4.0.0"),Gi.compareVersion(yr(),"4.0.2"),Gi.compareVersion(yr(),"4.0.6"),{clean:as,isWeDriveEnabled:rc,chooseWeDriveFile:cc,multiChooseWeDriveFile:sc,chooseTencentOfficeFile:ac,getClipboardData:oc,setClipboardData:ic,fileDownload:dc,getAppVersion:pc,compare:wc,isNewWwapp:vc,openCamera:fc,quoteToDiscuss:uc,forwardToConversion:lc,showNativePanel:Ec,updatePanelConfig:Mc,initToolbarConfig:Pc,showNativeToolbar:Oc,updateToolbarConfig:Dc,setTitle:qc,showOnlineUserList:Qc,getCustomTopbarButtonConfig:os,onCustomTopbarButtonClick:rs,viewProfile:_c,onUnload:hc,selectPerson:Sc,openUrl:ls,popBack:ds,saveImage:ws,previewImage:ps,chooseImage:vs,setActionButtons:Lc,showMenuActions:Fc,showBottomActionSheet:Uc,updateActionButtons:Rc,showNativeToast:ms,notifyCommentActionToNative:bs,notifyEmojiCommentToNative:ks,allCommentPanelCountUpdated:Cs,showNativeAllCommentPanel:ys,launchCommentInput:Ws,showEmojiActionPanel:Ss,vibration:ea,updateAuthority:Ac,wdocsUpdateAuthority:Ac,getLoginCst:ta,docLogin:ra,log:ca,sendMagicBoxMsg:sa,getClientMutexLock:aa,mapDocumentVersion:ua,removeDocumentVersion:la,getOfflineLocalConfig:da,isOfflineBidAvailable:fa,preloadJsReady:va,manualSaveDocData:wa,notifyNative:pa,firstLoadFinished:ga,documentUrlReplace:ha,requestFocus:ma,insertWxworkGroupChat:Ns,isInWxworkGroupChat:Bs,joinWxworkGroupChat:Fs,enterWxworkGroupChat:Us,createWxworkNameCardSelf:Rs,enterWxworkNameCard:Vs,canChatWithWxworkNameCard:qs,joinWxworkCalender:$s,queryWxworkCalenderInfo:Xs,createWxworkCalender:Qs,selectWxworkCalenderList:Js,viewDetailWxworkCalender:Gs,openChatMessageDetail:zs,createTransferedChatMessageInfo:Hs,clearDocUnread:Is,showDiscussion:Ps,hideDiscussion:Ds,updateDiscussion:Os,showCollaboratorPanel:Tc,showNativeSingleCommentPanel:_s,hideNativeSingleCommentPanel:As,updateOnlineUserList:xc,notifyDocChange:Ts,updateMessageQuoteStatus:xs,insertApp:Ks,openMiniProgram:Ys,updateAuth:Ic,vibrateDevice:na,queryLatestUnreadMsg:Ms,queryConversationUnread:Es}),nf={clean:as,getClipboardData:oc,setClipboardData:ic,getAppVersion:pc,compare:wc,isNewWwapp:vc,quoteToDiscuss:uc,forwardToConversion:lc,setTitle:qc,viewProfile:_c,onUnload:hc,selectPerson:Sc,openUrl:ls,previewImage:ps,showNativeToast:ms,notifyCommentActionToNative:bs,notifyEmojiCommentToNative:ks,allCommentPanelCountUpdated:Cs,showNativeAllCommentPanel:ys,launchCommentInput:Ws,showEmojiActionPanel:Ss,vibration:ea,updateAuthority:Ac,docLogin:ra,log:ca},tf={getAppVersion:pc,compare:wc,isNewWwapp:vc,viewProfile:_c,openUrl:ls,previewImage:ps,getLoginCst:ta,docLogin:ra},of=Dr(Ar()?ef:Tr()?nf:tf,Hi.isWeWorkApp),rf=e(e(e({},of),{isWedocWebview:Ar}),Ar()?{addEventListener:gc,removeEventListener:mc,removeIconButtonClickEvent:ts,callbackMap:Gc,deleteCookie:Nr}:{}),cf=(kr()===Hi.isWeWorkApp&&!Ar()&&Tr()&&document.addEventListener("WeixinJSBridgeReady",(function(){var e,n;Object.keys(rf).forEach((function(e){var n;tf[e]||(null==(n=window.tdocs)?void 0:n[e])===rf[e]&&delete window.tdocs[e]})),null!=(n=null==(e=window.qmailBridge)?void 0:e.destroy)&&n.call(e),console.warn("no jsapi support for this wxwork mobile version")})),new Map);function sf(n,t){var o,i=e({},t);return"function"==typeof t.onclick&&((o=cf.get(t.id))&&o.func===t.onclick?i.onclick=o.callbackId:(i.onclick=n.callback(t.onclick),cf.set(t.id,{callbackId:i.onclick,func:t.onclick}))),i}function af(e,n){return n.map((function(n){return sf(e,n)}))}Object.defineProperty(df.prototype,"canUseNativeAndroid",{get:function(){var e;return(null==(e=window.mqq)?void 0:e.android)&&window._mqqWebViewJSInterface&&window._mqqWebViewJSInterface.invoke},enumerable:!1,configurable:!0}),df.prototype.JSApiCallback=function(e){var n,t,o,i=this.reqCallbacks.get(e.callbackId);i?(n=i.callback,t=i.command,o=i.startTime,n&&($r.debug("callback invokeNative-"+e.callbackId+"-"+t+"-"+(Date.now()-o)+"ms",this.canUseNativeAndroid,"response="+JSON.stringify(e)),n(e)),this.reqCallbacks.delete(e.callbackId)):$r.warn("callback invokeNative-"+e.callbackId+" reqCallback not found")},df.prototype.createReqSeq=function(){return this.currentSeqId++},df.prototype.invokeNative=function(e,n,t,o){var i=this.createReqSeq(),r=t.command;this.reqCallbacks.set(i,{callback:o,command:r,startTime:Date.now()}),$r.debug("start call invokeNative-"+i+"-"+r,e,n,r,this.canUseNativeAndroid,"request="+JSON.stringify(t)),t.callbackId=i,this.canUseNativeAndroid?this.invokeNativeAndroid(e,n,t):window.mqq&&window.mqq.invoke(e,n,t)},df.prototype.invokeNativeAndroid=function(e,n,t){var o="jsbridge://"+encodeURIComponent(e)+"/"+encodeURIComponent(n);t&&(o+="?p="+encodeURIComponent(JSON.stringify(t))),window._mqqWebViewJSInterface.invoke(o)},df.prototype.defaultOfflineCodeVersion=function(e,n){$r.debug("defaultOfflineCodeVersion-"+e),window.mqq&&window.mqq.invoke("docx","defaultOfflineCodeVersion",{type:e},(function(t){$r.debug("defaultOfflineCodeVersion-"+e),n&&n(t)}))};var uf,lf=df;function df(){this.currentSeqId=0,this.reqCallbacks=new Map}Gi.isServerSide()?uf=null:window.jsApi?uf=window.jsApi:((uf=new lf).invokeNative=uf.invokeNative.bind(uf),uf.invokeNativeAndroid=uf.invokeNativeAndroid.bind(uf),window.jsApi=uf,window.JSApiCallback||(window.JSApiCallback=uf.JSApiCallback.bind(uf)));var ff=uf;function pf(e,t,o,i){void 0===i&&(i="docx");var r=o.success,c=n(o,["success","fail"]);e.invoke(i,t,c,r)}var wf=Dr({getClipboardData:function(e,n){e.invoke("docx","readSystemClipboard",{},(function(e){var t;null!=(t=null==n?void 0:n.success)&&t.call(n,e)}))},setClipboardData:function(e,t){var o=t||{},i=o.success,r=n(o,["success","fail"]);e.invoke("docx","writeSystemClipboard",r,(function(e){null!=i&&i(e)}))},getAppVersion:function(e,n){var t;null!=(t=n.success)&&t.call(n,e.clientVersion)},updateAuthority:function(e,n){e.invoke("QQApi","updatePermission",{},n.success)},setWxWorkLogin:function(e,t){var o=t.success,i=n(t,["success","fail"]);e.invoke("docx","setWxWorkLogin",i,o)},compare:function(e,n){var t;null!=(t=n.success)&&t.call(n,Gi.compareVersion(e.clientVersion,n.version||""))},copyNativeImage:function(e,n){var t=n||{},o=t.x;e.invoke("docx","copyNativeImageByPosition",{x:o,y:t.y})},openCamera:function(e,n){e.invoke("docx","openCamera",{},(function(e){var t;e.url&&null!=(t=null==n?void 0:n.success)&&t.call(n,e)}))},checkCameraPermission:function(e,n){e.invoke("docx","cameraCheckPermission",{},(function(){var e;null!=(e=null==n?void 0:n.success)&&e.call(n,{})}))},getScreenSize:function(e,n){var t;t=n,e.invoke("docx","getNativeScreenSize",{},(function(e){var n;null!=(n=t.success)&&n.call(t,e)}))},getDeviceId:function(e,n){},setTitle:function(e,n){null!=e&&e.invoke("ui","setWebviewNaviTitle",{title:n.title})},showNativeHeader:function(e){e.invoke("titlebar","setState",{state:1})},hideNativeHeader:function(e){e.invoke("titlebar","setState",{state:0})},openUrl:function(e,n){e.ui.openUrl({url:n.url,target:Ki.Detail,style:1})},openInBrowser:function(e,n){e.publicAccount.openInExternalBrowser(n.url)},jumpNativeList:function(e,n){e.invoke("QQApi","jumpNativeList",n,n.callback)},saveImage:function(t,o){var i=o.success,r=n(o,["success","fail"]);Cr()===zi.Android?null!=ff&&ff.invokeNative("ui","savePublicImg",r,(function(n){null!=i&&i(e({data:n.result},n))})):t.invoke("ui","savePublicImg",r,i)},chooseImage:function(e,n){console.log(e,n),e.invoke("docx","multipleImagePicker",{max_count:n.max_count},(function(e){var t,o;0===e.retcode?null!=(t=n.success)&&t.call(n,e):null!=(o=n.fail)&&o.call(n,"",e.retcode)}))},showDialog:function(e,n){e.invoke("titlebar","showDialogById",sf(e,{id:n.id,event:n.event,msg:n.msg,btnText:n.btnText,onclick:n.onClick}))},setActionButtons:function(e,n){var t=af(e,n.buttons);e.invoke("titlebar","setActionButtons",{buttons:t})},updateActionButtons:function(e,n){var t=af(e,n.buttons);e.invoke("titlebar","updateActionButtonsById",{buttons:t})},popBack:function(e){e.invoke("ui","popBack")},setTitleButtons:function(e,t){t.success;var o=n(t,["success","fail"]);e.ui.setTitleButtons(o)},fileDownload:function(e,n){e.invoke("docx","fileDownload",n.url)},getZoomState:function(e,n){e.invoke("QQApi","getZoomState",{},n.success)},setZoomState:function(e,t){var o=t.success,i=n(t,["success","fail"]);e.invoke("QQApi","setZoomState",i,o)},logoutAccount:function(e,n){e.invoke("docx","logoutAccount",(function(){var e;null!=(e=n.success)&&e.call(n)}))},updateUndoRedoState:function(e,n){e.invoke("docx","updateUndoRedoState",{isUndoAvailable:n.isUndoAvailable,isRedoAvailable:n.isRedoAvailable},(function(){var e;null!=(e=n.success)&&e.call(n)}))},sendMagicBoxMsg:function(t,o){var i=o.success,r=n(o,["success","fail"]);t.invoke("magicbox","emitEvent",e({},r),i)},getClientMutexLock:function(e,t){var o=t.success,i=n(t,["success","fail"]);null!=ff&&ff.invokeNative("docx","clientMutexLock",i,(function(e){null!=o&&o(e)}))},mapDocumentVersion:function(e,n){var t,o,i;dr.isElectronTencentDocsClient?(null!=(o=null==(t=navigator.serviceWorker)?void 0:t.controller)&&o.postMessage({type:"preload:map-document-version",data:n}),null!=(i=n.success)&&i.call(n,{})):pf(e,"mapDocumentVersion",n)},removeDocumentVersion:function(e,n){var t,o,i;dr.isElectronTencentDocsClient?(null!=(o=null==(t=navigator.serviceWorker)?void 0:t.controller)&&o.postMessage({type:"preload:remove-document-version",data:n}),null!=(i=n.success)&&i.call(n,{})):pf(e,"removeDocumentVersion",n)},isOfflineBidAvailable:function(e,n){pf(e,"isOfflineBidAvailable",n)},getOfflineLocalConfig:function(e,n){pf(e,"getOfflineLocalConfig",n)},preloadJsReady:function(e,t){var o=t.success,i=n(t,["success","fail"]);null!=ff&&ff.invokeNative("docx","preloadJsReady",i,(function(e){null!=o&&o(e)}))},manualSaveDocData:function(e,n){pf(e,"manualSaveDocData",n)},notifyNative:function(e,n){pf(e,"notifyNative",n)},firstLoadFinished:function(e,t){var o=t.success,i=n(t,["success","fail"]);e.invoke("docx","firstLoadFinished",i,o)},updateNativeList:function(e,n){e.invoke("QQApi","updateNativeList",{target:n.target},n.success)},requestFocus:function(e,t){var o=t.success,i=n(t,["success","fail"]);e.invoke("docx","requestFocus",i,o)},clientDatabaseRequest:function(e,t){var o=t.success,i=n(t,["success","fail"]);null!=ff&&ff.invokeNative("docx","clientDatabaseRequest",i,(function(e){null!=o&&o(e)}))}},Hi.isTencentDocsApp),vf=e({},wf);function hf(t,o,i){var r=Date.now().toString(36)+Math.random().toString(36).substring(2),c="__MEETING_SDK_CALLBACK_"+r,s=i.success,a=i.fail,u=n(i,["success","fail"]),l=e(e({},o),{callId:r,callback:c,param:u});window[c]=function(e){if(delete window[c],"string"==typeof e)try{e=JSON.parse(e)}catch(e){}1===(null==e?void 0:e.code)?null!=s&&s(e.data||{}):null!=a&&a(e)},t.invokeNative("JSCallNative",l)}var gf,mf,bf,kf,Cf,yf,Wf,Sf,_f=0<=Gi.compareVersion((gf=Gi.getLowerCaseUserAgent().match(/app_version\/([0-9.]*)/))?gf[1]:"","3.13.0.0"),Af=Dr(e({closeLoading:function(e,n){hf(e,{module:"CommonPlugin",method:"HideLoading"},n)},docLogin:function(e,n){(function(){return t(this,void 0,Promise,(function(){return o(this,(function(e){return[2,window.wemeet.wework.getCurDocAuthData({pageType:1})]}))}))})().then((function(e){var t,o,i,r,c,s,a,u=e.authCode,l=e.meetingId,d=e.openId,f=e.docCode;u&&l&&d&&f?(o={code:u,meeting_id:l,openid:d,doc_code:f},i=n,r=Gr("disklogin_meeting"),c=r.reportSuccess,s=r.reportFail,a="/disklogin/login?from_tdocs_jsapi=1&product=2&from=33&f=json&"+Object.keys(o).map((function(e){return e+"="+encodeURIComponent(o[e])})).join("&"),fetch(a).then((function(e){return e.json()})).then((function(e){var n,t,o,r;0===(null==(n=null==e?void 0:e.head)?void 0:n.ret)?(null!=(t=null==i?void 0:i.success)&&t.call(i,e),c()):(null!=(o=null==i?void 0:i.fail)&&o.call(i,e),s(e),qr({url:a,code:(null==(r=null==e?void 0:e.head)?void 0:r.ret)||-1,scene:"backendError"}))})).catch((function(e){var n;null!=(n=null==i?void 0:i.fail)&&n.call(i,e),s(null==e?void 0:e.message)}))):null!=(t=n.fail)&&t.call(n,{err_msg:"need meeting_id、openid、authCode、docCode",authCode:u,meetingId:l,openId:d,docCode:f})})).catch((function(e){var t;null!=(t=n.fail)&&t.call(n,e)}))},setDocTitle:function(e,n){hf(e,{module:"DocSharePlugin",method:"SetDocTitle"},n)}},_f?{enableRecordRect:function(e,n){hf(e,{module:"WebAppSharePlugin",method:"EnableRecordRect"},n)}}:{}),Hi.isTencentMeeting),Tf=(bf=kr(),kf=Cr(),(e=>{if(!wr)if(document.getElementById("tdocsJSScript"))fr=Promise.resolve();else{var n=document.createElement("script");switch(n.id="tdocsJSScript",n.crossOrigin="anonymous",e){case Hi.IsQQ:case Hi.isQQMiniProgram:case Hi.isTencentDocsApp:n.src=Di;break;case Hi.isElectronTencentDocsClient:return fr=Promise.resolve();case Hi.isWXh5:n.src=Oi;break;case Hi.isWeWork:if(Ir())n.src=Ei;else if(_r()){if(!jr())return fr=Promise.resolve();n.src=Li}else{if(!Wr())return console.error("no jsapi support for this wxwork version"),fr=Promise.resolve();n.src=Ei}break;case Hi.isWeWorkApp:if(Ar())n.src=Mi;else{if(!Tr())return console.error("no jsapi support for this wxwork mobile version"),fr=Promise.resolve();if(!jr())return fr=Promise.resolve();n.src=ji}break;case Hi.isTencentMeeting:window.tencentMeetingSDK=pr.getInstance(),n.src=Ni}if(Gi.isMobile()&&"loading"===document.readyState){try{document.write(n.outerHTML)}catch(e){console.error("document.write error",e)}if(document.getElementById("tdocsJSScript"))return fr=Promise.resolve()}fr=new Promise((function(e,t){n.onload=function(){console.error("--------资源加载成功"),e()},n.onerror=function(){console.error("--------资源加载失败"),t()},(null!==document.head?document.head:document.body).appendChild(n)}))}})(bf),(mf={})[Hi.isWeWork]=Ir()?Zd:Hd,mf[Hi.isWeWorkApp]=Ir()?rf:wu,mf[Hi.isTencentDocsApp]=vf,mf[Hi.isElectronTencentDocsClient]=vf,mf[Hi.isQQMiniProgram]=vf,mf[Hi.IsQQ]=vf,mf[Hi.isWXh5]={},mf[Hi.isTencentMeeting]=Af,mf[Hi.UNKNOW]={},Cf=mf[bf],Gi.isServerSide()||setTimeout((function(){document.dispatchEvent(new CustomEvent("tdocsReady"))})),Object.assign({environmentType:bf,platform:kf,version:"1.109.0"},Cf));return Sf=Tf,kr()===Hi.isWeWork&&Gi.isWindows()&&Wr()&&Ai()===Ti&&setTimeout((function(){var e;null!=(e=Sf.checkIsDocBrowser)&&e.call(Sf).then((function(e){e.isDocBrowser||Object.keys(Jd).forEach((function(e){Sf[e]&&!Xd[e]&&delete Sf[e]}))}))}),0),yf=Tf,kr()!==Hi.isWeWorkApp||Ar()||xr()||!Tr()||document.addEventListener("WeixinJSBridgeReady",(function(){Object.keys(lu).forEach((function(e){delete yf[e]}));var e,n,t=Dr(du,Hi.isWeWorkApp);t.docLogin&&(t.docLogin=Qr(t.docLogin)),Object.keys(t).forEach((function(e){yf[e]=t[e]})),null!=(n=null==(e=window.qmailBridge)?void 0:e.destroy)&&n.call(e),console.warn("tdocs jsapi switch to wxwork normal webview")})),kr()!==Hi.isWeWorkApp||!Ar()||xr()||Gi.isServerSide()||null!=(Wf=window.magicBox)&&Wf.start||!yf.getCustomTopbarButtonConfig||yf.getCustomTopbarButtonConfig(),Tf}));