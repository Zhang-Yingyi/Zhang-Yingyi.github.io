(self.webpackChunksheet=self.webpackChunksheet||[]).push([["38389"],{883446:function(e,n,t){var r;window,e.exports=function(){var e=[function(e,n){e.exports=t(997420)},function(e,n,t){"use strict";var r,o,i,u,c,a;t.d(n,"c",function(){return r}),t.d(n,"b",function(){return o}),t.d(n,"a",function(){return i}),(u=r||(r={})).DOC_SID="DOC_SID",u.SID="SID",u.UID="uid",u.UID_KEY="uid_key",u.USER_TYPE="utype",(c=o||(o={})).P_LONG_UIN="p_luin",c.P_LONG_SKEY="p_lskey",c.P_UIN="p_uin",c.P_SKEY="p_skey",(a=i||(i={})).UID="tdoc_uid",a.SKEY="wedoc_skey"},function(e,n){e.exports=t(694350)},function(e,n){e.exports=t(766123)},function(e,n,t){"use strict";t.r(n),t.d(n,"getUid",function(){return c}),t.d(n,"getNowUserId",function(){return a}),t.d(n,"isLogin",function(){return s}),t.d(n,"getSid",function(){return l}),t.d(n,"loginType",function(){return f}),t.d(n,"checkWeWork",function(){return d});var r=t(2),o=t(0),i=t(1);function u(){return location.hostname===(null===r.npmConfig||void 0===r.npmConfig?void 0:r.npmConfig.WECOM_DOMAIN)||"doc.weixin.qq.com"}function c(){var e,n,t;return(null==(e=window.global_multi_user)?void 0:e.uid)||(null==(t=null==(n=window.clientVars)?void 0:n.userInfo)?void 0:t.uid)||Object(o.getCookie)("uid")||(u()?Object(o.getCookie)(i.a.UID):"")}function a(){return window.nowUserIndex||c()}function s(){return!!(Object(o.getCookie)(i.c.UID)&&Object(o.getCookie)(i.c.UID_KEY)||Object(o.getCookie)(i.c.DOC_SID)||Object(o.getCookie)(i.c.SID)||Object(o.getCookie)(i.b.P_UIN)&&Object(o.getCookie)(i.b.P_SKEY)||Object(o.getCookie)(i.b.P_LONG_UIN)&&Object(o.getCookie)(i.b.P_LONG_SKEY))||!(!u()||!Object(o.getCookie)(i.a.SKEY))}function l(){var e,n;return null!=(n=null!=(e=Object(o.getCookie)(i.c.DOC_SID))?e:Object(o.getCookie)(i.c.SID))?n:""}function f(){var e,n=Object(o.getCookie)(i.c.USER_TYPE);return(null==(e=window.global_multi_user)?void 0:e.utype)||n}function d(){return"ww"===f()}},function(e,n){e.exports=t(21795)},function(e,n){e.exports=t(384341)},function(e,n){e.exports=t(126713)},function(e,n){e.exports=t(352669)},function(e,n){e.exports=t(795591)},function(e,n){e.exports=t(204816)},function(e,n){e.exports=t(737033)},function(e,n){e.exports=t(430327)},function(e,n){e.exports=t(815944)},function(e,n,t){"use strict";t.r(n),t.d(n,"isMultiLoginGray",function(){return V}),t.d(n,"checkMultiLoginGrayAsync",function(){return H}),t.d(n,"mobileIsMultiLoginGray",function(){return F}),t.d(n,"mobileCheckMultiLoginGrayAsync",function(){return B}),t.d(n,"quickQQLoginAsync",function(){return G}),t.d(n,"quickQQLogin",function(){return K}),t.d(n,"getUid",function(){return X}),t.d(n,"getNowUserId",function(){return Y}),t.d(n,"isLogin",function(){return J}),t.d(n,"loginType",function(){return z}),t.d(n,"getLoginType",function(){return Z}),t.d(n,"getUtype",function(){return ee}),t.d(n,"inWeWork",function(){return en});var r,o=t(4),i=t(3),u=t.n(i),c=t(6),a=t.n(c),s=t(0),l=t(11),f=t.n(l),d=t(7),p=t.n(d),g=t(8),h=t.n(g),w=t(2),v=t.n(w),m=t(12),b=t.n(m),y=t(13),O=t.n(y),P=t(1),A=function(e,n,t,r){return new(t||(t=Promise))(function(o,i){function u(e){try{a(r.next(e))}catch(e){i(e)}}function c(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var n;e.done?o(e.value):((n=e.value)instanceof t?n:new t(function(e){e(n)})).then(u,c)}a((r=r.apply(e,n||[])).next())})},x=function(e){return e},E=function(){var e,n,t;return Object(s.getCookie)(P.c.UID)||(null==(e=window.global_multi_user)?void 0:e.uid)||(null==(t=null==(n=window.clientVars)?void 0:n.userInfo)?void 0:t.uid)},k=function(){function e(){p()(this,e),this.url=(null===w.npmConfig||void 0===w.npmConfig?void 0:w.npmConfig.TOGGLE_PROXY_URL)||"https://service-4y7r0fta-1251316161.gz.apigw.tencentcs.com/release/toggleProxy-1613409159",this.productEn="tdocs_manager",this.productKey="ab1ef06b-d248-4d99-b937-e18af1b82d14",this.productId="698ba977-c8d4-47cb-bf51-b79b305e38d4",this.version="1.0.1",this.moduleId="219"}return h()(e,[{key:"isEnabled",value:function(e,n){return A(this,void 0,void 0,u.a.mark(function t(){var r,o,i,c,a,s;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.productId,o=this.productEn,i=this.moduleId,c=this.version,a={productEn:o,productKey:this.productKey,toggleKey:e,productId:r,version:c,moduleId:i,data:JSON.stringify(n)},t.next=4,b.a.post(this.url,O.a.stringify(a));case 4:if(!(s=t.sent).data||0!==s.data.retCode){t.next=7;break}return t.abrupt("return",s.data.isEnabled);case 7:return t.abrupt("return",!1);case 8:case"end":return t.stop()}},t,this)}))}}]),e}(),_=function(){function e(n){var t=this,r=n.toggleAPI,o=n.toggleKey,i=n.handlerMap,c=n.localStorageKey;p()(this,e),this.checkMultiLoginGrayAsync=function(e){return A(t,void 0,void 0,u.a.mark(function n(){var t,r,o,i,c,a,s,l,f;return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return null==(r=null==(t=this.handlerMap)?void 0:t.checkMultiLoginGrayAsync)||r.call(t),void 0===e&&(e=E()||"0"),s=this._getDevContext(),l=Object.assign({userId:e},s),n.next=6,this.toggleAPI.isEnabled(this.toggleKey,l);case 6:if(!0!==(f=n.sent)){n.next=10;break}return null==(i=null==(o=this.handlerMap)?void 0:o.isEnabledTrue)||i.call(o),n.abrupt("return",this._enterGray(e));case 10:if(!1!==f){n.next=14;break}return null==(a=null==(c=this.handlerMap)?void 0:c.isEnabledFalse)||a.call(c),n.next=14,this._checkAllUserGrayState(e);case 14:case"end":return n.stop()}},n,this)}))},this.isMultiLoginGray=function(){var e,n,r,o,i,u=t._getLocalHashMap(),c=[];for(var a in u)c.push(u[a]);var l=0!==c.length&&c.every(x),f=null!=(e=Object(s.getCookie)(P.c.DOC_SID))?e:Object(s.getCookie)(P.c.SID);return l?null==(r=null==(n=t.handlerMap)?void 0:n.isGrayTrue)||r.call(n):null==(i=null==(o=t.handlerMap)?void 0:o.isGrayFalse)||i.call(o),l||!!f},this.toggleAPI=r,this.toggleKey=o,this.handlerMap=i,this.localStorageKey=c}return h()(e,[{key:"_getLocalHashMap",value:function(){var e=localStorage.getItem(this.localStorageKey);return e&&(e=JSON.parse(e)),e||{}}},{key:"_setLocalHashMap",value:function(e){e&&localStorage.setItem(this.localStorageKey,JSON.stringify(e))}},{key:"_enterGray",value:function(e){void 0===e&&(e="0");var n=f()({},"".concat(e),!0),t=this._getLocalHashMap();this._setLocalHashMap(Object.assign(Object.assign({},t),n))}},{key:"_checkAllUserGrayState",value:function(e){return A(this,void 0,void 0,u.a.mark(function e(){var n,t,r,o,i;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Object.keys(this._getLocalHashMap()),t=[],r=0;case 4:if(!(r<n.length)){e.next=13;break}return o={userId:n[r]},e.next=8,this.toggleAPI.isEnabled(this.toggleKey,o);case 8:i=e.sent,t.push(i);case 10:r++,e.next=4;break;case 13:if(!(0!==t.length&&t.every(x))){e.next=16;break}return e.abrupt("return");case 16:case"end":return e.stop()}},e,this)}))}},{key:"_getDevContext",value:function(){var e=Object(s.getCookie)("dev_route_id"),n={};return e&&(n.properties={dev_route_id:e,fd:Object(s.getCookie)("fd")||"webserver"}),n}}]),e}(),I=function(e){var n;try{null==(n=null==window?void 0:window.AlloyReport)||n.zzsValue({attrid:e,value:1})}catch(e){console.warn(e)}},C=new k,S=t(9),q=t(10),D=function(e,n,t,r){return new(t||(t=Promise))(function(o,i){function u(e){try{a(r.next(e))}catch(e){i(e)}}function c(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var n;e.done?o(e.value):((n=e.value)instanceof t?n:new t(function(e){e(n)})).then(u,c)}a((r=r.apply(e,n||[])).next())})},j=v.a.getConfig("runtime.domainName")||"docs.qq.com",T="https://".concat(j,"/cgi-bin/online_docs/user_info"),M="https://".concat(j,"/cgi-bin/api/account-list"),R=t(5);function W(e,n){var t=e.split("?");if(n=Array.isArray(n)?n:[n],t.length>=2){for(var r=t[1].split(/[&;]/g),o=0,i=n.length;o<i;o++)for(var u="".concat(encodeURIComponent(n[o]),"="),c=r.length-1;c>=0;c--)-1!==r[c].lastIndexOf(u,0)&&r.splice(c,1);return t[0]+(r.length>0?"?".concat(r.join("&")):"")}return e}var $=(r||(r=new _({toggleAPI:C,toggleKey:"PC_multi_login",handlerMap:{isGrayTrue:function(){I("pc_multi_gray_true")},isGrayFalse:function(){I("pc_multi_gray_false")},isEnabledTrue:function(){I("pc_multi_endabled_true")},isEnabledFalse:function(){I("pc_multi_endabled_false")},checkMultiLoginGrayAsync:function(){I("pc_multi_check_multi_login")}},localStorageKey:"multi-login-gray"})),r),U=function(){return $.isMultiLoginGray()};function Q(){var e=Object(R.getQuery)("jumpuin");return new Promise(function(n,t){var r;(r=parseInt(e),D(void 0,void 0,void 0,u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){var t={xsrf:Object(q.getXsrf)()};Object(S.ajaxGet)({url:M,param:t,success:function(t){if(0===t.retcode){var o=t.data,i=!1;null==o||o.forEach(function(n){if(n.uin===r&&"qq"===n.uType)return e(!0),void(i=!0)}),i||n(!1)}n(!1)},error:function(){n(!1)}})}));case 1:case"end":return e.stop()}},e)}))).then(function(e){n(e)}).catch(function(){t(!1)})})}function L(){var e=Object(R.getQuery)("jumpuin"),n=Object(s.getCookie)("utype"),t=Object(s.getCookie)("p_luin")||Object(s.getCookie)("p_uin"),r=t?t.replace(/^[o0]+/i,""):null;return new Promise(function(t,o){"qq"===n&&e==r?D(void 0,void 0,void 0,u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){var t={xsrf:Object(q.getXsrf)()};Object(S.ajaxGet)({url:T,param:t,success:function(t){0===t.retcode?e(!0):n(!1)},error:function(){n(!1)}})}));case 1:case"end":return e.stop()}},e)})).then(function(e){if(e){console.error("jump uin already login");var n=W(window.location.href,"jumpuin");window.history.replaceState(window.history.state,null,n)}t(e)}).catch(function(){o(!1)}):o(!1)})}function N(){return!(a.a.isMobilePhone||a.a.isAndroidPad||!Object(R.getQuery)("jumpuin"))}var V=function(){return!0},H=function(){return new Promise(function(e){return e(!0)})},F=function(){return!0},B=function(){return new Promise(function(e){return e(!0)})},G=function(){var e,n,t,r;return e=this,n=void 0,t=void 0,r=u.a.mark(function e(){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=U(),!N()){e.next=11;break}if(!n){e.next=8;break}return e.next=5,Q();case 5:case 10:return e.abrupt("return",e.sent);case 8:return e.next=10,L();case 11:return e.abrupt("return",!0);case 12:case"end":return e.stop()}},e)}),new(t||(t=Promise))(function(o,i){function u(e){try{a(r.next(e))}catch(e){i(e)}}function c(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var n;e.done?o(e.value):((n=e.value)instanceof t?n:new t(function(e){e(n)})).then(u,c)}a((r=r.apply(e,n||[])).next())})},K=function(e){var n=U();N()&&(n?Q().then(function(n){if(n){console.error("jump uin already login");var t=W(window.location.href,"jumpuin");window.history.replaceState(null,"",t)}e&&e(n)}).catch(function(n){e&&e(!1)}):L().then(function(n){e&&e(n)}).catch(function(){e&&e(!1)}))},X=o.getUid,Y=o.getNowUserId,J=o.isLogin,z=o.loginType,Z=z,ee=z,en=o.checkWeWork}],n={};function r(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=n,r.d=function(e,n,t){r.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,n){if(1&n&&(e=r(e)),8&n||4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(r.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)r.d(t,o,(function(n){return e[n]}).bind(null,o));return t},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="",r(r.s=14)}()},694114:function(e,n,t){"use strict";t.d(n,{TX:function(){return u},X4:function(){return c},Ym:function(){return i},y8:function(){return a}});var r,o,i,u,c="AppBitShiftToggle",a=new RegExp("".concat(c,"/(\\d+)"));(r=i||(i={}))[r.fullOfflineModeAvailable=1]="fullOfflineModeAvailable",r[r.nativeDatabaseAvailable=2]="nativeDatabaseAvailable",r[r.nativeDatabaseWillDeprecated=4]="nativeDatabaseWillDeprecated",(o=u||(u={}))[o.nativeDatabaseAndFullOfflineModeAvailable=2]="nativeDatabaseAndFullOfflineModeAvailable"},384341:function(e,n,t){"use strict";t.r(n),t.d(n,{UserAgent:function(){return i},compareVersion:function(){return o.yC},getVersionFromUA:function(){return o.H7}});var r=t(137084),o=t(267410),i=function(){function e(e){void 0===e&&(e=(0,o.ij)());var n=this;this.getAndroidVersion=function(){return r.dl(n.userAgent)},this.isAndroidVersionAboveOrEqual=function(e){return r.Ez(e,n.userAgent)},this.getHarmonyVersion=function(){return r.EA(n.userAgent)},this.isHarmonyVersionAboveOrEqual=function(e){return r.J3(e,n.userAgent)},this.getIOSVersion=function(){return r.oK(n.userAgent)},this.isIOSVersionAboveOrEqual=function(e){return r.$M(e,n.userAgent)},this.getPCQQBrowserVersion=function(){return r.H2(n.userAgent)},this.isPCQQBrowserVersionAboveOrEqual=function(e){return r.uw(e,n.userAgent)},this.getMobileQQBrowserVersion=function(){return r.IR(n.userAgent)},this.isMobileQQBrowserVersionAboveOrEqual=function(e){return r.K1(e,n.userAgent)},this.getChromeVersion=function(){return r.vu(n.userAgent)},this.isChromeVersionAboveOrEqual=function(e){return r.Br(e,n.userAgent)},this.getSafariVersion=function(){return r.Rl(n.userAgent)},this.isSafariVersionAboveOrEqual=function(e){return r.AM(e,n.userAgent)},this.getFirefoxVersion=function(){return r.hY(n.userAgent)},this.isFirefoxVersionAboveOrEqual=function(e){return r.Gf(e,n.userAgent)},this.getWeChatVersion=function(){return r.C9(n.userAgent)},this.isWeChatVersionAboveOrEqual=function(e){return r.SA(e,n.userAgent)},this.isWxWorkCEFVersionAboveOrEqual=function(e){return r.PF(e,n.userAgent)},this.getWxDriveVersion=function(){return r.mQ(n.userAgent)},this.isWxDriveVersionAboveOrEqual=function(e){return r.st(e,n.userAgent)},this.getWxWorkVersion=function(){return r.Vm(n.userAgent)},this.isWxWorkVersionAboveOrEqual=function(e){return r.vs(e,n.userAgent)},this.getWxWorkPrivateVersion=function(){return r.bN(n.userAgent)},this.isWxWorkPrivateVersionAboveOrEqual=function(e){return r.Gp(e,n.userAgent)},this.getQQVersion=function(){return r.Ev(n.userAgent)},this.isQQVersionAboveOrEqual=function(e){return r.d5(e,n.userAgent)},this.getTimVersion=function(){return r.Rb(n.userAgent)},this.isTimVersionAboveOrEqual=function(e){return r.gI(e,n.userAgent)},this.getTencentDocsAppVersion=function(){return r.x6(n.userAgent)},this.isTencentDocsAppVersionAboveOrEqual=function(e){return r.ZB(e,n.userAgent)},this.getPCTencentDocsClientVersion=function(){return r._u(n.userAgent)},this.isPCTencentDocsClientVersionAboveOrEqual=function(e){return r.eN(e,n.userAgent)},this.getElectronTencentDocsClientVersion=function(){return r.zy(n.userAgent)},this.isElectronTencentDocsClientVersionAboveOrEqual=function(e){return r.m9(e,n.userAgent)},this.getBitToggleSettings=function(e){return r.KR(e)},Object.defineProperty(this,"userAgent",{value:e,writable:!1})}return Object.defineProperty(e.prototype,"isMobile",{get:function(){return r.tq(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMobilePhone",{get:function(){return r.p(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isIPhone",{get:function(){return r.IN(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isIPad",{get:function(){return r.zc(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isAndroidPhone",{get:function(){return r.$b(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isAndroidPad",{get:function(){return r.Q7(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHarmonyPhone",{get:function(){return r.d1(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHarmonyPad",{get:function(){return r.hi(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHarmonyPC",{get:function(){return r.n6(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPC",{get:function(){return r.Ro(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMac",{get:function(){return r.V5(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isIPadEmulatedMac",{get:function(){return r.QY(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isAndroid",{get:function(){return r.Dt(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHarmony",{get:function(){return r.aR(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isIOS",{get:function(){return r.gn(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWindows",{get:function(){return r.ED(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWindowsUWP",{get:function(){return r.Xw(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLinux",{get:function(){return r.IJ(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLinuxKylin",{get:function(){return r.O7(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLinuxUOS",{get:function(){return r.VA(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPCQQBrowser",{get:function(){return r.J$(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMobileQQBrowser",{get:function(){return r.I0(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isQQBrowser",{get:function(){return r.z6(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHarmonyBrowser",{get:function(){return r.iG(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isChrome",{get:function(){return r.i7(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSafari",{get:function(){return r.G6(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isIE",{get:function(){return r.w1(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isOldEdge",{get:function(){return r.UT(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isChromiumEdge",{get:function(){return r.tN(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFirefox",{get:function(){return r.vU(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWeChat",{get:function(){return r.e3(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWxWork",{get:function(){return r.ow(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWxWorkQt",{get:function(){return r.ez(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWxWorkCustom",{get:function(){return r.zZ(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWxWorkCEF",{get:function(){return r.ZR(this.userAgent)},enumerable:!1,configurable:!0}),e.prototype.getWxWorkCEFVersion=function(){return r.AO(this.userAgent)},Object.defineProperty(e.prototype,"isWxWorkPrivate",{get:function(){return r.i4(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWxDrive",{get:function(){return r.w6(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isQQ",{get:function(){return r.GP(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isQQForGooglePlay",{get:function(){return r.Ep(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTim",{get:function(){return r.Of(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPCTim",{get:function(){return r.yQ(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTimOrQQ",{get:function(){return r.xB(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTimOrQQFamily",{get:function(){return r.J0(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isQQDesktopDocsClient",{get:function(){return r.LP(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isQQMobileDocsClient",{get:function(){return r.dm(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMiniProgram",{get:function(){return r.C0(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWxMiniProgram",{get:function(){return r.Ks(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isQQMiniProgram",{get:function(){return r.gP(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTencentDocsApp",{get:function(){return r.VJ(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPCTencentDocsClient",{get:function(){return r.Gk(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPCTencentDocsApp",{get:function(){return r.Rg(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isElectronTencentDocsClient",{get:function(){return r.nK(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMacAppStoreTencentDocsClient",{get:function(){return r.BP(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWeiYunApp",{get:function(){return r.T4(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWatermarkApp",{get:function(){return r.xT(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSouGou",{get:function(){return r.ab(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTencentMeeting",{get:function(){return r.ag(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWxWorkTencentMeeting",{get:function(){return r.X5(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTencentMeetingRooms",{get:function(){return r.UQ(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSupportNativeDatabase",{get:function(){return r.OB(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSupportFullOfflineMode",{get:function(){return r.QE(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isNativeDatabaseWillDeprecated",{get:function(){return r.fw(this.userAgent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isYuanBao",{get:function(){return r.pi(this.userAgent)},enumerable:!1,configurable:!0}),e}();n.default=new i},137084:function(e,n,t){"use strict";t.d(n,{$A:function(){return x},$M:function(){return _},$b:function(){return s},AM:function(){return G},AO:function(){return ec},BP:function(){return eN},Br:function(){return H},C0:function(){return eC},C9:function(){return en},Dt:function(){return v},EA:function(){return O},ED:function(){return I},Ep:function(){return em},Ev:function(){return eb},Ez:function(){return b},G6:function(){return F},GP:function(){return ev},Gf:function(){return Z},Gk:function(){return eM},Gp:function(){return ew},H2:function(){return T},I0:function(){return R},IJ:function(){return S},IN:function(){return c},IR:function(){return W},J$:function(){return j},J0:function(){return ek},J3:function(){return A},K1:function(){return $},KR:function(){return eY},Ks:function(){return eS},LP:function(){return e_},O7:function(){return q},OB:function(){return eJ},Of:function(){return eO},PF:function(){return ea},Q7:function(){return l},QE:function(){return ez},QY:function(){return w},Rb:function(){return eA},Rg:function(){return eR},Rl:function(){return B},Ro:function(){return g},SA:function(){return et},T4:function(){return eV},UQ:function(){return eX},UT:function(){return X},V5:function(){return h},VA:function(){return D},VJ:function(){return eD},Vm:function(){return ep},X5:function(){return eK},Xw:function(){return C},ZB:function(){return eT},ZR:function(){return eu},_u:function(){return eW},aR:function(){return y},ab:function(){return eF},ag:function(){return eB},bN:function(){return eh},d1:function(){return f},d5:function(){return ey},dl:function(){return m},dm:function(){return eI},e3:function(){return ee},eN:function(){return e$},ez:function(){return eo},fw:function(){return eZ},gI:function(){return ex},gP:function(){return eq},gn:function(){return E},hY:function(){return z},hh:function(){return P},hi:function(){return d},i4:function(){return es},i7:function(){return L},iG:function(){return Q},m9:function(){return eL},mQ:function(){return ef},n6:function(){return p},nK:function(){return eU},oK:function(){return k},ow:function(){return er},p:function(){return u},pi:function(){return eG},st:function(){return ed},tN:function(){return Y},tq:function(){return i},uw:function(){return M},vU:function(){return J},vs:function(){return eg},vu:function(){return V},w1:function(){return K},w6:function(){return el},x6:function(){return ej},xB:function(){return eE},xT:function(){return eH},yQ:function(){return eP},z6:function(){return U},zZ:function(){return ei},zc:function(){return a},zy:function(){return eQ}});var r=t(694114),o=t(267410),i=(0,o.c$)(function(e){return/(mobile)/i.test(e)||l(e)||d(e)}),u=(0,o.c$)(function(e){return/(mobile)/i.test(e)&&!a(e)}),c=(0,o.c$)(function(e){return/(iphone)/i.test(e)}),a=(0,o.c$)(function(e){return/(ipad)/i.test(e)}),s=(0,o.c$)(function(e){return/(mobile)/i.test(e)&&v(e)}),l=(0,o.c$)(function(e){return(!/(mobile)/i.test(e)||/(tdocsIsPad)/i.test(e))&&v(e)}),f=(0,o.c$)(function(e){return y(e)&&/mobile/i.test(e)}),d=(0,o.c$)(function(e){return y(e)&&!/mobile/i.test(e)&&!/\bPC;/.test(e)}),p=(0,o.c$)(function(e){return y(e)&&!/mobile/i.test(e)&&/\bPC;/.test(e)}),g=(0,o.c$)(function(e){return!i(e)}),h=(0,o.c$)(function(e){return!i(e)&&/Mac OS X/i.test(e)}),w=(0,o.c$)(function(e){var n;return h(e)&&F(e)&&(navigator.maxTouchPoints>1||(null==(n=navigator.vendor)?void 0:n.startsWith("Google")))}),v=(0,o.c$)(function(e){return/android|adr/i.test(e)}),m=(0,o.c$)(function(e){return v(e)?(0,o.H7)("Android",e):null}),b=(0,o.$9)(function(e,n){return(0,o.yC)(m(e)||"",n)>=0}),y=(0,o.c$)(function(e){return/OpenHarmony|HarmonyOS/i.test(e)}),O=(0,o.c$)(function(e){return y(e)?(0,o.H7)("OpenHarmony",e):null}),P=(0,o.c$)(function(e){return y(e)&&er(e)?(0,o.H7)("HarmonyOSVersion",e):null}),A=(0,o.$9)(function(e,n){return(0,o.yC)(O(e)||"",n)>=0}),x=(0,o.$9)(function(e,n){return(0,o.yC)(P(e)||"",n)>=0}),E=(0,o.c$)(function(e){return/(iphone|ipad|ipod)/i.test(e)}),k=(0,o.c$)(function(e){return E(e)?(0,o.H7)("OS",e):null}),_=(0,o.$9)(function(e,n){return(0,o.yC)(k(e)||"",n)>=0}),I=(0,o.c$)(function(e){return/(win64|wow64|win32|wow32|windows nt)/i.test(e)}),C=(0,o.c$)(function(e){return/MSAppHost/i.test(e)}),S=(0,o.c$)(function(e){return/linux/i.test(e)&&!v(e)}),q=(0,o.c$)(function(e){return/linux-kylin/i.test(e)}),D=(0,o.c$)(function(e){return/linux-uos/i.test(e)}),j=(0,o.c$)(function(e){return!i(e)&&/QQBrowser/i.test(e)&&!/QBCore/i.test(e)}),T=(0,o.c$)(function(e){return j(e)?(0,o.H7)("QQBrowser",e):null}),M=(0,o.$9)(function(e,n){return(0,o.yC)(T(e)||"",n)>=0}),R=(0,o.c$)(function(e){return i(e)&&/MQQBrowser/i.test(e)&&!eE(e)&&!ee(e)&&!er(e)&&!eD(e)&&!eV(e)&&!eC(e)&&!eB(e)&&!eG(e)}),W=(0,o.c$)(function(e){return R(e)?(0,o.H7)("MQQBrowser",e):null}),$=(0,o.$9)(function(e,n){return(0,o.yC)(W(e)||"",n)>=0}),U=(0,o.c$)(function(e){return i(e)?R(e):j(e)}),Q=(0,o.c$)(function(e){return y(e)&&!eE(e)&&!ee(e)&&!er(e)&&!eD(e)&&!eV(e)&&!eC(e)&&!eB(e)&&!eG(e)}),L=(0,o.c$)(function(e){return/(Chrome|CriOS)\/\S+( Mobile\S*)? Safari\/\S+$/i.test(e)}),N=(0,o.c$)(function(e){return/Chrome\/\S+ Safari\/\S+ /i.test(e)&&er(e)}),V=(0,o.c$)(function(e){return(0,o.H7)("Chrome",e)}),H=(0,o.$9)(function(e,n){return(0,o.yC)(V(e)||"",n)>=0}),F=(0,o.c$)(function(e){return/Version\/\S+( Mobile\S*)? Safari\/\S+$/i.test(e)}),B=(0,o.c$)(function(e){return F(e)?(0,o.H7)("Version",e):null}),G=(0,o.$9)(function(e,n){return(0,o.yC)(B(e)||"",n)>=0}),K=(0,o.c$)(function(e){return/MSIE/i.test(e)&&!/opera/i.test(e)||/Trident/i.test(e)}),X=(0,o.c$)(function(e){return/Edge/i.test(e)}),Y=(0,o.c$)(function(e){return/Edg\//i.test(e)}),J=(0,o.c$)(function(e){return/(Firefox|Focus|FxiOS)\//i.test(e)}),z=(0,o.c$)(function(e){return J(e)?(0,o.H7)("(?:Firefox|Focus|FxiOS)",e):null}),Z=(0,o.$9)(function(e,n){return(0,o.yC)(z(e)||"",n)>=0}),ee=(0,o.c$)(function(e){return/MicroMessenger/i.test(e)&&!er(e)&&!eS(e)}),en=(0,o.c$)(function(e){return ee(e)||eS(e)?(0,o.H7)("MicroMessenger",e):null}),et=(0,o.$9)(function(e,n){return(0,o.yC)(en(e)||"",n)>=0}),er=(0,o.c$)(function(e){return/(wxwork)/i.test(e)}),eo=(0,o.c$)(function(e){return/(wxworkQt)/i.test(e)}),ei=(0,o.c$)(function(e){return/WeComCEF/i.test(e)&&er(e)}),eu=(0,o.c$)(function(e){if(er(e)&&g(e))if(h(e))return ei(e);else return N(e);return!1}),ec=(0,o.c$)(function(e){if(er(e)&&g(e))if(h(e))return(0,o.H7)("WeComCEF",e);else return V(e);return null}),ea=(0,o.$9)(function(e,n){return(0,o.yC)(ec(e)||"",n)>=0}),es=(0,o.c$)(function(e){return/(wxworklocal)/i.test(e)}),el=(0,o.c$)(function(e){return/WXDrive/i.test(e)}),ef=(0,o.c$)(function(e){return el(e)?(0,o.H7)("WXDrive",e):null}),ed=(0,o.$9)(function(e,n){return(0,o.yC)(ef(e)||"",n)>=0}),ep=(0,o.c$)(function(e){return er(e)?(0,o.H7)("wxwork",e):null}),eg=(0,o.$9)(function(e,n){return(0,o.yC)(ep(e)||"",n)>=0}),eh=(0,o.c$)(function(e){return es(e)?(0,o.H7)("wxworklocal",e):null}),ew=(0,o.$9)(function(e,n){return(0,o.yC)(eh(e)||"",n)>=0}),ev=(0,o.c$)(function(e){return/QQ\//i.test(e)&&!eD(e)&&!eq(e)&&!eO(e)}),em=(0,o.c$)(function(e){return/QQ\//i.test(e)&&/_GM/i.test(e)}),eb=(0,o.c$)(function(e){return ev(e)||eq(e)?(0,o.H7)("QQ",e):null}),ey=(0,o.$9)(function(e,n){return(0,o.yC)(eb(e)||"",n)>=0}),eO=(0,o.c$)(function(e){return/(TIM|MIT)\//i.test(e)}),eP=(0,o.c$)(function(e){return/QBCore/i.test(e)&&/TIM2.0/i.test(e)}),eA=(0,o.c$)(function(e){return eO(e)?(0,o.H7)("TIM",e)||(0,o.H7)("MIT",e):null}),ex=(0,o.$9)(function(e,n){return(0,o.yC)(eA(e)||"",n)>=0}),eE=(0,o.c$)(function(e){return eO(e)&&!eq(e)||ev(e)}),ek=(0,o.c$)(function(e){return eO(e)||/QQ/i.test(e)}),e_=(0,o.c$)(function(e){return/QQEX/i.test(e)&&eU(e)}),eI=(0,o.c$)(function(e){return/TDMobileQQMini/i.test(e)}),eC=(0,o.c$)(function(e){return/miniprogram|miniapp(?!enable)/i.test(e)||"undefined"!=typeof __wxjs_environment&&"miniprogram"===__wxjs_environment}),eS=(0,o.c$)(function(e){return/MicroMessenger/i.test(e)&&eC(e)}),eq=(0,o.c$)(function(e){return/QQ\/|TIM/i.test(e)&&eC(e)}),eD=(0,o.c$)(function(e){return/TencentDocs/i.test(e)}),ej=(0,o.c$)(function(e){return(0,o.H7)("TencentDocs",e)}),eT=(0,o.$9)(function(e,n){return(0,o.yC)(ej(e)||"",n)>=0}),eM=(0,o.c$)(function(e){return/TxDocsPC/i.test(e)}),eR=(0,o.c$)(function(e){return eM(e)}),eW=(0,o.c$)(function(e){return(0,o.H7)("TxDocsPC",e)}),e$=(0,o.$9)(function(e,n){return(0,o.yC)(eW(e)||"",n)>=0}),eU=(0,o.c$)(function(e){return/TDAppDesktop/i.test(e)}),eQ=(0,o.c$)(function(e){return(0,o.H7)("TDAppDesktop",e)}),eL=(0,o.$9)(function(e,n){return(0,o.yC)(eQ(e)||"",n)>=0}),eN=(0,o.c$)(function(e){return"30020"===(0,o.H7)("TDAppDesktopChannel",e)}),eV=(0,o.c$)(function(e){return/weiyun/i.test(e)}),eH=(0,o.c$)(function(e){return/WatermarkCamera/i.test(e)}),eF=(0,o.c$)(function(e){return/SE 2\.X MetaSr 1\.0/i.test(e)}),eB=(0,o.c$)(function(e){return/tencent_wemeet/i.test(e)}),eG=(0,o.c$)(function(e){return/YuanBao/i.test(e)}),eK=(0,o.c$)(function(e){return eB(e)&&/meeting_wework/i.test(e)}),eX=(0,o.c$)(function(e){return/TencentMeetingRooms/i.test(e)}),eY=function(e){return(0,o.up)(e)},eJ=(0,o.c$)(function(e){var n=e.match(/_tdocFlag\/(\d+)/);if(null==n?void 0:n[1]){var t=parseInt(n[1],10);return!!(t&r.TX.nativeDatabaseAndFullOfflineModeAvailable)}var o=e.match(r.y8);if(null==o?void 0:o[1]){var t=parseInt(o[1],10);return!!(t&r.Ym.nativeDatabaseAvailable)}return!1}),ez=(0,o.c$)(function(e){var n=e.match(/_tdocFlag\/(\d+)/);if(null==n?void 0:n[1]){var t=parseInt(n[1],10);return!!(t&r.TX.nativeDatabaseAndFullOfflineModeAvailable)}var o=e.match(r.y8);if(null==o?void 0:o[1]){var t=parseInt(o[1],10);return!!(t&r.Ym.fullOfflineModeAvailable)}return!1}),eZ=(0,o.c$)(function(e){var n=e.match(r.y8);return null!=n&&!!n[1]&&!!(parseInt(n[1],10)&r.Ym.nativeDatabaseWillDeprecated)})},267410:function(e,n,t){"use strict";t.d(n,{$9:function(){return d},H7:function(){return s},c$:function(){return f},ij:function(){return l},up:function(){return p},yC:function(){return a}});var r,o=t(694114),i=/\d+([._]\d+)*/;function u(e){var n,t=i.exec(e);return null!=(n=null==t?void 0:t[0].replace(/_/g,"."))?n:null}function c(e){var n=u(e);return(null==n?void 0:n.split(".").map(Number))||[]}function a(e,n){var t,r,o;return t=c(e),r=c(n),(o=Array(Math.max(t.length,r.length)).fill(0).map(function(e,n){return(t[n]||0)-(r[n]||0)}).find(function(e){return 0!==e})||0)<0?-1:+(o>0)}function s(e,n){try{t=RegExp("\\b".concat(e,"\\W+(\\d+([\\._]\\d+)*)"),"i")}catch(e){return null}var t,r=t.exec(n);return r?u(r[1]):null}var l=function(){return void 0===r&&(r="undefined"!=typeof navigator?navigator.userAgent:""),r};function f(e){return function(n){return e(n||l())}}function d(e){return function(n,t){return e(t||l(),n)}}function p(e){var n=0;return e.fullOffline&&(n|=o.Ym.fullOfflineModeAvailable),e.nativeDatabase&&(n|=o.Ym.nativeDatabaseAvailable),e.nativeDatabaseWillDeprecated&&(n|=o.Ym.nativeDatabaseWillDeprecated),"".concat(o.X4,"/").concat(n)}},271599:function(e,n,t){"use strict";t.d(n,{FJ:function(){return ee},VF:function(){return el},nK:function(){return ex},xw:function(){return Z}});var r,o,i,u,c,a,s=t(149133),l=t.n(s),f=t(384341),d=t(963327);t(130599);var p=t(847529),g=t.n(p),h=t(571227),w=t.n(h),v=t(766123),m=t.n(v),b=t(850244),y=t(829344),O=t(126713),P=t.n(O),A=t(352669),x=t.n(A),E=t(737033),k=t.n(E),_=(d.default.default||d.default).getInstance().getConfig('npm["@tencent/tencent_doc_net"]'),I="undefined"==typeof location?"":location.host,C=(null==_?void 0:_.TOB_HOST)||"doc.weixin.qq.com",S=RegExp((null==_?void 0:_.TOB_HOST_REGEXP)||"^doc\\.weixin\\.qq\\.com","i");null==_||_.esLogUrl;var q=Object.values((null==_?void 0:_.REPORT_URLS)||["report.idqqimg.com","aegis.qq.com","report.url.cn","access.toggle.qq.com","event.toggle.qq.com"]),D=Object.values((null==_?void 0:_.WEBSOCKET_URLS)||["docs.qq.com/websocket"]),j=Object.values((null==_?void 0:_.OTHER_URLS)||["gz.apigw.tencentcs.com","otheve.beacon.qq.com","casestudy.html5.qq.com","docrp.weixin.qq.com"]),T=Object.values((null==_?void 0:_.PRIVATE_REPORT_URLS)||["report.idqqimg.com","aegis.qq.com","report.url.cn","access.toggle.qq.com","event.toggle.qq.com","docrp.weixin.qq.com/report/","at.idqqimg.com/node/weblog"]),M=(null==_?void 0:_.PRIVATE_INTERCEPT_SDC)||!1,R=["data_report_collection"].concat(l()(q)),W=l()(D),$=[].concat(l()(j),[".json"]),U=["data_report_collection"].concat(l()(T)),Q=[].concat(["fcg_get_multiple_strategy","cgi-bin/online_docs/wxqrcode","cgi-bin/online_docs/polling","docs/components/assets.v4.json","myqcloud.com"],l()(R),l()(W),l()($)),L=[10004,10005,11e3,11005,1e5,12105,12100,60006,-20002,-1001],N=[10004,30004];function V(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0}function H(e){var n=new RegExp("(?:^|;+|\\s+)".concat(e,"=([^;]*)")),t=null,r=V();return null!=r&&r.document&&(t=r.document.cookie.match(n)),(t?t[1]:"")||null}function F(e,n){var t=e.split("?");if(t.length>=2){var r="".concat(encodeURIComponent(n),"="),o=t[1].split(/[&;]/g);console.warn(o,t[1],t[1].split(/[&;]/g));for(var i=o.length;i-=1;)-1!==o[i].lastIndexOf(r,0)&&o.splice(i,1);e=t[0]+(o.length>0?"?".concat(o.join("&")):"")}return e}function B(e,n){var t,r,o=("string"==typeof(t=n||(null==(r=V())||null==(r=r.location)?void 0:r.href)||"")?t:t.search).match(new RegExp("(\\?|&)".concat(e,"=([^&]*)(#|&|$)")));return o?decodeURIComponent(o[2]):""}function G(e,n){try{if(-1===e.responseURL.indexOf(location.host))return 0;var t=e.getResponseHeader(n);if(null!==t)return Number(t)}catch(e){}return 0}var K=null!=(i=null==(u=window.global_multi_user)?void 0:u.queryUserIndex)?i:B("u");function X(){var e;return(null==(e=window.global_multi_user)?void 0:e.nowUserIndex)||K||window.nowUserIndex}var Y=((r=Y||{}).UPDATE_USER_INDEX="account:update-user-index",r.DELETE_USER_INDEX="account:delete-user-index",r),J=!1;function z(){var e,n,t;J||null==(e=navigator.serviceWorker)||null==(e=e.controller)||e.postMessage({type:Y.UPDATE_USER_INDEX,data:{url:"https://".concat(I).concat(location.pathname),userIndex:X(),userType:(null==(n=window.global_multi_user)?void 0:n.utype)||"",uid:(null==(t=window.global_multi_user)?void 0:t.uid)||""}})}function Z(e){var n=!1;return Q.forEach(function(t){e.indexOf(t)>-1&&(n=!0)}),n}function ee(e){var n=e.indexOf("user_info?")>0&&e.indexOf("u=login")>0,t=B("u",e);if(n||e&&t||Z(e))return e;var r=window.nowUserIndex,o=e,i=e.split(/(\?|#)/),u=i[0],c=i[2]?"&".concat(i[2]):"";return et()&&(o="".concat(u,"?u=").concat(null!=r?r:"").concat(c)),o}function en(){window.global_multi_user||(window.global_multi_user={}),(null==(e=window.global_multi_user)?void 0:e.nowUserIndex)&&(window.global_multi_user.changeByServer=!0);var e,n=X();return window.nowUserIndex=n,!(!n&&et())}function et(){return!!H("SID")||!!H("DOC_SID")}g().setCallback(function(e){e&&10001===e.code&&(J=!0)});var er=I===C,eo=function(e,n){if("-20078"===e||"session disable by admin"===n){window.__is_ent_login_forbidden=!0;var t=new Event("ENT_LOGIN_FORBIDDEN");return window.dispatchEvent(t),!0}return!1},ei=function(e){try{if(!e)return!1;if(new URL(e).host===C)return!0}catch(e){console.error(e)}return!1};function eu(e){if(null!=(n=window)&&n.log){var n,t,r=e.type,o=e.options;null==(t=window)||null==(t=t.log)||t[r](o)}}var ec=I===C;function ea(e){try{var n,t,r,o,i;return n="string"==typeof e?JSON.parse(e):e,void 0!==(null==n?void 0:n.retcode)?n.retcode:void 0!==(null==n?void 0:n.code)?n.code:void 0!==(null==n?void 0:n.retCode)?n.retCode:void 0!==(null==n||null==(t=n.head)?void 0:t.ret)?n.head.ret:void 0!==(null==n||null==(r=n.header)?void 0:r.code)?n.header.code:void 0!==(null==n||null==(o=n.result)||null==(o=o.etype)?void 0:o.retcode)?n.result.etype.retcode:void 0!==(null==n||null==(i=n.param)?void 0:i.retcode)?n.param.retcode:0}catch(e){return 0}}var es=((o=es||{})[o.PENDING=0]="PENDING",o[o.SUCCESS=1]="SUCCESS",o[o.FAIL=2]="FAIL",o[o.EMPTY=3]="EMPTY",o),el=new(function(){function e(){P()(this,e),k()(this,"retryNum",0),k()(this,"MAX_RETRY_NUM",3),k()(this,"renewPromise",void 0),k()(this,"defaultPromise",void 0),k()(this,"renewState",es.EMPTY),k()(this,"needRenewUrl",[]),this.defaultPromise=new Promise(function(e){return e()}),this.renewPromise=this.defaultPromise}return x()(e,[{key:"awaitLoginTicket",value:function(e){return this.needRenewUrl.includes(e)?this.renewPromise:this.defaultPromise}},{key:"renewTicket",value:function(e){var n=this.canRenewLoginticket();return(n&&this.insertRenewUrl(e),this.renewState!==es.PENDING&&n)?(this.renewPromise=this.createRenewPromise(),!0):n}},{key:"renewSuccess",value:function(e){this.needRenewUrl.includes(e)&&(this.retryNum=0,this.renewPromise=this.defaultPromise,this.clearRenewUrl())}},{key:"insertRenewUrl",value:function(e){this.needRenewUrl.includes(e)||this.needRenewUrl.push(e)}},{key:"clearRenewUrl",value:function(){this.needRenewUrl=[]}},{key:"renewFail",value:function(){console.warn("\u7EED\u7968\u5931\u8D25,\u91CD\u7F6Epromise"),eu({type:"warn",options:{msg:"\u7EED\u7968\u5931\u8D25,\u91CD\u7F6Epromise"}}),this.renewPromise=this.defaultPromise,this.clearRenewUrl()}},{key:"createRenewPromise",value:function(){var e=this;return new Promise(function(n,t){e.renewState=es.PENDING;var r=n,o=t;n=function(){e.renewState=es.SUCCESS,r.apply(void 0,arguments)},t=function(){e.renewState=es.FAIL,o.apply(void 0,arguments)};var i=window.tdocs;if(!e.canRenewLoginticket()){console.warn("\u4E14\u8FDE\u7EED\u8BF7\u6C42\u6B21\u6570\u8FBE\u5230\u6700\u5927\u6B21\uFF0C\u5C31\u76F4\u63A5rj"),eu({type:"warn",options:{msg:"\u4E14\u8FDE\u7EED\u8BF7\u6C42\u6B21\u6570\u8FBE\u5230\u6700\u5927\u6B21\uFF0C\u5C31\u76F4\u63A5rj"}}),t();return}e.retryNum+=1,null==i||i.docLogin().then(function(r){if(!r||r.retcode){console.warn("\u7EED\u7968\u5931\u8D25!:",e.retryNum,r.retcode),eu({type:"warn",options:{msg:"\u7EED\u7968\u5931\u8D25"}}),e.createRenewPromise().then(n).catch(t);return}console.warn("single \u7EED\u7968\u6210\u529F, \u51C6\u5907\u91CD\u53D1\u8BF7\u6C42"),eu({type:"warn",options:{msg:"single \u7EED\u7968\u6210\u529F, \u51C6\u5907\u91CD\u53D1\u8BF7\u6C42"}}),n()}).catch(function(){e.renewState=es.FAIL,e.renewFail();for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];t(r)})})}},{key:"canRenewLoginticket",value:function(){var e;return(null==(e=window.tdocs)?void 0:e.docLogin)&&this.retryNum<this.MAX_RETRY_NUM}}]),e}());function ef(e){if(!e.includes("/sdc/getusermarkname"))return e;try{var n,t,r,o=null!=(n=location.pathname.split("/").reverse()[0])?n:"",i=null!=(t=null==(r=e.split("?")[1])?void 0:r.split("&").map(function(e){if(0===e.indexOf("localPadId="))return"globalPadID=".concat(e.split("=")[1]);if(0===e.indexOf("uids=")){var n=JSON.parse(e.split("=")[1]);return"count=".concat(n.length)}return 0===e.indexOf("xsrf=")?e:null}).filter(function(e){return!!e}))?t:["globalPadID=".concat(o),"count=10"];return"".concat("/sdc/getcollabroomuserinfos","?").concat(i.concat("fromOld=1").join("&"))}catch(n){return e}}var ed=f.default.isWxWork,ep=null==(c=window)||null==(c=c.XMLHttpRequest)?void 0:c.prototype,eg=null==ep?void 0:ep.open,eh=null==ep?void 0:ep.send,ew=null==ep?void 0:ep.setRequestHeader,ev=null==(a=window)?void 0:a.fetch;function em(e,n){var t,r=n.args,o=n.shouldSetCurrentUserIndex,i=n.readyStateChange;i&&(i.call(e),(null==(t=window)||!t.PRIVATE)&&o&&function(e,n){if(!ec){var t,r,o,i,u=(null==e?void 0:e.responseURL)||n,c=(null==e||null==(t=e.target)||null==(r=t.getResponseHeader)?void 0:r.call(t,"content-type"))||"";if(!Z(u)&&u&&["application/json; charset=UTF-8","text/plain; charset=utf-8","application/json","application/x-javascript; charset=utf-8"].includes(c)){if(200!==e.status){(0,y.monitor)(0x21d37d3),null==(o=window)||null==(o=o.log)||o.log("\u7F51\u7EDC\u62E6\u622A\uFF1Astatus:".concat(e.status," ,url:").concat(u)),(0,y.tdw)({opername:"multi",module:"multi-net",action:"multi-cgi-result",ver1:Date.now(),ver2:e.status,ver3:u,ver4:navigator.userAgent,ver5:JSON.stringify(e.response)});return}(0,y.monitor)(0x21d37d2);try{0!=ea(e)&&((0,y.monitor)(0x21d37d4),null==(i=window)||null==(i=i.log)||i.log("\u7F51\u7EDC\u62E6\u622A: url:".concat(u," ,response:").concat(JSON.stringify(e.response))),(0,y.tdw)({opername:"multi",module:"multi-net",action:"multi-cgi-result",ver1:Date.now(),ver2:e.status,ver3:u,ver4:navigator.userAgent,ver5:JSON.stringify(e.response)}))}catch(e){}}}}(e.response,r[1]))}function eb(e){if(!(null!=(n=window)&&n.PRIVATE&&e))return!1;var n,t="string"==typeof e?e:e.href;return U.findIndex(function(e){return t.includes(e)})>-1}function ey(e,n){var t,r;return!!(null!=(t=window.tdocs)&&t.docLogin&&ed&&(r=location.host,S.test(r)))&&(L.includes(e)||N.includes(null!=n?n:0))}window.AI_SPACE={fetch:ev};function eO(){return(eO=w()(m().mark(function e(n){var t;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=-1,e.prev=1,e.next=4,n.json();case 4:t=ea(e.sent),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),t=0;case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}},e,null,[[1,8]])}))).apply(this,arguments)}var eP=!1,eA=function(){var e,n,t,r,o,i,u,c,a,s,l,d,p,g,h,w=f.default.isMiniProgram;w||(n=location.href,t="",r=B("debug"),K&&"1"!==r&&(e=location.pathname,!/^\/(desktop|mall)/i.test(e))&&(t=F(n,"u"),window.history.replaceState(null,"",t))),w||(console.info("----- re add user index"),o=location.href,setTimeout(function(){if(!B("u",o)){var e;null!=(e=navigator.serviceWorker)&&null!=(e=e.controller)&&e.scriptURL.includes("service-worker.js")||function(e){if(e){var n,t,r,o,i,u,c,a,s,l=(r=(t=(null==(n=V())?void 0:n.location)||{}).host,i=void 0===(o=t.search)?"":o,u=t.pathname,c=t.hash,a="".concat(i,"&").concat("u","=").concat(e),s=i.indexOf("?")>=0?a:"?".concat(a),"https://".concat(r).concat(u).concat(s).concat(c));window.history.replaceState(null,"",l)}}(X())}},1e3)),i=location.href,u="",["otel_traceparent","otel_tracestate","otel_baggage"].forEach(function(e){B(e)&&(u=F(i,e))}),u&&window.history.replaceState(null,"",u),c=location.href,a="",s="wwapp_cst",(B("cst")||B("st")||B(s))&&(a=F(c,s),a=F(a,"wwapp_vid"),a=F(a,"wwapp_deviceid"),a=F(a,"cst"),a=F(a,"vid"),a=F(a,"st"),window.history.replaceState(null,"",a)),l=location.href,d="",g="newEmptyDoc",h="dver",(B(p="is_precreate")||B(g)||B(h))&&(d=F(l,p),d=F(d,g),d=F(d,h),window.history.replaceState(null,"",d))};function ex(e){console.warn("\u521D\u59CB\u5316\u62E6\u622A\u5668-2.0");var n=f.default.isMiniProgram;if(e&&Q.splice.apply(Q,[0,0].concat(l()(e.urlWhiteList))),"undefined"!=typeof window&&!window.hadIntercepted){eP=en(),n||navigator.serviceWorker&&setTimeout(function(){var e;X()&&(z(),void 0!==document.hidden?e="visibilitychange":void 0!==document.msHidden?e="msvisibilitychange":void 0!==document.webkitHidden&&(e="webkitvisibilitychange"),document.addEventListener(e,function(){"visible"===document.visibilityState&&z()}))},1e3);var t=eP;if(window&&"XMLHttpRequest"in window){ep.hijackXmlOpen=function(){var e;this.requestStart=Date.now();for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];if(this.requestOpenParams=r,this.headerMap=this.headerMap||new Map,!eb(null==(e=this.requestOpenParams)?void 0:e[1])){this.retryTimes=this.retryTimes||0,this.isLoaded=!1;var i=r,u=!["blob","document","arraybuffer"].includes(this.responseType);t&&u&&(i=r.map(function(e,n){return 1===n&&e?ee(e):e}));var c=(0,b.enterpriseXsrfInterceptor)({url:r[1],method:r[0]}).url;return c!==r[1]&&(i[1]=c),M&&(i[1]=ef(i[1])),null==eg?void 0:eg.apply(this,i)}},ep.open=ep.hijackXmlOpen,ep.hijackXmlSend=w()(m().mark(function e(){var n,t,r,u,c,a=arguments;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this,!eb(null==(n=t.requestOpenParams)?void 0:n[1])){e.next=5;break}return i(t),e.abrupt("return");case 5:for(o(t),u=Array(r=a.length),c=0;c<r;c++)u[c]=a[c];return t.requestSendParams=u,e.abrupt("return",null==eh?void 0:eh.apply(t,u));case 9:case"end":return e.stop()}},e,this)})),ep.send=ep.hijackXmlSend,ep.setRequestHeader=function(e,n){var t,r;eb(null==(t=this.requestOpenParams)?void 0:t[1])||(null==(r=this.headerMap)||r.set(e,n),null==ew||ew.call(this,e,n))};var r=function(e,n){var t;eb(null==(t=e.requestOpenParams)?void 0:t[1])||null==n||n.forEach(function(n,t){e.setRequestHeader(t,n)})},o=function(e){e.originOnload=e.originOnload?e.originOnload:e.onload||function(){},e.originOnloadend=e.originOnloadend?e.originOnloadend:e.onloadend||function(){},e.originOnreadystatechange=e.originOnreadystatechange?e.originOnreadystatechange:e.onreadystatechange||function(){};var n,o,i=new Promise(function(e){n=e}),u=(o=w()(m().mark(function n(){var t,r,o,u,c,a,s,l=arguments;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:for(o=Array(r=l.length),u=0;u<r;u++)o[u]=l[u];if(null==(t=e.originOnreadystatechange)||t.call(e,o),!(!e.isLoaded&&4===e.readyState)){n.next=9;break}return n.next=5,i;case 5:s=n.sent,null==(c=e.originOnload)||c.call(e,s),e.isLoaded=!0,null==(a=e.originOnloadend)||a.call(e,s);case 9:case"end":return n.stop()}},n)})),function(){return o.apply(this,arguments)});e.onload=function(e){var t;null==(t=n)||t(e)},e.onloadend=e.onload,e.onreadystatechange=function(){if(200===e.status&&4===e.readyState){if(!(er&&!f.default.isWxWork&&!f.default.isTencentMeeting&&!f.default.isWxWorkTencentMeeting&&ei(e.responseURL)&&eo(e.getResponseHeader("x-session-ret")||void 0,function(e){try{var n,t,r="string"==typeof e?JSON.parse(e):e;if(void 0!==(null==r||null==(n=r.head)?void 0:n.ret))return(null==r||null==(t=r.head)?void 0:t.msg)||"";return""}catch(e){return""}}(e.response)))){if(-20036===(null!=(o=ea(e.response))?o:0)){if(e.retryTimes<1){e.retryTimes+=1,e.hijackXmlOpen.apply(e,l()(e.requestOpenParams)),r(e,e.headerMap),e.hijackXmlSend.apply(e,l()(e.requestSendParams));var n,o,i,c="scode\u4E0D\u5339\u914D,\u5C1D\u8BD5\u91CD\u53D1\u8BF7\u6C42 retryTimes=".concat(e.retryTimes);console.warn(c),eu({type:"warn",options:{msg:c}})}else em(e,{args:e.requestOpenParams,shouldSetCurrentUserIndex:t,requestStart:e.requestStart,readyStateChange:u});return}if(function(e,n){var t,r=n&&(G(n,"trpc-func-ret")||G(n,"cgi_code"))||0;return ey(null!=(t=ea(e))?t:0,r)}(e.response,e)){var a=e.requestOpenParams[1];if(el.renewTicket(a)&&e.retryTimes<3){e.retryTimes+=1,console.warn("\u9700\u8981\u7EED\u7968,\u91CD\u53D1\u8BF7\u6C42"),eu({type:"warn",options:{msg:"\u9700\u8981\u7EED\u7968,\u91CD\u53D1\u8BF7\u6C42"}}),el.awaitLoginTicket(a).then(function(){e.hijackXmlOpen.apply(e,l()(e.requestOpenParams)),r(e,e.headerMap),e.hijackXmlSend.apply(e,l()(e.requestSendParams))}).catch(function(e){console.warn(e,"\u7EED\u7968\u5931\u8D25!~~~~~"),eu({type:"warn",options:{msg:"\u7EED\u7968\u5931\u8D25!~~~~~"}})});return}eu({type:"warn",options:{msg:"\u9700\u8981\u7EED\u7968, \u4F46\u662F\u5DF2\u7ECF\u5230\u91CD\u8BD5\u4E0A\u9650"}}),console.warn("\u9700\u8981\u7EED\u7968, \u4F46\u662F\u5DF2\u7ECF\u5230\u91CD\u8BD5\u4E0A\u9650"),em(e,{args:e.requestOpenParams,shouldSetCurrentUserIndex:t,requestStart:e.requestStart,readyStateChange:u});return}var s=null==(i=e.requestOpenParams)?void 0:i[1];e.retryTimes=0,el.renewSuccess(s),em(e,{args:e.requestOpenParams,shouldSetCurrentUserIndex:t,requestStart:e.requestStart,readyStateChange:u})}}else em(e,{args:e.requestOpenParams,shouldSetCurrentUserIndex:t,requestStart:e.requestStart,readyStateChange:u})}},i=function(e){e.send=function(){},e.originOnload=function(){},e.originOnreadystatechange=function(){},e.onload=function(){},e.onreadystatechange=function(){},e.setRequestHeader=function(){}}}window&&"fetch"in window&&(window.fetch=function(e,n){if(eb(e))return new Promise((t=w()(m().mark(function n(t){return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t("fetch \u8BF7\u6C42': ".concat(e));case 2:case"end":return n.stop()}},n)})),function(e){return t.apply(this,arguments)}));var t,r,o=e;return en()&&(o=ee(e)),M&&(o=ef(o)),new Promise((r=w()(m().mark(function t(r,i){var u;return m().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,el.awaitLoginTicket(e);case 2:console.warn(" wait :",e);try{null==ev||ev(o,n).then(function(){var t=w()(m().mark(function t(i){var u,c,a;return m().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return u=i.clone(),t.next=3,function(e){return eO.apply(this,arguments)}(u);case 3:var s;if(s=c=t.sent,-20036!==s){t.next=9;break}return a="scode\u4E0D\u5339\u914D,\u5C1D\u8BD5\u91CD\u53D1\u8BF7\u6C42, url=".concat(o),console.warn(a),eu({type:"warn",options:{msg:a}}),t.abrupt("return",null==ev?void 0:ev(e,n).then(function(e){return r(e)}));case 9:if(!ey(c)||!el.renewTicket(o)){t.next=12;break}return t.abrupt("return",window.fetch(e,n).then(function(e){return r(e)}));case 12:el.renewSuccess(e),r(i);case 14:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()).catch(function(t){var r;null==(r=window)||null==(r=r.log)||r.info("originFetch error:",e,n),i(t)})}catch(t){null==(u=window)||null==(u=u.log)||u.info("originFetch apply error:",e,n)}case 4:case"end":return t.stop()}},t)})),function(e,n){return r.apply(this,arguments)}))}),eA(),window.hadIntercepted=!0}}ex()},797218:function(e,n,t){"use strict";t.r(n),t.d(n,{isNeedScenarioRedirectLink:function(){return eI},setNewWindowUrl:function(){return e_},tencentDocOpenUrlForAll:function(){return eC},tencentDocOpenUrlReload:function(){return ek},openNewBlankWindow:function(){return eE},getMultUrl:function(){return eA},newBlankWindow:function(){return ex},setDefaultConfiguration:function(){return eP},tencentDocOpenUrl:function(){return eS}});var r,o,i,u,c,a,s,l,f,d,p,g,h=t(758282),w=t.n(h),v=t(384341),m=function(e){return e&&window.frameElement&&window.top||window},b=function(e){if(e&&window.frameElement){var n;return null==(n=window.top)?void 0:n.mqq}return window.mqq},y=function(e){if(e&&window.frameElement){var n;return null==(n=window.top)?void 0:n.wx}return window.wx},O=function(){var e,n,t,r;return/from=miniprogram/.test(null==(e=window)||null==(n=e.location)?void 0:n.search)||/from=miniprogram_wedoc/.test(null==(t=window)||null==(r=t.location)?void 0:r.search)},P=v.default.isTencentDocsApp,A=v.default.isQQ,x=v.default.isWindows;function E(){var e,n;return(null==(e=t.g)?void 0:e.ntqq)||(null==(n=t.g)?void 0:n.ntQQApi)}var k=t(851443),_=t.n(k),I=t(571227),C=t.n(I);(r=l||(l={}))[r.WxworkBrowser=1]="WxworkBrowser";var S="doc.weixin.qq.com";function q(e){var n,t,r,o=null!=(n=null==(t=e.match(/(http?:\/\/|https:\/\/|\/\/)?([^\/\?#]+)/i))?void 0:t[2])?n:"";if(!v.default.isWxWork||![S,"docs.qq.com"].includes(o))return e;var i=e.split("#"),u=null!=(r=i.shift())?r:"",c=i.join("#"),a=[f.NAME,f.VID,f.DEVICE_ID,d.NAME,d.VID,d.DEVICE_ID],s=u;return(a.forEach(function(e){s=function(e,n){var t=e.split("?"),r=T()(t,2),o=r[0],i=r[1];if(i){for(var u="".concat(encodeURIComponent(n),"="),c=i.split(/[&]/g),a=c.length;a-- >0;)-1!==c[a].lastIndexOf(u,0)&&c.splice(a,1);e=o+(c.length>0?"?".concat(c.join("&")):"")}return e}(s,e)}),c)?"".concat(s,"#").concat(c):"".concat(s)}function D(e){var n,t,r=B(e),o=V("u",r);if(t=r,!/^http(s)?:\/\/docs\.qq\.com/.test(t)||""!==o)return r;var i=(n=window.global_multi_user,window.nowUserIndex||(null==n?void 0:n.nowUserIndex)||V("u")||"");if(!i)return r;var u=new URL(r),c=u.protocol,a=u.host,s=u.pathname,l=u.search,f=u.hash;return l?"".concat(c,"//").concat(a).concat(s).concat(l,"&u=").concat(i).concat(f):"".concat(c,"//").concat(a).concat(s,"?u=").concat(i).concat(f)}(o=f||(f={})).NAME="wwapp_cst",o.VID="wwapp_vid",o.DEVICE_ID="wwapp_deviceid",(i=d||(d={})).NAME="cst",i.VID="vid",i.DEVICE_ID="deviceid";(u=p||(p={}))[u.LOW=-1]="LOW",u[u.EQUQL=0]="EQUQL",u[u.HEIGHT=1]="HEIGHT";var j=t(1705),T=t.n(j),M=t(963327).default.getInstance().getConfig("runtime.domainName")||window.location.hostname,R=t(126713),W=t.n(R),$=t(352669),U=t.n($),Q=t(737033),L=t.n(Q),N=new(function(){function e(){W()(this,e),L()(this,"options",{ignoreDomainDetect:!1,ignoreHosts:[S]})}return U()(e,[{key:"register",value:function(e){e&&(this.options.ignoreDomainDetect=!!e.ignoreDomainDetect,this.options=w()(w()({},this.options),e))}},{key:"getOptions",value:function(){return this.options}}]),e}());function V(e,n){var r,o=("string"==typeof(r=n||t.g.location||"")?r:r.search).match(new RegExp("(\\?|&)".concat(e,"=([^&]*)(#|&|$)")));return o?decodeURIComponent(o[2]):""}function H(e){return e.includes("/scenario/link.html")}function F(e){return/\.qq\.com/.test(e)}function B(e){return F(e)?e.replace(/^(http:)?\/\//i,"https://"):e}function G(e,n){var t,r,o,i,u,c,a=q(e);if(!a)return null;var s=N.getOptions();a=B(e);var l=(o=(s||{}).ignoreDomainDetect,t=(s||{}).ignoreHosts,r=!1,t&&(r=t.includes(M)),i=r,u=!F(e)&&!H(e),c=!F(e)&&!H(e),(i||null!=n&&n.ignoreDomainDetect||o)&&(u=!1),(u||c)&&o||(c=!1),{needRedirect:u,needOpenPanel:c}),f=l.needRedirect,d=l.needOpenPanel;if(f){a="//".concat(M,"/scenario/link.html?url=").concat(encodeURIComponent(a));var p=window.clientVars;p&&(a="".concat(a,"&pid=").concat(p.globalPadId,"&cid=").concat(p.creatorId))}return(null==n?void 0:n.noUserIndex)||(a=D(a)),{url:a,callback:d?s.ignoreDomainDetectCallback:void 0}}function K(e,n){var t=q(e);if(!t)return null;var r=N.getOptions();if(t=B(e),(!F(e)||H(e))&&!(null!=r&&r.ignoreDomainDetect)){t="//".concat(M,"/scenario/link.html?url=").concat(encodeURIComponent(t));var o=window.clientVars;o&&(t="".concat(t,"&pid=").concat(o.globalPadId,"&cid=").concat(o.creatorId))}return(null==n?void 0:n.noUserIndex)||(t=D(t)),t}function X(e){if(e.href===location.href&&"_self"===e.target)return void location.reload();var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(n)}var Y=v.default.isMac||v.default.isIPad,J=new(function(){function e(){var n=this;W()(this,e),L()(this,"isPressed",!1),L()(this,"handleKeyboardEvent",function(e){e.key===(Y?"Meta":"Control")&&n.setCtrlKeyStatus("keydown"===e.type)}),L()(this,"handleBlurEvent",function(){n.setCtrlKeyStatus(!1)});var t=["keydown","keyup"];if("undefined"==typeof window||"undefined"==typeof document)return void console.debug("CtrlKeyManager skip init, window or document is undefined");t.forEach(function(e){document.addEventListener(e,n.handleKeyboardEvent)}),window.addEventListener("blur",this.handleBlurEvent),window.addEventListener("beforeunload",function(){t.forEach(function(e){document.removeEventListener(e,n.handleKeyboardEvent)}),window.removeEventListener("blur",n.handleBlurEvent)})}return U()(e,[{key:"setCtrlKeyStatus",value:function(e){this.isPressed=e}}]),e}()),z=function(){var e,n,t;return function(e,n){if(e==n)return 0;for(var t=e.split("."),r=n.split("."),o=0;t[o]&&r[o];){if(+t[o]==+r[o]){o+=1;continue}return+t[o]>+r[o]?p.HEIGHT:p.LOW}return t[o]?p.HEIGHT:r[o]?p.LOW:p.EQUQL}((e="wdocs",(t=(n=navigator.userAgent.toLowerCase()).match(new RegExp("".concat(e,"\\/(\\d+\\.\\d+\\.\\d+)")))||n.match(new RegExp("".concat(e,"\\/(\\d+\\.\\d+)"))))?t[1]:""),"1.0.0")>=0},Z=function(e){return window.PRIVATE?[/^http(s):\/\/drive\.weixin\.qq\.com\/s\?/i,/^http(s):\/\/drive\.weixin\.qq\.com\/cgi-bin\/disk\/s\?/i].some(function(n){return n.test(e)}):/^http(s):\/\/drive\.weixin\.qq\.com\//i.test(e)},ee=function(e){return[/^http(s):\/\/doc\.weixin\.qq\.com\/doc/i,/^http(s):\/\/doc\.weixin\.qq\.com\/sheet/i,/^http(s):\/\/doc\.weixin\.qq\.com\/forms/i,/^http(s):\/\/doc\.weixin\.qq\.com\/mind/i,/^http(s):\/\/doc\.weixin\.qq\.com\/flowchart/i,/^http(s):\/\/doc\.weixin\.qq\.com\/slide/i,/^http(s):\/\/doc\.weixin\.qq\.com\/home/i,/^http(s):\/\/doc\.weixin\.qq\.com\/mall\/m\/profile\/craft/i,/^http(s):\/\/doc\.weixin\.qq\.com\/scenario\/login/i,/^http(s):\/\/doc\.weixin\.qq\.com\/txdoc/i,/^http(s):\/\/doc\.weixin\.qq\.com\/formcol/i].some(function(n){return n.test(e)})};(c=g||(g={}))[c.REPLACE=0]="REPLACE",c[c.FORK_WEBVIEW=1]="FORK_WEBVIEW",c[c.BROWSER=2]="BROWSER",c[c.NEW_WEBVIEW=3]="NEW_WEBVIEW";var en=function(e,n){var t,r;if(null!=(t=window)&&null!=(r=t.tdocs)&&r.openUrl){var o=n.replace?g.REPLACE:ee(e)?g.FORK_WEBVIEW:g.NEW_WEBVIEW;return w()(w()({},n),{},{target:o}),window.tdocs.openUrl({url:e,target:o,style:3})}return et(e,n)},et=function(e,n){var t,r,o,i,u;return null!=(t=window)&&null!=(r=t.mqq)&&null!=(o=r.ui)&&o.openUrl?window.mqq.ui.openUrl({url:e,target:+!n.replace,style:3,useQQBrowser:!0}):null!=(i=window)&&null!=(u=i.qmailBridge)&&u.openDocLink?window.qmailBridge.openDocLink({url:e}):ei(e,n)},er=(a=C()(_()().mark(function e(n,t){var r,o,i,u,c;return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null!=(r=window)&&null!=(o=r.qmailBridge)&&o.openFileInWedrive&&Z(n))){e.next=6;break}return e.next=3,ec(n);case 3:return c=e.sent,e.abrupt("return",window.qmailBridge.openFileInWedrive(c,n));case 6:if(!(null!=(i=window)&&null!=(u=i.tdocs)&&u.openInTab&&ee(n))){e.next=9;break}return e.abrupt("return",window.tdocs.openInTab({url:n}));case 9:return e.abrupt("return",ei(n,t));case 10:case"end":return e.stop()}},e)})),function(e,n){return a.apply(this,arguments)}),eo=(s=C()(_()().mark(function e(n,t){var r,o,i,u,c,a,s;return _()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.replace){e.next=4;break}return window.location.href=n,e.abrupt("return");case 4:if(!(null!=(r=window)&&null!=(o=r.tdocs)&&o.openFileInWedrive&&Z(n))){e.next=10;break}return e.next=7,ec(n);case 7:return s=e.sent,e.abrupt("return",window.tdocs.openFileInWedrive({fileId:s,url:n}));case 10:var l;if(!(null!=(i=window)&&null!=(u=i.tdocs)&&u.openInBrowser&&eI(n))){e.next=13;break}return e.abrupt("return",window.tdocs.openInBrowser({url:(l=n,/^(mailto:(\/\/)?)?([a-z\u00a1-\uffff0-9_\-.])+@([a-z\u00a1-\uffff0-9_\-.])+\.([a-z]{2,})$/i.test(l)?l=l.replace(/^(mailto:(\/\/)?)?/i,"mailto:"):/^(https?|ftp|file):\/\//i.test(l)||(l=/^(doc\.weixin\.qq\.com)/i.test(l)?"https://".concat(l):"http://".concat(l)),l)}));case 13:if(!(null!=(c=window)&&null!=(a=c.tdocs)&&a.openInTab)){e.next=16;break}return e.abrupt("return",window.tdocs.openInTab({is_silent:J.isPressed,url:n}));case 16:return e.abrupt("return",ei(n,t));case 17:case"end":return e.stop()}},e)})),function(e,n){return s.apply(this,arguments)}),ei=function(e,n){n.replace?window.location.href=e:window.open(e)},eu=function(e){var n;null==(n=window.tdocs)||n.openInWxworkBrowser({url:e})},ec=function(e){return new Promise(function(n){var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===t.readyState&&200===t.status){var e=t.responseText;try{var r,o=JSON.parse(e),i=null==o||null==(r=o.body)?void 0:r.fileid;i?n(i):n(null)}catch(e){console.error("fetchFileIdFromSvr error",e),n(null)}}},t.onerror=function(e){console.error("fetchFileIdFromSvr error",e),n(null)},t.ontimeout=function(e){console.error("fetchFileIdFromSvr timeout",e),n(null)},t.open("GET","https://doc.weixin.qq.com/wedoc/getfileinfobyurl?url=".concat(e),!0),t.setRequestHeader("Content-type","text/plain"),t.send()})};v.default.isIPad;var ea=v.default.isMobile,es=v.default.isMiniProgram,el=v.default.isWxMiniProgram,ef=v.default.isQQMiniProgram,ed=v.default.isTimOrQQ,ep=(v.default.isIOS,v.default.isWeChat),eg=v.default.isWxWork,eh=v.default.isTencentDocsApp,ew=v.default.isPCTencentDocsClient,ev=v.default.isIE,em=v.default.isSafari,eb=v.default.isElectronTencentDocsClient,ey=v.default.isQQDesktopDocsClient,eO=v.default.isWxDrive;function eP(e){N.register(e)}var eA=function(e){return D(e)};function ex(){return el||ef?"miniProgram":window.open()}function eE(e){var n=D(e);return window.open(n)}function ek(){eC({url:location.href,replace:!0})}function e_(e,n){if("miniProgram"===e)return void eC({url:n});if(n){var t=K(n);e?e.location=t:t&&(window.location.href=t)}}function eI(e,n){return!F(e)&&!(null!=n&&n.ignoreDomainDetect)}function eC(e){var n=e.url;e.wxUrl,e.replace,e.style,e.safariNeedReplace;var t=G(n,e)||{},r=t.url,o=t.callback;if(r){if(o)return void o(function(){eq(r,w()({ignoreDomainDetect:!0},e))});window.mqq,G(n,e),eq(r,e)}}function eS(e,n,t,r){if(void 0!==e){var o=K(e);if(ea||ev)window.open.apply(window,[e,n,t,r]);else{var i=document.createElement("a");i.href=o,!ea&&es&&(n="_self"),i.target=n||"_blank",i.rel="noreferrer",X(i)}}}function eq(e,n){var t,r,o,i,u,c,a,s,f,d,p,g,h,k,_,I,C,S,q=n.supportIFrame,D=n.safariNeedReplace,j=n.isDownLoad,T=m(q);if(j&&(ed||eh||eb||ey))(i=document.createElement("a")).href=e,i.rel="noreferrer",i.download="download",X(i);else if(el||ef)!function(e,n){var t,r,o,i,u,c,a=n.wxUrl,s=n.replace,l=n.noHistory,f=n.supportIFrame,d=y(f),p=m(f);if(O()){p.location.href=e;return}if(!(null!=d&&d.miniProgram)){o=n.replace,i=n.windowName,u=n.windowFeatures,c=m(n.supportIFrame),o?null==c||null==(r=c.location)||r.replace(e):null==c||c.open(e,i,u),console.error("no miniProgram sdk");return}var g=null!=a?a:(t=e,/^https:\/\/docs\.qq\.com\/(sheet|doc|slide|form|pdf|file|mind|flowchart|rec|aio)\/(.*)$/.test(t)?"/pages/detail/detail?url=".concat(encodeURIComponent(t)):"/pages/webview/webview?url=".concat(encodeURIComponent(t)));s?d.miniProgram.redirectTo({url:g}):l?d.miniProgram.reLaunch({url:g}):d.miniProgram.navigateTo({url:g})}(e,n);else if(ep||em&&D)T.location.href=e;else if(ed||eh)u=n.replace,c=n.style,a=n.useNewConfig,s=n.supportIFrame,f=n.appOption,d=b(s),p=m(s),!u&&x&&A&&!E()?p.open(e):(!u||E())&&d?null==d||d.invoke("ui","openUrl",w()(w()({},f),{},{url:e,target:1,style:c||2,useQQBrowser:!0,useNewConfig:a}),function(){}):function(e,n){var t,r,o,i=m(n);P&&(t=i.location.href,r=new URL(t),o=new URL(e),r.protocol===o.protocol&&r.host===o.host)?(i.history.replaceState(null,document.title,e),i.location.replace("")):i.location.replace(e)}(e,s);else if(eg||eO)!function(e,n){try{if(v.default.isMobile){if(z())return en(e,n);return et(e,n)}if(v.default.isWxDrive)return er(e,n);if(v.default.isWxWorkVersionAboveOrEqual("3.1.18")||v.default.isWxWorkPrivateVersionAboveOrEqual("2.7.2000")){if(n.openType===l.WxworkBrowser&&v.default.isWxWorkVersionAboveOrEqual("4.0.0"))return eu(e);return eo(e,n)}ei(e,n)}catch(t){return console.error("doOpenUrlForWxworkOrWedrive error",t),ei(e,n)}}(e,n);else if(ev)g=n.replace,h=n.windowFeatures,k=n.windowName,g?window.location.href=e:window.open(e,k,h);else if(ew){_=n.replace,I=n.windowFeatures,C=n.windowName,S=m(n.supportIFrame),_?S.location.href=e:S.open((r="opennew=1",o=t=e,r&&(o.indexOf("?")>=0?o+="&".concat(r):o+="?".concat(r)),o),C,I)}else!function(e,n,t){var r,o,i,u,c=n.replace,a=n.noHistory,s=n.safariNeedReplace,l=n.launchClient,f=e;try{f.startsWith("//")&&(f="".concat(location.protocol).concat(f));var d=new URL(f);"docs.qq.com"!==d.hostname||l||(d.searchParams.set("nlc","1"),f=d.toString())}catch(e){console.error("parse url params error:",e)}if(s){t.location.href=f;return}if(o=(r=w()(w()({},n),{},{url:f})).url,i=r.windowName,u=r.windowFeatures,!i||!u||(window.open(o,i,u),0)){var p=document.createElement("a");p.href=f,c?p.target="_self":(p.target="_blank",p.rel="noreferrer"),a&&history.replaceState(null,document.title,f),X(p)}}(e,n,T)}}}]);
//# sourceMappingURL=initial_vendors_tencent_2.e88a27ec6eb98ae2.js.map