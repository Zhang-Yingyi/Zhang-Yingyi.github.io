var log=(()=>{var t,e,n,o;function r(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];console.warn.apply(console,s([],a(t),!1))}(o=t=t||{}).INSERT_LOG="insert_log",o.GET_CONFIG="get_config",(n=e=e||{})[n.DEBUG=1]="DEBUG",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.FATAL=5]="FATAL";var i=Symbol("original_msg"),a=window&&window.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(o=i.next()).done;)a.push(o.value)}catch(t){r={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},s=window&&window.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||((o=o||Array.prototype.slice.call(e,0,r))[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))},c=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];console.log.apply(console,s([],a(t),!1))},l=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];console.error.apply(console,s([],a(t),!1))};function u(t,e){return Object.prototype.toString.call(e)==="[object ".concat(t,"]")}function p(t){return u("Object",t)}function f(t){var e=new Set,n="Circular";try{return JSON.stringify(t,(function(t,o){if(p(o)||Array.isArray(o)){if(e.has(o))return'["'.concat(n,'"]');e.add(o)}return o}))}catch(e){return l(e),p(t)?'{Object:["'.concat(n,'"]}'):Array.isArray(t)?'["'.concat(n,'"]'):n}}function h(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function d(t){return new Promise((function(e,n){var o,r=t.url,i="",a=((t,e)=>{var n=new XMLHttpRequest;if(!n)throw new Error("XMLHttp is not defined");var o=t.timeout,r=t.dataType,i=void 0===r?"json":r;try{o&&(n.timeout=o)}catch(t){c(t)}return n.onreadystatechange=function(){var t,o,r;4===n.readyState&&(200===n.status?(r=n.responseText,"json"===i&&(r=JSON.parse(n.responseText)),null!=(t=null==e?void 0:e.success)&&t.call(e,r)):null!=(o=null==e?void 0:e.error)&&o.call(e,{errCode:n.status}))},n.onerror=function(){var t;null!=(t=null==e?void 0:e.error)&&t.call(e,{errCode:-1})},n.ontimeout=function(){var t;null!=(t=null==e?void 0:e.error)&&t.call(e,{errCode:-2})},n})(t,{success:function(t){e(t)},error:function(t){n(t)}});if(a){if(a.open("POST",r,!0),"json"===t.contentType)i=JSON.stringify(t.param),a.setRequestHeader("Content-Type","application/json");else{i=(t=>{var e,n=[];for(e in t)h(t,e)&&n.push("".concat(e,"=").concat(encodeURIComponent(t[e])));return n.join("&")})(t.param||{}),o=t.xhrFields,a.withCredentials=!!(o=void 0===o?{withCredentials:!1}:o).withCredentials;var s=a,l=t.headers||{};if(s.setRequestHeader)for(var u in s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l=l||{})h(l,u)&&s.setRequestHeader(u,l[u])}a.send(i)}}))}var y=window&&window.__awaiter||function(t,e,n,o){return new(n=n||Promise)((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?r(t.value):((e=t.value)instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((o=o.apply(t,e||[])).next())}))},g=window&&window.__generator||function(t,e){var n,o,r,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){var l=[s,c];if(n)throw new TypeError("Generator is already executing.");for(;i=a&&l[a=0]?0:i;)try{if(n=1,o&&(r=2&l[0]?o.return:l[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,l[1])).done)return r;switch(o=0,(l=r?[2&l[0],r.value]:l)[0]){case 0:case 1:r=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,o=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!((r=0<(r=i.trys).length&&r[r.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3]))i.label=l[1];else if(6===l[0]&&i.label<r[1])i.label=r[1],r=l;else{if(!(r&&i.label<r[2])){r[2]&&i.ops.pop(),i.trys.pop();continue}i.label=r[2],i.ops.push(l)}}l=e.call(t,i)}catch(c){l=[6,c],o=0}finally{n=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}},v=window&&window.__assign||function(){return(v=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function w(t){return"object"==typeof t&&!Array.isArray(t)}function m(t){return t instanceof Object&&t.constructor!==Object}var b="https://weblog.cdn-go.cn/sdk/v".concat("1.38.0","/"),x="".concat(b,"browser/browser-backend-web.js"),O="".concat(b,"browser-remote-plugins/browser-remote-plugins.js"),S=(R.prototype.setupOnce=function(n){var o=this,r=(this.client=n,this.getPersistedLevel());n.setLevel(r),n.on(t.GET_CONFIG,(function(t){var r=t.config,i=null==r?void 0:r.level;i?(o.persistLevel(i),n.setLevel(i)):(o.clearPersistedLevel(),n.setLevel(e.INFO))}))},R.prototype.persistLevel=function(t){try{window.localStorage.setItem(this.getStorageKey(),String(t))}catch(t){r(t)}},R.prototype.getPersistedLevel=function(){try{return Number(window.localStorage[this.getStorageKey()])||e.INFO}catch(t){return r(t),e.INFO}},R.prototype.clearPersistedLevel=function(){try{window.localStorage.removeItem(this.getStorageKey())}catch(t){r(t)}},R.prototype.getStorageKey=function(){return"".concat("wl","-level-").concat(this.client.getContext().pid)},R),I=(L.prototype.setupOnce=function(e){var n=this;this.hasUrlOptions()&&e.loadAsset("URL_OPTIONS"),e.on(t.GET_CONFIG,(function(t){var o=t.config;o&&n.loadRemotePlugin(e,o)}))},L.prototype.loadRemotePlugin=function(t,e){try{var n=e.options,o=n&&JSON.parse(n)||{};"on"===o.WL_TOOL_ON_OFF&&t.loadAsset("CONFIG_OPTIONS",o)}catch(t){r(t)}},L.prototype.hasUrlOptions=function(){return Boolean(location.search.match("[?&]wl="))},L),T=function(t,e){return(T=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)};function L(){this.name="remote-plugin"}function R(){this.name="level-setting"}var k=function(){return(k=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function E(t,e,n,o){return new(n=n||Promise)((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?r(t.value):((e=t.value)instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((o=o.apply(t,e||[])).next())}))}function _(t,e){var n,o,r,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){var l=[s,c];if(n)throw new TypeError("Generator is already executing.");for(;i=a&&l[a=0]?0:i;)try{if(n=1,o&&(r=2&l[0]?o.return:l[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,l[1])).done)return r;switch(o=0,(l=r?[2&l[0],r.value]:l)[0]){case 0:case 1:r=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,o=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!((r=0<(r=i.trys).length&&r[r.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3]))i.label=l[1];else if(6===l[0]&&i.label<r[1])i.label=r[1],r=l;else{if(!(r&&i.label<r[2])){r[2]&&i.ops.pop(),i.trys.pop();continue}i.label=r[2],i.ops.push(l)}}l=e.call(t,i)}catch(c){l=[6,c],o=0}finally{n=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}function C(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(o=i.next()).done;)a.push(o.value)}catch(t){r={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}function A(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||((o=o||Array.prototype.slice.call(e,0,r))[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}var N=null;function P(t,e){return new Promise((function(n){var o=document.createElement("script");o.async=!0,o.src=t,o.setAttribute("retry-when-error","true"),o.onload=function(){var t=e.split(".").reduce((function(t,e){return t[e]}),window);n(t)},(document.head||document.body).appendChild(o)}))}F.prototype.beforeInvokeLog=function(t){var e,n=t.msgArray,o=t.type.split("_");return"loader"!==o[0]?t:(e=n.pop(),{msgArray:n,ts:e,type:o[1]||""})};var j,D,q,M=F;function F(){this.name="loader"}(j=j||{}).HttpRequestLogType="x",(q=D=D||{})[q.Request=0]="Request",q[q.ReplyOK=1]="ReplyOK",q[q.ReplyErr=2]="ReplyErr";var H="weblog-rpc",U=(W.identifiers={},W.count=0,W),G={MainThreadBackendLogger:K("MainThreadBackendLogger",["fatal"],!0)},B={ExtHostBackend:K("ExtHostBackend",["init","identify","insertLog","queryLog","reportLog","getSessionId"],!1)};function W(t,e,n){this.isMain=t,this.sid=e,this.methodNames=n,this.nid=++W.count,W.identifiers[this.nid]=this}function K(t,e,n){return new U(n,t,e)}function z(t){var e=U.identifiers[t];if(e)return e.sid;throw new Error("No ProxyIdentifier found for nid: ".concat(t))}function J(t){this.initialized=!1,this.count=0,this.lastLogTs=0,this.level=e.INFO,this.options=t}Object.defineProperty(ot.prototype,Symbol.toStringTag,{get:function(){return"LazyPromise"},enumerable:!1,configurable:!0}),ot.prototype.resolve=function(t){var e;this.hasValue||this.hasError||(this.hasValue=!0,this.value=t,null==(e=this.actualResolve))||e.call(this,t)},ot.prototype.reject=function(t){var e;this.hasValue||this.hasError||(this.hasError=!0,this.error=t,null==(e=this.actualReject))||e.call(this,t)},ot.prototype.then=function(t,e){return this.ensureActual().then(t,e)},ot.prototype.catch=function(t){return this.ensureActual().catch(t)},ot.prototype.finally=function(t){return this.ensureActual().finally(t)},ot.prototype.ensureActual=function(){var t=this;return this.actual||(this.actual=new Promise((function(e,n){t.actualResolve=e,t.actualReject=n,t.tryResolve()}))),this.actual},ot.prototype.tryResolve=function(){this.hasValue&&this.actualResolve&&this.actualResolve(this.value),this.hasError&&this.actualReject&&this.actualReject(this.error)};var V=ot,X=window&&window.__awaiter||function(t,e,n,o){return new(n=n||Promise)((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?r(t.value):((e=t.value)instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((o=o.apply(t,e||[])).next())}))},Y=window&&window.__generator||function(t,e){var n,o,r,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){var l=[s,c];if(n)throw new TypeError("Generator is already executing.");for(;i=a&&l[a=0]?0:i;)try{if(n=1,o&&(r=2&l[0]?o.return:l[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,l[1])).done)return r;switch(o=0,(l=r?[2&l[0],r.value]:l)[0]){case 0:case 1:r=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,o=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!((r=0<(r=i.trys).length&&r[r.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3]))i.label=l[1];else if(6===l[0]&&i.label<r[1])i.label=r[1],r=l;else{if(!(r&&i.label<r[2])){r[2]&&i.ops.pop(),i.trys.pop();continue}i.label=r[2],i.ops.push(l)}}l=e.call(t,i)}catch(c){l=[6,c],o=0}finally{n=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}},Q=(nt.prototype.getProxy=function(t){var e=t.methodNames,n=t.nid;return this.proxies[n]||(this.proxies[n]=this.createProxy(n,e)),this.proxies[n]},nt.prototype.set=function(t,e){return this.locals[t.nid]=e},nt.prototype.createProxy=function(t,e){var n=this,o={};return e.forEach((function(e){o[e]=function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return n.remoteCall(t,e,o)}})),o},nt.prototype.remoteCall=function(t,e,n){this.lastMessageId+=1;var o=this.lastMessageId,r=String(o),i=new V,a={key:H,type:D.Request,req:o,rpcId:t,method:e,args:n};return this.pendingReplies[r]=i,this.protocol.send(a),i},nt.prototype.receiveOneMessage=function(t){if(t.key===H){var e=t.type,n=t.req;if(void 0!==e&&void 0!==n)switch(e){case D.Request:var o=(()=>{if(t.type===D.Request&&void 0!==t.rpcId&&void 0!==t.method&&void 0!==t.args)return{rpcId:t.rpcId,method:t.method,args:t.args}})();o&&this.receiveRequest(n,o.rpcId,o.method,o.args);break;case D.ReplyOK:this.handleReply(n,!0,t);break;case D.ReplyErr:this.handleReply(n,!1,t);break;default:l("received unexpected message type: ".concat(e))}else l("received malformed message: ".concat(JSON.stringify(t)))}},nt.prototype.handleReply=function(t,e,n){var o,r=String(t);this.pendingReplies[r]&&(o=this.pendingReplies[r],delete this.pendingReplies[r],e?o.resolve((()=>{if(n.type===D.ReplyOK)return n.result})()):o.reject((()=>{if(n.type===D.ReplyErr)return n.err})()))},nt.prototype.receiveRequest=function(t,e,n,o){var r=this;this.invokeHandler(e,n,o).then((function(e){var n={key:H,type:D.ReplyOK,req:t,rpcId:0,method:"",result:e};r.protocol.send(n)})).catch((function(e){var n={key:H,type:D.ReplyErr,req:t,rpcId:0,method:"",err:e};r.protocol.send(n)}))},nt.prototype.invokeHandler=function(t,e,n){return X(this,void 0,void 0,(function(){var o,r;return Y(this,(function(i){if(!(o=this.locals[t]))throw new Error("Unknown actor ".concat(z(t)));if("function"!=typeof(r=o[e]))throw new Error("Unknown method ".concat(e," on actor ").concat(z(t)));return[2,r.apply(o,n)]}))}))},nt),Z=window&&window.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(o=i.next()).done;)a.push(o.value)}catch(t){r={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},$=window&&window.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||((o=o||Array.prototype.slice.call(e,0,r))[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))},tt=(et.prototype.on=function(t,e){var n=this;return this.events[t]||(this.events[t]=new Set),this.events[t].add(e),function(){return n.events[t].delete(e)}},et.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var o=this.events[t];null!=o&&o.forEach((function(t){return t.apply(void 0,$([],Z(e),!1))}))},et);function et(){this.events=Object.create(null)}function nt(t){var e=this;this.protocol=t,this.proxies={},this.pendingReplies={},this.locals={},this.lastMessageId=0,t.onMessage((function(t){return e.receiveOneMessage(t)}))}function ot(){this.actual=null,this.actualResolve=null,this.actualReject=null,this.hasValue=!1,this.value=null,this.hasError=!1,this.error=null}st.prototype.setupIntegrations=function(t,e,n){var o=this;(t=void 0===t?[]:t).forEach((function(t){o.setupIntegration(t,n,e)}))},st.prototype.getIntegration=function(t){return this.installedIntegrations.find((function(e){return e.name===t}))},st.prototype.beforeInvokeLog=function(t){return this.installedIntegrations.reduce((function(t,e){return e.beforeInvokeLog?e.beforeInvokeLog(t):t}),t)},st.prototype.setupIntegration=function(t,e,n){var o,r;this.installedIntegrationNames.has(t.name)||!1===(null==(o=t.canSetup)?void 0:o.call(t,e))||(null!=(r=t.setupOnce)&&r.call(t,e,n),this.installedIntegrations.push(t),this.installedIntegrationNames.add(t.name))};var rt=st,it=(at.prototype.send=function(t){this.protocol?this.protocol.send(t):this.messages.push(t)},at.prototype.setProtocol=function(t){var e=this;(this.protocol=t).onMessage((function(t){e.eventEmitter.emit("message",t)})),this.messages.forEach((function(t){return e.send(t)})),this.messages=[]},at);function at(t){this.eventEmitter=new tt,this.onMessage=this.eventEmitter.on.bind(this.eventEmitter,"message"),this.messages=[],t&&this.setProtocol(t)}function st(){this.installedIntegrations=[],this.installedIntegrationNames=new Set}function ct(t){switch(t){case e.DEBUG:return"log";case e.INFO:return"info";case e.WARN:return"warn";case e.ERROR:return"error";case e.FATAL:return"fatal";default:return""}}var lt,ut,pt=window&&window.__awaiter||function(t,e,n,o){return new(n=n||Promise)((function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?r(t.value):((e=t.value)instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((o=o.apply(t,e||[])).next())}))},ft=window&&window.__generator||function(t,e){var n,o,r,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){var l=[s,c];if(n)throw new TypeError("Generator is already executing.");for(;i=a&&l[a=0]?0:i;)try{if(n=1,o&&(r=2&l[0]?o.return:l[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,l[1])).done)return r;switch(o=0,(l=r?[2&l[0],r.value]:l)[0]){case 0:case 1:r=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,o=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!((r=0<(r=i.trys).length&&r[r.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3]))i.label=l[1];else if(6===l[0]&&i.label<r[1])i.label=r[1],r=l;else{if(!(r&&i.label<r[2])){r[2]&&i.ops.pop(),i.trys.pop();continue}i.label=r[2],i.ops.push(l)}}l=e.call(t,i)}catch(c){l=[6,c],o=0}finally{n=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}},ht={maxCount:1e4,maxLength:2048,keepDays:10},dt=(yt.prototype.setDefaultOptions=function(t){this.context.options=this.mergeOptions(t=void 0===t?{}:t)},yt.prototype.init=function(t,e){void 0===e&&(e={}),this.context.initialized||(this.context.initialized=!0,this.context.pid=t,this.context.options=this.mergeOptions(e),this.integrationManager.setupIntegrations(this.context.options.integration,this.context.options,this),this.logInitialization(),this.backend.init(t,this.constructBackendOptions()))},yt.prototype.identify=function(e,n){return pt(this,void 0,void 0,(function(){var o;return ft(this,(function(r){switch(r.label){case 0:return this.sdkLogger.info({identify:{uid:e,info:n}}),e?(this.context.uid=e,[4,this.backend.identify(e,n)]):[2];case 1:return o=r.sent(),this.context.config=o,this.sdkLogger.info({config:o}),this.event.emit(t.GET_CONFIG,{config:o}),[2,o]}}))}))},yt.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.invoke(e.DEBUG,t)},yt.prototype.log=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.invoke(e.DEBUG,t)},yt.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.invoke(e.INFO,t)},yt.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.invoke(e.WARN,t)},yt.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this.invoke(e.ERROR,t)},yt.prototype.fatal=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.invoke(e.FATAL,t)},yt.prototype.report=function(t,e,n){return this.backend.reportLog(t,null!=e?e:{},null!=n?n:{})},yt.prototype.getLogger=function(t){var e;return this.loggers.get(t)||(e=Object.create(this,{namespace:{value:t}}),this.loggers.set(t,e),e)},yt.prototype.on=function(t,e){return this.event.on(t,e)},yt.prototype.query=function(t){return this.backend.queryLog(t)},yt.prototype.setLevel=function(t){this.context.level=t},yt.prototype.setProtocol=function(t){this.protocol.setProtocol(t)},yt.prototype.getContext=function(){return this.context},yt.prototype.getOptions=function(){return this.context.options},yt.prototype.getSessionId=function(){return this.backend.getSessionId()},yt.prototype.getOriginalMsg=function(t){var e;return null!=(e=t[i])?e:[]},yt.prototype.mergeOptions=function(t){return function t(e,n,o){if(void 0===o&&(o=new WeakMap),Array.isArray(e)&&Array.isArray(n))return e.concat(n);if(m(e)||m(n)||!w(e)||!w(n))return n;if(o.has(n))return n;o.set(n,n);var r,i=v({},e);for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=t(e[r],n[r],o));return i}(this.context.options,t=void 0===t?{}:t)},yt.prototype.invoke=function(e,n){var o,r,a,s,c,l,u,p,h,d,y,g,v;this.shouldSkipLog(e)||(this.context.count+=1,s=(a=this.context).count,c=a.lastLogTs,l=a.options,u=Date.now(),h=(p=this.integrationManager.beforeInvokeLog({msgArray:n,ts:u,type:this.namespace})).msgArray,d=p.ts,y=p.type,g=this.processLogMessages(h,s,l.maxCount,l.maxLength,e),this.context.lastLogTs=Math.max(d,c+1),(o={level:e,msg:f(g),type:y,ts:this.context.lastLogTs})[i]=h,v=o,null!=(r=this.context.options)&&r.shouldInsertLog&&!1===this.context.options.shouldInsertLog(v))||(this.event.emit(t.INSERT_LOG,v),this.backend.insertLog(v))},yt.prototype.shouldSkipLog=function(t){var e=this.context,n=e.count;return t<this.context.level||n>e.options.maxCount},yt.prototype.processLogMessages=function(t,n,o,i,a){var s,c,l,u,p;return a===e.FATAL?t:(s=t,u=i,(p=f(l=n===o?(r(c=["[wl]单次访问达到日志上限:".concat(o,"条]")]),c):s)).length>u?["".concat(p.slice(0,u),"..")]:l)},yt.prototype.constructBackendOptions=function(){var t,e=this.context.options,n=e.release,o=e.batchLogTime,r=e.logFileDir;return{release:n,env:e.env,relatedPids:e.relatedPids,keepDays:e.keepDays,docId:e.docId,dbName:e.dbName||(t=this.context.pid,"wl-".concat(t)),batchLogTime:o,logFileDir:r}},yt.prototype.logInitialization=function(){var t=this.context.options,e=t.release;this.sdkLogger.info({init:{pid:this.context.pid,release:e,env:t.env,v:this.version}})},yt);function yt(t){this.version="1.38.0",this.integrationManager=new rt,this.protocol=new it,this.loggers=new Map,this.context=new J(ht),this.event=new tt,this.namespace="",this.context.options=this.mergeOptions(t),this.rpcProtocol=new Q(this.protocol),this.sdkLogger=this.getLogger("wl-sdk"),this.rpcProtocol.set(G.MainThreadBackendLogger,this.sdkLogger),this.backend=this.rpcProtocol.getProxy(B.ExtHostBackend)}function gt(t){return"display:inline-block;background-color:".concat(wt[t],";color:#fff;padding:2px 4px;")}window&&window.__assign,window&&window.__awaiter,window&&window.__generator,window&&window.__rest,window&&window.__read,window&&window.__spreadArray,window&&window.__values,(ut=lt=lt||{}).HIDE="hide",ut.SHOW="show";var vt="dev-console",wt={log:"#007a41",info:"#1e6fff",warn:"#e07800",error:"#e02424",fatal:"#e02424",logType:"rgba(69, 77, 90, 0.6)"},mt=(bt.prototype.setupOnce=function(e){this.client=e,this.getPersistedConsoleDevStatus()!==lt.HIDE&&function(e,n){y(this,void 0,void 0,(function(){var o,r;return g(this,(function(i){switch(i.label){case 0:return o=[],r=e.on(t.INSERT_LOG,(function(t){o.push(t)})),[4,e.query()];case 1:return i.sent().concat(o).forEach(n),r(),o=[],[2,e.on(t.INSERT_LOG,n)]}}))}))}(e,this.logHandler)},bt.prototype.buildConsoleLog=function(t){var e=t.level,n=t.type,o=ct(e),r=this.client.getOriginalMsg(t),i=[];return n?i.push("%c".concat(o.toUpperCase(),"%c").concat(n||"?"),gt(o),gt("logType")):i.push("%c".concat(o.toUpperCase()),gt(o)),i.push.apply(i,A([],C(r),!1)),i},bt);function bt(){var t=this;this.name=vt,this.persistConsoleDevStatus=function(e){try{window.localStorage.setItem(t.getStorageKey(),e)}catch(e){l(e)}},this.logHandler=function(e){var n;e.type!==j.HttpRequestLogType&&(n=t.buildConsoleLog(e),console.log.apply(console,A([],C(n),!1)))},this.getPersistedConsoleDevStatus=function(){try{return window.localStorage.getItem(t.getStorageKey())||lt.HIDE}catch(t){return r(t),lt.HIDE}},this.getStorageKey=function(){return"".concat("wl","-dev-console-").concat(t.client.getContext().pid)}}function xt(){return E(this,arguments,void 0,(function(t){var e=t.backendWorkerUrl;return _(this,(function(t){return e?[2,(r=new Worker(e),n=new tt,o="message",i={on:function(t){return n.on(o,t)},fire:function(t){return n.emit(o,t)}},r.onmessage=function(t){i.fire(t.data)},r.onerror=function(t){l("worker error",t)},{onMessage:i.on,send:function(t){r.postMessage(t)}})]:[2,P(x,"window.WebLog.mainProtocol")];var n,o,r,i}))}))}function Ot(){this.post=d}var St,It,Tt={BrowserMainThreadNetwork:K("BrowserMainThreadNetwork",["post"],!0)};function Lt(t){return E(this,void 0,void 0,(function(){var e,n,o;return _(this,(function(r){switch(r.label){case 0:return e={file_size:t.fileSize,filename:t.fileName,ext:t.ext,is_multipart:t.isMultipart,parent_id:t.parentId,hostFile:t.hostFileId,tmp_upload:t.tmpUpload,weblog_upload:!0},[4,(i="/v2/drive/applyUpload?xsrf=".concat((()=>{for(var t=document.cookie.split(";"),e=0;e<t.length;e++){var n=t[e].trim();if(n.startsWith("".concat("TOK","=")))return decodeURIComponent(n.substring(4))}return null})()),a=e,new Promise((function(t,e){var n=new XMLHttpRequest;n.open("POST",i),n.setRequestHeader("Content-Type","application/json"),n.onreadystatechange=function(){if(n.readyState===It.DONE){var o;if(200!==n.status)throw o=new Error("".concat(i," 请求失败，状态码为 ").concat(n.status)),e(o),o;t(JSON.parse(n.responseText))}},n.send(JSON.stringify(a))})))];case 1:if(n=r.sent(),(o=n.retcode)!==St.SUCCESS)throw new Error("上传信息获取失败，错误码：".concat(o));return[2,n.result]}var i,a}))}))}(St=St||{})[St.SUCCESS=0]="SUCCESS",(It=It||{})[It.DONE=4]="DONE";var Rt="upload-to-cos",kt=(Nt.prototype.setupOnce=function(t){return E(this,void 0,void 0,(function(){return _(this,(function(e){return this.client=t,[2]}))}))},Nt.prototype.uploadToCos=function(){return E(this,arguments,void 0,(function(t){var e,n,o,r,i,a,s,l,u,p,f;return void 0===t&&(t={}),_(this,(function(h){switch(h.label){case 0:return e=t.pid,n=t.startTs,o=t.endTs,r=t.sessionId,i=t.query,a=this.client.getContext().pid,s=new Date,l=new Date(s.getFullYear(),s.getMonth(),s.getDate(),0,0,0).getTime(),u=new Date(s.getFullYear(),s.getMonth(),s.getDate(),23,59,59).getTime(),this.queryLogOption={pid:e||a,startTs:null!=n?n:l,endTs:null!=o?o:u,sessionId:r,query:i},c("queryLogOption",this.queryLogOption),[4,this.uploadLogFileToCos()];case 1:if(p=h.sent(),null!=(f=p.objKey)&&f.replace("weblog/",""))return[2,p];throw new Error("上传失败：文件上传信息获取失败!")}}))}))},Nt.prototype.uploadLogFileToCos=function(){return E(this,void 0,void 0,(function(){var t,e,n,o;return _(this,(function(r){switch(r.label){case 0:return t="weblog_log_".concat((new Date).getTime()),[4,this.queryLogsText()];case 1:return e=r.sent(),n=this.getFileByText(t,e),[4,Lt({fileName:t,ext:"txt",fileSize:n.size,isMultipart:!1,tmpUpload:!1})];case 2:return i=(o=r.sent()).uploadUrl,a=n,(s=new FormData).append("file",a),(c=new XMLHttpRequest).open("PUT",i),c.onreadystatechange=function(){c.readyState===XMLHttpRequest.DONE&&c.status},c.send(s),[2,o]}var i,a,s,c}))}))},Nt.prototype.queryLogsText=function(){return E(this,void 0,void 0,(function(){var t,e,n,o,r,i,a,s,c=this;return _(this,(function(l){switch(l.label){case 0:return t=this.queryLogOption,[4,this.client.query(t)];case 1:return e=l.sent(),(n=e.map((function(t){var e;return t&&Array.isArray(t.data)&&((e=t.data||[]).unshift(t.msg),t.msg=JSON.stringify(e)),{ts:t.ts,sessionId:t.sessionId,level:t.level,msg:String(t.msg),type:t.type}})))&&0!==n.length?(o=this.timestampToDateString(t.startTs),r=this.timestampToDateString(t.endTs),i="日志起止时间：".concat(o," ~ ").concat(r,"\n\n"),a="level".concat(this.getTabs(1),"type").concat(this.getTabs(2),"time").concat(this.getTabs(4),"sessionId").concat(this.getTabs(5),"message\n"),s=i+a,n.forEach((function(t){s+="".concat(ct(t.level)+c.getTabs(1)+t.type+c.getTabs(2)+c.timestampToDateString(t.ts)+c.getTabs(2)+t.sessionId+c.getTabs(3)+c.msgTransform(t.msg),"\n")})),[2,s]):[2,Promise.resolve("")]}}))}))},Nt.prototype.getTabs=function(t){for(var e="",n=0;n<t;n++)e+="\t";return e},Nt.prototype.timestampToDateString=function(t){var e;return void 0===t?"":(e=new Date(t),"".concat(e.getFullYear(),"-")+"".concat(e.getMonth()+1<10?"0".concat(e.getMonth()+1):e.getMonth()+1,"-")+"".concat(e.getDate()," ")+"".concat(e.getHours(),":")+"".concat(e.getMinutes(),":")+e.getSeconds())},Nt.prototype.getFileByText=function(t,e){var n=new Blob([e],{type:"text/plain"});return new File([n],t,{type:"text/plain"})},Nt.prototype.msgTransform=function(t){if(!t)return"";var e=JSON.parse(t),n=e.length,o="";if(0!==n)for(var r=0;r<n;r++)u("String",e[r])||u("Number",e[r])?o+="".concat(e[r]," "):o+="".concat(f(e[r])," ");return o},Nt),Et=(t=>{function e(e){var n=t.call(this,e)||this;return n.setClientNetwork(),n}var n=e,o=t;if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=n}return T(n,o),n.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r),e.prototype.init=function(e){return E(this,arguments,void 0,(function(e,n){var o;return void 0===n&&(n={}),_(this,(function(r){switch(r.label){case 0:return this.getContext().initialized?[2,this]:(t.prototype.init.call(this,e,n),[4,xt(this.getOptions())]);case 1:return o=r.sent(),this.setProtocol(o),[2,this]}}))}))},e.prototype.loadAsset=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return E(this,void 0,void 0,(function(){var e;return _(this,(function(n){switch(n.label){case 0:return[4,(o=this,E(void 0,void 0,void 0,(function(){var t;return _(this,(function(e){switch(e.label){case 0:return N?[2,N]:[4,P(O,"window.WebLog.BrowserRemotePlugins")];case 1:return[2,N=(t=e.sent())?new t(o):N]}}))})))];case 1:return null!=(e=n.sent())&&e.call.apply(e,A([],C(t),!1)),[2]}var o}))}))},e.prototype.showConsole=function(){this.integrationManager.getIntegration(vt).persistConsoleDevStatus(lt.SHOW)},e.prototype.hideConsole=function(){this.integrationManager.getIntegration(vt).persistConsoleDevStatus(lt.HIDE)},e.prototype.uploadToCos=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this.integrationManager.getIntegration(Rt);if(n)return n.uploadToCos.apply(n,t);throw new Error("UploadToCosIntegration not found")},e.prototype.setClientNetwork=function(){this.rpcProtocol.set(Tt.BrowserMainThreadNetwork,new Ot)},e})(dt),_t=new Et({integration:[new S,new I,new M,new mt,new kt]}),Ct="/scenario/pub/wl2/browser-backend-worker-".concat("1.38.0",".js"),At="doc.weixin.qq.com"===location.host;function Nt(){this.name=Rt,this.queryLogOption={}}function Pt(){try{return window.location.pathname.split("/").pop()||""}catch(t){return""}}var jt,Dt,qt=/(http:\/\/|https:\/\/)?(doc\.weixin\.qq\.com|docs\.qq\.com)/gi,Mt="doc.weixin.qq.com"===location.host,Ft="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},Ht=(Kt.prototype.setupOnce=function(){},Kt.prototype.beforeInvokeLog=function(t){var e=this;if(Mt)try{var n,o=t.msgArray;o instanceof Array&&0<o.length&&(n=o.map((function(t){var n=new WeakSet;return e.deepClone(t,0,n)})),t.msgArray=n)}catch(t){c(t)}return t},Kt.prototype.deepClone=function(t,e,n){var o,r,i=this;if(void 0===n&&(n=null),!(8<(e=void 0===e?0:e))){var a=typeof t;if("string"==a)return t.replace(qt,"TDOC_HOSTNAME");if("boolean"==a||"number"==a||"undefined"==a||null===t)return t;if("symbol"==a||"bigint"==a)return t.toString();if("function"==a)return"[Function: ".concat(t.name||"anonymous","]");if(t===Ft)return"[Symbol(window)]";if("object"==a&&null!==t){if(null!=n&&n.has(t))return"[Circular]";n&&n.add(t)}if(Array.isArray(t))return t.map((function(t){return i.deepClone(t,e+1,n)}));var s={},c=Object.keys(t);try{for(var l=(t=>{var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&o>=t.length?void 0:t)&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")})(c),u=l.next();!u.done;u=l.next()){var p=u.value;s[p]=this.deepClone(t[p],e+1,n)}}catch(t){o={error:t}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(o)throw o.error}}return s}},Kt),Ut=(Wt.prototype.setupOnce=function(t,e){return E(this,void 0,void 0,(function(){var n,o;return _(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),"doc.weixin.qq.com"===location.host&&t instanceof Et?[4,t.getSessionId()]:[3,2];case 1:n=r.sent(),e.remotePluginOptions||(e.remotePluginOptions={reportDialog:{}}),e.remotePluginOptions.reportDialog||(e.remotePluginOptions.reportDialog={}),e.remotePluginOptions.reportDialog.getReportInfo=function(){return"docId: ".concat(Pt(),"; sessionId: ").concat(n)},r.label=2;case 2:return[3,4];case 3:return o=r.sent(),l("report-info integration errror",o),[3,4];case 4:return[2]}}))}))},Wt),Gt=(Bt.prototype.setupOnce=function(t){var e,n,o,r,i=t.getOptions().network||{},a=i.isEnabled,s=i.beforeRequest,c=i.afterResponse,u=i.onError;a&&(t.info("[wl] 网络请求日志集成已启用"),e=window.XMLHttpRequest)&&(n=e.prototype.open,o=e.prototype.send,r=t.getLogger(j.HttpRequestLogType),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o,r,i=t[0].toUpperCase(),a=t[1],s="undefined"==typeof crypto?"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})):(o=new Uint16Array(8),crypto.getRandomValues(o),o[3]=4095&o[3]|16384,o[4]=16383&o[4]|32768,(r=function(t){for(var e=t.toString(16);e.length<4;)e="0".concat(e);return e})(o[0])+r(o[1])+r(o[2])+r(o[3])+r(o[4])+r(o[5])+r(o[6])+r(o[7]));return this.logData={id:s,method:i,url:a,extra:{}},n.apply(this,t)},e.prototype.send=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i=this,a=i.logData,p=i.onload||function(){},f=(a.t1=Date.now(),i.onload=function(){for(var e,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];if(a&&4===i.readyState)try{var s=null==(e="function"==typeof c&&c(a,i,t))||e;a.status=i.status,a.t2=Date.now(),r[s?"info":"error"](a)}catch(e){l("[wl]计算请求耗时的时候失败",e)}return p.apply(i,n)},i.onerror||function(){});return i.onerror=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return a.t2=Date.now(),a.status=i.status,a.responseText=i.responseText,r.error(a),null!=u&&u(a,i,t),f.apply(i,e)},"function"==typeof s&&s(a,i,t),o.apply(i,e)})},Bt);function Bt(){this.name="network"}function Wt(){this.name="report-info"}function Kt(){this.name="log-filter"}return _t.setDefaultOptions({docId:Pt(),backendWorkerUrl:Ct,integration:[new Ht,new Ut,new Gt],batchLogTime:At?3e3:0,network:{isEnabled:"private-tdocs"===(null==(Dt=null==(jt=window.AppConfig)?void 0:jt.normal)?void 0:Dt.domain),afterResponse:function(t,e){try{var n=e.response;if(n&&"string"==typeof n){var o=JSON.parse(n);if(o&&"object"==typeof o){var r=o.retcode,i=o.msg,a=e.getResponseHeader("x-trace-id")||"";if(t.extra=k(k({},t.extra||{}),{retcode:r,msg:i,traceId:a}),void 0!==r&&0!==r)return!1}}}catch(t){}}}}),_t})();